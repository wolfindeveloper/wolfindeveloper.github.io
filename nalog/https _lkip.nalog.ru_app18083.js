var Ext=Ext||{};if(!Ext.locale){Ext.locale={}}if(!Ext.locale.ru){Ext.locale.ru={}}if(!Ext.locale.ru.form){Ext.locale.ru.form={}}if(!Ext.locale.ru.form.field){Ext.locale.ru.form.field={}}if(!Ext.locale.ru.grid){Ext.locale.ru.grid={}}if(!Ext.locale.ru.grid.header){Ext.locale.ru.grid.header={}}if(!Ext.locale.ru.grid.plugin){Ext.locale.ru.grid.plugin={}}if(!Ext.locale.ru.picker){Ext.locale.ru.picker={}}if(!Ext.locale.ru.tab){Ext.locale.ru.tab={}}if(!Ext.locale.ru.toolbar){Ext.locale.ru.toolbar={}}if(!Ext.locale.ru.view){Ext.locale.ru.view={}}if(!Ext.locale.ru.window){Ext.locale.ru.window={}}var ExtThemeNeptune=ExtThemeNeptune||{};if(!ExtThemeNeptune.container){ExtThemeNeptune.container={}}if(!ExtThemeNeptune.form){ExtThemeNeptune.form={}}if(!ExtThemeNeptune.form.field){ExtThemeNeptune.form.field={}}if(!ExtThemeNeptune.grid){ExtThemeNeptune.grid={}}if(!ExtThemeNeptune.grid.column){ExtThemeNeptune.grid.column={}}if(!ExtThemeNeptune.layout){ExtThemeNeptune.layout={}}if(!ExtThemeNeptune.layout.component){ExtThemeNeptune.layout.component={}}if(!ExtThemeNeptune.menu){ExtThemeNeptune.menu={}}if(!ExtThemeNeptune.panel){ExtThemeNeptune.panel={}}if(!ExtThemeNeptune.picker){ExtThemeNeptune.picker={}}if(!ExtThemeNeptune.resizer){ExtThemeNeptune.resizer={}}if(!ExtThemeNeptune.tab){ExtThemeNeptune.tab={}}if(!ExtThemeNeptune.toolbar){ExtThemeNeptune.toolbar={}}var Lk3IpTheme=Lk3IpTheme||{};if(!Lk3IpTheme.button){Lk3IpTheme.button={}}if(!Lk3IpTheme.form){Lk3IpTheme.form={}}if(!Lk3IpTheme.form.field){Lk3IpTheme.form.field={}}if(!Lk3IpTheme.layout){Lk3IpTheme.layout={}}if(!Lk3IpTheme.layout.container){Lk3IpTheme.layout.container={}}if(!Lk3IpTheme.picker){Lk3IpTheme.picker={}}if(!Lk3IpTheme.tip){Lk3IpTheme.tip={}}var LkIp=LkIp||{};if(!LkIp.controller){LkIp.controller={}}if(!LkIp.controller.Consent){LkIp.controller.Consent={}}if(!LkIp.controller.Docflow){LkIp.controller.Docflow={}}if(!LkIp.controller.Egrip){LkIp.controller.Egrip={}}if(!LkIp.controller.Egrn){LkIp.controller.Egrn={}}if(!LkIp.controller.Employees){LkIp.controller.Employees={}}if(!LkIp.controller.Foreign){LkIp.controller.Foreign={}}if(!LkIp.controller.Information){LkIp.controller.Information={}}if(!LkIp.controller.Information.Service){LkIp.controller.Information.Service={}}if(!LkIp.controller.Kkt){LkIp.controller.Kkt={}}if(!LkIp.controller.Kkt.Manufacturer){LkIp.controller.Kkt.Manufacturer={}}if(!LkIp.controller.Kkt.Manufacturer.Fn){LkIp.controller.Kkt.Manufacturer.Fn={}}if(!LkIp.controller.Kkt.Manufacturer.Fn.Instances){LkIp.controller.Kkt.Manufacturer.Fn.Instances={}}if(!LkIp.controller.Kkt.Manufacturer.Models){LkIp.controller.Kkt.Manufacturer.Models={}}if(!LkIp.controller.Kkt.Manufacturer.Models.Instances){LkIp.controller.Kkt.Manufacturer.Models.Instances={}}if(!LkIp.controller.PersonalData){LkIp.controller.PersonalData={}}if(!LkIp.controller.Rsb){LkIp.controller.Rsb={}}if(!LkIp.controller.Rsb.Cards){LkIp.controller.Rsb.Cards={}}if(!LkIp.controller.Rsb.Clarify){LkIp.controller.Rsb.Clarify={}}if(!LkIp.controller.Rsb.Clarify.Unexpay){LkIp.controller.Rsb.Clarify.Unexpay={}}if(!LkIp.controller.Rsb.Overpayment){LkIp.controller.Rsb.Overpayment={}}if(!LkIp.controller.Rsb.Reconciliation){LkIp.controller.Rsb.Reconciliation={}}if(!LkIp.controller.TaxSystems){LkIp.controller.TaxSystems={}}if(!LkIp.controller.TaxSystems.Eshn){LkIp.controller.TaxSystems.Eshn={}}if(!LkIp.controller.TaxSystems.Psn){LkIp.controller.TaxSystems.Psn={}}if(!LkIp.controller.TaxSystems.Usn){LkIp.controller.TaxSystems.Usn={}}if(!LkIp.mixins){LkIp.mixins={}}if(!LkIp.mixins.Information){LkIp.mixins.Information={}}if(!LkIp.mixins.Rsb){LkIp.mixins.Rsb={}}if(!LkIp.mixins.Rsb.Debt){LkIp.mixins.Rsb.Debt={}}if(!LkIp.mixins.Rsb.Unexpay){LkIp.mixins.Rsb.Unexpay={}}if(!LkIp.model){LkIp.model={}}if(!LkIp.model.Address){LkIp.model.Address={}}if(!LkIp.model.Calculator){LkIp.model.Calculator={}}if(!LkIp.model.DeskAudit){LkIp.model.DeskAudit={}}if(!LkIp.model.Docflow){LkIp.model.Docflow={}}if(!LkIp.model.Docflow.Documents){LkIp.model.Docflow.Documents={}}if(!LkIp.model.Docflow.Notice){LkIp.model.Docflow.Notice={}}if(!LkIp.model.Egrn){LkIp.model.Egrn={}}if(!LkIp.model.Egrn.Account){LkIp.model.Egrn.Account={}}if(!LkIp.model.Filters){LkIp.model.Filters={}}if(!LkIp.model.FnsMail){LkIp.model.FnsMail={}}if(!LkIp.model.FnsStands){LkIp.model.FnsStands={}}if(!LkIp.model.Kkt){LkIp.model.Kkt={}}if(!LkIp.model.Kkt.Manufacturer){LkIp.model.Kkt.Manufacturer={}}if(!LkIp.model.OnlineBooking){LkIp.model.OnlineBooking={}}if(!LkIp.model.Rsb){LkIp.model.Rsb={}}if(!LkIp.model.Rsb.Cards){LkIp.model.Rsb.Cards={}}if(!LkIp.model.Rsb.Cards.Debt){LkIp.model.Rsb.Cards.Debt={}}if(!LkIp.model.Rsb.Cards.Debt.Object){LkIp.model.Rsb.Cards.Debt.Object={}}if(!LkIp.model.Rsb.Cards.Debt.Object.GraphDebtPercent){LkIp.model.Rsb.Cards.Debt.Object.GraphDebtPercent={}}if(!LkIp.model.Rsb.Cards.Debt.Object.GraphInfo){LkIp.model.Rsb.Cards.Debt.Object.GraphInfo={}}if(!LkIp.model.Rsb.Cards.Debt.Object.GraphWriteOff){LkIp.model.Rsb.Cards.Debt.Object.GraphWriteOff={}}if(!LkIp.model.Rsb.Cards.Hung){LkIp.model.Rsb.Cards.Hung={}}if(!LkIp.model.Rsb.Cards.Nds){LkIp.model.Rsb.Cards.Nds={}}if(!LkIp.model.Rsb.Cards.Operations){LkIp.model.Rsb.Cards.Operations={}}if(!LkIp.model.Rsb.Clarify){LkIp.model.Rsb.Clarify={}}if(!LkIp.model.Rsb.Clarify.Unexpay){LkIp.model.Rsb.Clarify.Unexpay={}}if(!LkIp.model.Rsb.CompliedReqs){LkIp.model.Rsb.CompliedReqs={}}if(!LkIp.model.Rsb.DebitDecisions){LkIp.model.Rsb.DebitDecisions={}}if(!LkIp.model.Rsb.Overpayment){LkIp.model.Rsb.Overpayment={}}if(!LkIp.model.Rsb.OverpaymentDecisions){LkIp.model.Rsb.OverpaymentDecisions={}}if(!LkIp.model.Rsb.PvzDecisions){LkIp.model.Rsb.PvzDecisions={}}if(!LkIp.model.Rsb.Reconciliation){LkIp.model.Rsb.Reconciliation={}}if(!LkIp.model.Rsb.SuspendedDecisions){LkIp.model.Rsb.SuspendedDecisions={}}if(!LkIp.model.Rsb.UnexpayDecisions){LkIp.model.Rsb.UnexpayDecisions={}}if(!LkIp.model.TaxSystems){LkIp.model.TaxSystems={}}if(!LkIp.model.TaxSystems.Psn){LkIp.model.TaxSystems.Psn={}}if(!LkIp.plugins){LkIp.plugins={}}if(!LkIp.plugins.ComponentColumn){LkIp.plugins.ComponentColumn={}}if(!LkIp.store){LkIp.store={}}if(!LkIp.store.Calculator){LkIp.store.Calculator={}}if(!LkIp.store.DeskAudit){LkIp.store.DeskAudit={}}if(!LkIp.store.Docflow){LkIp.store.Docflow={}}if(!LkIp.store.Docflow.Documents){LkIp.store.Docflow.Documents={}}if(!LkIp.store.Docflow.Notice){LkIp.store.Docflow.Notice={}}if(!LkIp.store.Egrn){LkIp.store.Egrn={}}if(!LkIp.store.Egrn.Account){LkIp.store.Egrn.Account={}}if(!LkIp.store.EmployeesIdentification){LkIp.store.EmployeesIdentification={}}if(!LkIp.store.Envd){LkIp.store.Envd={}}if(!LkIp.store.FnsMail){LkIp.store.FnsMail={}}if(!LkIp.store.Information){LkIp.store.Information={}}if(!LkIp.store.Information.Service){LkIp.store.Information.Service={}}if(!LkIp.store.Information.Service.Operations){LkIp.store.Information.Service.Operations={}}if(!LkIp.store.Information.Service.Reconciliation){LkIp.store.Information.Service.Reconciliation={}}if(!LkIp.store.Kkt){LkIp.store.Kkt={}}if(!LkIp.store.Kkt.Manufacturer){LkIp.store.Kkt.Manufacturer={}}if(!LkIp.store.Rsb){LkIp.store.Rsb={}}if(!LkIp.store.Rsb.Cards){LkIp.store.Rsb.Cards={}}if(!LkIp.store.Rsb.Cards.Debt){LkIp.store.Rsb.Cards.Debt={}}if(!LkIp.store.Rsb.Cards.Debt.Object){LkIp.store.Rsb.Cards.Debt.Object={}}if(!LkIp.store.Rsb.Cards.Debt.Object.GraphDebtPercent){LkIp.store.Rsb.Cards.Debt.Object.GraphDebtPercent={}}if(!LkIp.store.Rsb.Cards.Debt.Object.GraphInfo){LkIp.store.Rsb.Cards.Debt.Object.GraphInfo={}}if(!LkIp.store.Rsb.Cards.Debt.Object.GraphWriteOff){LkIp.store.Rsb.Cards.Debt.Object.GraphWriteOff={}}if(!LkIp.store.Rsb.Cards.Hung){LkIp.store.Rsb.Cards.Hung={}}if(!LkIp.store.Rsb.Cards.Nds){LkIp.store.Rsb.Cards.Nds={}}if(!LkIp.store.Rsb.Cards.Operations){LkIp.store.Rsb.Cards.Operations={}}if(!LkIp.store.Rsb.Clarify){LkIp.store.Rsb.Clarify={}}if(!LkIp.store.Rsb.Clarify.Unexpay){LkIp.store.Rsb.Clarify.Unexpay={}}if(!LkIp.store.Rsb.CompliedReqs){LkIp.store.Rsb.CompliedReqs={}}if(!LkIp.store.Rsb.DebitDecisions){LkIp.store.Rsb.DebitDecisions={}}if(!LkIp.store.Rsb.Overpayment){LkIp.store.Rsb.Overpayment={}}if(!LkIp.store.Rsb.Overpayment.Statement){LkIp.store.Rsb.Overpayment.Statement={}}if(!LkIp.store.Rsb.Overpayment.Statement.OffsetDebt){LkIp.store.Rsb.Overpayment.Statement.OffsetDebt={}}if(!LkIp.store.Rsb.Overpayment.Statement.OffsetFuture){LkIp.store.Rsb.Overpayment.Statement.OffsetFuture={}}if(!LkIp.store.Rsb.OverpaymentDecisions){LkIp.store.Rsb.OverpaymentDecisions={}}if(!LkIp.store.Rsb.PvzDecisions){LkIp.store.Rsb.PvzDecisions={}}if(!LkIp.store.Rsb.PvzDecisions.Suspended){LkIp.store.Rsb.PvzDecisions.Suspended={}}if(!LkIp.store.Rsb.Reconciliation){LkIp.store.Rsb.Reconciliation={}}if(!LkIp.store.Rsb.Reconciliation.Object){LkIp.store.Rsb.Reconciliation.Object={}}if(!LkIp.store.Rsb.Reconciliation.Statement){LkIp.store.Rsb.Reconciliation.Statement={}}if(!LkIp.store.Rsb.SuspendedDecisions){LkIp.store.Rsb.SuspendedDecisions={}}if(!LkIp.store.Rsb.UnexpayDecisions){LkIp.store.Rsb.UnexpayDecisions={}}if(!LkIp.store.TaxSystem){LkIp.store.TaxSystem={}}if(!LkIp.store.TaxSystem.Psn){LkIp.store.TaxSystem.Psn={}}if(!LkIp.store.TaxSystem.Psn.Orn){LkIp.store.TaxSystem.Psn.Orn={}}if(!LkIp.store.TaxSystem.Psn.Patent){LkIp.store.TaxSystem.Psn.Patent={}}if(!LkIp.view){LkIp.view={}}if(!LkIp.view.Calculator){LkIp.view.Calculator={}}if(!LkIp.view.Complaints){LkIp.view.Complaints={}}if(!LkIp.view.Consent){LkIp.view.Consent={}}if(!LkIp.view.Deactivate){LkIp.view.Deactivate={}}if(!LkIp.view.Default){LkIp.view.Default={}}if(!LkIp.view.Default.CompositeFields){LkIp.view.Default.CompositeFields={}}if(!LkIp.view.Default.Filters){LkIp.view.Default.Filters={}}if(!LkIp.view.Default.Form){LkIp.view.Default.Form={}}if(!LkIp.view.DeskAudit){LkIp.view.DeskAudit={}}if(!LkIp.view.Docflow){LkIp.view.Docflow={}}if(!LkIp.view.Docflow.Documents){LkIp.view.Docflow.Documents={}}if(!LkIp.view.Docflow.Notice){LkIp.view.Docflow.Notice={}}if(!LkIp.view.Egrip){LkIp.view.Egrip={}}if(!LkIp.view.Egrip.Request){LkIp.view.Egrip.Request={}}if(!LkIp.view.Egrn){LkIp.view.Egrn={}}if(!LkIp.view.Egrn.Account){LkIp.view.Egrn.Account={}}if(!LkIp.view.Employees){LkIp.view.Employees={}}if(!LkIp.view.Employees.Identification){LkIp.view.Employees.Identification={}}if(!LkIp.view.Envd){LkIp.view.Envd={}}if(!LkIp.view.Envd.Deregistration){LkIp.view.Envd.Deregistration={}}if(!LkIp.view.Envd.Registration){LkIp.view.Envd.Registration={}}if(!LkIp.view.Feedback){LkIp.view.Feedback={}}if(!LkIp.view.FnsMail){LkIp.view.FnsMail={}}if(!LkIp.view.FnsStands){LkIp.view.FnsStands={}}if(!LkIp.view.Foreign){LkIp.view.Foreign={}}if(!LkIp.view.Index){LkIp.view.Index={}}if(!LkIp.view.Index.Widget){LkIp.view.Index.Widget={}}if(!LkIp.view.Information){LkIp.view.Information={}}if(!LkIp.view.Information.Service){LkIp.view.Information.Service={}}if(!LkIp.view.Information.Service.Accounting){LkIp.view.Information.Service.Accounting={}}if(!LkIp.view.Information.Service.Obligation){LkIp.view.Information.Service.Obligation={}}if(!LkIp.view.Information.Service.Operations){LkIp.view.Information.Service.Operations={}}if(!LkIp.view.Information.Service.PaymentsStatus){LkIp.view.Information.Service.PaymentsStatus={}}if(!LkIp.view.Information.Service.Reconciliation){LkIp.view.Information.Service.Reconciliation={}}if(!LkIp.view.Kkt){LkIp.view.Kkt={}}if(!LkIp.view.Kkt.DeRegistration){LkIp.view.Kkt.DeRegistration={}}if(!LkIp.view.Kkt.FiscalReport){LkIp.view.Kkt.FiscalReport={}}if(!LkIp.view.Kkt.Manufacturer){LkIp.view.Kkt.Manufacturer={}}if(!LkIp.view.Kkt.Manufacturer.Fn){LkIp.view.Kkt.Manufacturer.Fn={}}if(!LkIp.view.Kkt.Manufacturer.Fn.Instances){LkIp.view.Kkt.Manufacturer.Fn.Instances={}}if(!LkIp.view.Kkt.Manufacturer.Fn.Instances.Registration){LkIp.view.Kkt.Manufacturer.Fn.Instances.Registration={}}if(!LkIp.view.Kkt.Manufacturer.Models){LkIp.view.Kkt.Manufacturer.Models={}}if(!LkIp.view.Kkt.Manufacturer.Models.Instances){LkIp.view.Kkt.Manufacturer.Models.Instances={}}if(!LkIp.view.Kkt.Manufacturer.Models.Instances.Registration){LkIp.view.Kkt.Manufacturer.Models.Instances.Registration={}}if(!LkIp.view.Kkt.ReRegistration){LkIp.view.Kkt.ReRegistration={}}if(!LkIp.view.Kkt.Registration){LkIp.view.Kkt.Registration={}}if(!LkIp.view.Kkt.Registration.File){LkIp.view.Kkt.Registration.File={}}if(!LkIp.view.OnlineBooking){LkIp.view.OnlineBooking={}}if(!LkIp.view.Partnership){LkIp.view.Partnership={}}if(!LkIp.view.PersonalData){LkIp.view.PersonalData={}}if(!LkIp.view.PersonalData.Update){LkIp.view.PersonalData.Update={}}if(!LkIp.view.Profile){LkIp.view.Profile={}}if(!LkIp.view.Registration){LkIp.view.Registration={}}if(!LkIp.view.Rsb){LkIp.view.Rsb={}}if(!LkIp.view.Rsb.Budget){LkIp.view.Rsb.Budget={}}if(!LkIp.view.Rsb.Cards){LkIp.view.Rsb.Cards={}}if(!LkIp.view.Rsb.Cards.Budget){LkIp.view.Rsb.Cards.Budget={}}if(!LkIp.view.Rsb.Cards.Debt){LkIp.view.Rsb.Cards.Debt={}}if(!LkIp.view.Rsb.Cards.Debt.Objects){LkIp.view.Rsb.Cards.Debt.Objects={}}if(!LkIp.view.Rsb.Cards.Details){LkIp.view.Rsb.Cards.Details={}}if(!LkIp.view.Rsb.Cards.Hung){LkIp.view.Rsb.Cards.Hung={}}if(!LkIp.view.Rsb.Cards.Nds){LkIp.view.Rsb.Cards.Nds={}}if(!LkIp.view.Rsb.Cards.Operations){LkIp.view.Rsb.Cards.Operations={}}if(!LkIp.view.Rsb.Clarify){LkIp.view.Rsb.Clarify={}}if(!LkIp.view.Rsb.Clarify.Other){LkIp.view.Rsb.Clarify.Other={}}if(!LkIp.view.Rsb.Clarify.Unexpay){LkIp.view.Rsb.Clarify.Unexpay={}}if(!LkIp.view.Rsb.Clarify.Unexpay.Notify){LkIp.view.Rsb.Clarify.Unexpay.Notify={}}if(!LkIp.view.Rsb.Clarify.Unexpay.Statement){LkIp.view.Rsb.Clarify.Unexpay.Statement={}}if(!LkIp.view.Rsb.CompliedReqs){LkIp.view.Rsb.CompliedReqs={}}if(!LkIp.view.Rsb.DebitDecisions){LkIp.view.Rsb.DebitDecisions={}}if(!LkIp.view.Rsb.Overpayment){LkIp.view.Rsb.Overpayment={}}if(!LkIp.view.Rsb.Overpayment.Statement){LkIp.view.Rsb.Overpayment.Statement={}}if(!LkIp.view.Rsb.OverpaymentDecisions){LkIp.view.Rsb.OverpaymentDecisions={}}if(!LkIp.view.Rsb.PvzDecisions){LkIp.view.Rsb.PvzDecisions={}}if(!LkIp.view.Rsb.Reconciliation){LkIp.view.Rsb.Reconciliation={}}if(!LkIp.view.Rsb.Reconciliation.Object){LkIp.view.Rsb.Reconciliation.Object={}}if(!LkIp.view.Rsb.Reconciliation.Statement){LkIp.view.Rsb.Reconciliation.Statement={}}if(!LkIp.view.Rsb.SuspendedDecisions){LkIp.view.Rsb.SuspendedDecisions={}}if(!LkIp.view.Rsb.UnexpayDecisions){LkIp.view.Rsb.UnexpayDecisions={}}if(!LkIp.view.ServiceUnavailable){LkIp.view.ServiceUnavailable={}}if(!LkIp.view.ServicesList){LkIp.view.ServicesList={}}if(!LkIp.view.SignCheck){LkIp.view.SignCheck={}}if(!LkIp.view.StateRegistration){LkIp.view.StateRegistration={}}if(!LkIp.view.StatementList){LkIp.view.StatementList={}}if(!LkIp.view.TaxSystems){LkIp.view.TaxSystems={}}if(!LkIp.view.TaxSystems.Eshn){LkIp.view.TaxSystems.Eshn={}}if(!LkIp.view.TaxSystems.Eshn.Notification){LkIp.view.TaxSystems.Eshn.Notification={}}if(!LkIp.view.TaxSystems.Eshn.Refuse){LkIp.view.TaxSystems.Eshn.Refuse={}}if(!LkIp.view.TaxSystems.Eshn.Statement){LkIp.view.TaxSystems.Eshn.Statement={}}if(!LkIp.view.TaxSystems.Eshn.Stop){LkIp.view.TaxSystems.Eshn.Stop={}}if(!LkIp.view.TaxSystems.Psn){LkIp.view.TaxSystems.Psn={}}if(!LkIp.view.TaxSystems.Psn.Orn){LkIp.view.TaxSystems.Psn.Orn={}}if(!LkIp.view.TaxSystems.Psn.Patent){LkIp.view.TaxSystems.Psn.Patent={}}if(!LkIp.view.TaxSystems.Psn.Stop){LkIp.view.TaxSystems.Psn.Stop={}}if(!LkIp.view.TaxSystems.Usn){LkIp.view.TaxSystems.Usn={}}if(!LkIp.view.TaxSystems.Usn.Change){LkIp.view.TaxSystems.Usn.Change={}}if(!LkIp.view.TaxSystems.Usn.Notification){LkIp.view.TaxSystems.Usn.Notification={}}if(!LkIp.view.TaxSystems.Usn.Refuse){LkIp.view.TaxSystems.Usn.Refuse={}}if(!LkIp.view.TaxSystems.Usn.Statement){LkIp.view.TaxSystems.Usn.Statement={}}if(!LkIp.view.TaxSystems.Usn.Stop){LkIp.view.TaxSystems.Usn.Stop={}}var LkIpTheme=LkIpTheme||{};if(!LkIpTheme.form){LkIpTheme.form={}}if(!LkIpTheme.form.field){LkIpTheme.form.field={}}Ext.define("ExtThemeNeptune.Component",{override:"Ext.Component",initComponent:function(){this.callParent();if(this.dock&&this.border===undefined){this.border=false}},initStyles:function(){var b=this,a=b.border;if(b.dock){b.border=null}b.callParent(arguments);b.border=a}});Ext.onReady(function(){if(Ext.Date){Ext.Date.monthNames=["\u042f\u043d\u0432\u0430\u0440\u044c","\u0424\u0435\u0432\u0440\u0430\u043b\u044c","\u041c\u0430\u0440\u0442","\u0410\u043f\u0440\u0435\u043b\u044c","\u041c\u0430\u0439","\u0418\u044e\u043d\u044c","\u0418\u044e\u043b\u044c","\u0410\u0432\u0433\u0443\u0441\u0442","\u0421\u0435\u043d\u0442\u044f\u0431\u0440\u044c","\u041e\u043a\u0442\u044f\u0431\u0440\u044c","\u041d\u043e\u044f\u0431\u0440\u044c","\u0414\u0435\u043a\u0430\u0431\u0440\u044c"];Ext.Date.shortMonthNames=["\u042f\u043d\u0432","\u0424\u0435\u0432\u0440","\u041c\u0430\u0440\u0442","\u0410\u043f\u0440","\u041c\u0430\u0439","\u0418\u044e\u043d\u044c","\u0418\u044e\u043b\u044c","\u0410\u0432\u0433","\u0421\u0435\u043d\u0442","\u041e\u043a\u0442","\u041d\u043e\u044f\u0431","\u0414\u0435\u043a"];Ext.Date.getShortMonthName=function(a){return Ext.Date.shortMonthNames[a]};Ext.Date.monthNumbers={"\u042f\u043d\u0432":0,"\u0424\u0435\u0432":1,"\u041c\u0430\u0440":2,"\u0410\u043f\u0440":3,"\u041c\u0430\u0439":4,"\u0418\u044e\u043d":5,"\u0418\u044e\u043b":6,"\u0410\u0432\u0433":7,"\u0421\u0435\u043d":8,"\u041e\u043a\u0442":9,"\u041d\u043e\u044f":10,"\u0414\u0435\u043a":11};Ext.Date.getMonthNumber=function(a){return Ext.Date.monthNumbers[a.substring(0,1).toUpperCase()+a.substring(1,3).toLowerCase()]};Ext.Date.dayNames=["\u0412\u043e\u0441\u043a\u0440\u0435\u0441\u0435\u043d\u044c\u0435","\u041f\u043e\u043d\u0435\u0434\u0435\u043b\u044c\u043d\u0438\u043a","\u0412\u0442\u043e\u0440\u043d\u0438\u043a","\u0421\u0440\u0435\u0434\u0430","\u0427\u0435\u0442\u0432\u0435\u0440\u0433","\u041f\u044f\u0442\u043d\u0438\u0446\u0430","\u0421\u0443\u0431\u0431\u043e\u0442\u0430"];Ext.Date.getShortDayName=function(a){return Ext.Date.dayNames[a].substring(0,3)}}if(Ext.util&&Ext.util.Format){Ext.apply(Ext.util.Format,{thousandSeparator:".",decimalSeparator:",",currencySign:"\u0440\u0443\u0431",dateFormat:"d.m.Y"})}});Ext.define("Ext.locale.ru.view.View",{override:"Ext.view.View",emptyText:""});Ext.define("Ext.locale.ru.grid.plugin.DragDrop",{override:"Ext.grid.plugin.DragDrop",dragText:"{0} \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0445 \u0441\u0442\u0440\u043e\u043a"});Ext.define("Ext.locale.ru.tab.Tab",{override:"Ext.tab.Tab",closeText:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c \u044d\u0442\u0443 \u0432\u043a\u043b\u0430\u0434\u043a\u0443"});Ext.define("Ext.locale.ru.form.field.Base",{override:"Ext.form.field.Base",invalidText:"\u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0432 \u044d\u0442\u043e\u043c \u043f\u043e\u043b\u0435 \u043d\u0435\u0432\u0435\u0440\u043d\u043e\u0435"});Ext.define("Ext.locale.ru.view.AbstractView",{override:"Ext.view.AbstractView",loadingText:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430..."});Ext.define("Ext.locale.ru.picker.Date",{override:"Ext.picker.Date",todayText:"\u0421\u0435\u0433\u043e\u0434\u043d\u044f",minText:"\u042d\u0442\u0430 \u0434\u0430\u0442\u0430 \u0440\u0430\u043d\u044c\u0448\u0435 \u043c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0439 \u0434\u0430\u0442\u044b",maxText:"\u042d\u0442\u0430 \u0434\u0430\u0442\u0430 \u043f\u043e\u0437\u0436\u0435 \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0439 \u0434\u0430\u0442\u044b",disabledDaysText:"\u041d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e",disabledDatesText:"\u041d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e",nextText:"\u0421\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439 \u043c\u0435\u0441\u044f\u0446 (Control+\u0412\u043f\u0440\u0430\u0432\u043e)",prevText:"\u041f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0438\u0439 \u043c\u0435\u0441\u044f\u0446 (Control+\u0412\u043b\u0435\u0432\u043e)",monthYearText:"\u0412\u044b\u0431\u043e\u0440 \u043c\u0435\u0441\u044f\u0446\u0430 (Control+\u0412\u0432\u0435\u0440\u0445/\u0412\u043d\u0438\u0437 \u0434\u043b\u044f \u0432\u044b\u0431\u043e\u0440\u0430 \u0433\u043e\u0434\u0430)",todayTip:"{0} (\u041f\u0440\u043e\u0431\u0435\u043b)",format:"d.m.y",startDay:1});Ext.define("Ext.locale.ru.picker.Month",{override:"Ext.picker.Month",okText:"&#160;OK&#160;",cancelText:"\u041e\u0442\u043c\u0435\u043d\u0430"});Ext.define("Ext.locale.ru.toolbar.Paging",{override:"Ext.PagingToolbar",beforePageText:"\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430",afterPageText:"\u0438\u0437 {0}",firstText:"\u041f\u0435\u0440\u0432\u0430\u044f \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0430",prevText:"\u041f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0430\u044f \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0430",nextText:"\u0421\u043b\u0435\u0434\u0443\u044e\u0449\u0430\u044f \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0430",lastText:"\u041f\u043e\u0441\u043b\u0435\u0434\u043d\u044f\u044f \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0430",refreshText:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c",displayMsg:"\u041e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u044e\u0442\u0441\u044f \u0437\u0430\u043f\u0438\u0441\u0438 \u0441 {0} \u043f\u043e {1}, \u0432\u0441\u0435\u0433\u043e {2}",emptyMsg:"\u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445 \u0434\u043b\u044f \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f"});Ext.define("Ext.locale.ru.form.field.Text",{override:"Ext.form.field.Text",minLengthText:"\u041c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u0430\u044f \u0434\u043b\u0438\u043d\u0430 \u044d\u0442\u043e\u0433\u043e \u043f\u043e\u043b\u044f {0}",maxLengthText:"\u041c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u0430\u044f \u0434\u043b\u0438\u043d\u0430 \u044d\u0442\u043e\u0433\u043e \u043f\u043e\u043b\u044f {0}",blankText:"\u042d\u0442\u043e \u043f\u043e\u043b\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0434\u043b\u044f \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f",regexText:"",emptyText:null});Ext.define("Ext.locale.ru.form.field.Number",{override:"Ext.form.field.Number",minText:"\u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u044d\u0442\u043e\u0433\u043e \u043f\u043e\u043b\u044f \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043c\u0435\u043d\u044c\u0448\u0435 {0}",maxText:"\u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u044d\u0442\u043e\u0433\u043e \u043f\u043e\u043b\u044f \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435 {0}",nanText:"{0} \u043d\u0435 \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0447\u0438\u0441\u043b\u043e\u043c",negativeText:"\u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043e\u0442\u0440\u0438\u0446\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u043c"});Ext.define("Ext.locale.ru.form.field.Date",{override:"Ext.form.field.Date",disabledDaysText:"\u041d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e",disabledDatesText:"\u041d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e",minText:"\u0414\u0430\u0442\u0430 \u0432 \u044d\u0442\u043e\u043c \u043f\u043e\u043b\u0435 \u0434\u043e\u043b\u0436\u043d\u0430 \u0431\u044b\u0442\u044c \u043f\u043e\u0437\u0436\u0435 {0}",maxText:"\u0414\u0430\u0442\u0430 \u0432 \u044d\u0442\u043e\u043c \u043f\u043e\u043b\u0435 \u0434\u043e\u043b\u0436\u043d\u0430 \u0431\u044b\u0442\u044c \u0440\u0430\u043d\u044c\u0448\u0435 {0}",invalidText:"{0} \u043d\u0435 \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u043e\u0439 \u0434\u0430\u0442\u043e\u0439 - \u0434\u0430\u0442\u0430 \u0434\u043e\u043b\u0436\u043d\u0430 \u0431\u044b\u0442\u044c \u0443\u043a\u0430\u0437\u0430\u043d\u0430 \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 {1}",format:"d.m.y",altFormats:"d.m.y|d/m/Y|d-m-y|d-m-Y|d/m|d-m|dm|dmy|dmY|d|Y-m-d"});Ext.define("Ext.locale.ru.form.field.ComboBox",{override:"Ext.form.field.ComboBox",valueNotFoundText:undefined},function(){Ext.apply(Ext.form.field.ComboBox.prototype.defaultListConfig,{loadingText:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430..."})});Ext.define("Ext.locale.ru.form.field.VTypes",{override:"Ext.form.field.VTypes",emailText:'\u042d\u0442\u043e \u043f\u043e\u043b\u0435 \u0434\u043e\u043b\u0436\u043d\u043e \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u0430\u0434\u0440\u0435\u0441 \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u043e\u0439 \u043f\u043e\u0447\u0442\u044b \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 "user@example.com"',urlText:'\u042d\u0442\u043e \u043f\u043e\u043b\u0435 \u0434\u043e\u043b\u0436\u043d\u043e \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c URL \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 "http://www.example.com"',alphaText:'\u042d\u0442\u043e \u043f\u043e\u043b\u0435 \u0434\u043e\u043b\u0436\u043d\u043e \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u043b\u0430\u0442\u0438\u043d\u0441\u043a\u0438\u0435 \u0431\u0443\u043a\u0432\u044b \u0438 \u0441\u0438\u043c\u0432\u043e\u043b \u043f\u043e\u0434\u0447\u0435\u0440\u043a\u0438\u0432\u0430\u043d\u0438\u044f "_"',alphanumText:'\u042d\u0442\u043e \u043f\u043e\u043b\u0435 \u0434\u043e\u043b\u0436\u043d\u043e \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u043b\u0430\u0442\u0438\u043d\u0441\u043a\u0438\u0435 \u0431\u0443\u043a\u0432\u044b, \u0446\u0438\u0444\u0440\u044b \u0438 \u0441\u0438\u043c\u0432\u043e\u043b \u043f\u043e\u0434\u0447\u0435\u0440\u043a\u0438\u0432\u0430\u043d\u0438\u044f "_"'});Ext.define("Ext.locale.ru.form.field.HtmlEditor",{override:"Ext.form.field.HtmlEditor",createLinkText:"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u0430\u0434\u0440\u0435\u0441:"},function(){Ext.apply(Ext.form.field.HtmlEditor.prototype,{buttonTips:{bold:{title:"\u041f\u043e\u043b\u0443\u0436\u0438\u0440\u043d\u044b\u0439 (Ctrl+B)",text:"\u041f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u043f\u043e\u043b\u0443\u0436\u0438\u0440\u043d\u043e\u0433\u043e \u043d\u0430\u0447\u0435\u0440\u0442\u0430\u043d\u0438\u044f \u043a \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u043d\u043e\u043c\u0443 \u0442\u0435\u043a\u0441\u0442\u0443.",cls:Ext.baseCSSPrefix+"html-editor-tip"},italic:{title:"\u041a\u0443\u0440\u0441\u0438\u0432 (Ctrl+I)",text:"\u041f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u043a\u0443\u0440\u0441\u0438\u0432\u043d\u043e\u0433\u043e \u043d\u0430\u0447\u0435\u0440\u0442\u0430\u043d\u0438\u044f \u043a \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u043d\u043e\u043c\u0443 \u0442\u0435\u043a\u0441\u0442\u0443.",cls:Ext.baseCSSPrefix+"html-editor-tip"},underline:{title:"\u041f\u043e\u0434\u0447\u0451\u0440\u043a\u043d\u0443\u0442\u044b\u0439 (Ctrl+U)",text:"\u041f\u043e\u0434\u0447\u0451\u0440\u043a\u0438\u0432\u0430\u043d\u0438\u0435 \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u0442\u0435\u043a\u0441\u0442\u0430.",cls:Ext.baseCSSPrefix+"html-editor-tip"},increasefontsize:{title:"\u0423\u0432\u0435\u043b\u0438\u0447\u0438\u0442\u044c \u0440\u0430\u0437\u043c\u0435\u0440",text:"\u0423\u0432\u0435\u043b\u0438\u0447\u0435\u043d\u0438\u0435 \u0440\u0430\u0437\u043c\u0435\u0440\u0430 \u0448\u0440\u0438\u0444\u0442\u0430.",cls:Ext.baseCSSPrefix+"html-editor-tip"},decreasefontsize:{title:"\u0423\u043c\u0435\u043d\u044c\u0448\u0438\u0442\u044c \u0440\u0430\u0437\u043c\u0435\u0440",text:"\u0423\u043c\u0435\u043d\u044c\u0448\u0435\u043d\u0438\u0435 \u0440\u0430\u0437\u043c\u0435\u0440\u0430 \u0448\u0440\u0438\u0444\u0442\u0430.",cls:Ext.baseCSSPrefix+"html-editor-tip"},backcolor:{title:"\u0417\u0430\u043b\u0438\u0432\u043a\u0430",text:"\u0418\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u0446\u0432\u0435\u0442\u0430 \u0444\u043e\u043d\u0430 \u0434\u043b\u044f \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u0442\u0435\u043a\u0441\u0442\u0430 \u0438\u043b\u0438 \u0430\u0431\u0437\u0430\u0446\u0430.",cls:Ext.baseCSSPrefix+"html-editor-tip"},forecolor:{title:"\u0426\u0432\u0435\u0442 \u0442\u0435\u043a\u0441\u0442\u0430",text:"\u0418\u0437\u043c\u0435\u043d\u0438\u0435 \u0446\u0432\u0435\u0442\u0430 \u0442\u0435\u043a\u0441\u0442\u0430.",cls:Ext.baseCSSPrefix+"html-editor-tip"},justifyleft:{title:"\u0412\u044b\u0440\u043e\u0432\u043d\u044f\u0442\u044c \u0442\u0435\u043a\u0441\u0442 \u043f\u043e \u043b\u0435\u0432\u043e\u043c\u0443 \u043a\u0440\u0430\u044e",text:"\u0412\u044b\u0440a\u0432\u043d\u0438\u0432\u0430\u043d\u0438\u0435 \u0442\u0435\u043a\u0441\u0442\u0430 \u043f\u043e \u043b\u0435\u0432\u043e\u043c\u0443 \u043a\u0440\u0430\u044e.",cls:Ext.baseCSSPrefix+"html-editor-tip"},justifycenter:{title:"\u041f\u043e \u0446\u0435\u043d\u0442\u0440\u0443",text:"\u0412\u044b\u0440a\u0432\u043d\u0438\u0432\u0430\u043d\u0438\u0435 \u0442\u0435\u043a\u0441\u0442\u0430 \u043f\u043e \u0446\u0435\u043d\u0442\u0440\u0443.",cls:Ext.baseCSSPrefix+"html-editor-tip"},justifyright:{title:"\u0412\u044b\u0440\u043e\u0432\u043d\u044f\u0442\u044c \u0442\u0435\u043a\u0441\u0442 \u043f\u043e \u043f\u0440\u0430\u0432\u043e\u043c\u0443 \u043a\u0440\u0430\u044e",text:"\u0412\u044b\u0440a\u0432\u043d\u0438\u0432\u0430\u043d\u0438\u0435 \u0442\u0435\u043a\u0441\u0442\u0430 \u043f\u043e \u043f\u0440\u0430\u0432\u043e\u043c\u0443 \u043a\u0440\u0430\u044e.",cls:Ext.baseCSSPrefix+"html-editor-tip"},insertunorderedlist:{title:"\u041c\u0430\u0440\u043a\u0435\u0440\u044b",text:"\u041d\u0430\u0447\u0430\u0442\u044c \u043c\u0430\u0440\u043a\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0439 \u0441\u043f\u0438\u0441\u043e\u043a.",cls:Ext.baseCSSPrefix+"html-editor-tip"},insertorderedlist:{title:"\u041d\u0443\u043c\u0435\u0440\u0430\u0446\u0438\u044f",text:"\u041d\u0430\u0447\u0430\u0442\u044c \u043d\u0443\u043c\u0435\u0440\u043d\u043e\u0432\u0430\u043d\u043d\u044b\u0439 \u0441\u043f\u0438\u0441\u043e\u043a.",cls:Ext.baseCSSPrefix+"html-editor-tip"},createlink:{title:"\u0412\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u0433\u0438\u043f\u0435\u0440\u0441\u0441\u044b\u043b\u043a\u0443",text:"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0441\u0441\u044b\u043b\u043a\u0438 \u0438\u0437 \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u0442\u0435\u043a\u0441\u0442\u0430.",cls:Ext.baseCSSPrefix+"html-editor-tip"},sourceedit:{title:"\u0418\u0441\u0445\u043e\u0434\u043d\u044b\u0439 \u043a\u043e\u0434",text:"\u041f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f \u043d\u0430 \u0438\u0441\u0445\u043e\u0434\u043d\u044b\u0439 \u043a\u043e\u0434.",cls:Ext.baseCSSPrefix+"html-editor-tip"}}})});Ext.define("Ext.locale.ru.form.Basic",{override:"Ext.form.Basic",waitTitle:"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043f\u043e\u0434\u043e\u0436\u0434\u0438\u0442\u0435..."});Ext.define("Ext.locale.ru.grid.header.Container",{override:"Ext.grid.header.Container",sortAscText:"\u0421\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e \u0432\u043e\u0437\u0440\u0430\u0441\u0442\u0430\u043d\u0438\u044e",sortDescText:"\u0421\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e \u0443\u0431\u044b\u0432\u0430\u043d\u0438\u044e",lockText:"\u0417\u0430\u043a\u0440\u0435\u043f\u0438\u0442\u044c \u0441\u0442\u043e\u043b\u0431\u0435\u0446",unlockText:"\u0421\u043d\u044f\u0442\u044c \u0437\u0430\u043a\u0440\u0435\u043f\u043b\u0435\u043d\u0438\u0435 \u0441\u0442\u043e\u043b\u0431\u0446\u0430",columnsText:"\u0421\u0442\u043e\u043b\u0431\u0446\u044b"});Ext.define("Ext.locale.ru.grid.GroupingFeature",{override:"Ext.grid.GroupingFeature",emptyGroupText:"(\u041f\u0443\u0441\u0442\u043e)",groupByText:"\u0413\u0440\u0443\u043f\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e \u044d\u0442\u043e\u043c\u0443 \u043f\u043e\u043b\u044e",showGroupsText:"\u041e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0442\u044c \u043f\u043e \u0433\u0440\u0443\u043f\u043f\u0430\u043c"});Ext.define("Ext.locale.ru.grid.PropertyColumnModel",{override:"Ext.grid.PropertyColumnModel",nameText:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",valueText:"\u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435",dateFormat:"d.m.Y"});Ext.define("Ext.locale.ru.window.MessageBox",{override:"Ext.window.MessageBox",buttonText:{ok:"OK",cancel:"\u041e\u0442\u043c\u0435\u043d\u0430",yes:"\u0414\u0430",no:"\u041d\u0435\u0442"}});Ext.define("Ext.locale.ru.Component",{override:"Ext.Component"});Ext.define("LkIp.LoadMask",{override:"Ext.LoadMask",msg:"\u0412\u0430\u0448 \u0437\u0430\u043f\u0440\u043e\u0441 \u043e\u0431\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0435\u0442\u0441\u044f...",hideMode:"display"});Ext.define("Lk3IpTheme.tip.Tip",{override:"Ext.tip.Tip",cls:"blue-tooltip"});Ext.define("ExtThemeNeptune.panel.Panel",{override:"Ext.panel.Panel",border:false,bodyBorder:false,initBorderProps:Ext.emptyFn,initBodyBorder:function(){if(this.bodyBorder!==true){this.callParent()}}});Ext.define("ExtThemeNeptune.toolbar.Toolbar",{override:"Ext.toolbar.Toolbar",usePlainButtons:false,border:false});Ext.define("Lk3IpTheme.button.Button",{override:"Ext.button.Button",cls:"blue-button",scale:"medium"});Ext.define("ExtThemeNeptune.layout.component.Dock",{override:"Ext.layout.component.Dock",noBorderClassTable:[0,Ext.baseCSSPrefix+"noborder-l",Ext.baseCSSPrefix+"noborder-b",Ext.baseCSSPrefix+"noborder-bl",Ext.baseCSSPrefix+"noborder-r",Ext.baseCSSPrefix+"noborder-rl",Ext.baseCSSPrefix+"noborder-rb",Ext.baseCSSPrefix+"noborder-rbl",Ext.baseCSSPrefix+"noborder-t",Ext.baseCSSPrefix+"noborder-tl",Ext.baseCSSPrefix+"noborder-tb",Ext.baseCSSPrefix+"noborder-tbl",Ext.baseCSSPrefix+"noborder-tr",Ext.baseCSSPrefix+"noborder-trl",Ext.baseCSSPrefix+"noborder-trb",Ext.baseCSSPrefix+"noborder-trbl"],edgeMasks:{top:8,right:4,bottom:2,left:1},handleItemBorders:function(){var y=this,f=0,z=8,A=4,l=2,e=1,a=y.owner,s=a.bodyBorder,n=a.border,j=y.collapsed,p=y.edgeMasks,k=y.noBorderClassTable,x=a.dockedItems.generation,w,d,v,h,r,m,u,o,g,q,t,c;if(y.initializedBorders===x){return}t=[];c=[];d=y.getBorderCollapseTable();k=y.getBorderClassTable?y.getBorderClassTable():k;y.initializedBorders=x;y.collapsed=false;v=y.getDockedItems();y.collapsed=j;for(r=0,m=v.length;r<m;r++){u=v[r];if(u.ignoreBorderManagement){continue}o=u.dock;q=h=0;t.length=0;c.length=0;if(o!=="bottom"){if(f&z){w=u.border}else{w=n;if(w!==false){h+=z}}if(w===false){q+=z}}if(o!=="left"){if(f&A){w=u.border}else{w=n;if(w!==false){h+=A}}if(w===false){q+=A}}if(o!=="top"){if(f&l){w=u.border}else{w=n;if(w!==false){h+=l}}if(w===false){q+=l}}if(o!=="right"){if(f&e){w=u.border}else{w=n;if(w!==false){h+=e}}if(w===false){q+=e}}if((g=u.lastBorderMask)!==q){u.lastBorderMask=q;if(g){c[0]=k[g]}if(q){t[0]=k[q]}}if((g=u.lastBorderCollapse)!==h){u.lastBorderCollapse=h;if(g){c[c.length]=d[g]}if(h){t[t.length]=d[h]}}if(c.length){u.removeCls(c)}if(t.length){u.addCls(t)}f|=p[o]}q=h=0;t.length=0;c.length=0;if(f&z){w=s}else{w=n;if(w!==false){h+=z}}if(w===false){q+=z}if(f&A){w=s}else{w=n;if(w!==false){h+=A}}if(w===false){q+=A}if(f&l){w=s}else{w=n;if(w!==false){h+=l}}if(w===false){q+=l}if(f&e){w=s}else{w=n;if(w!==false){h+=e}}if(w===false){q+=e}if((g=y.lastBodyBorderMask)!==q){y.lastBodyBorderMask=q;if(g){c[0]=k[g]}if(q){t[0]=k[q]}}if((g=y.lastBodyBorderCollapse)!==h){y.lastBodyBorderCollapse=h;if(g){c[c.length]=d[g]}if(h){t[t.length]=d[h]}}if(c.length){a.removeBodyCls(c)}if(t.length){a.addBodyCls(t)}},onRemove:function(b){var a=b.lastBorderMask;if(!b.isDestroyed&&!b.ignoreBorderManagement&&a){b.lastBorderMask=0;b.removeCls(this.noBorderClassTable[a])}this.callParent([b])}});Ext.define("ExtThemeNeptune.container.ButtonGroup",{override:"Ext.container.ButtonGroup",usePlainButtons:false});Ext.define("LkIpTheme.form.field.Text",{override:"Ext.form.field.Text",cls:"input-field"});Ext.define("LkIpTheme.form.field.Checkbox",{override:"Ext.form.field.Checkbox",cls:"blue-checkbox"});Ext.define("LkIpTheme.form.field.Radio",{override:"Ext.form.field.Radio",cls:"blue-radio-button"});Ext.define("ExtThemeNeptune.toolbar.Paging",{override:"Ext.toolbar.Paging",defaultButtonUI:"plain-toolbar",inputItemWidth:40});Ext.define("LkIpTheme.form.field.Number",{override:"Ext.form.field.Number",fieldStyle:"text-align:right;padding-right: 5px;",cls:"input-field",mouseWheelEnabled:false,allowExponential:false,minValue:0});Ext.define("Lk3IpTheme.picker.Date",{cellTtip:undefined,override:"Ext.picker.Date",disableMonthMenu:false,activeCells:[],initComponent:function(){this.callParent();this.addEvents({changeMonth:true})},getActiveCells:function(){return this.activeCells},showPrevMonth:function(c){var b=Ext.Date.add(this.activeDate,Ext.Date.MONTH,-1),a=this.setValue(b);this.fireEvent("changeMonth","prev",b);return a},showNextMonth:function(c){var b=Ext.Date.add(this.activeDate,Ext.Date.MONTH,1),a=this.setValue(b);this.fireEvent("changeMonth","next",b);return a},fullUpdate:function(z){var D=this,f=D.cells.elements,d=D.textNodes,F=D.disabledCellCls,n=Ext.Date,v=0,C=0,e=D.isVisible(),l=+n.clearTime(z,true),y=+n.clearTime(new Date()),t=D.minDate?n.clearTime(D.minDate,true):Number.NEGATIVE_INFINITY,u=D.maxDate?n.clearTime(D.maxDate,true):Number.POSITIVE_INFINITY,B=D.disabledDatesRE,s=D.disabledDatesText,G=D.disabledDays?D.disabledDays.join(""):false,A=D.disabledDaysText,w=D.format,k=n.getDaysInMonth(z),p=n.getFirstDateOfMonth(z),g=p.getDay()-D.startDay,x=n.add(z,n.MONTH,-1),b=D.longDayFormat,j,q,a,E,m,o,c,h,r;D.activeCells=[];if(g<0){g+=7}k+=g;j=n.getDaysInMonth(x)-g;q=new Date(x.getFullYear(),x.getMonth(),j,D.initHour);if(D.showToday){E=n.clearTime(new Date());a=(E<t||E>u||(B&&w&&B.test(n.dateFormat(E,w)))||(G&&G.indexOf(E.getDay())!=-1));if(!D.disabled){D.todayBtn.setDisabled(a);D.todayKeyListener.setDisabled(a)}}m=function(i,H){r=+n.clearTime(q,true);i.firstChild.dateValue=r;if(r==y){H+=" "+D.todayCls;D.todayElSpan=Ext.DomHelper.append(i.firstChild,{tag:"span",cls:Ext.baseCSSPrefix+"hide-clip",html:D.todayText},true)}if(r==l){H+=" "+D.selectedCls;D.fireEvent("highlightitem",D,i);if(e&&D.floating){Ext.fly(i.firstChild).focus(50)}}if(r<t){H+=" "+F}else{if(r>u){H+=" "+F}else{if(G&&G.indexOf(q.getDay())!==-1){H+=" "+F}else{if(B&&w){h=n.dateFormat(q,w);if(B.test(h)){H+=" "+F}}}}}i.className=H+" "+D.cellCls};for(;v<D.numDays;++v){if(v<g){o=(++j);c=D.prevCls}else{if(v>=k){o=(++C);c=D.nextCls}else{o=v-g+1;c=D.activeCls}}d[v].innerHTML=o;q.setDate(q.getDate()+1);m(f[v],c);if(f[v].className.indexOf("-disabled")===-1){f[v].className=f[v].className+" tooltip-cell";D.activeCells.push(f[v])}}D.monthBtn.setText(Ext.Date.format(z,D.monthYearFormat))},onOkClick:function(b,e){var d=this,f=e[0],c=e[1],a=new Date(c,f,d.getActive().getDate());if(a.getMonth()!==f){a=Ext.Date.getLastDateOfMonth(new Date(c,f,1))}d.setValue(a);d.hideMonthPicker();this.fireEvent("changeMonth","okClick",a)},rusShortDays:{"\u041f\u043e\u043d\u0435\u0434\u0435\u043b\u044c\u043d\u0438\u043a":"\u041f\u043d","\u0412\u0442\u043e\u0440\u043d\u0438\u043a":"\u0412\u0442","\u0421\u0440\u0435\u0434\u0430":"\u0421\u0440","\u0427\u0435\u0442\u0432\u0435\u0440\u0433":"\u0427\u0442","\u041f\u044f\u0442\u043d\u0438\u0446\u0430":"\u041f\u0442","\u0421\u0443\u0431\u0431\u043e\u0442\u0430":"\u0421\u0431","\u0412\u043e\u0441\u043a\u0440\u0435\u0441\u0435\u043d\u044c\u0435":"\u0412\u0441"},getDayInitial:function(a){return this.rusShortDays[a]},beforeRender:function(){var a=this;a.callParent();a.monthBtn=new Ext.button.Split({ownerCt:a,ownerLayout:a.getComponentLayout(),text:"",tooltip:!a.disableMonthMenu?a.monthYearText:undefined,listeners:!a.disableMonthMenu?{click:a.showMonthPicker,arrowclick:a.showMonthPicker,scope:a}:{}})}});Ext.define("ExtThemeNeptune.picker.Month",{override:"Ext.picker.Month",measureMaxHeight:36});Ext.define("Lk3IpTheme.form.field.File",{override:"Ext.form.field.File",clearOnSubmit:false,cls:"file-upload",labelWidth:150,width:500,fieldLabel:"\u0412\u043b\u043e\u0436\u0438\u0442\u044c \u0444\u0430\u0439\u043b",buttonText:"\u041e\u0431\u0437\u043e\u0440...",emptyText:"--\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0444\u0430\u0439\u043b--",msgTarget:"under",buttonConfig:{cls:"blue-button file-button",scale:Ext.isIE8?"small":"medium"},manualReset:function(){var a=this;a.clearOnSubmit=true;a.reset();a.clearOnSubmit=false}});Ext.define("ExtThemeNeptune.form.field.HtmlEditor",{override:"Ext.form.field.HtmlEditor",defaultButtonUI:"plain-toolbar"});Ext.define("ExtThemeNeptune.panel.Table",{override:"Ext.panel.Table",bodyBorder:true});Ext.define("ExtThemeNeptune.grid.RowEditor",{override:"Ext.grid.RowEditor",buttonUI:"default-toolbar"});Ext.define("ExtThemeNeptune.grid.column.RowNumberer",{override:"Ext.grid.column.RowNumberer",width:25});Ext.define("Lk3IpTheme.layout.container.Accordion",{override:"Ext.layout.container.Accordion",beforeRenderItems:function(f){var g=this,e=f.length,c=0,b=g.owner,h=g.collapseFirst,a=Ext.isDefined(h),j,d;for(;c<e;c++){d=f[c];if(!d.rendered){if(a){d.collapseFirst=h}if(g.hideCollapseTool){d.hideCollapseTool=g.hideCollapseTool;d.titleCollapse=true}else{if(g.titleCollapse){d.titleCollapse=g.titleCollapse}}delete d.hideHeader;delete d.width;d.collapsible=true;d.title=d.title||"&#160;";d.addBodyCls(Ext.baseCSSPrefix+"accordion-body");if(!g.hasExpanded){if(g.expandedItem!==undefined){d.collapsed=true}else{if(d.hasOwnProperty("collapsed")&&d.collapsed===false){g.expandedItem=c}else{d.collapsed=true}}b.mon(d,{show:g.onComponentShow,beforeexpand:g.onComponentExpand,scope:g})}if(g.fill){b.mon(d,{beforecollapse:g.onComponentCollapse,scope:g})}}}j=g.expandedItem;if(!g.hasExpanded){if(j===undefined){f[0].collapsed=true}else{if(g.activeOnTop){j=f[j];j.collapsed=false;g.configureItem(j);b.insert(0,j)}}g.hasExpanded=true}}});Ext.define("ExtThemeNeptune.resizer.Splitter",{override:"Ext.resizer.Splitter",size:8});Ext.define("ExtThemeNeptune.menu.Menu",{override:"Ext.menu.Menu",showSeparator:false});Ext.define("ExtThemeNeptune.menu.Separator",{override:"Ext.menu.Separator",border:true});Ext.define("ExtThemeNeptune.panel.Tool",{override:"Ext.panel.Tool",height:16,width:16});Ext.define("ExtThemeNeptune.tab.Tab",{override:"Ext.tab.Tab",border:false});(Ext.cmd.derive("LkIp.Auth",Ext.Base,{singleton:true,registerUrl:"/api/user/register/password",authUrl:"/api/auth/login",logoutUrl:"/api/auth/logout",mcReady:false,cardsReady:false,envdReady:false,psnReady:false,taxModeReady:false,headReady:false,egripReady:false,statisticDocs:false,overpaymentStatus:false,kktList:false,init:function(){},authorize:function(b){var a=this;LkIp.Request.setMaxAttempts(20).request({url:a.authUrl,scope:a,async:true,method:"POST"},function(c){if(!Ext.isEmpty(c)&&false!==c){c.status=parseInt(c.status);if(1==c.status){LkIp.User.setUserData(c.response);b()}else{switch(c.response.code){case"CERTIFICATE_OVERDUE":LkIp.Error.certificateError();break;case"USER_NOT_FOUND":LkIp.User.setUserData(c.response.body);a.registrationByCert();break;case"ACTIVATE_ERROR":LkIp.User.setUserData(c.response.data);a.activation();break;case"INN_REQUIRED":LkIp.User.setUserData(c.response.data);a.enterInnToCheckUserAuth();break;case"USER_IN_DELAYED_REGISTRATION":LkIp.User.setUserData(c.response.data);a.delayedRegistration();break;case"ACTIVITY_CANCELED":LkIp.Error.eLoginEgrip();break;case"NO_OGRNIP":LkIp.Error.auth();break;case"NO_OGRNIP_IN_CERTIFICATE":LkIp.Error.noOgrnipInCertificate();break;case"TECHNICAL_ERROR":LkIp.Error.technicalProblems();break;case"ACCESS_DENIED":LkIp.Error.cancelled();break;case"USER_WITHOUT_LKFL_PASSWORD_ERROR":LkIp.Error.noLkFlPassword();break;case"INVALID_LETTERS":LkIp.Error.invalidLetters(c.response.data);break;default:LkIp.Error.technicalProblems();break}}}else{LkIp.Error.technicalProblems()}},0)},registration:function(){var a=this;LkIp.Request.setMaxAttempts(20).request({url:a.registerUrl,scope:a,async:true,method:"POST"},function(b){if(false!==b&&!Ext.isEmpty(b.response)&&"DELAYED_REGISTRATION"===b.response.code){LkIp.User.setUserData(b.response.data);a.delayedRegistration()}else{a.registrationByPassword(b)}})},registrationByPassword:function(a){LkIp.app.getController("RegistrationPasswordViewport").setRegisterData(a);LkIp.app.renderWidget("LkIpRegistrationPasswordViewport");LkIp.app.getController("RegistrationPasswordViewport").loadIndex()},registrationByCert:function(){LkIp.Signature.init();LkIp.app.renderWidget("LkIpRegistrationViewport")},activation:function(){LkIp.app.renderWidget("LkIpActivationViewport")},delayedRegistration:function(){LkIp.app.renderWidget("LkIpDelayedRegistrationViewport")},logout:function(b,a){a=a||"/logout";LkIp.Request.request({url:this.logoutUrl,scope:this,method:"POST"},function(){b();window.location=a})},enterInnToCheckUserAuth:function(){LkIp.app.renderWidget("LkIpInnEnterViewport")},authorizationRequestPool:function(c,a,d){var b=this;a=a||0;if(!Ext.isEmpty(c.headReady)){b.headReady=true}if(a<LkIp.Request.maxAttempts){Ext.Ajax.request({url:"/api/auth/afterAuthorize",method:"GET",disableCaching:false,params:c,headers:LkIp.Request.updateAuthHeaders(),callback:function(h,k,g){switch(g.status){case 401:if(LkIp.User.isCertUser()){window.location.reload()}else{window.location="/"}break;case 403:LkIp.Error.e403();break;case 406:LkIp.Error.e406();break;case 503:LkIp.Error.e503();break;case 200:default:var j=Ext.JSON.decode(g.responseText).response;if(LkIp.User.hasKktAccess()){if(!Ext.isEmpty(j.kktList)&&j.kktList.status!=2){b.kktList=true;c.kktList=true;LkIp.Settings.set("kktList",j.kktList.status==1?j.kktList.response:[])}}else{b.kktList=true;c.kktList=true}if(!Ext.isEmpty(j.mc)&&j.mc.status!=2){b.mcReady=true;c.mcReady=true;LkIp.Settings.set("mc",j.mc.status==1?j.mc.response:[])}if(!Ext.isEmpty(j.head)&&j.head.status!=2){b.headReady=true;c.headReady=true;if(!Ext.isEmpty(j.head.response.SvedIP)){LkIp.Settings.set("head",j.head.status==1?j.head.response.SvedIP:[])}}if(!Ext.isEmpty(j.cards)&&j.cards.status!=2){b.cardsReady=true;c.cardsReady=true;LkIp.Settings.set("cards",j.cards.status==1?j.cards.response:[])}if(!Ext.isEmpty(j.envd)&&j.envd.status!=2){b.envdReady=true;c.envdReady=true;LkIp.Settings.set("envd",j.envd.status==1?j.envd.response:[])}if(!Ext.isEmpty(j.psn)&&j.psn.status!=2){b.psnReady=true;c.psnReady=true;if(j.psn.status==1){var e=LkIp.Settings.get("otherTaxMode");if(!Ext.isEmpty(e)&&!Ext.isEmpty(e.psn)&&!Ext.isEmpty(j.psn.response.psn)){e.psn=Ext.Array.merge(e.psn,j.psn.response.psn)}else{if(Ext.isEmpty(e)){e={}}if(!Ext.isEmpty(j.psn.response.psn)){e.psn=j.psn.response.psn}}LkIp.Settings.set("otherTaxMode",e)}}if(!Ext.isEmpty(j.otherTaxes)&&j.otherTaxes.status!=2){b.taxModeReady=true;c.taxModeReady=true;if(j.otherTaxes.status==1){var e=LkIp.Settings.get("otherTaxMode");if(!Ext.isEmpty(e)&&!Ext.isEmpty(e.psn)&&!Ext.isEmpty(j.otherTaxes.response.psn)){e.psn=Ext.Array.merge(e.psn,j.otherTaxes.response.psn);delete j.otherTaxes.response.psn}if(Ext.isEmpty(e)){e={}}e=Ext.Object.merge(e,j.otherTaxes.response);LkIp.Settings.set("otherTaxMode",e)}}if(LkIp.User.isActiveUser()){if(!Ext.isEmpty(j.overpaymentStatus)&&j.overpaymentStatus.status!=2){b.overpaymentStatus=true;c.overpaymentStatus=true;if(!Ext.isEmpty(j.overpaymentStatus)&&j.overpaymentStatus.status!=0){var i=j.overpaymentStatus.response["@Pereplata"];i=parseFloat(i.replace(",","."));LkIp.Settings.set("overpaymentStatus",i>0)}}}else{b.overpaymentStatus=true;c.overpaymentStatus=true}if(b.headReady&&b.mcReady&&b.cardsReady&&b.envdReady&&b.psnReady&&b.taxModeReady&&b.overpaymentStatus&&b.kktList){d()}else{var f=new Ext.util.DelayedTask(function(){a++;b.authorizationRequestPool(c,a,d)});f.delay(LkIp.Request.firstDelay+(a*1500)/2)}}},failure:function(){d(false)}})}else{d(false)}}},0,0,0,0,0,0,[LkIp,"Auth"],0));(Ext.cmd.derive("LkIp.Error",Ext.Base,{singleton:true,e403:function(){this.show(403)},e404:function(b){var a="404";this.show(a)},e500:function(){this.show(500)},cryptoError:function(){this.show(600)},e406:function(){LkIp.Msg.info(reference.lang.errors.versionMismatch,{buttons:[{text:reference.lang.buttons.refresh,handler:function(){location.reload(true)}}],rewriteDefaultButtons:true});return false},e503:function(){this.show(503)},eLoginEgrip:function(){this.show("egrip")},cancelled:function(){this.show("cancelled")},passwordExpired:function(){this.show("expired")},auth:function(){this.show("auth")},certificateError:function(){this.show("certificate")},technicalProblems:function(){this.show("deny")},fio:function(){this.show("incorrectFio")},checkLkFl:function(a){this.show("checkLkFl/"+a)},show:function(a){window.location="/restricted/"+a},invalidData:function(){this.show("invalidData")},incorrectInn:function(){this.show("incorrectInn")},noLkFlPassword:function(){this.show("lkflpassword")},invalidFioOrSnils:function(a){a=a||false;switch(a){case"fio":this.fio();break;case"snils":this.show("incorrectSnils");break;default:this.show("incorrectSnilsFio");break}},registerDenied:function(){this.show("registerDeny")},noOgrnipInCertificate:function(){this.show("noOgrnip")},invalidLetters:function(a){LkIp.Msg.error(a,{buttons:[{text:"\u041d\u0430 \u0433\u043b\u0430\u0432\u043d\u0443\u044e",handler:function(){LkIp.Utils.goTo("/")}}],rewriteDefaultButtons:true})}},0,0,0,0,0,0,[LkIp,"Error"],0));(Ext.cmd.derive("LkIp.FlashData",Ext.Base,{singleton:true,set:function(a,b){a="flash."+a;LkIp.Settings.set(a,b)},get:function(b){b="flash."+b;var a=LkIp.Settings.get(b);if(!Ext.isEmpty(a)){LkIp.Settings.remove(b)}return a}},0,0,0,0,0,0,[LkIp,"FlashData"],0));(Ext.cmd.derive("LkIp.History",Ext.Base,{singleton:true,lastPages:[],lastPagesCookieName:"lastPages",init:function(){Ext.util.History.useTopWindow=false;Ext.util.History.init(function(){this.historyLoaded=true},this);Ext.util.History.on("change",function(a){this.navigate(a)},this)},notifyPageLoaded:function(){this.pageLoaded=true;this.initialNavigate()},initialNavigate:function(){if(this.historyLoaded&&this.pageLoaded){var a=Ext.util.History.getToken();if(Ext.isEmpty(a)){LkIp.Utils.goTo("#!/index")}else{this.navigate(a)}}},navigate:function(b){if(!Ext.isEmpty(b)){if(b.indexOf("#")==-1||b.indexOf("#")!=0){b="#"+b}var a=LkIp.PageRegistry.getControllerName(b);LkIp.app.getController((typeof a!="undefined"?a:"Index")).loadIndex(false)}},parseToken:function(a){return{url:"#"+a}},push:function(a){a=this.cleanUrl(a);if(!/^#!?/.test(a)){a="#!"+a}var b=Ext.util.History.getToken()||"";if("#"+b.replace(/^%21/,"!")!==a){Ext.util.History.add(a)}},cleanUrl:function(a){return a.replace(/^[^#]*#/,"#")},pushLastPage:function(c){if(this.lastPages.length===6){this.lastPages.pop()}var b=0,a=this.lastPages.length;for(;b<a;b++){if(this.lastPages[b].href===c.href){this.lastPages.splice(b,1);break}}this.lastPages[0].visible=true;if(typeof c.useAsLastPage==="undefined"||c.useAsLastPage){c.visible=false;this.lastPages.unshift(c)}Ext.util.Cookies.set(this.lastPagesCookieName,Ext.JSON.encode(this.lastPages),Ext.Date.add(new Date(),Ext.Date.YEAR,1))},getLastPages:function(){return this.lastPages},back:function(){Ext.util.History.back()}},0,0,0,0,0,0,[LkIp,"History"],0));(Ext.cmd.derive("LkIp.LocalStore",Ext.Base,{storeName:"",init:function(){this.localStorage=!!browserLocalStorage;this.store=Ext.create(this.storeName);if(this.localStorage){this.cleanup();this.store.load();if(window.addEventListener){window.addEventListener("storage",Ext.Function.bind(this.onStorageChange,this),false)}else{window.attachEvent("onstorage",Ext.Function.bind(this.onStorageChange,this))}}},onStorageChange:function(a){a=a||window.event;if(a.key===this.store.getProxy().id){this.store.load()}},syncStore:function(){if(this.localStorage){this.store.sync()}},cleanup:function(){var c=/flash\..*/,b=0,a;for(;b<window.localStorage.length;b++){a=window.localStorage.key(b);if(!c.test(a)){window.localStorage.removeItem(a)}}}},0,0,0,0,0,0,[LkIp,"LocalStore"],0));(Ext.cmd.derive("LkIp.Msg",Ext.window.MessageBox,{buttonText:{ok:reference.lang.buttons.ok,yes:reference.lang.buttons.yes,no:reference.lang.buttons.no,cancel:reference.lang.buttons.cancel},cls:"info-window",ui:"nalogThemeWindow",minWidth:400,minHeight:160,OK:"ok-32-icon",makeButton:function(a,d,b){var c=this.buttonIds[a];return new Ext.button.Button({handler:d||this.btnCallback,itemId:c,scope:this,text:b||this.buttonText[c],minWidth:75})},reconfigure:function(l){var m=this,n=0,j=true,o=m.resizer,f=l.buttons.length,a,b,p,h,c,g,e,k,d;l=l||{};m.cfg=l;if(l.width){b=l.width}if(l.height){p=l.height}m.minWidth=l.minWidth||m.defaultMinWidth;m.maxWidth=l.maxWidth||m.defaultMaxWidth;m.minHeight=l.minHeight||m.defaultMinHeight;m.maxHeight=l.maxHeight||m.defaultMaxHeight;if(o){a=o.resizeTracker;o.minWidth=a.minWidth=m.minWidth;o.maxWidth=a.maxWidth=m.maxWidth;o.minHeight=a.minHeight=m.minHeight;o.maxHeight=a.maxHeight=m.maxHeight}delete m.defaultFocus;if(l.defaultFocus){m.defaultFocus=l.defaultFocus}m.animateTarget=l.animateTarget||undefined;m.modal=l.modal!==false;m.setTitle(l.title||"");m.setIconCls(l.iconCls||"");Ext.suspendLayouts();delete m.width;delete m.height;if(b||p){if(b){m.setWidth(b)}if(p){m.setHeight(p)}}m.hidden=false;if(!m.rendered){m.render(Ext.getBody())}m.closable=l.closable!==false&&!l.wait;m.header.child("[type=close]").setVisible(m.closable);if(!l.title&&!m.closable&&!l.iconCls){m.header.hide()}else{m.header.show()}m.liveDrag=!l.proxyDrag;m.userCallback=Ext.Function.bind(l.callback||l.fn||Ext.emptyFn,l.scope||Ext.global);m.setIcon(l.icon,l.iconWidth,l.iconHeight);e=m.msg;if(l.msg){e.setValue(l.msg);e.show()}else{e.hide()}c=m.textArea;g=m.textField;if(l.prompt||l.multiline){m.multiline=l.multiline;if(l.multiline){c.setValue(l.value);c.setHeight(l.defaultTextHeight||m.defaultTextHeight);c.show();g.hide();m.defaultFocus=c}else{g.setValue(l.value);c.hide();g.show();m.defaultFocus=g}}else{c.hide();g.hide()}k=m.progressBar;if(l.progress||l.wait){k.show();m.updateProgress(0,l.progressText);if(l.wait===true){k.wait(l.waitConfig)}}else{k.hide()}if(Ext.isArray(l.buttons)){m.bottomTb.removeAll();m.bottomTb.add("->");for(h=0;h<f;h++){m.bottomTb.add({xtype:"button",text:l.buttons[h].text,handler:l.buttons[h].handler,minWidth:75,scope:this,itemId:l.buttons[h].id,hidden:false})}j=false}else{if(Ext.isObject(l.buttons)){m.buttonText=l.buttons;n=0}else{m.buttonText=l.buttonText||m.buttonText;n=Ext.isNumber(l.buttons)?l.buttons:0}d=m.msgButtons;for(h=0;h<4;h++){if(n&Math.pow(2,h)){if(!m.defaultFocus){m.defaultFocus=d[h]}d[h].show();j=false}else{d[h].hide()}}}if(j){m.bottomTb.hide()}else{m.bottomTb.show()}Ext.resumeLayouts(true)},initComponent:function(){var a=this;a.defaultButtons={close:{text:reference.lang.buttons.close,handler:function(){a.fireEvent("closemessagebox",a);a.close()}}};a.callParent()},onClose:function(){this.fireEvent("closemessagebox",this);this.callParent()},info:function(b,a){this.sendMsg(Ext.apply({msg:b,title:reference.lang.msg.info,icon:this.INFO},Ext.isObject(a)?a:{}))},success:function(b,a){this.sendMsg(Ext.apply({msg:b,title:reference.lang.msg.info,icon:this.OK},Ext.isObject(a)?a:{}))},error:function(b,a){this.sendMsg(Ext.apply({msg:b,title:reference.lang.msg.error,icon:this.WARNING},Ext.isObject(a)?a:{}))},sendMsg:function(d){if("UFNS_EXPERIMENT_ERROR"==d.msg){d.msg=reference.lang.ufnsExperiment}if(!this.isHidden()){this.hide()}var c=[this.defaultButtons.close],b,a;if(Ext.isArray(d.buttons)){if(true===d.rewriteDefaultButtons){c=d.buttons}else{for(b=0,a=d.buttons.length;b<a;b++){c.push(d.buttons[b])}}delete d.buttons;delete d.rewriteDefaultButtons}d.buttons=c;d.cls=this.cls+!Ext.isEmpty(d.cls)?" "+d.cls:"";d.shadow=false;this.show(d)},progress:function(d,c,a,b){c=c||"";a=a||"";b=Ext.isObject(b)?b:{};this.show({title:d,msg:"\u0423\u0432\u0430\u0436\u0430\u0435\u043c\u044b\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c. \u0424\u0430\u0439\u043b \u0441 \u0437\u0430\u043f\u0440\u0430\u0448\u0438\u0432\u0430\u0435\u043c\u043e\u0439 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0435\u0439 \u0444\u043e\u0440\u043c\u0438\u0440\u0443\u0435\u0442\u0441\u044f.",progressText:a,cls:this.cls+(!Ext.isEmpty(b.cls)?" "+b.cls:"")+" progress-window",shadow:false,progress:true,closable:false,buttons:[],wait:true,waitConfig:{interval:800}})},waitForDocument:function(c,b){var a=this;b=Ext.isObject(b)?b:{};a.sendMsg({title:reference.lang.msg.progress.waitDocument.title,msg:reference.lang.msg.progress.waitDocument.text,cls:"progress-window",shadow:false,progress:true,closable:false,buttons:[],wait:true,width:560,waitConfig:{interval:800}});Ext.TaskManager.start({run:function(){if(Ext.isEmpty(Ext.util.Cookies.get(c))){if(a.hasCls("progress-window")){a.hide()}return false}},interval:10})}},0,["messageBox"],["panel","window","messagebox","component","container","box","messageBox"],{panel:true,window:true,messagebox:true,component:true,container:true,box:true,messageBox:true},["widget.messageBox"],0,[LkIp,"Msg"],function(){LkIp.Msg=new this()}));(Ext.cmd.derive("LkIp.PageRegistry",Ext.Base,{singleton:true,data:[{key:"index",href:"#!/index",menuTitle:reference.lang.pages.index.menuTitle,title:reference.lang.pages.index.title,controller:"Index",itemId:"indexTab",useAsLastPage:false,children:[{key:"foreign",href:"#!/foreign",signature:true,needServiceCheck:true,menuTitle:reference.lang.pages.foreign.menuTitle,title:reference.lang.pages.foreign.title,controller:"Foreign.Index",itemId:"foreignTab"},{key:"consent",href:"#!/consent",signature:true,needServiceCheck:true,menuTitle:reference.lang.pages.consent.menuTitle,title:reference.lang.pages.consent.title,controller:"Consent.Index",itemId:"consentTab"},{key:"employeesIdentification",href:"#!/employees/identification",signature:true,needServiceCheck:true,menuTitle:reference.lang.pages.employeesIdentification.menuTitle,title:reference.lang.pages.employeesIdentification.title,controller:"Employees.Identification",itemId:"employeesIdentificationTab"},{key:"signcheck",href:"#!/sign-check",menuTitle:reference.lang.pages.signCheck.menuTitle,title:reference.lang.pages.signCheck.title,controller:"SignCheck",itemId:"signcheckTab",sort:0},{key:"statementList",href:"#!/statement/list",menuTitle:reference.lang.pages.statementsList.menuTitle,title:reference.lang.pages.statementsList.title,controller:"StatementList",itemId:"statementListTab",access:["CERT_ACCESS","INSPECTOR_ACCESS","RESTRICTED_ACCESS","HRESTRICTED_ACCESS"]},{key:"egriprequest",href:"#!/egrip/request",needServiceCheck:true,menuTitle:reference.lang.pages.egrip.request.menuTitle,title:reference.lang.pages.egrip.request.title,controller:"Egrip.Request",itemId:"egripRequestTab",tab:true,menuAlias:"docs",sort:0,access:["CERT_ACCESS","RESTRICTED_ACCESS"]},{key:"servicesList",href:"#!/services/list",menuTitle:reference.lang.pages.servicesList.menuTitle,title:reference.lang.pages.servicesList.title,controller:"ServicesList",itemId:"servicesListTab",access:["CERT_ACCESS","INSPECTOR_ACCESS","RESTRICTED_ACCESS","HRESTRICTED_ACCESS"]},{key:"egrnAccount",href:"#!/egrn/account",menuTitle:reference.lang.pages.egrn.menuTitle,title:reference.lang.pages.egrn.title,controller:"Egrn.Account",itemId:"egrnAccountTab",tab:true,menuAlias:"userInfo",access:["CERT_ACCESS","INSPECTOR_ACCESS","RESTRICTED_ACCESS","HRESTRICTED_ACCESS"],sort:1},{key:"rsbCards",href:"#!/rsb/cards",menuTitle:reference.lang.pages.rsb.cards.menuTitle,title:reference.lang.pages.rsb.cards.title,controller:"Rsb.Cards",itemId:"rsbCardsTab",tab:true,menuAlias:"budgetInfo",access:["CERT_ACCESS","INSPECTOR_ACCESS","RESTRICTED_ACCESS","HRESTRICTED_ACCESS"],sort:1,children:[{key:"rsbCardsDetails",href:"#!/rsb/cards/details",menuTitle:reference.lang.pages.rsb.cards.menuTitle,title:"",controller:"Rsb.Cards.Details",itemId:"rsbCardsDetailsTab",access:["CERT_ACCESS","INSPECTOR_ACCESS","RESTRICTED_ACCESS","HRESTRICTED_ACCESS"],children:[{key:"rsbCardsOperations",href:"#!/rsb/cards/operations",title:reference.lang.pages.rsb.cards.operations.title,menuTitle:reference.lang.pages.rsb.cards.operations.menuTitle,controller:"Rsb.Cards.Operations",itemId:"rsbCardsOperationsTab",requireParam:["fidCard"],error:reference.lang.rsb.cards.errors.cardNotSelected,access:["CERT_ACCESS","INSPECTOR_ACCESS","RESTRICTED_ACCESS","HRESTRICTED_ACCESS"]},{key:"rsbCardsDebt",href:"#!/rsb/cards/debt",title:reference.lang.pages.rsb.cards.debt.title,menuTitle:reference.lang.pages.rsb.cards.debt.menuTitle,controller:"Rsb.Cards.Debt",itemId:"rsbCardsDebtTab",history:false,requireParam:["fidCard"],error:reference.lang.rsb.cards.errors.cardNotSelected,access:["CERT_ACCESS","RESTRICTED_ACCESS","INSPECTOR_ACCESS"],children:[{key:"rsbCardsDebtObj",href:"#!/rsb/cards/debt/object",title:reference.lang.pages.rsb.cards.debt.objects.title,menuTitle:reference.lang.pages.rsb.cards.debt.objects.menuTitle,controller:"Rsb.Cards.DebtObject",itemId:"rsbCardsDebtObjTab",history:false,requireParam:["fidCard","fidDebtCard"],access:["CERT_ACCESS","RESTRICTED_ACCESS","INSPECTOR_ACCESS"],error:reference.lang.rsb.cards.errors.cardNotSelected}]}]},{key:"rsbCardsNds",href:"#!/rsb/cards/nds",title:reference.lang.pages.rsb.cards.nds.title,menuTitle:reference.lang.pages.rsb.cards.nds.menuTitle,controller:"Rsb.Cards.Nds",itemId:"rsbCardsNdsTab",requireParam:["fidCard"],error:reference.lang.rsb.cards.errors.cardNotSelected,access:["CERT_ACCESS","INSPECTOR_ACCESS","RESTRICTED_ACCESS","HRESTRICTED_ACCESS"]},{key:"rsbCardsHung",href:"#!/rsb/cards/hung",title:reference.lang.pages.rsb.cards.hung.title,menuTitle:reference.lang.pages.rsb.cards.hung.menuTitle,controller:"Rsb.Cards.Hung",itemId:"rsbCardsHungTab",requireParam:["fidCard"],error:reference.lang.rsb.cards.errors.cardNotSelected,access:["CERT_ACCESS","INSPECTOR_ACCESS","RESTRICTED_ACCESS","HRESTRICTED_ACCESS"]}]},{key:"rsbOverpaymentDecisions",href:"#!/rsb/overpayment/decisions",menuTitle:reference.lang.pages.rsb.overpaymentDecisions.menuTitle,title:reference.lang.pages.rsb.overpaymentDecisions.title,controller:"Rsb.OverpaymentDecisions",itemId:"rsbOverpaymentDecisionsTab",menuAlias:"budgetInfo",access:["CERT_ACCESS","RESTRICTED_ACCESS","INSPECTOR_ACCESS"],sort:5},{key:"rsbUnexpayDecisions",href:"#!/rsb/unexpay/decisions",menuTitle:reference.lang.pages.rsb.unexpayDecisions.menuTitle,title:reference.lang.pages.rsb.unexpayDecisions.title,controller:"Rsb.UnexpayDecisions",itemId:"rsbUnexpayDecisionsTab",menuAlias:"budgetInfo",access:["CERT_ACCESS","INSPECTOR_ACCESS","RESTRICTED_ACCESS","HRESTRICTED_ACCESS"],sort:5},{key:"rsbCompliedReqs",href:"#!/rsb/compliedreqs",menuTitle:reference.lang.pages.rsb.compliedreqs.menuTitle,title:reference.lang.pages.rsb.compliedreqs.title,controller:"Rsb.CompliedReqs",itemId:"rsbCompliedReqsTab",menuAlias:"budgetInfo",access:["CERT_ACCESS","INSPECTOR_ACCESS","RESTRICTED_ACCESS","HRESTRICTED_ACCESS"],sort:6},{key:"rsbPvzDecisions",href:"#!/rsb/pvz/money",menuTitle:reference.lang.pages.rsb.pvzMoney.menuTitle,title:reference.lang.pages.rsb.pvzMoney.title,controller:"Rsb.PvzDecisions",itemId:"rsbPvzDecisionsTab",menuAlias:"budgetInfo",access:["CERT_ACCESS","RESTRICTED_ACCESS","INSPECTOR_ACCESS"],sort:7},{key:"rsbPvzDecisions",href:"#!/rsb/pvz/property",menuTitle:reference.lang.pages.rsb.pvzProperty.menuTitle,title:reference.lang.pages.rsb.pvzProperty.title,controller:"Rsb.PvzDecisions",itemId:"rsbPvzDecisionsTab",menuAlias:"budgetInfo",access:["CERT_ACCESS","RESTRICTED_ACCESS","INSPECTOR_ACCESS"],sort:8},{key:"rsbSuspendedDecisions",href:"#!/rsb/suspended/decisions",menuTitle:reference.lang.pages.rsb.suspendedDecisions.menuTitle,title:reference.lang.pages.rsb.suspendedDecisions.title,controller:"Rsb.SuspendedDecisions",itemId:"rsbSuspendedDecisionsTab",menuAlias:"budgetInfo",sort:9,access:["CERT_ACCESS","RESTRICTED_ACCESS","INSPECTOR_ACCESS"]},{key:"rsbReconciliation",href:"#!/rsb/reconciliation",menuTitle:reference.lang.pages.rsb.reconciliation.menuTitle,title:reference.lang.pages.rsb.reconciliation.title,controller:"Rsb.Reconciliation",itemId:"rsbReconciliationTab",menuAlias:"budgetInfo",sort:10,access:["CERT_ACCESS","INSPECTOR_ACCESS","RESTRICTED_ACCESS","HRESTRICTED_ACCESS"],children:[{key:"rsbReconciliationObject",href:"#!/rsb/reconciliation/object",menuTitle:reference.lang.pages.rsb.reconciliation.object.menuTitle,title:reference.lang.pages.rsb.reconciliation.object.title,controller:"Rsb.Reconciliation.Object",itemId:"rsbReconciliationObjectTab",requireParam:["fidReconciliation"],error:reference.lang.rsb.reconciliation.errors.notSelected,access:["CERT_ACCESS","INSPECTOR_ACCESS","RESTRICTED_ACCESS","HRESTRICTED_ACCESS"]}]},{key:"rsbDebitDecisions",href:"#!/rsb/debit/decisions",menuTitle:reference.lang.pages.rsb.debitDecisions.menuTitle,title:reference.lang.pages.rsb.debitDecisions.title,controller:"Rsb.DebitDecisions",itemId:"rsbDebitDecisionsTab",menuAlias:"budgetInfo",sort:11,access:["CERT_ACCESS","RESTRICTED_ACCESS","INSPECTOR_ACCESS"]},{key:"rsbOverpayment",href:"#!/rsb/overpayment",menuTitle:reference.lang.pages.rsb.overpayment.menuTitle,title:reference.lang.pages.rsb.overpayment.title,controller:"Rsb.Overpayment",itemId:"rsbOverpaymentTab",tab:true,menuAlias:"docs",sort:1,access:["CERT_ACCESS","INSPECTOR_ACCESS","RESTRICTED_ACCESS","HRESTRICTED_ACCESS"],children:[{key:"rsbOverpaymentStatement",href:"#!/rsb/overpayment/statement",menuTitle:"",title:"",controller:"Rsb.Overpayment.Statement",itemId:"rsbOverpaymentStatementTab",signature:true,needServiceCheck:true,requireParam:["typeStatement","fidCard","paymentType"],history:false,access:["CERT_ACCESS","RESTRICTED_ACCESS","INSPECTOR_ACCESS"]}]},{key:"clarify",href:"#!/clarify",menuTitle:reference.lang.pages.rsb.clarify.menuTitle,title:reference.lang.pages.rsb.clarify.title,controller:"Rsb.Clarify",itemId:"clarifyPaymentsTab",tab:true,menuAlias:"docs",sort:2,access:["CERT_ACCESS","INSPECTOR_ACCESS","RESTRICTED_ACCESS","HRESTRICTED_ACCESS"],children:[{key:"rsbUnexpay",href:"#!/rsb/unexpay",title:reference.lang.pages.rsb.clarify.unexpay.title,menuTitle:reference.lang.pages.rsb.clarify.unexpay.menuTitle,controller:"Rsb.Clarify.Unexpay",itemId:"rsbUnexpayTab",tab:true,menuAlias:"budgetInfo",sort:3,access:["CERT_ACCESS","INSPECTOR_ACCESS","RESTRICTED_ACCESS","HRESTRICTED_ACCESS"],children:[{key:"rsbUnexpayNotify",href:"#!/rsb/unexpay/notify",title:reference.lang.pages.rsb.clarify.unexpay.notify.title,menuTitle:reference.lang.pages.rsb.clarify.unexpay.notify.menuTitle,controller:"Rsb.Clarify.Unexpay.Notify",itemId:"rsbUnexpayNotifyTab",error:reference.lang.rsb.clarify.unexpay.errors.canNotGetCardData,requireParam:["fidCard"],signature:true,needServiceCheck:true,history:false,access:["CERT_ACCESS","RESTRICTED_ACCESS"]},{key:"rsbUnexpayStatement",href:"#!/rsb/unexpay/statement",title:reference.lang.pages.rsb.clarify.unexpay.statement.title,menuTitle:reference.lang.pages.rsb.clarify.unexpay.statement.menuTitle,controller:"Rsb.Clarify.Unexpay.Statement",itemId:"rsbUnexpayStatementTab",error:reference.lang.rsb.clarify.unexpay.errors.canNotGetCardData,requireParam:["fidCard"],requireParent:"rsbUnexpay",signature:true,needServiceCheck:true,history:false,access:["CERT_ACCESS","RESTRICTED_ACCESS"]}]},{key:"rsbClarifyOther",href:"#!/rsb/clarify/other",title:reference.lang.pages.rsb.clarify.other.title,menuTitle:reference.lang.pages.rsb.clarify.other.menuTitle,controller:"Rsb.Clarify.Other",itemId:"rsbUnexpayOtherTab",signature:true,needServiceCheck:true,tab:true,access:["CERT_ACCESS","RESTRICTED_ACCESS"]}]},{key:"envdRegistration",href:"#!/envd/registration",menuTitle:reference.lang.pages.envd.registration.menuTitle,title:reference.lang.pages.envd.registration.title,controller:"Envd",itemId:"envdRegistrationTab",tab:true,signature:true,needServiceCheck:true,menuAlias:"docs",sort:3,access:["CERT_ACCESS","RESTRICTED_ACCESS"]},{key:"envdDeregistration",href:"#!/envd/deregistration",menuTitle:reference.lang.pages.envd.deregistration.menuTitle,title:reference.lang.pages.envd.deregistration.title,controller:"Envd",itemId:"envdDeRegistrationTab",tab:true,signature:true,needServiceCheck:true,menuAlias:"docs",sort:4,access:["CERT_ACCESS","RESTRICTED_ACCESS"]},{key:"rsbRStatement",href:"#!/rsb/reconciliation/statement",menuTitle:reference.lang.pages.rsb.reconciliation.statement.menuTitle,title:reference.lang.pages.rsb.reconciliation.statement.title,controller:"Rsb.Reconciliation.Statement",itemId:"rsbRStatementTab",menuAlias:"docs",signature:true,needServiceCheck:true,sort:5,access:["CERT_ACCESS","RESTRICTED_ACCESS"]},{key:"partnership",href:"#!/partnership",menuTitle:reference.lang.pages.partnership.menuTitle,title:reference.lang.pages.partnership.title,controller:"Partnership",itemId:"partnershipTab",menuAlias:"docs",signature:true,needServiceCheck:true,sort:6,access:["CERT_ACCESS","RESTRICTED_ACCESS"]},{key:"informationService",href:"#!/information/service",menuTitle:reference.lang.pages.informationService.menuTitle,title:reference.lang.pages.informationService.title,controller:"Information.Service",itemId:"InformationServiceTab",tab:true,menuAlias:"docs",sort:7,access:["CERT_ACCESS","RESTRICTED_ACCESS"],children:[{key:"ISPaymentsStatus",href:"#!/information/service/paymentsStatus",menuTitle:reference.lang.pages.informationService.paymentsStatus.menuTitle,title:reference.lang.pages.informationService.paymentsStatus.title,controller:"Information.Service.PaymentsStatus",itemId:"ISPaymentsStatusTab",signature:true,needServiceCheck:true,tab:true,access:["CERT_ACCESS","RESTRICTED_ACCESS"]},{key:"ISObligation",href:"#!/information/service/obligation",menuTitle:reference.lang.pages.informationService.obligation.menuTitle,title:reference.lang.pages.informationService.obligation.title,controller:"Information.Service.Obligation",itemId:"ISObligationTab",signature:true,needServiceCheck:true,tab:true,access:["CERT_ACCESS","RESTRICTED_ACCESS"]},{key:"ISAccounting",href:"#!/information/service/accounting",menuTitle:reference.lang.pages.informationService.accounting.menuTitle,title:reference.lang.pages.informationService.accounting.title,controller:"Information.Service.Accounting",itemId:"ISAccountingTab",signature:true,needServiceCheck:true,tab:true,access:["CERT_ACCESS","RESTRICTED_ACCESS"]},{key:"ISReconciliation",href:"#!/information/service/reconciliation",menuTitle:reference.lang.pages.informationService.reconciliation.menuTitle,title:reference.lang.pages.informationService.reconciliation.title,controller:"Information.Service.Reconciliation",itemId:"ISReconciliationTab",signature:true,needServiceCheck:true,tab:true,access:["CERT_ACCESS","RESTRICTED_ACCESS"]},{key:"ISOperations",href:"#!/information/service/operations",menuTitle:reference.lang.pages.informationService.operations.menuTitle,title:reference.lang.pages.informationService.operations.title,controller:"Information.Service.Operations",itemId:"ISOperationsTab",signature:true,needServiceCheck:true,tab:true,access:["CERT_ACCESS","RESTRICTED_ACCESS"]}]},{key:"stateRegistration",href:"#!/stateRegistration",controller:"StateRegistration",menuTitle:reference.lang.pages.stateRegistration.menuTitle,title:reference.lang.pages.stateRegistration.title,itemId:"stateRegistrationTab",tab:true,signature:true,needServiceCheck:true,menuAlias:"docs",sort:8,access:["CERT_ACCESS","RESTRICTED_ACCESS"]},{key:"docflowList",href:"#!/docflow/list",menuTitle:reference.lang.pages.docflow.menuTitle,title:reference.lang.pages.docflow.title,controller:"Docflow.Documents",itemId:"docflowTab",tab:true,menuAlias:"docs",sort:9,access:["CERT_ACCESS","INSPECTOR_ACCESS","RESTRICTED_ACCESS","HRESTRICTED_ACCESS","INSPECTOR_ACCESS_ECR"]},{key:"docflowNotice",href:"#!/docflow/notice",menuTitle:reference.lang.pages.docflowNotice.menuTitle,title:reference.lang.pages.docflowNotice.title,controller:"Docflow.Notice",itemId:"docflowNoticeTab",access:["CERT_ACCESS","INSPECTOR_ACCESS","RESTRICTED_ACCESS","HRESTRICTED_ACCESS","INSPECTOR_ACCESS_ECR"]},{key:"personalDataUpdate",href:"#!/personaldata/update",menuTitle:reference.lang.pages.personalData.update.menuTitle,title:reference.lang.pages.personalData.update.title,controller:"PersonalData.Update",itemId:"userinfoUpdateTab",needServiceCheck:true,access:["CERT_ACCESS","RESTRICTED_ACCESS"]},{key:"profile",href:"#!/profile",controller:"Profile",itemId:"profileTab",needServiceCheck:true,access:["CERT_ACCESS","INSPECTOR_ACCESS","RESTRICTED_ACCESS","HRESTRICTED_ACCESS","INSPECTOR_ACCESS_ECR"]},{key:"deactivate",href:"#!/user/deactivate",menuTitle:reference.lang.pages.deactivate.menuTitle,title:reference.lang.pages.deactivate.title,controller:"Deactivate",itemId:"deactivateTab",needServiceCheck:true,access:["CERT_ACCESS","RESTRICTED_ACCESS","HRESTRICTED_ACCESS"]},{key:"feedback",href:"#!/feedback",menuTitle:reference.lang.pages.feedback.menuTitle,title:reference.lang.pages.feedback.title,controller:"Feedback",itemId:"feedbackTab",needServiceCheck:true,optionalParams:["codeNo"],access:["CERT_ACCESS","RESTRICTED_ACCESS"]},{key:"calculator",href:"#!/calculator",menuTitle:reference.lang.pages.calculator.menuTitle,title:reference.lang.pages.calculator.title,controller:"Calculator",itemId:"calculatorTab",access:["CERT_ACCESS","RESTRICTED_ACCESS"]},{key:"eshnNotification",href:"#!/eshn/notification",title:reference.lang.pages.eshn.notification.title,menuTitle:reference.lang.pages.eshn.notification.menuTitle,controller:"TaxSystems.Eshn.Notification",itemId:"eshnNotificationTab",signature:true,needServiceCheck:true,access:["CERT_ACCESS","RESTRICTED_ACCESS"]},{key:"eshnStatement",href:"#!/eshn/statement",signature:true,title:reference.lang.pages.eshn.statement.title,menuTitle:reference.lang.pages.eshn.statement.menuTitle,controller:"TaxSystems.Eshn.Statement",itemId:"eshnStatementab",needServiceCheck:true,access:["CERT_ACCESS","RESTRICTED_ACCESS"]},{key:"eshnStop",href:"#!/eshn/stop",signature:true,title:reference.lang.pages.eshn.stop.title,menuTitle:reference.lang.pages.eshn.stop.title,controller:"TaxSystems.Eshn.Stop",itemId:"eshnStopTab",needServiceCheck:true,access:["CERT_ACCESS","RESTRICTED_ACCESS"]},{key:"eshnRefuse",href:"#!/eshn/refuse",signature:true,title:reference.lang.pages.eshn.refuse.title,menuTitle:reference.lang.pages.eshn.refuse.title,controller:"TaxSystems.Eshn.Refuse",itemId:"eshnRefuseTab",needServiceCheck:true,access:["CERT_ACCESS","RESTRICTED_ACCESS"]},{key:"usnStatement",href:"#!/usn/statement",signature:true,title:reference.lang.pages.usn.statement.title,menuTitle:reference.lang.pages.usn.statement.menuTitle,controller:"TaxSystems.Usn.Statement",itemId:"usnStatementab",needServiceCheck:true,access:["CERT_ACCESS","RESTRICTED_ACCESS"]},{key:"usnNotification",href:"#!/usn/notification",signature:true,title:reference.lang.pages.usn.notification.title,menuTitle:reference.lang.pages.usn.notification.menuTitle,controller:"TaxSystems.Usn.Notification",itemId:"usnNotificationTab",needServiceCheck:true,access:["CERT_ACCESS","RESTRICTED_ACCESS"]},{key:"usnRefuse",href:"#!/usn/refuse",signature:true,title:reference.lang.pages.usn.refuse.title,menuTitle:reference.lang.pages.usn.refuse.menuTitle,controller:"TaxSystems.Usn.Refuse",itemId:"usnRefuseTab",needServiceCheck:true,access:["CERT_ACCESS","RESTRICTED_ACCESS"]},{key:"usnChange",href:"#!/usn/change",signature:true,title:reference.lang.pages.usn.change.title,menuTitle:reference.lang.pages.usn.change.menuTitle,controller:"TaxSystems.Usn.Change",itemId:"usnChangeTab",needServiceCheck:true,access:["CERT_ACCESS","RESTRICTED_ACCESS"]},{key:"usnStop",href:"#!/usn/stop",signature:true,title:reference.lang.pages.usn.stop.title,menuTitle:reference.lang.pages.usn.stop.menuTitle,controller:"TaxSystems.Usn.Stop",itemId:"usnStopTab",needServiceCheck:true,access:["CERT_ACCESS","RESTRICTED_ACCESS"]},{key:"psnPatent",href:"#!/psn/patent",signature:true,title:reference.lang.pages.psn.patent.title,menuTitle:reference.lang.pages.psn.patent.menuTitle,controller:"TaxSystems.Psn.Patent",itemId:"psnPatentTab",needServiceCheck:true,access:["CERT_ACCESS","RESTRICTED_ACCESS"]},{key:"psnOrn",href:"#!/psn/orn",signature:true,title:reference.lang.pages.psn.orn.title,menuTitle:reference.lang.pages.psn.orn.menuTitle,controller:"TaxSystems.Psn.Orn",itemId:"psnOrnTab",needServiceCheck:true,access:["CERT_ACCESS","RESTRICTED_ACCESS"]},{key:"psnStop",href:"#!/psn/stop",signature:true,title:reference.lang.pages.psn.stop.title,menuTitle:reference.lang.pages.psn.stop.title,controller:"TaxSystems.Psn.Stop",itemId:"psnStopTab",needServiceCheck:true,access:["CERT_ACCESS","RESTRICTED_ACCESS"]},{key:"deskAudit",href:"#!/knp",menuTitle:reference.lang.pages.knp.menuTitle,title:reference.lang.pages.knp.title,controller:"DeskAudit",itemId:"knpTab",access:["CERT_ACCESS","INSPECTOR_ACCESS","RESTRICTED_ACCESS","HRESTRICTED_ACCESS"]},{key:"fnsMail",href:"#!/fns/mail",menuTitle:reference.lang.pages.fnsMail.menuTitle,title:reference.lang.pages.fnsMail.title,controller:"FnsMail",itemId:"fnsMail",access:["CERT_ACCESS","INSPECTOR_ACCESS","RESTRICTED_ACCESS","HRESTRICTED_ACCESS"]},{key:"fnsStands",href:"#!/fns/stands",menuTitle:reference.lang.pages.fnsStands.menuTitle,title:reference.lang.pages.fnsStands.title,controller:"FnsStands",itemId:"fnsStands",access:["CERT_ACCESS","INSPECTOR_ACCESS","RESTRICTED_ACCESS","HRESTRICTED_ACCESS"]},{key:"onlineBooking",href:"#!/onlineBooking",menuTitle:reference.lang.pages.onlineBooking.title,title:reference.lang.pages.onlineBooking.title,controller:"OnlineBooking",itemId:"onlineBookingTab",needServiceCheck:true,access:["CERT_ACCESS","RESTRICTED_ACCESS","HRESTRICTED_ACCESS"]},{key:"overpaymentStatus",href:"#!/overpayment/statuses",menuTitle:reference.lang.pages.rsb.overpayment.status.title,title:reference.lang.pages.rsb.overpayment.status.title,controller:"Rsb.Overpayment.Status",itemId:"overpaymentStatusTab",access:["CERT_ACCESS","RESTRICTED_ACCESS","HRESTRICTED_ACCESS","INSPECTOR_ACCESS"]},{key:"kkt",href:"#!/kkt",menuTitle:reference.lang.pages.kkt.menuTitle,title:"",controller:"Kkt.Index",access:["CERT_ACCESS","RESTRICTED_ACCESS","HRESTRICTED_ACCESS","INSPECTOR_ACCESS"],itemId:"kktTab",children:[{key:"kktRegistration",href:"#!/kkt/registration",signature:true,menuTitle:reference.lang.pages.kkt.registration.menuTitle,title:reference.lang.pages.kkt.registration.title,controller:"Kkt.Registration",needServiceCheck:true,access:["CERT_ACCESS","KKT_ACCESS","RESTRICTED_ACCESS"],optionalParams:["kktId"],itemId:"kktRegistrationTab"},{key:"kktRegistrationFile",href:"#!/kkt/registration/file",signature:true,menuTitle:reference.lang.pages.kkt.registration.menuTitle,title:reference.lang.pages.kkt.registration.title,controller:"Kkt.RegistrationFile",needServiceCheck:true,access:["CERT_ACCESS","KKT_ACCESS","RESTRICTED_ACCESS"],itemId:"kktRegistrationFileTab"},{key:"kktDeRegistration",href:"#!/kkt/deregistration",signature:true,menuTitle:reference.lang.pages.kkt.deRegistration.menuTitle,title:reference.lang.pages.kkt.deRegistration.title,controller:"Kkt.DeRegistration",needServiceCheck:true,access:["CERT_ACCESS","KKT_ACCESS","RESTRICTED_ACCESS"],requireParam:["kktId"],itemId:"kktDeRegistrationTab"},{key:"kktReRegistration",href:"#!/kkt/reregistration",signature:true,menuTitle:reference.lang.pages.kkt.reRegistration.menuTitle,title:reference.lang.pages.kkt.reRegistration.title,controller:"Kkt.ReRegistration",needServiceCheck:true,access:["CERT_ACCESS","KKT_ACCESS","RESTRICTED_ACCESS"],requireParam:["kktId"],itemId:"kktReRegistrationTab"},{key:"kktFiscalReport",href:"#!/kkt/fiscal-report",signature:true,menuTitle:reference.lang.pages.kkt.fiscalReport.menuTitle,title:reference.lang.pages.kkt.fiscalReport.title,controller:"Kkt.FiscalReport",needServiceCheck:true,access:["CERT_ACCESS","KKT_ACCESS","RESTRICTED_ACCESS"],itemId:"kktFiscalReport"},{key:"kktManufacturer",href:"#!/kkt/manufacturer",menuTitle:reference.lang.pages.kkt.manufacturer.menuTitle,title:"",controller:"Kkt.Manufacturer.Index",access:["KKT_MANUFACTURER_ACCESS"],itemId:"kktManufacturer",children:[{key:"kktModelInstanceRegistration",href:"#!/kkt/models/instances/registration",menuTitle:reference.lang.pages.kkt.produced.register.menuTitle,title:reference.lang.pages.kkt.produced.register.title,controller:"Kkt.Manufacturer.Models.Instances.Register",access:["KKT_MANUFACTURER_ACCESS"],itemId:"kktModelsInstancesRegistrationTab"},{key:"kktFnInstancesRegistration",href:"#!/kkt/fn/instances/registration",menuTitle:reference.lang.pages.kkt.fn.produced.register.menuTitle,title:reference.lang.pages.kkt.fn.produced.register.title,controller:"Kkt.Manufacturer.Fn.Instances.Register",access:["KKT_MANUFACTURER_ACCESS"],itemId:"kktFnInstancesRegistrationTab"}]}]},{key:"serviceUnavailable",href:"#!/service-unavailable"}]}],bc:[],init:function(){this.createBreadcrumbs()},getControllerName:function(a){a=this.modifyHref(a);var b=this.getInfo(a);return b.controller},getInfo:function(b,f){b=this.modifyHref(b);f=f||this.data;var e=0,d=f.length,c={};for(;e<d;e++){if(b===f[e].href&&(typeof(f[e].access)=="undefined"||Ext.Array.intersect(LkIp.User.get("accessStatus"),f[e].access).length>0)){if(typeof(f[e].access)!="undefined"){var a=Ext.Array.intersect(LkIp.User.get("accessStatus"),f[e].access);if(a.length==1&&a[0]=="KKT_ACCESS"){return{}}else{return f[e]}}else{return f[e]}}else{if(typeof f[e].children!=="undefined"&&f[e].children.length>0){c=this.getInfo(b,f[e].children);if(!Ext.Object.isEmpty(c)){return c}}}}return{}},getPagesForMenu:function(e,d){d=d||this.data;var c=0,b=d.length,a=[];for(;c<b;c++){if(typeof d[c].menuAlias!=="undefined"&&d[c].menuAlias==e){a.push(d[c])}else{if(typeof d[c].children!=="undefined"&&d[c].children.length>0){Ext.Array.each(this.getPagesForMenu(e,d[c].children),function(f){a.push(f)})}}}return a},createBreadcrumbs:function(f,e){f=f||this.data;e=e||false;var d=0,c=f.length;for(;d<c;d++){this.bc[f[d].href]=[];if(false!==e&&typeof this.bc[e.href]!=="undefined"){for(var b=0,a=this.bc[e.href].length;b<a;b++){this.bc[f[d].href].push(this.bc[e.href][b])}}this.bc[f[d].href].push(f[d]);if(typeof f[d].children!=="undefined"&&f[d].children.length>0){this.createBreadcrumbs(f[d].children,f[d])}}},getBreadcrumbs:function(a){a=this.modifyHref(a);return typeof this.bc[a]!=="undefined"&&this.bc[a].length>1?this.bc[a]:[]},modifyHref:function(b){var a=b.indexOf("?");if(a>-1){b=b.substring(0,a)}if(Ext.String.endsWith(b,"/")){b=b.substring(0,b.length-1)}return b}},0,0,0,0,0,0,[LkIp,"PageRegistry"],0));(Ext.cmd.derive("LkIp.Request",Ext.Base,{singleton:true,attempt:0,defaultMaxAttempts:10,maxAttempts:10,firstDelay:500,updateAuthHeaders:function(){return{"Web-Client-Version":LkIp.app.version}},setMaxAttempts:function(a){this.maxAttempts=a;return this},request:function(e,f,b,a){var d=this,c=arguments.length;switch(c){case 2:a=false;b=0;break;case 3:if(Ext.isBoolean(b)){a=b}break}if(Ext.isString(e)){e={url:e}}if(b<d.maxAttempts){Ext.Ajax.request(Ext.apply({method:"GET",disableCaching:false,headers:d.updateAuthHeaders(),callback:function(i,j,h){switch(h.status){case 401:if(LkIp.User.isCertUser()){window.location.reload()}else{window.location="/"}break;case 403:LkIp.Error.e403();break;case 406:LkIp.Error.e406();break;case 500:case 404:case 405:if(a){f({})}else{}break;case 503:LkIp.Error.e503();break;case 200:default:h=Ext.JSON.decode(h.responseText);if(2===h.status){var g=new Ext.util.DelayedTask(function(){b++;d.request(e,f,b,a)});g.delay(d.firstDelay+(b*1500)/2)}else{d.maxAttempts=d.defaultMaxAttempts;f(h)}break}},failure:function(){f(false)}},e))}else{d.maxAttempts=d.defaultMaxAttempts;f(false)}},formSubmit:function(a,c){var b=c.failure;c.failure=function(d,e){if(Ext.isEmpty(e.result)||Ext.isEmpty(e.result.response)){if(!Ext.isObject(e.result)){e.result={}}e.result.response=!Ext.isEmpty(c.fileSubmit)&&c.fileSubmit?reference.lang.errors.uploadError:reference.lang.signature.errorDefault}b=Ext.Function.bind(b,this);b(d,e)};a.submit(Ext.apply({method:"POST",headers:this.updateAuthHeaders(),dataType:"json"},c))},queue:function(c,a,b){return Ext.TaskManager.start({run:function(){c()},interval:a})}},0,0,0,0,0,0,[LkIp,"Request"],0));function checkPrivateMode2(){var d,a,b;try{b=new Date();(d=window.localStorage).setItem(b,b);a=d.getItem(b)!=b;d.removeItem(b);a&&(d=false)}catch(c){d=false}return !!((Ext.isSafari||Ext.is.iOS||Ext.is.Mac)&&d===false)}(Ext.cmd.derive("LkIp.model.Setting",Ext.data.Model,{fields:["id","key","value"],proxy:{type:browserLocalStorage&&!checkPrivateMode2()?"localstorage":"memory",id:"LkIp-settings"}},0,0,0,0,0,0,[LkIp.model,"Setting"],0));(Ext.cmd.derive("LkIp.store.Settings",Ext.data.Store,{model:"LkIp.model.Setting"},0,0,0,0,0,0,[LkIp.store,"Settings"],0));(Ext.cmd.derive("LkIp.Settings",LkIp.LocalStore,{singleton:true,storeName:"LkIp.store.Settings",defaults:{tabs:[]},set:function(b,c){var a=this.store.findExact("key",b);if(a>-1){this.store.removeAt(a)}this.store.add({key:b,value:c});this.syncStore()},get:function(b){var a=this.store.findExact("key",b);return a>-1?this.store.getAt(a).get("value"):null},remove:function(a){this.store.removeAt(this.store.findExact("key",a));this.syncStore()},cleanStore:function(){this.store.removeAll(true);this.syncStore()}},0,0,0,0,0,0,[LkIp,"Settings"],0));(Ext.cmd.derive("LkIp.Signature",Ext.Base,{singleton:true,cryptoapi:undefined,pluginLoaded:false,certificateList:undefined,certificatesLoading:false,certificateListError:false,signing:false,signingResult:[],signingMode:undefined,signingError:false,init:function(){var a=this;var b=new Ext.util.DelayedTask(function(){a.cryptoapi=new CryptoApi();a.loadPlugin()});b.delay(1000)},loadPlugin:function(){var b=this;try{var d=b.cryptoapi.newProcess("loadPlugin");var a=Ext.TaskManager.start({run:function(){if(d.isReady()){b.pluginLoaded=true;Ext.TaskManager.stop(a)}},interval:200})}catch(c){b.pluginLoaded=true}},sign:function(f,c,b){var d=this;b=b||{};if(!d.checkPlugin()){return}if(d.isSigning()){return}d.reset();d.signing=true;var e=d.getCryptoApi().newProcess("isBinded",[c]);var a=Ext.TaskManager.start({run:function(){if(e.isReady()){Ext.TaskManager.stop(a);if(e.getResult()){d._sign(f,c,b)}else{d.showBindCertificateWindow(c,function(g){d.bindCertificate(c,g,function(){d._sign(f,c,b)})})}}},interval:200})},isSigning:function(){return this.signing==true},_sign:function(d,b,a){var c=this;if(!c.isSigning()){return false}if(Ext.isArray(d)){c._signManyDocuments(d,b,a)}else{c._signOneDocument(d,b,a)}},_signManyDocuments:function(c,d,b){var e=this;e.multiSign=[];e.signingMode="multiple";Ext.Array.each(c,function(g){var f;if(b.signXml){f=e.getCryptoApi().newProcess("signXml",[g.hash,d])}else{if(b.gp3){f=e.getCryptoApi().newProcess("signHashCms",[g.hash,d])}else{f=e.getCryptoApi().newProcess("signHash",[g.hash,d])}}e.signingResult.push({id:g.id,process:f})});var a=Ext.TaskManager.start({run:function(){var f=true;Ext.Array.each(e.signingResult,function(h,g){if(h.process.isReady()){if(h.process.isSuccessful()){h.hash=h.process.getResult()}else{e.signingError=h.process.getError();f=true;return false}}else{f=false}});if(f){e.signing=false;Ext.TaskManager.stop(a)}},interval:1000})},_signOneDocument:function(f,c,b){var d=this,e;d.signingMode="single";if(b.signXml){e=d.getCryptoApi().newProcess("signXml",[f,c])}else{if(b.gp3){e=d.getCryptoApi().newProcess("signHashCms",[f,c])}else{e=d.getCryptoApi().newProcess("signHash",[f,c])}}var a=Ext.TaskManager.start({run:function(){if(e.isReady()){d.signing=false;if(e.isSuccessful()){d.signingResult={hash:e.getResult()}}else{d.signingError=e.getError()}Ext.TaskManager.stop(a)}},interval:1000})},isPluginEnabled:function(){return this.getCryptoApi().isPluginEnabled()},showBindCertificateWindow:function(b,d){var c=this,a=Ext.create("LkIp.view.CertificatePinWindow",{title:c.getCryptoApi().getBindWindowTitle(),bindCertificate:function(e){d(e)}});a.show()},getCryptoApi:function(){return this.cryptoapi},bindCertificate:function(c,b,f){var d=this;var e=d.getCryptoApi().newProcess("bind",[c,b]);var a=Ext.TaskManager.start({run:function(){if(e.isReady()){Ext.TaskManager.stop(a);if(e.isSuccessful()){f()}else{d.signing=false;d.signingError=e.getError();return false}}},interval:200})},isPluginLoaded:function(){return this.pluginLoaded},isEnabled:function(){return LkIp.User.get("esign")&&LkIp.User.get("esign")!=="0"},hasSigningError:function(){return false!==this.signingError},getSigningError:function(){return this.signingError},getSigningResults:function(){var a=this;return a.signingResult},hasCertificateListError:function(){return false!==this.certificateListError},getCertificateListError:function(){return this.certificateListError},getCertificates:function(){var a=this;return a.certificateList},isCertificatesLoading:function(){return"loading"===this.certificatesLoading},hasCertificates:function(){var a=this;return !Ext.isEmpty(a.certificateList)},hasValidCertificates:function(){var a=this;return a.hasCertificates()&&a.getCertificates().valid.length>0},loadCertificates:function(){var b=this;if(!b.checkPlugin()){return false}if(b.isCertificatesLoading()||b.isCertificateListLoaded()){return}b.certificatesLoading="loading";if(LkIp.User.authorizedNotByCertificate()){var d=b.getCryptoApi().newProcess("getCertificateList");var a=Ext.TaskManager.start({run:function(){if(d.isReady()){b.certificatesLoading=true;try{if(d.isSuccessful()){b.certificateList=b.parseCertificateList(d.getResult())}else{b.certificateListError=d.getError()}Ext.TaskManager.stop(a)}catch(f){b.certificateListError="\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0441\u043f\u0438\u0441\u043a\u0430 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0432";Ext.TaskManager.stop(a)}}},interval:100})}else{try{b.certificateList=[b.getCertificate(LkIp.User.getCertificateIdentifier())];b.certificatesLoading=true}catch(c){b.certificateListError="\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0441\u043f\u0438\u0441\u043a\u0430 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0432";b.certificatesLoading=true}}},parseCertificateList:function(d){var a=this,c=[],b=[];Ext.Array.each(d,function(e){var f=a.parseCertificate(e);if(f.valid){c.push(f)}else{b.push(f)}});return{valid:c,invalid:b}},parseCertificate:function(j){function m(y){var z={"0":"\u044f\u043d\u0432\u0430\u0440\u044f","1":"\u0444\u0435\u0432\u0440\u0430\u043b\u044f","2":"\u043c\u0430\u0440\u0442\u0430","3":"\u0430\u043f\u0440\u0435\u043b\u044f","4":"\u043c\u0430\u044f","5":"\u0438\u044e\u043d\u044f","6":"\u0438\u044e\u043b\u044f","7":"\u0430\u0432\u0433\u0443\u0441\u0442\u0430","8":"\u0441\u0435\u043d\u0442\u044f\u0431\u0440\u044f","9":"\u043e\u043a\u0442\u044f\u0431\u0440\u044f","10":"\u043d\u043e\u044f\u0431\u0440\u044f","11":"\u0434\u0435\u043a\u0430\u0431\u0440\u044f"};return y.getDate()+" "+z[y.getMonth()]+" "+y.getFullYear()+" \u0433. "+y.getHours()+":"+y.getMinutes()}var c=j.clearName(j.extract(j.getSubjectName(),["INN=","\u0418\u041d\u041d=","1.2.643.3.131.1.1="])),w=j.clearName(j.extract(j.getSubjectName(),["\u041e\u0413\u0420\u041d=","OGRN=","1.2.643.100.1="])),i=j.clearName(j.extract(j.getSubjectName(),["\u041e\u0413\u0420\u041d\u0418\u041f=","OGRNIP=","1.2.643.100.5="])),f=j.extract(j.getSubjectName(),"SN=").replace(/_/g," "),q=j.extract(j.getSubjectName(),["GN=","G="]).replace(/_/g," "),k=j.getThumbprint(),p=j.isValid(),r=j.clearName(j.extract(j.getSubjectName(),["\u0421\u041d\u0418\u041b\u0421=","SNILS=","1.2.643.100.3="])),x="",a=new Date(),n=j.getSha1(),l=false,u=false,g=false,o=false,t=false,h=false,d,e;if(!p){if(a>j.validToDate()||a<j.validFromDate()){o=true;x="\u0423 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430 \u0437\u0430\u043a\u043e\u043d\u0447\u0438\u043b\u0441\u044f \u0441\u0440\u043e\u043a \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f."}else{if(!j.hasPrivateKey()){t=true;x="\u041d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d \u0437\u0430\u043a\u0440\u044b\u0442\u044b\u0439 \u043a\u043b\u044e\u0447 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430."}else{x="\u041d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0439 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442."}}}if(p){if(w.length>0||c.length==10){p=false;h=true;x="\u0421\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442 \u044e\u0440\u0438\u0434\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e \u043b\u0438\u0446\u0430."}else{if(c.length==0){d=j.validFromDate();d.setHours(0,0,0,0);e=LkIp.Utils.getDateObject("2015-07-01");if(d>=e){p=false;l=true;x="\u0412 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0435 \u0418\u043d\u0434\u0438\u0432\u0438\u0434\u0443\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043f\u0440\u0435\u0434\u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u0435\u043b\u044f, \u0432\u044b\u043f\u0443\u0449\u0435\u043d\u043d\u043e\u043c \u043f\u043e\u0441\u043b\u0435 1 \u0438\u044e\u043b\u044f 2015 \u0433\u043e\u0434\u0430 \u0434\u043e\u043b\u0436\u0435\u043d \u043f\u0440\u0438\u0441\u0443\u0442\u0441\u0432\u043e\u0432\u0430\u0442\u044c \u0418\u041d\u041d."}}else{var b=true,v=!Ext.isEmpty(c),s=!Ext.isEmpty(i);if(v&&c!=LkIp.User.get("inn")){b=false;l=true}if(s&&i!=LkIp.User.get("ogrn")){b=false;u=true}if((f+" "+q).toLowerCase()!=LkIp.User.get("fullName").toLowerCase().trim()){b=false;g=true}if(!b){p=false;x="\u0421\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442 \u043f\u0440\u0438\u043d\u0430\u0434\u043b\u0435\u0436\u0438\u0442 \u0434\u0440\u0443\u0433\u043e\u043c\u0443 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044e."}}}}return{id:j.getId(),innFault:l,ogrnIpFault:u,dateFault:o,privateKeyFault:t,ulFault:h,nameFault:g,valid_from:j.validToDate(),valid_to:j.validFromDate(),validity_string:"\u0441: "+m(j.validFromDate())+" \u043f\u043e: "+m(j.validToDate()),inn:c,ogrnip:i,snils:r,name:f+" "+q,issuer:j.getIssuerCommonName(),owner:j.getCommonName(),certificateIdentifier:n,thumbprint:k,valid:p,invalid_reason:x}},isCertificateListLoaded:function(){return true===this.certificatesLoading},getCertificateContent:function(a){var b=this;return b.getCryptoApi().getCertificateContent(a)},getCertificate:function(a){var b=this;return b.getCryptoApi().getCertificate(a)},reset:function(){var a=this;a.signing=false;a.signingMode=undefined;a.signingError=false;a.signingResult=[]},checkPlugin:function(){var a=this;if(LkIp.User.authorizedByCertificate()){return true}if(!a.isPluginEnabled()){var b=a.getCryptoApi().getPluginException();if(Ext.isEmpty(b)){b='\u041e\u0448\u0438\u0431\u043a\u0430 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043f\u043b\u0430\u0433\u0438\u043d\u0430, \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u043e\u043d \u043e\u0442\u043a\u043b\u044e\u0447\u0435\u043d. \u041f\u0440\u043e\u0439\u0434\u0438\u0442\u0435 <a href="#!/signCheck">\u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0443</a> \u0434\u043b\u044f \u0443\u0441\u0442\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u044b.'}LkIp.Msg.error(b);return false}return true}},0,0,0,0,0,0,[LkIp,"Signature"],0));(Ext.cmd.derive("LkIp.User",Ext.Base,{singleton:true,init:function(){},getUserData:function(b){var a=this;LkIp.Request.request({url:"/api/user/get",scope:this},function(c){a.setUserData(c.response);b()})},setUserData:function(b){var a=this;a.set("email",!Ext.isEmpty(b.emailAddress)?b.emailAddress:"");a.set("address",!Ext.isEmpty(b.address)?b.address:"");a.set("phone",!Ext.isEmpty(b.phone)?b.phone:"");a.set("subscriptions",!Ext.isEmpty(b.subscriptions)?b.subscriptions:[]);a.privateSet([{key:"inn",value:b.inn},{key:"ogrn",value:b.ogrnIp},{key:"name",value:b.name},{key:"firstname",value:b.name},{key:"patronymic",value:b.patronymic},{key:"surname",value:b.surname},{key:"fullName",value:b.fullName},{key:"organizationName",value:a.getOrganizationName(b)},{key:"sha1",value:b.sha1},{key:"esign",value:b.esign},{key:"userId",value:b.userId},{key:"loginType",value:b.loginType},{key:"accessStatus",value:typeof(b.accessStatus)!="undefined"?b.accessStatus.split(","):["HRESTRICTED_ACCESS"]},{key:"confirmEmail",value:b.confirmEmail},{key:"isDataUpdating",value:b.isDataUpdating},{key:"delayedRegistration",value:b.delayedRegistration},{key:"temporaryPassword",value:b.temporaryPassword},{key:"in_ufns_experiment",value:Ext.isEmpty(b.in_ufns_experiment)?false:b.in_ufns_experiment}]);a.privateSet("hideOverpayment",typeof b.hideOverpayment!="undefined");if("inspector"===b.loginType){a.privateSet([{key:"codeNO",value:b.codeNO},{key:"inspectorName",value:b.inspectorName}])}if(("undefined"!==typeof b.changeEmail)&&(1==b.changeEmail)){a.privateSet("changeEmail","1")}if(("undefined"!==typeof b.serialNumber&&b.serialNumber!="000000000000")){a.privateSet("serial",b.serialNumber)}if("undefined"!==typeof b.head){a.privateSet("head",b.head.SvedIP)}if("undefined"!==typeof b.extraParams){Ext.Object.each(b.extraParams,function(d,c){a.privateSet(d,c)})}},isEmailConfirmed:function(){return this.get("confirmEmail")==1},privateSet:function(a,c){var b=this;if(Ext.isArray(a)){Ext.Array.each(a,function(d){b.setWorkaround(d.key,d.value)})}else{b.setWorkaround(a,c)}},setWorkaround:function(a,b){Object.defineProperty(this,a,{value:b,writable:false,enumerable:true,configurable:false})},get:function(a){return Ext.isEmpty(this[a])?"":this[a]},set:function(a,b){this[a]=b},getOrganizationName:function(a){return Ext.String.format(reference.lang.user.organizationPattern,a.surname,a.name,a.patronymic)},isUser:function(){return this.isLoginUser()||this.isClosedUser()||this.isCertUser()},isInspector:function(){var a=this.get("accessStatus");return Ext.Array.contains(a,"INSPECTOR_ACCESS")||this.isEcrInspector()},isEcrInspector:function(){var a=this.get("accessStatus");return Ext.Array.contains(a,"INSPECTOR_ACCESS_ECR")},isLoginUser:function(){var a=this.get("accessStatus");return Ext.Array.contains(a,"RESTRICTED_ACCESS")},isClosedUser:function(){var a=this.get("accessStatus");return Ext.Array.contains(a,"HRESTRICTED_ACCESS")},isCertUser:function(){var a=this.get("accessStatus");return Ext.Array.contains(a,"CERT_ACCESS")||this.isJacartaUser()},isJacartaUser:function(){return"jacarta"==this.get("loginType")},isInspectorWithCodeNO:function(){return this.isInspector()&&!Ext.isEmpty(this.get("codeNO"))},isActiveUser:function(){return !this.isInspector()&&!this.isClosedUser()},getDateIPFromHead:function(){var a=this.get("head");if(!Ext.isEmpty(a)&&!Ext.isEmpty(a.SvedUchet)&&!Ext.isEmpty(a.SvedUchet["SvedUchetIP"])&&!Ext.isEmpty(a.SvedUchet["SvedUchetIP"]["@DataPostIP"])){return a.SvedUchet["SvedUchetIP"]["@DataPostIP"]}if(!Ext.isEmpty(a)&&!Ext.isEmpty(a.SvedUchet)&&!Ext.isEmpty(a.SvedUchet["@DataPostMJ"])){return a.SvedUchet["@DataPostMJ"]}return null},getCodeNO:function(){if(!Ext.isEmpty(LkIp.User.get("head"))){return LkIp.User.get("head").SvedUchet["@KodNalOrg"]}return null},isKktManufacturer:function(){var a=this.get("accessStatus");return Ext.Array.contains(a,"KKT_MANUFACTURER_ACCESS")},hasKktAccess:function(){return true},isInUfnsExperiment:function(){return this.get("in_ufns_experiment")},canSendKkt:function(){var a=this.get("head");if(Ext.isEmpty(a)){return false}return !(Ext.isEmpty(a.SvedUchet)||Ext.isEmpty(a.SvedUchet["SvedUchetIP"])||Ext.isEmpty(a.SvedUchet["SvedUchetIP"]["@KodPrichPostIP"])||Ext.isEmpty(a.SvedUchet["SvedUchetIP"]["@DataPostIP"]))},authorizedByCertificate:function(){return"certificate"==this.get("loginType")},authorizedByAnyCertificate:function(){return this.authorizedByCertificate()||this.authorizedByJacarta()||this.authorizedByRutoken()},authorizedByPassword:function(){return"login_password"==this.get("loginType")},authorizedNotByCertificate:function(){return !this.authorizedByAnyCertificate()&&this.isActiveUser()},authorizedByJacarta:function(){return"jacarta"==this.get("loginType")},authorizedByRutoken:function(){return"rutoken"==this.get("loginType")},getCertificateIdentifier:function(){var a=this;if(a.authorizedByCertificate()){return a.get("sha1")}else{if(a.authorizedByJacarta()){return{token:a.get("a_tokenId"),certificate:a.get("a_certificateId")}}else{if(a.authorizedByRutoken()){return{deviceId:a.get("a_deviceId"),certificateId:a.get("a_certificateId")}}}}}},0,0,0,0,0,0,[LkIp,"User"],0));(Ext.cmd.derive("LkIp.Utils",Ext.Base,{singleton:true,dateFormat:"d.m.Y",timeFormat:"H:i",xmlDateFormat:"Y-m-d",init:function(a){Ext.apply(this,Ext.isObject(a)?a:{})},getDate:function(a,b){if(!Ext.isEmpty(a)){b=b||false;a=Ext.Date.parseDate(a.replace("Z",""),b?"Y-m-dTH:i:s":"Y-m-d");return Ext.Date.format(a,b?(this.dateFormat+" "+this.timeFormat):this.dateFormat)}return""},getNowDate:function(a){a=a||false;return Ext.Date.format(new Date(),a?this.xmlDateFormat:this.dateFormat)},getDateObject:function(a){if(a.indexOf(".")==-1){a=this.getDate(a)}a=a.split(".");return new Date(a[2],a[1]-1,a[0])},getGender:function(a){return"1"===a?reference.lang.gender.male:reference.lang.gender.female},stringWrap:function(a){return !Ext.isEmpty(a)?Ext.String.format('<span class="string-wrap-by-block">{0}</span>',a):""},getClientHeight:function(){return Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight)},getClientWidth:function(){return Math.max(document.body.scrollWidth,document.documentElement.scrollWidth,document.body.offsetWidth,document.documentElement.offsetWidth,document.body.clientWidth,document.documentElement.clientWidth)},tooltip:function(a,d,c){var b=Ext.apply({cls:"blue-tooltip simple-tooltip",target:typeof a==="string"?a:(undefined!==a.inputEl?a.inputEl:a.id),anchorToTarget:true,trackMouse:false,hideDelay:0,showDelay:0,anchor:"left",html:d},Ext.isObject(c)?c:{});return Ext.create("Ext.tip.ToolTip",b)},closableTooltip:function(a,d,c,b){b=Ext.isObject(b)?b:{};return this.tooltip(a,d,Ext.apply({anchor:"right",autoHide:false,autoShow:false,closable:true,disabled:false,title:c,cls:"blue-tooltip tooltip-with-table",listeners:{close:function(){this.setDisabled(true)}}},b))},numberConvert:function(a){Ext.apply(Ext.util.Format,{thousandSeparator:" "});return Ext.util.Format.number(a,"0,0.00")},getFile:function(d,a){var c=0,b=[];a=a||"/web/file/download";while(d[c]){b.push({tag:"input",type:"hidden",name:d[c].name,value:d[c].value});c++}Ext.DomHelper.append(Ext.getBody(),{tag:"form",id:"get-file",action:a,method:"POST",cn:[b]}).submit()},header:function(c,b){if(!Ext.isNumber(b)){b=1}var a=new Ext.Template("<h{type}>{text}</h{type}>");return a.apply({type:b,text:c})},rouble:function(a){return a+reference.lang.rouble},noRenderer:function(a){var b=true;if(!Ext.isEmpty(a)){if(Ext.isObject(a)){b=a.actual;a=a.code}if(!b){return'<span class="gray">'+a+"</span>"}else{if(!LkIp.User.isInspector()&&a!="9965"){return Ext.String.format("<span class='ifns-tooltip' code='{0}'>{0}</span>",a)}else{return a}}}return"-"},checkFilterStore:function(b){var a=b.getStore(),c=b.getValue();if(0==c||!a.getById(c)){b.reset()}},unique:function(b,c){var a=[],d=[];Ext.Array.each(b,function(e){if(!Ext.Array.contains(a,e[c])){d.push(e);a.push(e[c])}});return d},isFilterEmpty:function(a){return this.isEmpty(a)},downloadDocument:function(f,b,c,e){var a=new Date(),d="GET";Ext.util.Cookies.set(f,1,new Date(a.getTime()+(2*60*1000)));LkIp.Msg.waitForDocument(f);c=Ext.isObject(c)?c:{};if(!Ext.isEmpty(c.method)){d=c.method;delete c.method}LkIp.Request.request({url:b,method:d,params:c,scope:this},function(g){if(false!==g){if(0!==g.status){LkIp.Utils.getFile([{name:"file",value:g.response.file},{name:"cookieName",value:f}]);if("undefined"!==typeof e){e()}}else{Ext.util.Cookies.clear(f);LkIp.Msg.error(reference.lang.docflow.getDocumentError)}}else{Ext.util.Cookies.clear(f);LkIp.Msg.error(reference.lang.errors.downloadError)}})},simpleDownload:function(c,b){var a=new Date();Ext.util.Cookies.set(c,1,new Date(a.getTime()+(2*60*1000)));LkIp.Msg.waitForDocument(c);LkIp.Utils.getFile([{name:"file",value:b},{name:"cookieName",value:c}])},goTo:function(a){document.location.href=a},scrollTo:function(b,c){var a=Ext.isChrome?Ext.getBody():Ext.get(Ext.query("html"));c=Ext.isObject(c)?c:{};return a.scrollTo("top",0==b?0:b.getPositionEl().getY(),Ext.apply({duration:2000},c))},isEmpty:function(a){return Ext.isEmpty(a)||0==a},hideDomMask:function(){Ext.suspendLayouts();var a=Ext.query(".x-mask");if(!Ext.isEmpty(a)){Ext.Array.each(a,function(b){Ext.get(b).setStyle("display","none")})}Ext.resumeLayouts(true)},ucfirst:function(a){return a.charAt(0).toUpperCase()+a.slice(1)},isJsonSuccess:function(a){return !Ext.isEmpty(a)&&false!==a&&0!==a.status},roundTaxValues:function(a){Ext.apply(Ext.util.Format,{thousandSeparator:" "});a=Math.round(a);return Ext.util.Format.number(a,"0,0")},checkForInspectorNo:function(){var a={};if(LkIp.User.isInspectorWithCodeNO()){a.codeNO=LkIp.User.get("codeNO")}return a},checkForRussianName:function(a,d,e){if(Ext.isEmpty(a)){return true}var c=a.match(/[-\- '0-9]*/i),b=a.length;d=d||false;e=e||false;if(!Ext.isEmpty(c[0])&&c[0].length===b||(!e&&Ext.isEmpty(a))){return true}else{return((false!==d)?Ext.String.format(reference.lang.errors.nameError,d):reference.lang.errors.nameErrorShort)}},generateNumberString:function(b){var a=LkIp.Utils.rouble(LkIp.Utils.numberConvert(b));if(b==0){return Ext.String.format('<span class="lightergray">{0}</span>',a)}else{return a}},requiredLabel:function(){return'<span class="form-required-field" data-qtip="'+reference.lang.form.required+'">*</span>'},formatRnm:function(b){var a=b.match(/.{1,4}/g);return a.join(" ")},openExternalLink:function(a){Ext.DomHelper.append(Ext.getBody(),'<a href="'+a+'" id="external_link" target="_blank"></a>').click();Ext.get("external_link").remove()}},0,0,0,0,0,0,[LkIp,"Utils"],0));(Ext.cmd.derive("LkIp.view.Index.Widget.DropZone",Ext.dd.DropTarget,{constructor:function(a,b){this.portal=a;Ext.dd.ScrollManager.register(a.body);LkIp.view.Index.Widget.DropZone.superclass.constructor.call(this,a.body,b);a.body.ddScrollConfig=this.ddScrollConfig},ddScrollConfig:{vthresh:50,hthresh:-1,animate:true,increment:200},createEvent:function(a,f,d,b,h,g){return{portal:this.portal,panel:d.panel,columnIndex:b,column:h,position:g,data:d,source:a,rawEvent:f,status:this.dropAllowed}},notifyOver:function(u,s,v){var d=s.getXY(),a=this.portal,p=u.proxy;if(!this.grid){this.grid=this.getGrid()}var b=a.body.dom.clientWidth;if(!this.lastCW){this.lastCW=b}else{if(this.lastCW!=b){this.lastCW=b;this.grid=this.getGrid()}}var o=0,c=0,n=this.grid.columnX,q=n.length,m=false;for(q;o<q;o++){c=n[o].x+n[o].w;if(d[0]<c){m=true;break}}if(!m){o--}var i,g=0,r=0,l=false,k=a.items.getAt(o),t=k.items.items,j=false;q=t.length;for(q;g<q;g++){i=t[g];r=i.el.getHeight();if(r===0){j=true}else{if((i.el.getY()+(r/2))>d[1]){l=true;break}}}g=(l&&i?g:k.items.getCount())+(j?-1:0);var f=this.createEvent(u,s,v,o,k,g);if(a.fireEvent("validatedrop",f)!==false&&a.fireEvent("beforedragover",f)!==false){p.getProxy().setWidth("auto");if(i){u.panelProxy.moveProxy(i.el.dom.parentNode,l?i.el.dom:null)}else{u.panelProxy.moveProxy(k.el.dom,null)}u.panelProxy.proxy.setSize({width:this.grid.columnX[o].w,height:u.panelProxy.proxy.getSize().height});this.lastPos={c:k,col:o,p:j||(l&&i)?g:false};this.scrollPos=a.body.getScroll();a.fireEvent("dragover",f);return f.status}else{return f.status}},notifyOut:function(){delete this.grid},notifyDrop:function(l,h,g){delete this.grid;if(!this.lastPos){return}var j=this.lastPos.c,f=this.lastPos.col,k=this.lastPos.p,a=l.panel,b=this.createEvent(l,h,g,f,j,k!==false?k:j.items.getCount());if(this.portal.fireEvent("validatedrop",b)!==false&&this.portal.fireEvent("beforedrop",b)!==false){Ext.suspendLayouts();a.el.dom.style.display="";l.panelProxy.hide();l.proxy.hide();if(k!==false){j.insert(k,a)}else{j.add(a)}Ext.resumeLayouts(true);this.portal.fireEvent("drop",b);var m=this.scrollPos.top;if(m){var i=this.portal.body.dom;setTimeout(function(){i.scrollTop=m},10)}}delete this.lastPos;return true},getGrid:function(){var a=this.portal.body.getBox();a.columnX=[];this.portal.items.each(function(b){a.columnX.push({x:b.el.getX(),w:b.el.getWidth()})});return a},unreg:function(){Ext.dd.ScrollManager.unregister(this.portal.body);LkIp.view.Index.Widget.DropZone.superclass.unreg.call(this)}},1,0,0,0,0,0,[LkIp.view.Index.Widget,"DropZone"],0));(Ext.cmd.derive("LkIp.view.Index.Widget.Window",Ext.panel.Panel,{layout:"fit",anchor:"100%",frame:false,closable:false,collapsible:false,draggable:{moveOnDrag:false},cls:"widget-window"},0,["widgetWindow"],["panel","component","container","widgetWindow","box"],{panel:true,component:true,container:true,widgetWindow:true,box:true},["widget.widgetWindow"],0,[LkIp.view.Index.Widget,"Window"],0));(Ext.cmd.derive("LkIp.view.Index.Widget.Column",Ext.Container,{layout:"anchor",defaultType:"widgetWindow",cls:"widget-column"},0,["widgetColumn"],["component","widgetColumn","container","box"],{component:true,widgetColumn:true,container:true,box:true},["widget.widgetColumn"],0,[LkIp.view.Index.Widget,"Column"],0));(Ext.cmd.derive("LkIp.view.Index.Widget.Panel",Ext.panel.Panel,{cls:"widget-panel",bodyCls:"widget-panel-body",defaultType:"widgetColumn",autoScroll:false,manageHeight:false,initComponent:function(){var a=this;a.layout={type:"column"};a.callParent();a.addEvents({validatedrop:true,beforedragover:true,dragover:true,beforedrop:true,drop:true})},initEvents:function(){this.callParent();this.dd=Ext.create("LkIp.view.Index.Widget.DropZone",this,this.dropConfig)},beforeDestroy:function(){if(this.dd){this.dd.unreg()}this.callParent()}},0,["widgetPanel"],["panel","widgetPanel","component","container","box"],{panel:true,widgetPanel:true,component:true,container:true,box:true},["widget.widgetPanel"],0,[LkIp.view.Index.Widget,"Panel"],0));(Ext.cmd.derive("LkIp.view.Index.TaxCalendarWidget",Ext.Container,{layout:{type:"auto"},cls:"taxcalendar-widget",dateString:'<span class="date-object">\u043d\u0435 \u043f\u043e\u0437\u0434\u043d\u0435\u0435 <span class="date-object-day"> {0}</span> {1}</span>',dateStringSimple:'<span class="date-object"><span class="date-object-day"> {0}</span> {1}</span>',monthNames:reference.lang.index.taxCalendarWidget.monthNames,initComponent:function(){var a=this;Ext.apply(a,{items:[{xtype:"container",layout:{type:"auto"},cls:"tax-calendar-datepicker taxcalendar-widget-item",items:[{xtype:"datepicker",itemId:"taxpayerCalendar",format:"Y-m-d",border:0,componentCls:""},{xtype:"component",html:'<div class="blue-exclamation-icon events-help" style="padding: 5px 0 0 20px; cursor: pointer;">\u0421\u043e\u0431\u044b\u0442\u0438\u044f</div>'}]},{xtype:"gridpanel",itemId:"tax-calendar-events-grid",columnLines:false,rowLines:false,cls:"border-table",stripeRows:true,autoHeight:true,hideHeaders:true,sortableColumns:false,enableColumnMove:false,enableColumnResize:false,componentCls:"taxcalendar-widget-item tax-calendar-events-list",viewConfig:{enableTextSelection:true},store:{extend:"Ext.data.ArrayStore",fields:["name","status","type",{name:"date",type:"string",convert:function(d,c){var b=LkIp.Utils.getDateObject(d),e=Ext.Date.format(b,"n")-1;if(c.get("common")!="undefined"&&c.get("common")=="booking"){return Ext.String.format(a.dateStringSimple,Ext.Date.format(b,"j"),a.monthNames[e])}else{return Ext.String.format(a.dateString,Ext.Date.format(b,"j"),a.monthNames[e])}}},"sum","fid","nameKBK","common","shortKBK"],storeId:"taxCalendarEventsStore",pageSize:3,limit:1},columns:[{width:125,dataIndex:"",renderer:function(d,f,c){var b,e;f.tdCls=f.tdCls+" tax-name";if(Ext.isEmpty(c.get("common"))){b=c.get("status");e=c.get("type")===1?"\u041f\u0440\u0435\u0434\u0441\u0442\u043e\u044f\u0449\u0438\u0439 \u043f\u043b\u0430\u0442\u0435\u0436":"\u041f\u0440\u0435\u0434\u0441\u0442\u043e\u044f\u0449\u0438\u0439 \u043f\u043b\u0430\u0442\u0435\u0436 (\u0430\u0432\u0430\u043d\u0441)";b=b===""?"":"<br/>("+b+")";return Ext.String.format('<div><div class="paymentType-name">{0}</div> <div class="link rsb-card-details-link show-full-name-tooltip calendar-event-tax-name" fid="{1}" fullName="{2}">{3}</div></div>',e,c.get("fid"),c.get("nameKBK"),c.get("name")+b)}else{if(c.get("common")=="booking"){return Ext.String.format('<div><div class="paymentType-name">{0}</div><div class="link"><a href="#!/onlineBooking">\u043f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435</a></div></div>',c.get("name"))}else{return Ext.String.format('<div><div class="paymentType-name">{0}</div> <div class="link show-full-name-tooltip calendar-event-tax-name default-cursor" fullName="{1}" style="font-size: 2em;">{2}</div></div>',c.get("name"),c.get("nameKBK"),c.get("shortKBK"))}}}},{flex:1,dataIndex:"",renderer:function(c,d,b){return b.get("date")}}]},{xtype:"component",html:"\u041d\u0435\u0442 \u043f\u0440\u0435\u0434\u0441\u0442\u043e\u044f\u0449\u0438\u0445 \u043f\u043b\u0430\u0442\u0435\u0436\u0435\u0439",itemId:"noFutureEvents",componentCls:"taxcalendar-widget-item tax-calendar-events-list no-future-events",hidden:true},{cls:"clear"}]});a.callParent()}},0,["widgettaxcalendar"],["widgettaxcalendar","component","container","box"],{widgettaxcalendar:true,component:true,container:true,box:true},["widget.widgettaxcalendar"],0,[LkIp.view.Index,"TaxCalendarWidget"],0));(Ext.cmd.derive("LkIp.view.Index.RsbWidget",Ext.Container,{cls:"rsb-widget iScroll",initComponent:function(){var a=LkIp.User.isClosedUser();Ext.apply(this,{items:[{xtype:"container",cls:"rsb-mc-container",defaults:{cls:"rsb-mc-block"},items:[{xtype:"container",items:[{xtype:"component",cls:"rsb-title",html:reference.lang.index.rsb.debt},{xtype:"component",itemId:"debt",cls:"collapsed orange-background summ-padding action-block red",tpl:'<span id="debt-summ" class="rsb-summ rsb-clickable-field">{debt}</span><div id="debt-arrow" class="rsb-arrow"></div>',data:{debt:"-"}}]},{xtype:"container",items:[{xtype:"component",cls:"rsb-title",html:reference.lang.index.rsb.overpayment},{xtype:"component",itemId:"overpayment",cls:"collapsed blue-background summ-padding action-block green",tpl:'<span id="overpayment-summ" class="rsb-summ rsb-clickable-field">{overpayment}</span><span id="overpayment-arrow" class="rsb-arrow"></span>',data:{overpayment:"-"}}]},{xtype:"container",items:[{xtype:"component",cls:"rsb-title",html:reference.lang.index.rsb.unexpay},{xtype:"component",itemId:"unexpay",cls:"summ-padding",tpl:'<a href="#!/rsb/unexpay" class="rsb-summ">{unexpay}</a>',data:{unexpay:"-"}}]}]},{xtype:"container",cls:"rsb-cards-container",defaults:{hidden:true,cls:"cards-block"},items:[{xtype:"container",itemId:"debt-cards",layout:{type:"table",columns:1,tableAttrs:{cls:"cards-table"}},defaults:{xtype:"component"},items:[!a?{html:'<a href="#!/rsb/compliedreqs">'+reference.lang.pages.rsb.compliedreqs.menuTitle+"</a>"}:{cls:"display-none"},!a?{html:'<a href="#!/rsb/pvz/money">'+reference.lang.pages.rsb.pvzMoney.menuTitle+"</a>"}:{cls:"display-none"},!a?{html:'<a href="#!/rsb/pvz/property">'+reference.lang.pages.rsb.pvzProperty.menuTitle+"</a>"}:{cls:"display-none"},!a?{html:'<a href="#!/rsb/debit/decisions">'+reference.lang.pages.rsb.debitDecisions.title+"</a>"}:{cls:"display-none"},!a?{html:'<a href="#!/rsb/suspended/decisions">'+reference.lang.pages.rsb.suspendedDecisions.menuTitle+"</a>"}:{cls:"display-none"}]},{xtype:"container",itemId:"overpayment-cards",layout:{type:"table",columns:1,tableAttrs:{cls:"cards-table"}},defaults:{xtype:"component"},items:[!a?{html:'<a href="#!/rsb/overpayment/decisions">'+reference.lang.pages.rsb.overpaymentDecisions.menuTitle+"</a>"}:{cls:"display-none"},{html:'<a href="#!/overpayment/statuses">'+reference.lang.pages.rsb.overpayment.status.title+"</a>"}]}]},{xtype:"container",cls:"rsb-cards",items:[{xtype:"component",hidden:true,cls:"rsb-wait-info-text",itemId:"rsb-wait-info-text",html:reference.lang.dataWaiting},{xtype:"container",itemId:"rsb-widget-cards",cls:"rsb-cards-items",items:[]}]},{xtype:"container",cls:"rsb-links-block",defaults:{xtype:"component",cls:"rsb-cards-link"},items:[{componentCls:"fl-r",html:'<a class="more-orange" href="#!/rsb/cards">\u0412\u0441\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u0441\u0442\u0432\u0430</a>'},{componentCls:"fl-l choose-tax-mode",style:{width:"70%"},xtype:"container",defaults:{xls:"rsb-cards-link",xtype:"component"},items:[{html:'<a href="#!/rsb/reconciliation">\u0421\u0432\u0435\u0440\u043a\u0438 \u0441 \u0431\u044e\u0434\u0436\u0435\u0442\u043e\u043c</a>'},{html:'<a href="#!/knp">\u041a\u0430\u043c\u0435\u0440\u0430\u043b\u044c\u043d\u044b\u0435 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438</a>'}]}]}]});this.callParent()}},0,["rsbWidget"],["component","rsbWidget","container","box"],{component:true,rsbWidget:true,container:true,box:true},["widget.rsbWidget"],0,[LkIp.view.Index,"RsbWidget"],0));(Ext.cmd.derive("LkIp.view.Index.TaxModeWidget",Ext.Container,{cls:"tax-mode-widget iScroll",tooltips:{envd:reference.lang.index.tax.tooltips.envd,psn:reference.lang.index.tax.tooltips.psn,usn:reference.lang.index.tax.tooltips.usn,eshn:reference.lang.index.tax.tooltips.eshn},tabs:{orn:{title:'<span class="show-full-name-tooltip" fullName="'+reference.lang.index.tax.orn.fullName+'">'+reference.lang.index.tax.orn.name+"</span>",itemId:"orn-tab",type:"tab",componentCls:"tax-tab-item",items:[{xtype:"component",cls:"mode-description",itemId:"mode-description-short",html:reference.lang.index.tax.orn.description},{xtype:"container",cls:"mode-description",itemId:"mode-description",hidden:true,defaults:{cls:"table-container"},items:[{xtype:"component",width:"47%",html:reference.lang.index.tax.orn.info},{xtype:"component",width:"52%",html:reference.lang.index.tax.orn.moreInfo},{xtype:"component",cls:"clear right",html:'<span class="link toggle-more-link">'+reference.lang.index.tax.hideMoreInfo+"</span>"}]}]},envd:{title:'<span class="show-full-name-tooltip" fullName="'+reference.lang.index.tax.envdBlock.fullName+'">'+reference.lang.index.tax.envdBlock.name+"</span>",itemId:"envd-tab",type:"tab",componentCls:"tax-tab-item",items:[{xtype:"container",margin:"0 0 10",defaults:{padding:"0 10"},cls:"mode-info",items:[{xtype:"component",margin:"10 0 0 0",html:reference.lang.index.tax.envdBlock.rate+' <span class="bold-text">15%</span>'},{xtype:"component",itemId:"tooltip",cls:"with-blue-exclamation-icon",html:reference.lang.index.tax.envdBlock.objects},{xtype:"component",itemId:"info-table",padding:0,margin:"10 -10 0 -10",tpl:"<table><tr><td>"+reference.lang.index.tax.envdBlock.activity+"</td><td>"+reference.lang.index.tax.envdBlock.start+"</td><td>"+reference.lang.index.tax.envdBlock.no+'</td></tr><tpl for="."><tr><td class="bold-text">{[ values["@KodVidD"] ]} - {naimDeyat}</td><td class="bold-text">{[ LkIp.Utils.getDate(values["@DataNach"]) ]}</td><td class="bold-text">{[ LkIp.Utils.noRenderer(values["@KodNalOrg"]) ]}</td></tr></tpl></table>'}]},{xtype:"component",cls:"mode-description",margin:"0 2",itemId:"mode-description-short",html:'<span class="link toggle-more-link fl-l">'+reference.lang.index.tax.showMoreInfo+"</span>"},{xtype:"container",cls:"mode-description",itemId:"mode-description",hidden:true,defaults:{cls:"table-container"},items:[{xtype:"component",width:"47%",html:reference.lang.index.tax.envdBlock.info},{xtype:"component",width:"52%",html:reference.lang.index.tax.envdBlock.moreInfo},{xtype:"component",cls:"clear right",html:'<span class="link toggle-more-link">\u0421\u043a\u0440\u044b\u0442\u044c</span>'}]}]},psn:{title:'<span class="show-full-name-tooltip" fullName="\u041f\u0430\u0442\u0435\u043d\u0442\u043d\u0430\u044f \u0441\u0438\u0441\u0442\u0435\u043c\u0430 \u043d\u0430\u043b\u043e\u0433\u043e\u043e\u0431\u043b\u043e\u0436\u0435\u043d\u0438\u044f">\u041f\u0421\u041d</span>',itemId:"psn-tab",type:"tab",componentCls:"tax-tab-item",items:[{xtype:"container",margin:"0 0 10",cls:"mode-info",defaults:{padding:"0 10"},items:[{xtype:"component",margin:"10 0 0 0",html:'\u0421\u0442\u0430\u0432\u043a\u0430: <span class="bold-text">6%</span>'},{xtype:"component",itemId:"tooltip",cls:"with-blue-exclamation-icon",html:'\u041e\u0431\u044a\u0435\u043a\u0442 \u043d\u0430\u043b\u043e\u0433\u043e\u043e\u0431\u043b\u043e\u0436\u0435\u043d\u0438\u044f: <span class="bold-text">\u041f\u043e\u0442\u0435\u043d\u0446\u0438\u0430\u043b\u044c\u043d\u043e \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u044b\u0439 <br/>\u0434\u043e\u0445\u043e\u0434</span>'},{xtype:"component",padding:"0",itemId:"info-table",margin:"10 -10 0 -10",tpl:'<table><tr><td>\u0412\u0438\u0434 \u0434\u0435\u044f\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u0438</td><td>\u0414\u0430\u0442\u0430 \u043d\u0430\u0447\u0430\u043b\u0430 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f</td><td>\u041f\u0435\u0440\u0438\u043e\u0434 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u043f\u0430\u0442\u0435\u043d\u0442\u0430, \u043c\u0435\u0441\u044f\u0446\u0435\u0432</td><td>\u041a\u043e\u0434 \u041d\u041e</td></tr><tpl for="."><tr><td class="bold-text">{[ values["@KodVidD"] ]} - {naimDeyat}</td><td class="bold-text">{[ LkIp.Utils.getDate(values["@DataNach"]) ]}</td><td class="bold-text">{[ values["@Period"] ]}</td><td class="bold-text">{[ LkIp.Utils.noRenderer(values["@KodNalOrg"]) ]}</td></tr></tpl></table>'}]},{xtype:"component",cls:"mode-description",itemId:"mode-description-short",html:'<span class="link toggle-more-link fl-l">'+reference.lang.index.tax.showMoreInfo+"</span>"},{xtype:"container",cls:"mode-description",itemId:"mode-description",hidden:true,defaults:{cls:"table-container"},items:[{xtype:"component",width:"47%",html:'<table class="mode-criteria"><tr><th>\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u043f\u0430\u0442\u0435\u043d\u0442\u043d\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u0435 \u043d\u0430\u043b\u043e\u0433\u043e\u043e\u0431\u043b\u043e\u0436\u0435\u043d\u0438\u044f:</th></tr><tr><td>\u041f\u0435\u0440\u0435\u0447\u0435\u043d\u044c \u0432\u0438\u0434\u043e\u0432 \u043f\u0440\u0435\u0434\u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u043e\u0439 \u0434\u0435\u044f\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u0438, \u043f\u043e\u0434\u043b\u0435\u0436\u0430\u0449\u0438\u0445 \u043d\u0430\u043b\u043e\u0433\u043e\u043e\u0431\u043b\u043e\u0436\u0435\u043d\u0438\u044e \u0432 \u0440\u0430\u043c\u043a\u0430\u0445 \u041f\u0421\u041d, \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d</td></tr><tr><td>\u0418\u043d\u0434\u0438\u0432\u0438\u0434\u0443\u0430\u043b\u044c\u043d\u044b\u0439 \u043f\u0440\u0435\u0434\u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u0435\u043b\u044c \u043d\u0430 \u043f\u0430\u0442\u0435\u043d\u0442\u043d\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u0435 \u043d\u0430\u043b\u043e\u0433\u043e\u043e\u0431\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u043e\u0431\u044f\u0437\u0430\u043d \u0432\u0435\u0441\u0442\u0438 \u041a\u043d\u0438\u0433\u0443 \u0443\u0447\u0435\u0442\u0430 \u0434\u043e\u0445\u043e\u0434\u043e\u0432</td></tr></table>'},{xtype:"component",width:"52%",html:'<table class="mode-tax"><tr><th>3 \u043d\u0430\u043b\u043e\u0433\u0430, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0437\u0430\u043c\u0435\u043d\u044f\u0435\u0442 \u041f\u0421\u041d:</th></tr><tr><td>\u041d\u0414\u0424\u041b (\u0432 \u0447\u0430\u0441\u0442\u0438 \u0434\u043e\u0445\u043e\u0434\u043e\u0432, \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u043d\u044b\u0445 \u043f\u0440\u0438 \u043e\u0441\u0443\u0449\u0435\u0441\u0442\u0432\u043b\u0435\u043d\u0438\u0438 \u0432\u0438\u0434\u043e\u0432 \u043f\u0440\u0435\u0434\u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u043e\u0439 \u0434\u0435\u044f\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u0438, \u0432 \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u0438 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u043f\u0440\u0438\u043c\u0435\u043d\u044f\u0435\u0442\u0441\u044f \u041f\u0421\u041d)</td></tr><tr><td>\u041d\u0430\u043b\u043e\u0433 \u043d\u0430 \u0438\u043c\u0443\u0449\u0435\u0441\u0442\u0432\u043e \u0444\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u0438\u0445 \u043b\u0438\u0446, \u0432 \u0447\u0430\u0441\u0442\u0438 \u0438\u043c\u0443\u0449\u0435\u0441\u0442\u0432\u0430, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u043e\u0433\u043e \u043f\u0440\u0438 \u043e\u0441\u0443\u0449\u0435\u0441\u0442\u0432\u043b\u0435\u043d\u0438\u0438 \u0432\u0438\u0434\u043e\u0432 \u043f\u0440\u0435\u0434\u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u043e\u0439 \u0434\u0435\u044f\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u0438, \u0432 \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u0438 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u043f\u0440\u0438\u043c\u0435\u043d\u044f\u0435\u0442\u0441\u044f \u041f\u0421\u041d, \u0437\u0430 \u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435\u043c \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432, \u0432 \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u0438 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u043d\u0430\u043b\u043e\u0433\u043e\u0432\u0430\u044f \u0431\u0430\u0437\u0430 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442\u0441\u044f \u043a\u0430\u043a \u043a\u0430\u0434\u0430\u0441\u0442\u0440\u043e\u0432\u0430\u044f \u0441\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c \u0432 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u0438 <a href="http://nalog.garant.ru/fns/nk/50/#block_378" target="_blank">\u0441\u043e \u0441\u0442\u0430\u0442\u044c\u0435\u0439 378.2. \u041a\u043e\u0434\u0435\u043a\u0441\u0430</a></td></tr><tr><td>\u041d\u0430\u043b\u043e\u0433 \u043d\u0430 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043d\u0443\u044e \u0441\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c</td></tr></table>'},{xtype:"component",cls:"clear right",html:'<span class="link toggle-more-link">\u0421\u043a\u0440\u044b\u0442\u044c</span>'}]}]},usn:{title:'<span class="show-full-name-tooltip" fullName="\u0423\u043f\u0440\u043e\u0449\u0435\u043d\u043d\u0430\u044f \u0441\u0438\u0441\u0442\u0435\u043c\u0430 \u043d\u0430\u043b\u043e\u0433\u043e\u043e\u0431\u043b\u043e\u0436\u0435\u043d\u0438\u044f">\u0423\u0421\u041d</span>',itemId:"usn-tab",type:"tab",componentCls:"tax-tab-item",items:[{xtype:"container",margin:"0 0 10",cls:"mode-info",defaults:{padding:"0 10"},items:[{xtype:"component",itemId:"tooltip",margin:"10 0 0 0",cls:"with-blue-exclamation-icon",tpl:'\u0421\u0442\u0430\u0432\u043a\u0430: <span class="bold-text">{rate}</span>'},{xtype:"component",itemId:"typeObject",tpl:'\u041e\u0431\u044a\u0435\u043a\u0442 \u043d\u0430\u043b\u043e\u0433\u043e\u043e\u0431\u043b\u043e\u0436\u0435\u043d\u0438\u044f: <span class="bold-text">{taxObject}</span>'},{xtype:"component",padding:"0",itemId:"info-table",margin:"10 0 0",tpl:'<table><tr><td>\u041d\u043e\u043c\u0435\u0440 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f \u043e \u043f\u0435\u0440\u0435\u0445\u043e\u0434\u0435</td><td>\u0414\u0430\u0442\u0430 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f \u043e \u043f\u0435\u0440\u0435\u0445\u043e\u0434\u0435</td><td>\u041a\u043e\u0434 \u041d\u041e</td></tr><tpl for="."><tr><td class="bold-text">{[ values["@NomerDok"] ]}</td><td class="bold-text">{[ LkIp.Utils.getDate(values["@DataDok"]) ]}</td><td class="bold-text">{[ LkIp.Utils.noRenderer(values["@KodNalOrg"]) ]}</td></tr></tpl></table>'}]},{xtype:"component",cls:"mode-description",itemId:"mode-description-short",html:'<span class="link toggle-more-link fl-l">\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435</span>'},{xtype:"container",cls:"mode-description",itemId:"mode-description",hidden:true,defaults:{cls:"table-container"},items:[{xtype:"component",width:"47%",html:'<table class="mode-criteria"><tr><th>3 \u043e\u0441\u043d\u043e\u0432\u043d\u044b\u0445 \u0443\u0441\u043b\u043e\u0432\u0438\u044f \u043f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0423\u0421\u041d:</th></tr><tr><td><i>\u0423\u0440\u043e\u0432\u0435\u043d\u044c \u0434\u043e\u0445\u043e\u0434\u0430</i><p>\u043d\u0435 \u0431\u043e\u043b\u0435\u0435 150 \u043c\u043b\u043d. \u0440\u0443\u0431\u043b\u0435\u0439 \u0432 \u0433\u043e\u0434</p></td></tr><tr><td><i>\u0421\u0440\u0435\u0434\u043d\u044f\u044f \u0447\u0438\u0441\u043b\u0435\u043d\u043d\u043e\u0441\u0442\u044c \u0440\u0430\u0431\u043e\u0442\u043d\u0438\u043a\u043e\u0432</i><p>\u043d\u0435 \u0431\u043e\u043b\u0435\u0435 100 \u0447\u0435\u043b\u043e\u0432\u0435\u043a</p></td></tr><tr><td><i>\u041e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u0430\u044f \u0441\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c \u043e\u0441\u043d\u043e\u0432\u043d\u044b\u0445 \u0441\u0440\u0435\u0434\u0441\u0442\u0432</i><p>\u043d\u0435 \u0431\u043e\u043b\u0435\u0435 150 \u043c\u043b\u043d. \u0440\u0443\u0431\u043b\u0435\u0439</p></td></tr></table>'},{xtype:"component",width:"52%",html:'<table class="mode-tax"><tr><th>3 \u043d\u0430\u043b\u043e\u0433\u0430, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0437\u0430\u043c\u0435\u043d\u044f\u0435\u0442 \u0423\u0421\u041d:</th></tr><tr><td>\u041d\u0414\u0424\u041b (\u0432 \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u0438 \u0434\u043e\u0445\u043e\u0434\u043e\u0432 \u043e\u0442 \u043f\u0440\u0435\u0434\u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u043e\u0439 \u0434\u0435\u044f\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u0438 \u043e\u0431\u043b\u0430\u0433\u0430\u0435\u043c\u043e\u0439 \u0423\u0421\u041d)</td></tr><tr><td>\u041d\u0430\u043b\u043e\u0433 \u043d\u0430 \u0438\u043c\u0443\u0449\u0435\u0441\u0442\u0432\u043e \u0444\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u0438\u0445 \u043b\u0438\u0446</td></tr><tr><td>\u041d\u0430\u043b\u043e\u0433 \u043d\u0430 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043d\u0443\u044e \u0441\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c</td></tr></table>'},{xtype:"component",cls:"clear right",html:'<span class="link toggle-more-link">\u0421\u043a\u0440\u044b\u0442\u044c</span>'}]}]},eshn:{title:'<span class="show-full-name-tooltip" fullName="\u0415\u0434\u0438\u043d\u044b\u0439 \u0441\u0435\u043b\u044c\u0441\u043a\u043e\u0445\u043e\u0437\u044f\u0439\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0439 \u043d\u0430\u043b\u043e\u0433">\u0415\u0421\u0425\u041d</span>',itemId:"eshn-tab",type:"tab",componentCls:"tax-tab-item",items:[{xtype:"container",margin:"0 0 10",cls:"mode-info",defaults:{padding:"0 10"},items:[{xtype:"component",itemId:"rate",html:'\u0421\u0442\u0430\u0432\u043a\u0430: <span class="bold-text">6%</span>'},{xtype:"component",itemId:"tooltip",cls:"with-blue-exclamation-icon",html:'\u041e\u0431\u044a\u0435\u043a\u0442 \u043d\u0430\u043b\u043e\u0433\u043e\u043e\u0431\u043b\u043e\u0436\u0435\u043d\u0438\u044f: <span class="bold-text">\u0414\u043e\u0445\u043e\u0434\u044b, \u0443\u043c\u0435\u043d\u044c\u0448\u0435\u043d\u043d\u044b\u0435 \u043d\u0430 \u0432\u0435\u043b\u0438\u0447\u0438\u043d\u0443 \u0440\u0430\u0441\u0445\u043e\u0434\u043e\u0432</span>'},{xtype:"component",padding:"0",itemId:"info-table",margin:"10 0 0",tpl:'<table><tr><td>\u041d\u043e\u043c\u0435\u0440 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f \u043e \u043f\u0435\u0440\u0435\u0445\u043e\u0434\u0435</td><td>\u0414\u0430\u0442\u0430 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f \u043e \u043f\u0435\u0440\u0435\u0445\u043e\u0434\u0435</td><td>\u0414\u0430\u0442\u0430 \u043d\u0430\u0447\u0430\u043b\u0430 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f</td><td>\u041a\u043e\u0434 \u041d\u041e</td></tr><tpl for="."><tr><td class="bold-text">{[ values["@NomerDok"] ]}</td><td class="bold-text">{[ LkIp.Utils.getDate(values["@DataDok"]) ]}</td><td class="bold-text">{[ LkIp.Utils.getDate(values["@DataNach"]) ]}</td><td class="bold-text">{[ LkIp.Utils.noRenderer(values["@KodNalOrg"]) ]}</td></tr></tpl></table>'}]},{xtype:"component",cls:"mode-description",itemId:"mode-description-short",html:'<span class="link toggle-more-link fl-l">\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435</span>'},{xtype:"container",cls:"mode-description",itemId:"mode-description",hidden:true,defaults:{cls:"table-container"},items:[{xtype:"component",width:"47%",html:'<table class="mode-criteria"><tr><th>\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u0441\u0438\u0441\u0442\u0435\u043c\u0435 \u043d\u0430\u043b\u043e\u0433\u043e\u043e\u0431\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0434\u043b\u044f \u0441\u0435\u043b\u044c\u0441\u043a\u043e\u0445\u043e\u0437\u044f\u0439\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0445 \u0442\u043e\u0432\u0430\u0440\u043e\u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u0435\u0439:</th></tr><tr><td>\u0414\u043e\u0445\u043e\u0434 \u043e\u0442 \u0441\u0435\u043b\u044c\u0441\u043a\u043e\u0445\u043e\u0437\u044f\u0439\u0441\u0442\u0432\u0435\u043d\u043d\u043e\u0439 \u0434\u0435\u044f\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u0438 \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u0431\u043e\u043b\u0435\u0435 70%</td></tr><tr><td>\u0418\u043d\u0434\u0438\u0432\u0438\u0434\u0443\u0430\u043b\u044c\u043d\u044b\u0435 \u043f\u0440\u0435\u0434\u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u0435\u043b\u0438, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043d\u0435 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u044f\u0442 \u0441\u0435\u043b\u044c\u0445\u043e\u0437\u043f\u0440\u043e\u0434\u0443\u043a\u0446\u0438\u044e, \u0430 \u0442\u043e\u043b\u044c\u043a\u043e \u043e\u0441\u0443\u0449\u0435\u0441\u0442\u0432\u043b\u044f\u044e\u0442 \u0435\u0435 \u043f\u0435\u0440\u0432\u0438\u0447\u043d\u0443\u044e \u0438\u043b\u0438 \u043f\u043e\u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0443\u044e (\u043f\u0440\u043e\u043c\u044b\u0448\u043b\u0435\u043d\u043d\u0443\u044e) \u043f\u0435\u0440\u0435\u0440\u0430\u0431\u043e\u0442\u043a\u0443, \u043d\u0435 \u0432\u043f\u0440\u0430\u0432\u0435 \u043f\u0440\u0438\u043c\u0435\u043d\u044f\u0442\u044c \u0415\u0421\u0425\u041d</td></tr></table>'},{xtype:"component",width:"52%",html:'<table class="mode-tax"><tr><th>3 \u043d\u0430\u043b\u043e\u0433\u0430, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0437\u0430\u043c\u0435\u043d\u044f\u0435\u0442 \u0415\u0421\u0425\u041d:</th></tr><tr><td>\u041d\u0414\u0424\u041b (\u0432 \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u0438 \u0434\u043e\u0445\u043e\u0434\u043e\u0432 \u043e\u0442 \u043f\u0440\u0435\u0434\u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u043e\u0439 \u0434\u0435\u044f\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u0438)</td></tr><tr><td>\u041d\u0430 \u0438\u043c\u0443\u0449\u0435\u0441\u0442\u0432\u043e \u0444\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u0438\u0445 \u043b\u0438\u0446</td></tr><tr><td>\u041d\u0430 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043d\u0443\u044e \u0441\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c</td></tr></table>'},{xtype:"component",cls:"clear right",html:'<span class="link toggle-more-link">\u0421\u043a\u0440\u044b\u0442\u044c</span>'}]}]}},initComponent:function(){Ext.apply(this,{items:[{xtype:"tabpanel",cls:"tabs-block tabs-block-border-bottom",itemId:"tabs-block",plain:true,layout:"fit",bodyCls:"tabsContent",items:[]},{xtype:"component",itemId:"no-tax-mode",html:reference.lang.index.tax.empty},{xtype:"component",hidden:true,cls:"rsb-wait-info-text",itemId:"tax-info-text",html:"-"},{xtype:"container",cls:"left-block links-block",margin:"-15 0 0 0",style:{overflow:"auto",paddingBottom:"15px"},defaults:{xtype:"component",cls:"cards-link"},items:[{hidden:!LkIp.User.isActiveUser(),style:{paddingRight:"15px"},html:'<a id="taxSystemStatement" class="all-services more-orange">'+reference.lang.index.tax.statement+"</a>"},{componentCls:"choose-tax-mode",style:{marginTop:"-10px"},hidden:!LkIp.User.isActiveUser(),html:'<a href="'+(LkIp.User.isActiveUser()?"#!/calculator":"")+'">'+reference.lang.index.tax.chooseAnotherSystem+"</a>"}]}]});this.callParent()},addTab:function(c,e){var d=this,a=d.down("#no-tax-mode"),b;if(!a.isHidden()){a.hide()}d.down("#tabs-block").add(d.tabs[c]);if("orn"===c){return true}b=d.down("#"+c+"-tab");if(!Ext.isEmpty(b)){b.down("#info-table").update(e);if("usn"==c){b.down("#tooltip").update({rate:e["@rate"]});b.down("#typeObject").update({taxObject:e["@ObNal"]})}}},addTabs:function(a){var b=this;Ext.suspendLayouts();Ext.Object.each(a,function(c,d){b.addTab(c,d)});Ext.resumeLayouts(true)}},0,["taxModeWidget"],["taxModeWidget","component","container","box"],{taxModeWidget:true,component:true,container:true,box:true},["widget.taxModeWidget"],0,[LkIp.view.Index,"TaxModeWidget"],0));(Ext.cmd.derive("LkIp.view.Index.ProfileWidget",Ext.Container,{layout:{type:"auto"},cls:"profile-widget",initComponent:function(){this.callParent()}},0,["widgetprofile"],["component","container","box","widgetprofile"],{component:true,container:true,box:true,widgetprofile:true},["widget.widgetprofile"],0,[LkIp.view.Index,"ProfileWidget"],0));(Ext.cmd.derive("LkIp.view.Index.MailWidget",Ext.Container,{layout:{type:"auto"},cls:"profile-widget",initComponent:function(){Ext.apply(this,{defaults:{xtype:"container",componentCls:"profile-widget-block",defaults:{xtype:"component"}},items:[{items:[{xtype:"container",layout:{type:"auto"},defaults:{xtype:"component"},items:[(!LkIp.User.isEcrInspector()?{html:'<div class="profile-mail div-more sm"><div class="profile-mail-item profile-mail-icon-send"></div><div class="profile-mail-item profile-mail-text"><a href="#!/statement/list">\u041e\u0431\u0440\u0430\u0442\u0438\u0442\u044c\u0441\u044f \u0432 \u043d\u0430\u043b\u043e\u0433\u043e\u0432\u044b\u0439 \u043e\u0440\u0433\u0430\u043d</a></div><div class="clear"></div></div>'}:{cls:"display-none"}),{itemId:"countNewAnswers",tpl:'<div class="profile-mail div-more sm"><div class="profile-mail-item profile-mail-icon-get"></div><div class="profile-mail-item profile-mail-text"><a href="#!/docflow/list">\u041f\u043e\u043b\u0443\u0447\u0435\u043d\u043e \u0438\u0437 \u043d\u0430\u043b\u043e\u0433\u043e\u0432\u043e\u0433\u043e \u043e\u0440\u0433\u0430\u043d\u0430</a></div><tpl if="count &gt; 0"> <span class="circle orange absolute">{count}</span></tpl><div class="clear"></div></div><div class="profile-mail div-more sm"><div class="profile-mail-item profile-mail-icon-get"></div><div class="profile-mail-item profile-mail-text"><a href="#!/docflow/notice">\u0423\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f \u043e\u0442 \u043d\u0430\u043b\u043e\u0433\u043e\u0432\u043e\u0433\u043e \u043e\u0440\u0433\u0430\u043d\u0430:</a><div>\u0412\u0441\u0435\u0433\u043e \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u0439 {noticeCount} / \u0438\u0437 \u043d\u0438\u0445 \u043d\u0435 \u043f\u0440\u043e\u0447\u0438\u0442\u0430\u043d\u043d\u044b\u0445</div></div><span class="circle orange absolute" style="bottom:30px;">{noticeNewCount}</span><div class="clear"></div></div>',data:{count:"0",noticeCount:"0",noticeNewCount:"0"}}]}]}]});this.callParent()}},0,["widgetmail"],["widgetmail","component","container","box"],{widgetmail:true,component:true,container:true,box:true},["widget.widgetmail"],0,[LkIp.view.Index,"MailWidget"],0));(Ext.cmd.derive("LkIp.view.Index.IWantWidget",Ext.Container,{layout:{type:"auto"},cls:"i-want-widget",initComponent:function(){var a=[];a.push({html:'<div class="print-blue-40-icon block-with-icon" style="padding-top: 10px;"><a href="#!/egrip/request" class="i-want-address-no">'+reference.lang.profile.links.egripRequest+"</a></div>"},{html:'<div class="okpaper-blue-40-icon block-with-icon"><a href="#!/information/service/obligation" class=" i-want-egrip-request">'+reference.lang.pages.informationService.obligation.titleForServiceList+"</a></div>"},{html:'<div class="marker-blue-40-icon block-with-icon"><a href="#!/information/service/paymentsStatus" class="i-want-order">'+reference.lang.pages.informationService.paymentsStatus.titleForServiceList+"</a></div>"});a.push({html:'<a href="#!/services/list" class="all-services more-orange">'+reference.lang.pages.allServices+"</a>"});Ext.apply(this,{defaults:{xtype:"container",layout:{type:"auto"},defaults:{xtype:"component",margin:"0"}},items:[{items:a}]});this.callParent()}},0,["widgetIWant"],["component","container","box","widgetIWant"],{component:true,container:true,box:true,widgetIWant:true},["widget.widgetIWant"],0,[LkIp.view.Index,"IWantWidget"],0));(Ext.cmd.derive("LkIp.view.Index.KktWidget",Ext.Container,{layout:{type:"auto"},cls:"kkt-widget",initComponent:function(){Ext.apply(this,{items:[{xtype:"container",padding:15,items:[{xtype:"component",itemId:"emptyKktList",html:'<div class="div-more sm text-center"><p>'+reference.lang.kkt.emptyKktWidget+"</p><p>"+reference.lang.kkt.regLinkWidget+"</p></div>"},{xtype:"component",itemId:"kktInstance",hidden:true,tpl:'<div class="div-more sm"><p class="bold">{address}</p><p>'+reference.lang.kkt.modelWidget+": {model}, "+reference.lang.kkt.factoryCodeWidget+": {factory_code}, "+reference.lang.kkt.rnmWidget+': {rnm}</p><div style="float: left; margin-top: 2px;">{table}</div><div style="margin-left: 45px;">'+reference.lang.kkt.stateWidget+": {status_name}</div></div>",data:{address:"-",model:"-",factory_code:"-",rnm:"-",cls:"",status_name:"-"}},{xtype:"component",html:'<a href="#!/kkt" class="all-services more-orange">'+reference.lang.kkt.allKkt+"</a>"}]}]});this.callParent()}},0,["widgetKkt"],["component","container","box","widgetKkt"],{component:true,container:true,box:true,widgetKkt:true},["widget.widgetKkt"],0,[LkIp.view.Index,"KktWidget"],0));(Ext.cmd.derive("LkIp.view.Index.MarkirovkaWidget",Ext.Container,{layout:{type:"auto"},cls:"i-want-widget",initComponent:function(){var a=[];Ext.apply(this,{defaults:{xtype:"container",layout:{type:"auto"},defaults:{xtype:"component",margin:"0"}},items:[{items:[{html:'<div class="markirovka-blue-icon block-with-icon" style="padding-top: 15px;"><a class="i-want-address-no markirovkaLink">'+reference.lang.profile.links.markirovka+"</a></div>"}]}]});this.callParent()}},0,["widgetMarkirovka"],["widgetMarkirovka","component","container","box"],{widgetMarkirovka:true,component:true,container:true,box:true},["widget.widgetMarkirovka"],0,[LkIp.view.Index,"MarkirovkaWidget"],0));(Ext.cmd.derive("LkIp.view.Index.SmpWidget",Ext.Container,{layout:{type:"auto"},cls:"i-want-widget",initComponent:function(){var a=[];Ext.apply(this,{defaults:{xtype:"container",layout:{type:"auto"},defaults:{xtype:"component",margin:"0"}},items:[{items:[{html:'<div class="smp-blue-icon block-with-icon" style="padding-top: 15px;"><a class="i-want-address-no smpLink">'+reference.lang.profile.links.smp+"</a></div>"}]}]});this.callParent()}},0,["widgetSmp"],["widgetSmp","component","container","box"],{widgetSmp:true,component:true,container:true,box:true},["widget.widgetSmp"],0,[LkIp.view.Index,"SmpWidget"],0));(Ext.cmd.derive("LkIp.view.Index.Index",Ext.Container,{cls:"index iScroll",defaultOrder:[{"widget-profile":{},"widget-mail":{},"widget-iwant":{},"widget-markirovka":{},"widget-smp":{},"widget-tax-calendar":{}},{"widget-kkt":{},"widget-rsb":{},"widget-tax-system":{}}],elements:{"widget-profile":{title:'<a href="#!/profile">\u041c\u043e\u0439 \u043f\u0440\u043e\u0444\u0438\u043b\u044c</a>',id:"widget-profile",items:{xtype:"widgetprofile"},componentCls:"blue-back-header hidden-panel-body",height:46},"widget-iwant":{title:"\u0421\u0435\u0440\u0432\u0438\u0441\u044b",id:"widget-iwant",items:{xtype:"widgetIWant"},componentCls:"blue-back-header hidden-panel-body"},"widget-mail":{title:"\u041c\u043e\u044f \u043f\u043e\u0447\u0442\u0430",id:"widget-mail",componentCls:"hidden-panel-body",items:{xtype:"widgetmail"}},"widget-tax-system":{title:"\u041c\u043e\u044f \u0441\u0438\u0441\u0442\u0435\u043c\u0430 \u043d\u0430\u043b\u043e\u0433\u043e\u043e\u0431\u043b\u043e\u0436\u0435\u043d\u0438\u044f",id:"widget-tax-system",componentCls:"hidden-panel-body",items:{xtype:"taxModeWidget"}},"widget-tax-calendar":{title:"\u041c\u043e\u0439 \u043d\u0430\u043b\u043e\u0433\u043e\u0432\u044b\u0439 \u043a\u0430\u043b\u0435\u043d\u0434\u0430\u0440\u044c",id:"widget-tax-calendar",componentCls:"hidden-panel-body",items:{xtype:"widgettaxcalendar"}},"widget-rsb":{title:"\u041c\u043e\u0438 \u043d\u0430\u043b\u043e\u0433\u0438, \u0441\u0442\u0440\u0430\u0445\u043e\u0432\u044b\u0435 \u0432\u0437\u043d\u043e\u0441\u044b",id:"widget-rsb",componentCls:"hidden-panel-body",items:{xtype:"rsbWidget"}},"widget-kkt":{title:"\u041c\u043e\u0438 \u043a\u0430\u0441\u0441\u044b",id:"widget-kkt",componentCls:"hidden-panel-body",items:{xtype:"widgetKkt"},available:function(){return LkIp.User.hasKktAccess()}},"widget-markirovka":{title:"\u041c\u0430\u0440\u043a\u0438\u0440\u043e\u0432\u043a\u0430 \u0442\u043e\u0432\u0430\u0440\u043e\u0432",id:"widget-markirovka",items:{xtype:"widgetMarkirovka"}},"widget-smp":{title:"\u0421\u0443\u0431\u044a\u0435\u043a\u0442\u044b \u043c\u0430\u043b\u043e\u0433\u043e \u043f\u0440\u0435\u0434\u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u0435\u043b\u044c\u0441\u0442\u0432\u0430",id:"widget-smp",items:{xtype:"widgetSmp"}}},enableForEcr:["widget-mail","widget-profile"],initComponent:function(){Ext.apply(this,{items:[{xtype:"container",itemId:"debt-write-off",hidden:true,cls:"success__block closable",margin:"0 0 30 0",items:[{xtype:"component",html:'<div class="message__block-close close-debt-write-off"><div class="message__block-close-icon"></div></div><div>\u0412 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u0438 \u0441 \u043d\u0430\u043b\u043e\u0433\u043e\u0432\u043e\u0439 \u0430\u043c\u043d\u0438\u0441\u0442\u0438\u0435\u0439 2018 \u0433\u043e\u0434\u0430 \u0412\u0430\u043c \u043f\u0440\u043e\u0438\u0437\u0432\u0435\u0434\u0435\u043d\u043e \u0441\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043d\u0430\u043b\u043e\u0433\u043e\u0432\u043e\u0439 \u0437\u0430\u0434\u043e\u043b\u0436\u0435\u043d\u043d\u043e\u0441\u0442\u0438. \u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435 \u0441 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0435\u0439 \u043e \u043d\u0430\u043b\u043e\u0433\u043e\u0432\u043e\u0439 \u0430\u043c\u043d\u0438\u0441\u0442\u0438\u0438 2018 \u0412\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u043e\u0437\u043d\u0430\u043a\u043e\u043c\u0438\u0442\u044c\u0441\u044f \u043d\u0430 <a href="https://www.nalog.ru/" target="_blank">\u0441\u0430\u0439\u0442\u0435 \u0424\u041d\u0421 \u0420\u043e\u0441\u0441\u0438\u0438</a>.</div>'},{xtype:"checkboxfield",margin:"10 0 0 0",boxLabel:"\u0411\u043e\u043b\u044c\u0448\u0435 \u043d\u0435 \u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c",itemId:"close-write-off-forever-checkbox"}]},{xtype:"component",itemId:"info-block",cls:"success__block",html:'<div class="message__block-header">\u0423\u0432\u0430\u0436\u0430\u0435\u043c\u044b\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0438!</div><div class="message__block-close close-index-info-block"></div><div>\u0414\u043b\u044f \u0440\u0430\u0431\u043e\u0442\u043e\u0434\u0430\u0442\u0435\u043b\u0435\u0439 \u043f\u043e\u044f\u0432\u0438\u043b\u0430\u0441\u044c \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c <a href="#!/employees/identification">\u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u0424\u0418\u041e, \u0418\u041d\u041d \u0438 \u0421\u041d\u0418\u041b\u0421 \u0440\u0430\u0431\u043e\u0442\u043d\u0438\u043a\u043e\u0432</a> \u0434\u043b\u044f \u0446\u0435\u043b\u0435\u0439 \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0440\u0430\u0441\u0447\u0435\u0442\u043e\u0432 \u043f\u043e \u0441\u0442\u0440\u0430\u0445\u043e\u0432\u044b\u043c \u0432\u0437\u043d\u043e\u0441\u0430\u043c.</div>'},{xtype:"component",margin:"20 0 0 0",html:'<a href="/docs/\u043a\u0430\u043b\u0435\u043d\u0434\u0430\u0440\u044c_3\u043a\u0432\u0430\u0440\u0442\u0430\u043b_\u0418\u041f.pdf" target="_blank" download>\u0421\u043a\u0430\u0447\u0430\u0442\u044c \u0433\u0440\u0430\u0444\u0438\u043a \u043f\u0440\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u044f \u0442\u0435\u0445\u043d\u043e\u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u0438\u0445 \u0440\u0430\u0431\u043e\u0442 \u041b\u0438\u0447\u043d\u043e\u0433\u043e \u043a\u0430\u0431\u0438\u043d\u0435\u0442\u0430 \u0438\u043d\u0434\u0438\u0432\u0438\u0434\u0443\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043f\u0440\u0435\u0434\u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u0435\u043b\u044f (\u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u043e 20.06.2018)</a>'},{xtype:"widgetPanel",items:this.getPanelItems()}]});this.callParent()},getPanelItems:function(){var g=this,a=Ext.JSON.decode(Ext.util.Cookies.get("widget-order")),d=[],c={};if(Ext.isEmpty(a)){a=g.defaultOrder}else{var e=Ext.Object.getKeys(Ext.Object.merge(Ext.clone(a[0]),Ext.clone(a[1]))),f=Ext.Object.getKeys(g.elements);if(e.length!=f.length){var b=Ext.Array.difference(f,e);Ext.Array.each(b,function(l,j){var h=g.getElementPositionInDefaultOrder(l);if(Ext.Object.getSize(a[h.column])>h.insert){var k=Ext.clone(a[h.column]),i=0;a[h.column]={};Ext.Object.each(k,function(m,n){if(i==h.insert){a[h.column][l]={}}a[h.column][m]={};i++})}else{a[h.column][l]={}}})}}Ext.Array.each(a,function(i,h){c={id:0==h?"column-wide":"column-narrow",width:0==h?500:450,items:[]};Ext.Object.each(i,function(j,k){if(!Ext.isEmpty(g.elements[j])&&(!LkIp.User.isEcrInspector()||Ext.Array.contains(g.enableForEcr,j))&&(Ext.isEmpty(g.elements[j].available)||g.elements[j].available()==true)){c.items.push(Ext.apply(g.elements[j],k))}});d.push(c)});return d},getElementPositionInDefaultOrder:function(e){var d=this,c,a,b=0;Ext.Array.each(d.defaultOrder,function(g,f){c=f;b=0;Ext.Object.each(g,function(h,i){if(h==e){a=b;return false}b++});if(!Ext.isEmpty(a)){return false}});return{column:c,insert:a}}},0,["index"],["index","component","container","box"],{index:true,component:true,container:true,box:true},["widget.index"],0,[LkIp.view.Index,"Index"],0));(Ext.cmd.derive("LkIp.view.Default.Note",Ext.Container,{cls:"note",text:"",layout:{type:"auto"},initComponent:function(){Ext.apply(this,{items:[{xtype:"container",cls:"note-icon fl-l"},{xtype:"component",itemId:"note-text",cls:"note-text fl-l",html:this.text}]});this.callParent(arguments)},setText:function(a){this.down("#note-text").update(a)}},0,["note"],["component","container","box","note"],{component:true,container:true,box:true,note:true},["widget.note"],0,[LkIp.view.Default,"Note"],0));(Ext.cmd.derive("LkIp.view.Scrolling",Ext.Base,{onClassMixedIn:function(a){Ext.Function.interceptBefore(a.prototype,"initComponent",this.prototype.initScrolling)},initScrolling:function(){this.scrollContext="index";this.scrollState={};this.on("afterrender",function(){this.getScrollEl().addListener("scroll",this.saveScrollState,this)},this)},setScrollContext:function(a){this.scrollContext=a},eraseScrollContext:function(a){delete this.scrollState[a]},saveScrollState:function(){this.scrollState[this.scrollContext]=this.getScrollTop()},restoreScrollState:function(){this.setScrollTop(this.scrollState[this.scrollContext]||0)},scrollToView:function(a,b){a=Ext.get(a);b=b||{};if(a){this.setScrollTop(this.getScrollTop()+a.getY()+(b.offset||0));this.setScrollLeft(0);if(b.highlight){a.highlight()}}},getScrollTop:function(){return this.getScrollEl().getScroll().top},setScrollTop:function(a){return this.getScrollEl().scrollTo("top",a)},setScrollLeft:function(a){return this.getScrollEl().scrollTo("left",a)},scrollToTop:function(){this.getScrollEl().scrollTo("top")},getScrollEl:function(){return this.body||this.el}},0,0,0,0,0,0,[LkIp.view,"Scrolling"],0));(Ext.cmd.derive("LkIp.view.Egrip.Request.Index",Ext.form.Panel,{rel:"form",layout:"auto",cls:"egriprequest iScroll",defaults:{margin:5},initComponent:function(){Ext.apply(this,{items:[{xtype:"component",html:reference.lang.egrip.request.title},{xtype:"container",layout:{type:"auto"},margin:"20 0 0 0",items:[{xtype:"component",html:LkIp.Utils.header(reference.lang.pages.instruction,3),cls:"fl-l"}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"1",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.egrip.request.step1}]},{xtype:"note",text:reference.lang.egrip.request.disableMailRequest},{xtype:"button",text:reference.lang.buttons.send,rel:"submit",formBind:true,disabled:true,handler:function(){this.fireEvent("submitForm")}},{xtype:"radiogroup",rel:"egrip-request-type",fieldLabel:"",labelSeparator:"",allowBlank:false,columns:1,hidden:true,items:[{boxLabel:reference.lang.egrip.request.type3,componentCls:"radioBtn",name:"requestType",inputValue:"3",checked:true}]},{xtype:"note",text:reference.lang.egrip.request.note,margin:"20 0"}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"2",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.pages.steps.step3},{xtype:"component",html:"<p>"+reference.lang.pages.steps.step3Description+"</p>"},{xtype:"component",html:"<p>"+reference.lang.egrip.request.downloadNote+"</p>"},{xtype:"component",html:"<p>"+reference.lang.egrip.request.openNote+"</p>"},{xtype:"component",html:"<p>"+reference.lang.egrip.request.instructionNote+"</p>"}]}]}]});this.callParent()}},0,["egriprequest"],["panel","form","component","container","egriprequest","box"],{panel:true,form:true,component:true,container:true,egriprequest:true,box:true},["widget.egriprequest"],[[LkIp.view.Scrolling.prototype.mixinId||LkIp.view.Scrolling.$className,LkIp.view.Scrolling]],[LkIp.view.Egrip.Request,"Index"],0));(Ext.cmd.derive("LkIp.view.Default.Filters.Select",Ext.form.field.ComboBox,{tpl:'<tpl for="."><tpl if="code != 0"><li data-qtip="{qtip}" class="x-boundlist-item" role="option">{value}</li></tpl><tpl if="code == 0"><li class="x-boundlist-item" role="option">{value}</li></tpl></tpl>',displayField:"filterValue",valueField:"code",listConfig:{loadingText:reference.lang.loading},editable:true,typeAhead:true,typeAheadDelay:600,minChars:1,maskRe:/[0-9]/,forceSelection:true,queryMode:"local",triggerAction:"all",labelWidth:190,labelAlign:"left",width:600,ttip:undefined,cls:"dropdown-text select-field",padding:"10 0",clearFilterOnBlur:true,listeners:{beforerender:function(a){if(typeof a.lang!="undefined"){this.emptyText=(!Ext.isEmpty(a.emptyText)?a.emptyText:a.lang.empty);this.fieldLabel=!Ext.isEmpty(a.fieldLabel)?a.fieldLabel:a.lang.label}},change:function(b,c){var a=b.getStore().findRecord("code",c);if(undefined!==this.ttip){this.ttip.destroy()}if(!Ext.isEmpty(a)&&0!=c){this.ttip=LkIp.Utils.tooltip(b,a.get("qtip"))}},beforeHide:function(){typeof this.beforeHide!="undefined"&&this.beforeHide(this)},specialkey:function(c,d){if(c.editable){var b=c.getValue(),a;if(d.getKey()===d.BACKSPACE&&!Ext.isNumeric(b)){a=b.length-1;if(a==0){c.reset()}}}}},beforeBlur:function(){var a=this;if(a.queryFilter&&a.queryMode==="local"&&a.clearFilterOnBlur){delete a.queryFilter;a.store.clearFilter(true);a.store.filter()}a.doQueryTask.cancel();a.assertValue()},getValue:function(){if(Ext.isEmpty(this.value)){this.value=0}return this.callParent()}},0,["filterSelect"],["field","trigger","combobox","textfield","pickerfield","filterSelect","component","combo","box","triggerfield"],{field:true,trigger:true,combobox:true,textfield:true,pickerfield:true,filterSelect:true,component:true,combo:true,box:true,triggerfield:true},["widget.filterSelect"],0,[LkIp.view.Default.Filters,"Select"],0));(Ext.cmd.derive("LkIp.view.Default.Filters.SimpleSelect",Ext.form.field.ComboBox,{model:"LkIp.model.SimpleSelect",editable:false,displayField:"name",valueField:"id",store:[],width:360,labelWidth:190,cls:"dropdown-text select-field",disableTooltip:false,listeners:{beforeHide:function(){this.reset()},beforerender:function(a){if(typeof a.lang!="undefined"){this.emptyText="-"+a.lang.empty+"-";this.fieldLabel=a.lang.label}},render:function(a){this.originalWidth=this.getWidth()},change:function(b,d,a){var c=this.getRawValue();if(!this.disableTooltip){Ext.suspendLayouts();if(undefined!==this.ttip){this.ttip.destroy()}this.ttip=LkIp.Utils.tooltip(b,!Ext.isEmpty(c)?c:reference.lang.filters.defaultDateSelect);Ext.resumeLayouts(true)}}}},0,["simpleSelect"],["field","trigger","combobox","textfield","pickerfield","component","combo","box","simpleSelect","triggerfield"],{field:true,trigger:true,combobox:true,textfield:true,pickerfield:true,component:true,combo:true,box:true,simpleSelect:true,triggerfield:true},["widget.simpleSelect"],0,[LkIp.view.Default.Filters,"SimpleSelect"],0));(Ext.cmd.derive("LkIp.view.Default.Filters.DateSelect",LkIp.view.Default.Filters.SimpleSelect,{storeSimple:[["0",reference.lang.filters.dateStore.defaultValue],["1",reference.lang.filters.dateStore.equal],["2",reference.lang.filters.dateStore.more],["3",reference.lang.filters.dateStore.less],["4",reference.lang.filters.dateStore.period]],storeFull:[["0",reference.lang.filters.dateStore.defaultValue],["1",reference.lang.filters.dateStore.week],["2",reference.lang.filters.dateStore.today],["3",reference.lang.filters.dateStore.equal],["4",reference.lang.filters.dateStore.more],["5",reference.lang.filters.dateStore.less],["6",reference.lang.filters.dateStore.period]],storeKkt:[["0",reference.lang.filters.dateStore.defaultValue],["1",reference.lang.filters.dateStore.today],["2",reference.lang.filters.dateStore.week],["3",reference.lang.filters.dateStore.period],["4",reference.lang.filters.dateStore.last]],storeType:"simple",initComponent:function(){if("simple"===this.storeType){this.store=this.storeSimple}else{if("full"===this.storeType){this.store=this.storeFull}else{if("kkt"===this.storeType){this.store=this.storeKkt}}}this.callParent();this.on({change:function(b,d,a){var f=b.ownerCt.down('[name="'+b.name+'_from"]'),e=b.ownerCt.down('[name="'+b.name+'_to"]'),c=this.getRawValue();Ext.suspendLayouts();f.reset();e.reset();if("simple"===this.storeType){switch(parseInt(d)){case 1:case 2:case 3:f.setFieldLabel(undefined);e.setFieldLabel(undefined);f.show();e.hide();this.setWidth(this.shortWidth);break;case 4:f.setFieldLabel(reference.lang.filters.from);e.setFieldLabel(reference.lang.filters.to);f.show();e.show();this.setWidth(this.shortWidth);break;case 0:default:this.setWidth(this.originalWidth);e.hide();f.hide();f.setFieldLabel(undefined);e.setFieldLabel(undefined);b.reset();break}}else{if("full"===this.storeType){switch(parseInt(d)){case 1:case 2:this.setWidth(this.originalWidth);e.hide();f.hide();break;case 3:case 4:case 5:f.setFieldLabel(undefined);e.setFieldLabel(undefined);f.show();e.hide();this.setWidth(this.shortWidth);break;case 6:f.setFieldLabel(reference.lang.filters.from);e.setFieldLabel(reference.lang.filters.to);f.show();e.show();this.setWidth(this.shortWidth);break;case 0:default:this.setWidth(this.originalWidth);e.hide();f.hide();f.setFieldLabel(undefined);e.setFieldLabel(undefined);b.reset();break}}else{if("kkt"===this.storeType){switch(parseInt(d)){case 1:case 2:case 4:this.setWidth(this.originalWidth);e.hide();f.hide();break;case 3:f.setFieldLabel(reference.lang.filters.from);e.setFieldLabel(reference.lang.filters.to);f.show();e.show();this.setWidth(this.shortWidth);break;case 0:default:this.setWidth(this.originalWidth);e.hide();f.hide();f.setFieldLabel(undefined);e.setFieldLabel(undefined);b.reset();break}}}}Ext.resumeLayouts(true)}})}},0,["filterSelectDate"],["field","trigger","combobox","textfield","pickerfield","component","combo","box","filterSelectDate","simpleSelect","triggerfield"],{field:true,trigger:true,combobox:true,textfield:true,pickerfield:true,component:true,combo:true,box:true,filterSelectDate:true,simpleSelect:true,triggerfield:true},["widget.filterSelectDate"],0,[LkIp.view.Default.Filters,"DateSelect"],0));(Ext.cmd.derive("LkIp.view.Default.Filters.Date",Ext.form.DateField,{hidden:true,format:"d.m.Y",sendFormat:"Y-m-d",typeAhead:false,editable:true,startDay:1,width:130,maxValue:new Date(),emptyText:"\u0434\u0434.\u043c\u043c.\u0433\u0433\u0433\u0433",invalidText:reference.lang.filters.dateField.format,cls:"select-field calendar-field",setValueAfterShow:true,setValues:function(a){a=a||"";this.setValue(a);this.originalValue=(a=="")?undefined:a},getOriginalValue:function(){return this.originalValue},getSendValue:function(){var a=this.getRawValue();if(!Ext.isEmpty(a)){return a}else{return""}},initComponent:function(){var a=this;a.callParent(arguments);a.on({beforerender:function(b){if(typeof b.name=="undefined"){b.name=b.id}},beforehide:function(b){b.reset()},change:function(g,i){var e,d=g.name.indexOf("_from"),c=g.name.indexOf("_to"),h=g.getValue(),f=g.ownerCt.down('[name="'+g.name.substring(0,d!=-1?d:c)+'"]'),b=Ext.isEmpty(f)?4:f.getValue();if(d!=-1){if(Ext.isEmpty(g.findByItemId)||g.findByItemId==false){e=g.ownerCt.down('[name="'+g.name.substring(0,d)+'_to"]')}else{e=g.ownerCt.down("#"+g.itemId.replace("_from","_to"))}if(4==b&&!Ext.isEmpty(e)){e.setMinValue(h)}}else{if(c!=-1){if(Ext.isEmpty(g.findByItemId)||g.findByItemId==false){e=g.ownerCt.down('[name="'+g.name.substring(0,c)+'_from"]')}else{e=g.ownerCt.down("#"+g.itemId.replace("_to","_from"))}if(4==b&&!Ext.isEmpty(e)){e.setMaxValue(h)}}}},beforeshow:function(b){this.setValueAfterShow&&b.setValue(LkIp.Utils.getNowDate())}})}},0,["filterDate"],["field","trigger","textfield","filterDate","pickerfield","component","datefield","box","triggerfield"],{field:true,trigger:true,textfield:true,filterDate:true,pickerfield:true,component:true,datefield:true,box:true,triggerfield:true},["widget.filterDate"],0,[LkIp.view.Default.Filters,"Date"],0));(Ext.cmd.derive("LkIp.view.Default.Filters.DateFilter",Ext.Container,{initComponent:function(){Ext.apply(this,{layout:{type:"hbox"},padding:"5 0 0 0",items:[{xtype:"filterSelectDate",name:this.dateFieldName,lang:this.lang,storeType:typeof this.storeType=="undefined"?"simple":this.storeType,labelWidth:typeof this.labelWidth=="undefined"?115:this.labelWidth,width:typeof this.iWidth=="undefined"?290:this.iWidth,shortWidth:typeof this.shortWidth=="undefined"?240:this.shortWidth,padding:typeof this.dateFieldPadding=="undefined"?undefined:this.dateFieldPadding,margin:typeof this.dateFieldMargin=="undefined"?undefined:this.dateFieldMargin},{xtype:"filterDate",name:this.dateFieldName+"_from",cls:"calendar-field fl-l",fieldLabel:"",labelWidth:10,hideEmptyLabel:false,margin:typeof this.dateInnerFieldsMargin=="undefined"?"5 0 0 5":this.dateInnerFieldsMargin},{xtype:"filterDate",name:this.dateFieldName+"_to",cls:"calendar-field fl-l",fieldLabel:"",labelWidth:15,width:135,hideEmptyLabel:false,margin:typeof this.dateInnerFieldsMargin=="undefined"?"5 0 0 5":this.dateInnerFieldsMargin}]});this.callParent(arguments)}},0,["defaultDateFilter"],["defaultDateFilter","component","container","box"],{defaultDateFilter:true,component:true,container:true,box:true},["widget.defaultDateFilter"],0,[LkIp.view.Default.Filters,"DateFilter"],0));(Ext.cmd.derive("LkIp.view.Default.Filters.FilterPanel",Ext.form.Panel,{collapsible:true,titleCollapse:true,collapsed:true,componentCls:"filters-panel",title:reference.lang.filters.title,border:1,data:[],filters:[],disabledButtons:false,buttonFormBind:false,hideApply:false,hideReset:false,applyText:undefined,initComponent:function(){var a=this;a.data.push({cls:"clear"},{xtype:"button",disabled:a.disabledButtons,text:typeof a.applyText!="undefined"?a.applyText:reference.lang.buttons.apply,formBind:a.buttonFormBind,rel:"apply",hidden:a.hideApply,handler:function(){this.fireEvent("applyFilters")}},{margin:"0 0 0 10",xtype:"button",disabled:a.disabledButtons,formBind:a.buttonFormBind,text:reference.lang.buttons.reset,rel:"reset",hidden:a.hideReset,handler:function(){this.fireEvent("resetFilters")}});Ext.apply(a,{items:a.data});delete a.data;a.callParent()}},0,["defaultFilterPanel"],["panel","form","component","container","box","defaultFilterPanel"],{panel:true,form:true,component:true,container:true,box:true,defaultFilterPanel:true},["widget.defaultFilterPanel"],0,[LkIp.view.Default.Filters,"FilterPanel"],0));(Ext.cmd.derive("LkIp.view.Rsb.Budget.Index",Ext.Container,{cls:"rsbBudget iScroll",initComponent:function(){Ext.apply(this,{items:[{xtype:"defaultFilterPanel",id:"rsbBudgetFilterPanel",data:[{xtype:"filterSelect",name:"codeNO",lang:reference.lang.filters.no,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"budgetNoStore"}}]},{xtype:"note",text:reference.lang.rsb.budget.info},{xtype:"container",name:"codeNODateContainer",hidden:true,margin:"15 0 0 0",layout:{type:"hbox"},defaults:{xtype:"component"},items:[{html:reference.lang.rsb.budget.date},{html:"",margin:"0 0 0 15",name:"codeNODate"}]},{margin:"10 0 0 0",xtype:"treepanel",type:"budget-tree-grid",cls:"tree-grid border-table",sortableColumns:false,useArrows:true,rootVisible:false,singleExpand:false,enableColumnMove:false,columnLines:true,rowLines:true,store:{extend:"Ext.data.TreeStore",model:"LkIp.model.Rsb.Budget",autoDestroy:true,storeId:"budgetGridStore",reader:{type:"json",root:"children"},root:{children:[]}},viewConfig:{getRowClass:function(a){var b=["TekuschPlat"];return !a.get("leaf")||Ext.Array.contains(b,a.get("defaultNodeKey"))?"bold-row":""}},columns:{defaults:{align:"right",renderer:function(a){a=Ext.isEmpty(a)?0:a;return LkIp.Utils.numberConvert(a)}},items:[{xtype:"treecolumn",text:reference.lang.rsb.cards.budget.headers.name,dataIndex:"name",align:"left",width:300,renderer:function(a){return a}},{text:LkIp.Utils.rouble(reference.lang.rsb.cards.budget.headers.total),flex:1,dataIndex:"@Vsego"},{text:LkIp.Utils.rouble(reference.lang.rsb.cards.budget.headers.tax),flex:1,dataIndex:"@Nalog"},{text:LkIp.Utils.rouble(reference.lang.rsb.cards.budget.headers.penni),flex:1,dataIndex:"@Peni"},{text:LkIp.Utils.rouble(reference.lang.rsb.cards.budget.headers.penalty),flex:1,dataIndex:"@SHtrafyi",hidden:true},{text:LkIp.Utils.rouble(reference.lang.rsb.cards.budget.headers.percent),flex:1,dataIndex:"@Protsentyi",hidden:true},{text:LkIp.Utils.rouble(reference.lang.rsb.cards.budget.headers.percentAdditional),flex:1,dataIndex:"@ProtsentyiZaPolzByudjSr",hidden:true}]}},{xtype:"container",margin:"15 0 0 0",layout:{type:"auto"},defaults:{xtype:"component"},items:[{cls:"fl-l",html:'<a href="#!/rsb/cards" class="simple-button">'+reference.lang.rsb.budget.buttons.rsbCards+"</a>"},{cls:"fl-r",html:'<a class="simple-button saveBudgetFile">'+reference.lang.rsb.budget.buttons.saveBtn+"</a>"}]}]});this.callParent(arguments)}},0,["rsbBudget"],["rsbBudget","component","container","box"],{rsbBudget:true,component:true,container:true,box:true},["widget.rsbBudget"],[[LkIp.view.Scrolling.prototype.mixinId||LkIp.view.Scrolling.$className,LkIp.view.Scrolling]],[LkIp.view.Rsb.Budget,"Index"],0));(Ext.cmd.derive("LkIp.view.Default.Grid",Ext.grid.Panel,{forceFit:false,columnLines:true,rowLines:true,contextMenu:false,enableColumnMove:false,limitFilter:true,pageSize:5,availablePageSizes:[5,10,25,50,100],beforeLoadFlag:true,preserveScroll:true,viewConfigListeners:{},elementsToToggle:[],defaultElementsToToggle:['[itemId="pagingComponent"]'],height:"auto",autoHeight:true,maxHeight:500,cls:"border-table",getFileAction:true,paging:true,myViewConfig:{},initComponent:function(){var d=this,b=[],a=d.getStore(),c=[];Ext.suspendLayouts();d.elementsToToggle=Ext.Array.merge(d.elementsToToggle,d.defaultElementsToToggle);if(typeof d.isLocked=="undefined"||false===d.isLocked){if(d.limitFilter){b.push("-");b.push(reference.lang.grid.paging.displayText);b.push(new Ext.form.ComboBox({itemId:"limitFilter",cls:"dropdown-text grid-limit",typeAhead:false,editable:false,mode:"remote",value:d.pageSize,width:50,style:{top:"1px!important"},store:d.availablePageSizes,gridStore:a,listeners:{change:d.changeLimitFilterAction}}))}if(d.getFileAction){c.push("",{tooltip:{text:reference.lang.buttons.getGridFile},iconCls:"grid-get-file-button",border:0,itemId:"getFileBtn",handler:function(){d.fireEvent("getFile")}})}Ext.apply(d,{bbar:d.paging?Ext.create("Ext.PagingToolbar",{border:1,pageSize:d.pageSize,height:30,cls:"paging-toolbar",padding:"0 0 6 8",displayInfo:true,store:d.store,itemId:"pagingComponent",displayMsg:reference.lang.grid.paging.allRecords+" / "+reference.lang.grid.paging.recordOnThePage,emptyMsg:reference.lang.grid.paging.empty,items:c}):undefined,viewConfig:Ext.apply({autoScroll:true,enableTextSelection:true,getRowClass:d.getRowClass,stripeRows:false,markDirty:false,preserveScrollOnRefresh:d.preserveScroll,loadingText:reference.lang.loading,listeners:Ext.apply({refresh:function(e){}},d.viewConfigListeners)},d.myViewConfig)});if(d.paging){d.bbar.add(b)}}if(d.contextMenu){d.on({itemcontextmenu:function(f,j,h,g,i){i.stopEvent();d.contextMenu.showAt(i.getXY());return false},itemdblclick:function(g,f,i,h,j){j.stopEvent();d.contextMenu.showAt(j.getXY());return false}})}d.callParent();if((typeof d.isLocked=="undefined"||false===d.isLocked)&&d.paging){a=d.getStore();a.setPageSize(d.pageSize);a.on({load:{fn:d.load,scope:d},beforeLoad:{fn:d.beforeLoad,scope:d}})}Ext.resumeLayouts(true)},load:function(c,b,e){var d=this,a=d.getHeight();d.toggleGridDockedElements();d.beforeLoadFlag=true;c.resetAttempts();if(a<d.maxHeight){d.setHeight(a+20);d.doLayout()}LkIp.app.getController("Content").initNoTooltips()},beforeLoad:function(a){this.setHeight("auto");this.autoHeight=true;delete this.height;if(this.beforeLoadFlag){a.updateProxy();this.setLoading(false);this.toggleGridDockedElements();this.beforeLoadFlag=false}},toggleGridDockedElements:function(){var b=0,a=this.elementsToToggle.length,c;Ext.suspendLayouts();for(;b<a;b++){c=this.getDockedItems(this.elementsToToggle[b])[0]||Ext.get(this.elementsToToggle[b]);if(!Ext.isEmpty(c)){c.setDisabled(!c.isDisabled())}}Ext.resumeLayouts(true)},changeLimitFilterAction:function(b,c){var a=Ext.getStore(b.gridStore);a.setPageSize(c);a.loadPage(1)},getSelected:function(){var a=this.getSelectionModel().getSelection();return a.length?a[0]:null},stringRenderer:function(a){return LkIp.Utils.stringWrap(a)}},0,["gridtable"],["panel","gridtable","component","tablepanel","container","grid","box","gridpanel"],{panel:true,gridtable:true,component:true,tablepanel:true,container:true,grid:true,box:true,gridpanel:true},["widget.gridtable"],0,[LkIp.view.Default,"Grid"],0));(Ext.cmd.derive("LkIp.view.Default.GridStatusBar",Ext.Container,{layout:"auto",cls:"grid-status-bar",data:[],itemId:"gridStatusBar",activeTab:0,initComponent:function(){Ext.apply(this,{items:[{xtype:"component",cls:"show-text",html:"\u041f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c:"},{xtype:"tabpanel",cls:"tabs-block",itemId:"statusBarTabs"+this.page,tabBar:this.tabBar,plain:true,defaults:{type:"status-bar-tab"},items:this.data,activeTab:this.activeTab}]});this.callParent()},getActive:function(){return this.tabBar.getActiveTab()},setActive:function(a){this.tabBar.setActiveTab(a)}},0,["gridStatusBar"],["gridStatusBar","component","container","box"],{gridStatusBar:true,component:true,container:true,box:true},["widget.gridStatusBar"],0,[LkIp.view.Default,"GridStatusBar"],0));(Ext.cmd.derive("LkIp.view.Docflow.Documents.Grid",LkIp.view.Default.Grid,{itemId:"documentsGrid",store:"Docflow.Documents.GridStore",getFileAction:false,docWithoutInfo:["59","79","80","81","83","84","85","86","97","118","122","119","94","108","109","110","126","127","128","129","131","132","133","134","135","136","137","140","142","143","144","145","146","147","148","149","150","166","179","298","224"],infoTpl:{31:'<table class="describe-table no-border"><tr><td class="small-column"><span class="label">'+reference.lang.docflow.tooltip.detailsSettlementDocument+'</span></td><td><span class="text"> \u2116 {docNomer} / {docData}</span></td></tr><tr><td class="small-column"><span class="label">'+reference.lang.docflow.tooltip.summa+'</span></td><td><span class="text"> {docSumma}</span></td></tr></table>',36:'<table class="describe-table no-border"><tr><td class="small-column"><span class="label">'+reference.lang.docflow.tooltip.overpaymentSumm+'</span></td><td><span class="text"> {summ}</span></td></tr><tr><td class="small-column"><span class="label">'+reference.lang.docflow.tooltip.overpaymentInfo+'</span></td><td><span class="text"> {parentKBK}/{parentOKTMO}; {parentTipPl}; {parentStatusKod} - {parentStatus};</span></td></tr><tr><td class="small-column"><span class="label">'+reference.lang.docflow.tooltip.debtInfo+'</span></td><td><span class="text"> {KBK}/{OKTMO}; {tipPl}; {statusKod} - {status};</span></td></tr></table>',37:{1:'<table class="describe-table no-border"><tr><td class="small-column"><span class="label">'+reference.lang.docflow.tooltip.overpaymentSumm+'</span></td><td><span class="text"> {summ}</span></td></tr><tr><td class="small-column"><span class="label">'+reference.lang.docflow.tooltip.overpaymentInfo+'</span></td><td><span class="text"> {parentKBK}/{parentOKTMO}; {parentTipPl}; {parentStatusKod} - {parentStatus};</span></td></tr><tr><td class="small-column"><span class="label">'+reference.lang.docflow.tooltip.paymentAccountInfo+'</span></td><td><span class="text"> {bankAccount}; {bankName}; {bankInn} / {bankKpp}; <br>'+reference.lang.docflow.tooltip.bik+" {bankBik}; <br>"+reference.lang.docflow.tooltip.account+" {bankAccountK}</span></td></tr></table>",2:'<table class="describe-table no-border"><tr><td class="small-column"><span class="label">'+reference.lang.docflow.tooltip.overpaymentSumm+'</span></td><td><span class="text"> {summ}</span></td></tr><tr><td class="small-column"><span class="label">'+reference.lang.docflow.tooltip.overpaymentInfo+'</span></td><td><span class="text"> {parentKBK}/{parentOKTMO}; {parentTipPl}; {parentStatusKod} - {parentStatus};</span></td></tr><tr><td class="small-column"><span class="label">'+reference.lang.docflow.tooltip.personalAccountInfo+'</span></td><td><span class="text"> {pAccount}; {pAccountName}; </span></td></tr></table>'},43:'<table class="describe-table no-border"><tr><td class="small-column"><span class="label">'+reference.lang.docflow.tooltip.dateState+'</span></td><td><span class="text"> {dateState}</span></td></tr></table>',52:'<table class="describe-table no-border"><tr><td class="small-column"><span class="label">'+reference.lang.docflow.tooltip.dateState+'</span></td><td><span class="text"> {dateState}</span></td></tr><tr><td class="small-column"><span class="label">'+reference.lang.docflow.tooltip.kbkOktmo+'</span></td><td><span class="text"> {kbkOktmo} </span></td></tr></table>',55:'<table class="describe-table no-border"><tr><td class="small-column"><span class="label">'+reference.lang.docflow.tooltip.dateState+'</span></td><td><span class="text"> {dateState}</span></td></tr><tr><td class="small-column"><span class="label">'+reference.lang.docflow.tooltip.receiveType+'</span></td><td><span class="text"> {answerType}</span></td></tr></table>',62:'<table class="describe-table no-border"><tr><td class="small-column"><span class="label">'+reference.lang.docflow.tooltip.notifyInfo+'</span></td><td><span class="text"> {nomer} / {data}</span></td></tr><tr><td class="small-column"><span class="label">'+reference.lang.docflow.tooltip.summPaymentDoc+'</span></td><td><span class="text"> {docSumma}</span></td></tr><tr><td class="small-column"><span class="label">'+reference.lang.docflow.tooltip.paymentDocInfo+'</span></td><td><span class="text"> {docNomer} / {docData} </span></td></tr></table>',65:'<table class="describe-table no-border"><tr><td class="small-column"><span class="label">'+reference.lang.docflow.tooltip.detailsSettlementDocument+'</span></td><td><span class="text">\u2116 {docNomer} / {docData}</span></td></tr><tr><td class="small-column"><span class="label">'+reference.lang.docflow.tooltip.summa+'</span></td><td><span class="text"> {docSumma}</span></td></tr></table>',67:'<table class="describe-table no-border"><tr><td class="small-column"><span class="label">'+reference.lang.docflow.tooltip.dateState+'</span></td><td><span class="text"> {date}</span></td></tr><tr><td class="small-column"><span class="label">'+reference.lang.docflow.tooltip.sectionAct+'</span></td><td><span class="text"> {section}</span></td></tr><tr><td class="small-column"><span class="label">'+reference.lang.docflow.tooltip.kbkOktmo+'</span></td><td><span class="text"> {kbkOktmo} </span></td></tr></table>',101:'<table class="describe-table no-border"><tr><td class="small-column"><span class="label">'+reference.lang.docflow.tooltip.fiscalYear+'</span></td><td><span class="text"> {year}</span></td></tr><tr><td class="small-column"><span class="label">'+reference.lang.docflow.tooltip.condition+'</span></td><td><span class="text"> {condition}</span></td></tr><tr><td class="small-column"><span class="label">'+reference.lang.docflow.tooltip.kbkOktmo+'</span></td><td><span class="text"> {kbkOktmo} </span></td> </tr></table> ',102:'<table class="describe-table no-border"><tr><td class="small-column"><span class="label">'+reference.lang.docflow.tooltip.periodFrom+'</span></td><td><span class="text"> {dateFrom} </span></td></tr><tr><td class="small-column"><span class="label">'+reference.lang.docflow.tooltip.periodTo+'</span></td><td><span class="text"> {dateTo}</span></td></tr><tr><td class="small-column"><span class="label">'+reference.lang.docflow.tooltip.selectCondition+'</span></td><td><span class="text"> {condition} </span></td></tr></table>',111:'<table class="describe-table no-border"><tr><td class="small-column"><span class="label">'+reference.lang.docflow.tooltip.ogrnip+'</span></td><td><span class="text"> {ogrnIp} </span></td></tr><tr><td class="small-column"><span class="label">'+reference.lang.docflow.tooltip.extractType+'</span></td><td><span class="text"> {requestType} </span></td></tr></table>',112:'<table class="describe-table no-border"><tr><td class="small-column"><span class="label">'+reference.lang.docflow.tooltip.ogrnip+'</span></td><td><span class="text"> {ogrnIp} </span></td></tr><tr><td class="small-column"><span class="label">'+reference.lang.docflow.tooltip.extractType+'</span></td><td><span class="text"> {requestType} </span></td></tr></table>'},myViewConfig:{preserveScrollOnRefresh:true},excludedInSatisfy:["142","143","144","145","146","150","151"],initComponent:function(){var a=this;Ext.apply(a,{columns:[{text:reference.lang.docflow.grid.request,menuDisabled:true,columns:[{text:reference.lang.docflow.grid.requestName,dataIndex:"@NaimZayavl",width:250,sortable:true,renderer:this.statementNameRenderer},{text:reference.lang.docflow.grid.requestDate,dataIndex:"@DataPriemaZayavl",width:100,sortable:true,renderer:function(b){return !Ext.isEmpty(b)?LkIp.Utils.getDate(b,true):""}},{text:reference.lang.docflow.grid.regNumber,dataIndex:"@RegNomer",id:"regNumberColumn",width:150,sortable:false,renderer:this.statementNameRenderer},{text:reference.lang.docflow.grid.regDate,dataIndex:"@RegData",id:"regDateColumn",width:120,sortable:false,renderer:function(b){return !Ext.isEmpty(b)?LkIp.Utils.getDate(b,true):""}},{text:reference.lang.docflow.grid.requestDoc,dataIndex:"@ExtZayavl",menuDisabled:true,sortable:false,width:90,xtype:"actioncolumn",menuText:reference.lang.docflow.grid.requestDocMenuText,items:[{getClass:function(b){switch(b){case"pdf":return"pdf-32-icon";case"zip":return"zip-32-icon";case"loading":return"loading-32-icon";case"doc":case"docs":return"doc-32-icon";default:return"x-hide-display"}},tooltip:reference.lang.download,handler:function(b,c){b.ownerCt.fireEvent("downloadStatement",b.getStore().getAt(c))}}]}]},{text:reference.lang.docflow.grid.requestStatus,dataIndex:"@StatusZayavl",flex:1,minWidth:140,sortable:false,renderer:function(d,f,c){var b="",e=c.get("@TipOtv");if(144==e&&LkIp.User.hasKktAccess()){b='<span class="help-tooltip-icon kkt-maybe-need-fiscalization"></span>'}return d+b}},{text:reference.lang.docflow.grid.noAnswer,dataIndex:"",renderer:function(c,f,b){var e=parseInt(b.get("@KolDokumOtv")),d=b.internalId;if(e>0){if(e==1){return'<a class="document-answers" data-index="'+d+'">'+reference.lang.docflow.grid.answersLinkOne+"</a>"}else{return'<a class="document-answers" data-index="'+d+'">'+reference.lang.docflow.grid.answersLink+"("+e+")</a>"}}}},{text:reference.lang.docflow.grid.noCode,dataIndex:"@KodNO",width:90,sortable:true,renderer:function(b){return LkIp.Utils.noRenderer(b)}},{text:reference.lang.docflow.grid.satisfy,dataIndex:"",menuDisabled:true,sortable:false,hidden:true,width:140,menuText:reference.lang.docflow.grid.satisfy,renderer:function(d,f,b){var c=b.get("@KolDokumOtv"),h=b.get("@DataOtsenki"),g=b.get("@UdovlUsl"),e=b.get("@Tip");if(!Ext.Array.contains(this.excludedInSatisfy,e)){if(c>0){if(Ext.isEmpty(g)&&Ext.isEmpty(h)){return(!LkIp.User.isInspector()?Ext.String.format('<span class="feedback-window page-action-link" idDoc="{0}">{1}</span>',b.get("@FIdZayavl"),reference.lang.docflow.feedback.evaluate):"")}else{if(g==0){f.tdAttr='data-qtip="'+b.get("@Kommentariy")+'" data-qclass="qtip-resize" style="text-align:center;"'}return(g==1?reference.lang.docflow.feedback.answerYes:reference.lang.docflow.feedback.answerNo)+'<div class="gray">'+LkIp.Utils.getDate(b.get("@DataOtsenki"),true)+"</div>"}}}return""}}]});this.callParent(arguments)},statementNameRenderer:function(d,b,a){var c=a.get("@Tip");if(!Ext.Array.contains(this.docWithoutInfo,c)){return Ext.String.format('<span style="white-space:normal !important;" class="text-tooltip documentTooltip" fid="{0}" docType="{1}">{2}</span>',a.get("@FIdZayavl"),c,d)}return d},getStatementTpl:function(c,b){b=("53"==b||"54"==b)?"52":b;var a=this.infoTpl[b];if(b==37){a=a[c.type37]}a=Ext.create("Ext.XTemplate",a);return a.applyTemplate(c)}},0,["documentsGrid"],["panel","gridtable","component","tablepanel","container","grid","box","documentsGrid","gridpanel"],{panel:true,gridtable:true,component:true,tablepanel:true,container:true,grid:true,box:true,documentsGrid:true,gridpanel:true},["widget.documentsGrid"],0,[LkIp.view.Docflow.Documents,"Grid"],0));(Ext.cmd.derive("LkIp.view.Docflow.Documents.UserFeedback",Ext.window.Window,{autoHeight:true,layout:"auto",modal:true,ui:"nalogThemeWindow",title:reference.lang.docflow.feedback.title,width:450,idDoc:undefined,required:'<span class="form-required-field" data-qtip="'+reference.lang.form.required+'">*</span>',initComponent:function(){var a=this;Ext.apply(a,{items:{xtype:"container",layout:{type:"auto"},margin:10,items:[{xtype:"form",layout:"auto",itemId:"feedback-form",width:"100%",items:[{xtype:"component",html:reference.lang.docflow.feedback.question,margin:"0 0 15 0"},{xtype:"container",layout:"hbox",itemId:"feedback-first-buttons",defaults:{xtype:"button",margin:"0 15 0 0"},items:[{itemId:"feedback-yes",text:reference.lang.docflow.feedback.yes},{itemId:"feedback-no",text:reference.lang.buttons.no},{itemId:"feedback-evaluate-later",text:reference.lang.docflow.feedback.evaluateLater}]},{xtype:"container",layout:"auto",itemId:"feedback-comment-block",hidden:true,items:[{xtype:"textareafield",grow:true,name:"comment",emptyText:reference.lang.docflow.feedback.commentPlaceholder,fieldLabel:"",width:"100%",allowBlank:false},{xtype:"button",width:150,formBind:true,itemId:"feedback-send",text:reference.lang.buttons.feedback}]}]}]}});a.callParent(arguments)}},0,["feedbackWindow"],["panel","feedbackWindow","window","component","container","box"],{panel:true,feedbackWindow:true,window:true,component:true,container:true,box:true},["widget.feedbackWindow"],0,[LkIp.view.Docflow.Documents,"UserFeedback"],0));(Ext.cmd.derive("LkIp.view.Docflow.Documents.Index",Ext.Container,{cls:"docflowList iScroll",initComponent:function(){var b=this,a=[];if(!LkIp.User.isInspectorWithCodeNO()){a.push({lang:reference.lang.filters.no,name:"codeNO",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"docflowNoStore"}})}a.push({lang:reference.lang.docflow.filters.docType,name:"statementType",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"docflowStatementTypeStore"}},{lang:reference.lang.docflow.filters.statementStatus,name:"statementStatus",tpl:'<tpl for="."><tpl if="code != 0"><li data-qtip="{qtip}" class="x-boundlist-item" role="option">{value}</li></tpl><tpl if="code == 0"><li class="x-boundlist-item" role="option">{value}</li></tpl></tpl>',displayField:"value",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"docflowStatementStatusStore"}});Ext.apply(b,{items:[{xtype:"component",html:Ext.String.format(reference.lang.docflow.infoBlock,"<br/><br/>")},{xtype:"note",text:reference.lang.docflow.note},{xtype:"component",html:LkIp.Utils.header(reference.lang.docflow.grid.title,4),margin:"15 0 0 0"},{xtype:"defaultFilterPanel",id:"docflowFilterPanel",data:[{cls:"first-column fl-l",defaults:{labelWidth:140,width:390,xtype:"filterSelect"},items:a},{cls:"second-column fl-l",items:[{xtype:"defaultDateFilter",dateFieldName:"dateStatement",storeType:"full",lang:reference.lang.docflow.filters.statementDate},{xtype:"defaultDateFilter",dateFieldName:"dateAnswer",storeType:"full",lang:reference.lang.docflow.filters.answerDate},{xtype:"filterSelect",labelWidth:115,width:290,tpl:'<tpl for="."><tpl if="code != 0"><li data-qtip="{qtip}" class="x-boundlist-item" role="option">{value}</li></tpl><tpl if="code == 0"><li class="x-boundlist-item" role="option">{value}</li></tpl></tpl>',displayField:"value",lang:reference.lang.docflow.filters.answerStatus,name:"answerStatus",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"docflowAnswerStatusStore"}}]}]},{xtype:"container",cls:"grid-with-status-bar",items:[{xtype:"gridStatusBar",page:"DocflowDocuments",data:[{title:reference.lang.docflow.gridStatus.newDocuments,itemId:"tab-new-documents",tooltip:reference.lang.docflow.gridStatus.newDocumentsTtip},{title:reference.lang.docflow.gridStatus.allDocuments,tooltip:reference.lang.docflow.gridStatus.allDocumentsTtip,itemId:"tab-all-documents"}]},{xtype:"documentsGrid"}]},LkIp.User.isActiveUser()?{xtype:"component",margin:"15 0 0",html:'<a class="link4-icon link" style="margin: 2px 0 0 15px;padding:3px 0 5px 35px;" href="#!/onlineBooking">'+reference.lang.pages.onlineBooking.title+"</a>"}:{cls:"display-none"}]});this.callParent()}},0,["docflowList"],["component","container","box","docflowList"],{component:true,container:true,box:true,docflowList:true},["widget.docflowList"],[[LkIp.view.Scrolling.prototype.mixinId||LkIp.view.Scrolling.$className,LkIp.view.Scrolling]],[LkIp.view.Docflow.Documents,"Index"],0));(Ext.cmd.derive("LkIp.view.Docflow.Notice.Grid",LkIp.view.Default.Grid,{itemId:"noticeGrid",store:"Docflow.Notice.GridStore",getFileAction:false,initComponent:function(){var a=this;Ext.apply(a,{columns:[{text:reference.lang.docflowNotice.grid.docName,dataIndex:"docType",width:250,sortable:true},{text:reference.lang.docflowNotice.grid.date,dataIndex:"lkDate",width:130,sortable:true,renderer:function(b){return !Ext.isEmpty(b)?LkIp.Utils.getDate(b,true):""}},{text:reference.lang.docflowNotice.grid.doc,dataIndex:"docExt",menuDisabled:true,sortable:false,width:90,xtype:"actioncolumn",items:[{getClass:function(b){switch(b){case"pdf":return"pdf-32-icon";case"zip":return"zip-32-icon";case"loading":return"loading-32-icon";case"doc":case"docs":return"doc-32-icon";default:return"x-hide-display"}},getTip:function(d,b,c){return c.get("docStatusCode")==4?reference.lang.download:reference.lang.docflowNotice.grid.docTip},handler:function(b,c){b.ownerCt.fireEvent("docClick",b.getStore().getAt(c))}}]},{text:reference.lang.docflowNotice.grid.status,dataIndex:"docStatus",flex:1,minWidth:140,sortable:false},{text:reference.lang.docflowNotice.grid.no,menuDisabled:true,columns:[{text:reference.lang.docflowNotice.grid.noCode,dataIndex:"noCode",width:90,sortable:true,renderer:function(b){return LkIp.Utils.noRenderer(b)}},{text:reference.lang.docflowNotice.grid.noName,dataIndex:"noName",width:200,sortable:true}]}]});a.callParent(arguments)}},0,["noticeGrid"],["noticeGrid","panel","gridtable","component","tablepanel","container","grid","box","gridpanel"],{noticeGrid:true,panel:true,gridtable:true,component:true,tablepanel:true,container:true,grid:true,box:true,gridpanel:true},["widget.noticeGrid"],0,[LkIp.view.Docflow.Notice,"Grid"],0));(Ext.cmd.derive("LkIp.view.Docflow.Notice.Index",Ext.Container,{cls:"docflowList iScroll",initComponent:function(){var b=this,a=[];if(!LkIp.User.isInspectorWithCodeNO()){a.push({lang:reference.lang.filters.no,name:"codeNO",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"docflowNoStore"}})}a.push({lang:reference.lang.docflowNotice.filters.docType,name:"docType",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"docflowStatementTypeStore"}});Ext.apply(b,{items:[{xtype:"defaultFilterPanel",id:"noticeFilterPanel",data:[{cls:"first-column fl-l",defaults:{labelWidth:140,width:390,xtype:"filterSelect"},items:a},{cls:"second-column fl-l",items:[{xtype:"filterSelect",labelWidth:140,width:390,lang:reference.lang.docflowNotice.filters.docStatus,name:"docStatus",tpl:'<tpl for="."><tpl if="code != 0"><li data-qtip="{qtip}" class="x-boundlist-item" role="option">{value}</li></tpl><tpl if="code == 0"><li class="x-boundlist-item" role="option">{value}</li></tpl></tpl>',displayField:"value",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"docflowStatementStatusStore"}},{xtype:"defaultDateFilter",labelWidth:140,dateFieldName:"lkDate",storeType:"full",lang:reference.lang.docflowNotice.filters.docDate}]}]},{xtype:"container",cls:"grid-with-status-bar",items:[{xtype:"gridStatusBar",page:"DocflowNotice",data:[{title:reference.lang.docflow.gridStatus.newDocuments,itemId:"tab-new-documents",tooltip:reference.lang.docflowNotice.newDocumentsTtip},{title:reference.lang.docflow.gridStatus.allDocuments,tooltip:reference.lang.docflowNotice.allDocumentsTtip,itemId:"tab-all-documents"}]},{xtype:"noticeGrid"}]},LkIp.User.isActiveUser()?{xtype:"component",margin:"15 0 0",html:'<a class="link4-icon link" style="margin: 2px 0 0 15px;padding:3px 0 5px 35px;" href="#!/onlineBooking">'+reference.lang.pages.onlineBooking.title+"</a>"}:{cls:"display-none"}]});this.callParent()}},0,["docflowNotice"],["docflowNotice","component","container","box"],{docflowNotice:true,component:true,container:true,box:true},["widget.docflowNotice"],0,[LkIp.view.Docflow.Notice,"Index"],0));(Ext.cmd.derive("LkIp.view.Egrn.Account.Index",Ext.Container,{cls:"egrnAccount iScroll",data:[],initComponent:function(){var b=this,a=[];if(!LkIp.User.isInspectorWithCodeNO()){a.push({lang:reference.lang.filters.region,name:"codeRegion",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"egrnRegionStore"}},{lang:reference.lang.filters.no,name:"codeNO",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"egrnNoStore"}})}a.push({lang:reference.lang.egrn.account.filters.reason,name:"codeReason",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"egrnReasonStore"}});Ext.apply(b,{items:[{xtype:"tabpanel",cls:"tabs-block small-font",itemId:"tabs-block",plain:true,layout:"fit",margin:"0 0 15 0",tabBar:{layout:{type:"hbox",align:"stretch"},defaults:{flex:1,height:64},height:65},bodyCls:"tabsContent",activeTab:1,items:[{title:reference.lang.egrn.account.userInfoBlock.tabFL.title,items:{xtype:"component",tpl:this.flTpl,id:"tabFL",data:this.data},listeners:{afterRender:function(c){c.ownerCt.setHeight(c.getHeight()+85);if(Ext.isIE8){c.up("#tabs-block").setHeight(c.getHeight()+85)}}}},{title:reference.lang.egrn.account.userInfoBlock.tabIP.title,items:{xtype:"component",tpl:this.ipTpl,id:"tabIP",data:this.data}},{title:reference.lang.egrn.account.userInfoBlock.tabCertificate.title,items:{xtype:"component",tpl:this.certificateTpl,id:"tabCertificate",data:this.data}}]},{xtype:"component",html:LkIp.Utils.header(reference.lang.egrn.account.grid.header,4),margin:"15 0 0 0"},{xtype:"defaultFilterPanel",id:"egrnFilterPanel",data:[{cls:"first-column fl-l",defaults:{labelWidth:140,width:390,xtype:"filterSelect"},items:a},{cls:"second-column fl-l",items:[{xtype:"defaultDateFilter",dateFieldName:"date_set",lang:reference.lang.egrn.account.filters.dateSet},{xtype:"defaultDateFilter",dateFieldName:"date_remove",lang:reference.lang.egrn.account.filters.dateRemove}]}]},{xtype:"container",cls:"grid-with-status-bar",items:[{xtype:"gridStatusBar",page:"EgrnAccount",data:[{title:reference.lang.egrn.account.gridStatus.active,id:"tab-active-reasons"},{title:reference.lang.egrn.account.gridStatus.all,id:"tab-all-reasons"}]},{xtype:"gridtable",id:"egrnAccountGrid",pageSize:100,store:"Egrn.Account.GridStore",columns:[{text:reference.lang.egrn.account.grid.ImyaPrichinyi,dataIndex:"@ImyaPrichinyi",flex:1},{text:reference.lang.egrn.account.grid.DataPostanovki,dataIndex:"@DataPostanovki",width:100,renderer:function(c){return !Ext.isEmpty(c)?LkIp.Utils.getDate(c):""}},{text:reference.lang.egrn.account.grid.DataSnyatiya,dataIndex:"@DataSnyatiya",width:100,hidden:true,id:"dateRemoveColumn",renderer:function(c){return !Ext.isEmpty(c)?LkIp.Utils.getDate(c):""}},{text:reference.lang.egrn.account.grid.noInfo,menuDisabled:true,columns:[{text:reference.lang.egrn.account.grid.KodNalOrg,dataIndex:"@KodNalOrg",sortable:true,width:100,renderer:function(c){return LkIp.Utils.noRenderer(c)}},{text:reference.lang.egrn.account.grid.ImyaNalOrg,dataIndex:"@ImyaNalOrg",sortable:false,width:200},{text:reference.lang.egrn.account.grid.AdresNalOrg,dataIndex:"@AdresNalOrg",sortable:false,width:200}]}]}]}]});this.callParent()},flTpl:'<table class="info-table two-columns"><tbody><tr><td><span class="label">'+reference.lang.egrn.account.userInfoBlock.tabFL.fio+':</span><span class="text">{surname} {name} {patronymic}</span></td><td class="last-column"><span class="label">'+reference.lang.egrn.account.userInfoBlock.tabFL.document+':</span><span class="text">{document}</span></td></tr><tr><td><span class="label">'+reference.lang.egrn.account.userInfoBlock.tabFL.birthDate+':</span><span class="text">{birthDate}</span></td><td class="last-column"><span class="label">'+reference.lang.egrn.account.userInfoBlock.tabFL.series+':</span><span class="text">{series}</span><span class="label">'+reference.lang.egrn.account.userInfoBlock.tabFL.whenGet+':</span><span class="text">{whenGet}</span></td></tr><tr><td><span class="label">'+reference.lang.egrn.account.userInfoBlock.tabFL.address+':</span><span class="text">{address}</span></td><td class="last-column"><span class="label">'+reference.lang.egrn.account.userInfoBlock.tabFL.whoGive+':</span><span class="text">{whoGive}</span></td></tr><tr class="last-row"><td colspan="2" class="last-column"><tpl if="certUser == 1">'+reference.lang.egrn.account.userInfoBlock.tabFL.error+'<a class="link4-icon link" style="margin: 2px 0 0 15px;padding:3px 0 5px 35px;" href="#!/personaldata/update">'+reference.lang.egrn.account.userInfoBlock.tabFL.sendPersonalData+"</a></tpl></td> </tr></tbody></table> ",ipTpl:'<table class="info-table two-columns"><tbody><tr><td colspan="2" class="last-column" style="width: 100%;"><div class="fl-l" style="width: 25%;"><span class="label">'+reference.lang.egrn.account.userInfoBlock.tabIP.no+'</span> </div><div class="fl-r" style="width: 75%;">{no}</div><div class="clear"></div></td></tr><tr><th style="width: 55%;">'+reference.lang.egrn.account.userInfoBlock.tabIP.reasonNameHeader+'</th><th class="last-column">'+reference.lang.egrn.account.userInfoBlock.tabIP.reasonDateHeader+'</th></tr><tr class=""><td><span class="label">'+reference.lang.egrn.account.userInfoBlock.tabIP.reasonNamePMJ+'</span> </td><td class="last-column"><span class="text fl-r">{datePMJ}</span></td></tr><tr class="last-row"><td><span class="label">{reasonName}</span> </td><td class="last-column"><span class="text fl-r">{reasonDate}</span></td></tr></tbody></table>',certificateTpl:'<table class="info-table one-column"><tbody><tr><td><div class="fl-l"><span class="label">'+reference.lang.egrn.account.userInfoBlock.tabCertificate.series+'</span> </div><div class="fl-r">{series}</div><div class="clear"></div> </td></tr><tr><td><div class="fl-l"><span class="label">'+reference.lang.egrn.account.userInfoBlock.tabCertificate.number+'</span> </div><div class="fl-r">{number}</div><div class="clear"></div> </td></tr><tr class="last-row"><td><div class="fl-l"><span class="label">'+reference.lang.egrn.account.userInfoBlock.tabCertificate.dateGet+'</span> </div><div class="fl-r">{dateGet}</div><div class="clear"></div> </td></tr></tbody></table>'},0,["egrnAccount"],["component","container","egrnAccount","box"],{component:true,container:true,egrnAccount:true,box:true},["widget.egrnAccount"],[[LkIp.view.Scrolling.prototype.mixinId||LkIp.view.Scrolling.$className,LkIp.view.Scrolling]],[LkIp.view.Egrn.Account,"Index"],0));(Ext.cmd.derive("LkIp.view.Rsb.Cards.Index",Ext.Container,{cls:"rsb-cards iScroll",initComponent:function(){var a=LkIp.User.isClosedUser();Ext.apply(this,{items:[{xtype:"container",layout:{type:"auto"},defaults:{xtype:"container"},items:[{xtype:"container",cls:"rsb-cards-items",itemId:"rsb-cards-items",items:[]},{xtype:"container",cls:"information-service-block",layout:"auto",items:[{xtype:"container",margin:"15 0 0",defaults:{xtype:"component",height:80,cls:"information-service-item"},items:[{html:'<div class="service-icon link4-icon">'+(LkIp.User.isActiveUser()?'<a href="#!/information/service/paymentsStatus">':'<a class="not-active-link certificate-tooltip">')+reference.lang.pages.informationService.paymentsStatus.titleForIndex+"</a></div>"},{componentCls:"middle-block",html:'<div class="service-icon link4-icon">'+(LkIp.User.isActiveUser()?'<a href="#!/information/service/operations">':'<a class="not-active-link certificate-tooltip">')+reference.lang.pages.informationService.operations.titleForIndex+"</a></div>"},{html:'<div class="service-icon link4-icon">'+(LkIp.User.isActiveUser()?'<a href="#!/information/service/accounting">':'<a class="not-active-link certificate-tooltip">')+reference.lang.pages.informationService.accounting.title+"</a></div>"}]}]}]}]});this.callParent()}},0,["rsbCards"],["component","container","box","rsbCards"],{component:true,container:true,box:true,rsbCards:true},["widget.rsbCards"],0,[LkIp.view.Rsb.Cards,"Index"],0));(Ext.cmd.derive("LkIp.view.Rsb.Cards.CardInfo",Ext.Container,{cardTpl:'<table class="describe-table"><tbody><tr><th colspan="2">'+reference.lang.rsb.cards.card.title+'</th> </tr><tr class="no-border"><td class="small-column"><span class="label">'+reference.lang.rsb.cards.card.kbkOkato+'</span></td><td><span class="text">{kbkOkato}</span></td></tr><tr class="no-border"><td class="small-column"><span class="label">'+reference.lang.rsb.cards.card.status+'</span></td><td><span class="text">{status}</span></td></tr><tr class="no-border"><td class="small-column"><span class="label">'+reference.lang.rsb.cards.card.no+'</span></td><td><span class="text">{no}</span></td></tr><tr class="no-border"><td class="small-column"><span class="label">'+reference.lang.rsb.cards.card.dateSost+'</span></td><td><span class="text">{dateSost}</span></td></tr></tbody></table> ',initComponent:function(){Ext.apply(this,{items:[{xtype:"component",tpl:this.cardTpl,name:"rsbCardTpl",data:{kbkOkato:"-",status:"-",no:"-",dateSost:"-"}}]});this.callParent()}},0,["rsbCardInfo"],["component","container","box","rsbCardInfo"],{component:true,container:true,box:true,rsbCardInfo:true},["widget.rsbCardInfo"],0,[LkIp.view.Rsb.Cards,"CardInfo"],0));(Ext.cmd.derive("LkIp.view.Rsb.Cards.Nds.Index",Ext.Container,{cls:"rsbCardsNds iScroll",initComponent:function(){var a=this;Ext.apply(a,{items:[{xtype:"note",text:reference.lang.rsb.cards.nds.tooltip,style:{marginTop:"0px !important"}},{xtype:"rsbCardInfo"},{xtype:"gridtable",id:"rsbCardsNdsGrid",store:"Rsb.Cards.Nds.GridStore",columns:[{text:reference.lang.rsb.cards.nds.grid.dataPodachi,dataIndex:"@DataPodachi",width:150,renderer:function(b){return !Ext.isEmpty(b)?LkIp.Utils.getDate(b):""}},{text:reference.lang.rsb.cards.nds.grid.nomer,dataIndex:"@Nomer",width:200},{text:reference.lang.rsb.cards.nds.grid.nalPeriod,dataIndex:"@NalPeriod",width:200},{text:reference.lang.rsb.cards.nds.grid.srokUpl,dataIndex:"@SrokUpl",width:200},{text:reference.lang.rsb.cards.nds.grid.summaDekl,dataIndex:"@SummaDekl",flex:1,renderer:function(b){return Ext.isEmpty(b)?"-":LkIp.Utils.numberConvert(b)}}]}]});this.callParent()}},0,["rsbCardsNds"],["component","container","box","rsbCardsNds"],{component:true,container:true,box:true,rsbCardsNds:true},["widget.rsbCardsNds"],[[LkIp.view.Scrolling.prototype.mixinId||LkIp.view.Scrolling.$className,LkIp.view.Scrolling]],[LkIp.view.Rsb.Cards.Nds,"Index"],0));(Ext.cmd.derive("LkIp.view.Rsb.Cards.Hung.Index",Ext.Container,{cls:"rsbCardsHung iScroll",initComponent:function(){var a=this;Ext.apply(a,{items:[{xtype:"component",name:"rsbCardsTitle",cls:"rsbCardsTitle",tpl:'<div class="pageTitle fl-l">'+reference.lang.rsb.cards.hung.title+'</div><div class="kbkName fl-l">{imyaKbk}</div>',data:{imyaKbk:""}},{cls:"clear"},{xtype:"rsbCardInfo"},{xtype:"component",margin:"15 0 0 0",html:LkIp.Utils.header(reference.lang.rsb.cards.hung.grid.title,4)},{xtype:"gridtable",id:"rsbCardsHungGrid",store:"Rsb.Cards.Hung.GridStore",columns:[{text:reference.lang.rsb.cards.hung.grid.docOsn,menuDisabled:true,columns:[{text:reference.lang.rsb.cards.hung.grid.data,dataIndex:"@DokOsnData",width:90,renderer:function(b){return !Ext.isEmpty(b)?LkIp.Utils.getDate(b):""}},{text:reference.lang.rsb.cards.hung.grid.nomer,dataIndex:"@DokOsnNom",width:70},{text:reference.lang.rsb.cards.hung.grid.naimen,dataIndex:"@DokOsnNaimen",width:110}]},{text:reference.lang.rsb.cards.hung.grid.summPlatDoc,dataIndex:"@SummOpUpl",width:100,renderer:function(b){return Ext.isEmpty(b)?"-":LkIp.Utils.numberConvert(b)}},{text:reference.lang.rsb.cards.hung.grid.naimenBanka,dataIndex:"@NaimBanka",width:140},{text:reference.lang.rsb.cards.hung.grid.nomerScheta,dataIndex:"@NomerScheta",width:180},{text:reference.lang.rsb.cards.hung.grid.tipPl,dataIndex:"@TipPl",width:70},{text:reference.lang.rsb.cards.hung.grid.dataSpisan,dataIndex:"@SrokUpl",width:90,renderer:function(b){return !Ext.isEmpty(b)?LkIp.Utils.getDate(b):""}},{text:reference.lang.rsb.cards.hung.grid.summUplBank,dataIndex:"@SummUplBank",width:110,renderer:function(b){return Ext.isEmpty(b)?"-":LkIp.Utils.numberConvert(b)}},{text:reference.lang.rsb.cards.hung.grid.docOsnPrizIsp,menuDisabled:true,columns:[{text:reference.lang.rsb.cards.hung.grid.data,dataIndex:"@DokOsnPriznIspData",width:100,renderer:function(b){return !Ext.isEmpty(b)?LkIp.Utils.getDate(b):""}},{text:reference.lang.rsb.cards.hung.grid.nomer,dataIndex:"@DokOsnPriznIspNom",width:90},{text:reference.lang.rsb.cards.hung.grid.naimen,dataIndex:"@OrgPrinyavResh",width:150}],listeners:{render:function(){this.setWidth(340)}}}]}]});this.callParent()}},0,["rsbCardsHung"],["component","container","box","rsbCardsHung"],{component:true,container:true,box:true,rsbCardsHung:true},["widget.rsbCardsHung"],[[LkIp.view.Scrolling.prototype.mixinId||LkIp.view.Scrolling.$className,LkIp.view.Scrolling]],[LkIp.view.Rsb.Cards.Hung,"Index"],0));(Ext.cmd.derive("LkIp.view.Rsb.Cards.Operations.Index",Ext.Container,{cls:"rsbCardsOperations iScroll",initComponent:function(){var a=this;Ext.apply(a,{items:[{xtype:"component",name:"rsbCardsTitle",cls:"rsbCardsTitle",tpl:'<div class="pageTitle fl-l">'+reference.lang.rsb.cards.operations.title+'</div><div class="kbkName fl-l">{imyaKbk}</div>',data:{imyaKbk:""}},{cls:"clear"},{xtype:"rsbCardInfo"},{xtype:"component",margin:"15 0",cls:"saldo-block",name:"saldo-block",tpl:'<div class="saldo-info"><div class="title"><span class="label">'+reference.lang.rsb.cards.operations.saldo.label+'</span></div> <div class="field-value"><span class="label">'+reference.lang.rsb.cards.operations.saldo.tax+'</span><span class="text">{tax}</span></div><div class="field-value"><span class="label">'+reference.lang.rsb.cards.operations.saldo.peni+'</span><span class="text">{peni}</span></div><div class="field-value"><span class="label">'+reference.lang.rsb.cards.operations.saldo.penalty+'</span><span class="text">{penalty}</span></div><div class="field-value"><span class="label text-tooltip" name="procent">'+reference.lang.rsb.cards.operations.saldo.procent+'</span><span class="text">{procent}</span></div><div class="field-value"><span class="label text-tooltip" name="procentNo">'+reference.lang.rsb.cards.operations.saldo.procentNo+'</span><span class="text">{procentNo}</span></div></div>',data:{tax:"-",peni:"-",penalty:"-",procent:"-",procentNo:"-"},listeners:{afterrender:function(b){}}},{xtype:"component",html:LkIp.Utils.header(reference.lang.rsb.cards.operations.grid.header,4)},{xtype:"defaultFilterPanel",id:"rsbCardsOperationsFilterPanel",data:[{xtype:"filterSelect",tpl:'<tpl for="."><li class="x-boundlist-item" role="option">{value}</li></tpl>',displayField:"value",labelWidth:300,width:400,name:"year",fieldLabel:reference.lang.rsb.cards.operations.filters.year.label,value:Ext.Date.format(new Date(),"Y"),editable:false,typeAhead:false,disableKeyFilter:false,forceSelection:true,preventMark:true,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"rsbCardsYearStore"},onFocus:function(){var b=this;if(!b.isExpanded){b.expand()}b.getPicker().focus()}},{cls:"clear"},{xtype:"container",layout:"auto",items:[{cls:"first-column fl-l",style:{width:"57%!important"},items:[{xtype:"defaultDateFilter",dateFieldPadding:"5 0 0 0",dateFieldName:"paymentDate",lang:reference.lang.rsb.cards.operations.filters.paymentDate}]},{cls:"second-column fl-l",style:{width:"40%!important"},defaults:{labelWidth:130,width:290,xtype:"filterSelect",tpl:'<tpl for="."><li data-qtip="{qtip}" class="x-boundlist-item" role="option">{value}</li></tpl>',displayField:"value"},items:[{lang:reference.lang.filters.typePayment,name:"typePayment",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"rsbCardsPaymentTypeStore"}},{lang:reference.lang.rsb.cards.operations.filters.accountingPeriod,name:"accountingPeriod",hidden:true,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"rsbCardsAccountingPeriodStore"}}]}]}]},{xtype:"gridtable",margin:"0",id:"rsbCardsOperationsGrid",store:"Rsb.Cards.Operations.GridStore",columns:[{text:reference.lang.rsb.cards.operations.grid.srokUpl,dataIndex:"@SrokUpl",width:100,renderer:function(b){return !Ext.isEmpty(b)?LkIp.Utils.getDate(b):""}},{text:reference.lang.rsb.cards.operations.grid.imyaOp,width:170,dataIndex:"@ImyaOp"},{text:reference.lang.rsb.cards.operations.grid.imyaTipPl,dataIndex:"@ImyaTipPl"},{text:reference.lang.rsb.cards.operations.grid.summOpNach,dataIndex:"@SummOpNach",renderer:function(b){return Ext.isEmpty(b)?"":LkIp.Utils.numberConvert(b)}},{text:reference.lang.rsb.cards.operations.grid.summOpUpl,dataIndex:"@SummOpUpl",renderer:function(b){return Ext.isEmpty(b)?"":LkIp.Utils.numberConvert(b)}},{text:Ext.String.format('<span class="link">{0}</span>',reference.lang.rsb.cards.operations.grid.summRaschOp),dataIndex:"@SummRaschOp",renderer:function(b){return Ext.isEmpty(b)?"":LkIp.Utils.numberConvert(b)},listeners:{afterrender:function(){LkIp.Utils.tooltip(this.getEl(),reference.lang.rsb.cards.operations.grid.summaTtip)}}},{text:reference.lang.rsb.cards.operations.grid.dokumentOcnovanie,menuDisabled:true,columns:[{text:reference.lang.rsb.cards.operations.grid.dokOsnNumber,dataIndex:"DokOsnNumber",sortable:true,width:70},{text:reference.lang.rsb.cards.operations.grid.dokOsnData,dataIndex:"DokOsnData",width:85,renderer:function(b){return !Ext.isEmpty(b)?LkIp.Utils.getDate(b):""},sortable:true},{text:reference.lang.rsb.cards.operations.grid.docOsnNaimen,dataIndex:"DocOsnNaimen",sortable:true,width:135}]},{text:reference.lang.rsb.cards.operations.grid.dataRasch,hidden:true,dataIndex:"@DataRaschOp",width:100,renderer:function(b){return !Ext.isEmpty(b)?LkIp.Utils.getDate(b):""}},{text:reference.lang.rsb.cards.operations.grid.dataNachPeni,hidden:true,dataIndex:"@DataNachPeni",width:100,renderer:function(b){return !Ext.isEmpty(b)?LkIp.Utils.getDate(b):""}},{text:reference.lang.rsb.cards.operations.grid.accountingPeriod,hidden:true,width:180,dataIndex:"DokOsnOtchPeriod",listeners:{show:function(b){this.ownerCt.grid.fireEvent("toggleAccountingPeriodFilter",true)},hide:function(b){this.ownerCt.grid.fireEvent("toggleAccountingPeriodFilter",false)}}},{text:reference.lang.rsb.cards.operations.grid.napravleniePl,hidden:true,dataIndex:"@NaprPlat"},{text:reference.lang.rsb.cards.operations.grid.napravlenieZach,hidden:true,menuDisabled:true,columns:[{text:reference.lang.rsb.cards.operations.grid.zachKbk,hidden:true,dataIndex:"NaprZachKBK",sortable:true,width:130},{text:reference.lang.rsb.cards.operations.grid.zachOkatoOktmo,hidden:true,dataIndex:"NaprZachOKATO_OKTMO",width:100,sortable:true},{text:reference.lang.rsb.cards.operations.grid.zachTipPl,hidden:true,dataIndex:"NaprZachImyaTipPl",width:90,sortable:true}]}]}]});this.callParent()}},0,["rsbCardsOperations"],["component","container","box","rsbCardsOperations"],{component:true,container:true,box:true,rsbCardsOperations:true},["widget.rsbCardsOperations"],[[LkIp.view.Scrolling.prototype.mixinId||LkIp.view.Scrolling.$className,LkIp.view.Scrolling]],[LkIp.view.Rsb.Cards.Operations,"Index"],0));(Ext.cmd.derive("LkIp.view.Rsb.Cards.Debt.Grid",LkIp.view.Default.Grid,{id:"rsbCardsDebtGrid",store:"Rsb.Cards.Debt.GridStore",initComponent:function(){var a=this;Ext.apply(a,{columns:[{text:reference.lang.rsb.cards.debt.grid.spUreg,dataIndex:"@NaimSpUreg",width:100},{text:reference.lang.rsb.cards.debt.grid.osnUreg,dataIndex:"@OsnUreg",flex:1},{text:reference.lang.rsb.cards.debt.grid.upOrgResh,dataIndex:"@UpolnOrg",width:150},{text:reference.lang.rsb.cards.debt.grid.nomerResh,dataIndex:"@NomerResh",width:70},{text:reference.lang.rsb.cards.debt.grid.dataResh,dataIndex:"@DataResh",width:100,renderer:function(b){return !Ext.isEmpty(b)?LkIp.Utils.getDate(b):""}},{text:reference.lang.rsb.cards.debt.grid.nomerZayavl,dataIndex:"@NomerZayavl",width:80},{text:reference.lang.rsb.cards.debt.grid.dataZayavl,dataIndex:"@DataZayavl",width:100,renderer:function(b){return !Ext.isEmpty(b)?LkIp.Utils.getDate(b):""}},{text:reference.lang.rsb.cards.debt.grid.summaResh,dataIndex:"@SummaResh",width:100,renderer:function(b){return !Ext.isEmpty(b)?LkIp.Utils.numberConvert(b):""}},{text:reference.lang.rsb.cards.debt.grid.summaOstResh,dataIndex:"@OstSummaResh",width:100,renderer:function(b){return !Ext.isEmpty(b)?LkIp.Utils.numberConvert(b):""}}]});this.callParent(arguments)}},0,["rsbCardsDebtGridIndex"],["rsbCardsDebtGridIndex","panel","gridtable","component","tablepanel","container","grid","box","gridpanel"],{rsbCardsDebtGridIndex:true,panel:true,gridtable:true,component:true,tablepanel:true,container:true,grid:true,box:true,gridpanel:true},["widget.rsbCardsDebtGridIndex"],0,[LkIp.view.Rsb.Cards.Debt,"Grid"],0));(Ext.cmd.derive("LkIp.view.Rsb.Cards.Debt.Index",Ext.Container,{cls:"rsbCards iScroll",initComponent:function(){var a=this;Ext.apply(a,{items:[{xtype:"component",name:"rsbCardsTitle",cls:"rsbCardsTitle",tpl:'<div class="pageTitle">'+reference.lang.rsb.cards.debt.title+'</div><div class="kbkName">{imyaKbk}</div>',data:{imyaKbk:""}},{cls:"clear"},{xtype:"rsbCardInfo"},{xtype:"component",html:LkIp.Utils.header(reference.lang.rsb.cards.debt.grid.title,4),margin:"15 0"},{xtype:"defaultFilterPanel",id:"rsbCardsDebtFilterPanel",data:[{cls:"first-column fl-l",items:[{xtype:"filterSelect",labelWidth:200,width:400,lang:reference.lang.filters.settlementMode,tpl:'<tpl for="."><tpl if="code &gt; 0"><li data-qtip="{name}" data-qclass="qtip-resize" class="x-boundlist-item" role="option">{value}</li></tpl><tpl if="code == 0"><li class="x-boundlist-item" role="option">{value}</li></tpl></tpl>',displayField:"value",name:"settlementMode",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"rsbCardsSettlementModeStore"}}]},{cls:"second-column fl-l",items:[{xtype:"filterSelect",lang:reference.lang.filters.settlementReason,tpl:'<tpl for="."><tpl if="code &gt; 0"><li data-qtip="{name}" data-qclass="qtip-resize" class="x-boundlist-item" role="option">{value}</li></tpl><tpl if="code == 0"><li class="x-boundlist-item" role="option">{value}</li></tpl></tpl>',displayField:"value",name:"settlementReason",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"rsbCardsSettlementReasonStore"},labelWidth:200,width:480}]}]},{xtype:"rsbCardsDebtGridIndex"},{xtype:"button",text:reference.lang.rsb.cards.debt.buttons.contentDecision,rel:"showDecisionContent",disabled:"true"}]});this.callParent()}},0,["rsbCardsDebt"],["rsbCardsDebt","component","container","box"],{rsbCardsDebt:true,component:true,container:true,box:true},["widget.rsbCardsDebt"],[[LkIp.view.Scrolling.prototype.mixinId||LkIp.view.Scrolling.$className,LkIp.view.Scrolling]],[LkIp.view.Rsb.Cards.Debt,"Index"],0));(Ext.cmd.derive("LkIp.view.Rsb.Cards.Debt.Objects.DecisionInfo",Ext.Container,{decisionTpl:'<table class="describe-table decision-info"><tbody><tr><th colspan="4">'+reference.lang.rsb.cards.debt.object.decisionInfo.title+'</th> </tr><tr class="no-border"><td class="small-column"><span class="label">'+reference.lang.rsb.cards.debt.object.decisionInfo.spUreg+'</span></td><td class="border-column"><span class="text">{spUreg}</span></td><td class="small-column"><span class="label">'+reference.lang.rsb.cards.debt.object.decisionInfo.osnUreg+'</span></td><td><span class="text">{osnUreg}</span></td></tr><tr class="no-border"><td class="small-column"><span class="label">'+reference.lang.rsb.cards.debt.object.decisionInfo.infoDoc+'</span></td><td class="border-column"><span class="text">{infoDoc}</span></td><td class="small-column"><span class="label">'+reference.lang.rsb.cards.debt.object.decisionInfo.protsKred+'</span></td><td><span class="text">{protsKred}</span></td></tr><tr class="no-border"><td class="small-column"><span class="label">'+reference.lang.rsb.cards.debt.object.decisionInfo.upOrgResh+'</span></td><td class="border-column"><span class="text">{upOrgResh}</span></td><td class="small-column"><span class="label">'+reference.lang.rsb.cards.debt.object.decisionInfo.infoZayavl+'</span></td><td><span class="text">{infoZayavl}</span></td></tr></tbody></table> ',initComponent:function(){Ext.apply(this,{items:[{xtype:"component",tpl:this.decisionTpl,name:"rsbDebtObjTpl",data:{spUreg:"-",osnUreg:"-",infoDoc:"-",protsKred:"-",upOrgResh:"-",infoZayavl:"-",urBuydj:"-"}}]});this.callParent()}},0,["rsbDebtDecisionInfo"],["component","container","rsbDebtDecisionInfo","box"],{component:true,container:true,rsbDebtDecisionInfo:true,box:true},["widget.rsbDebtDecisionInfo"],0,[LkIp.view.Rsb.Cards.Debt.Objects,"DecisionInfo"],0));(Ext.cmd.derive("LkIp.view.Rsb.Cards.Debt.Objects.ObjectsInfo",Ext.Container,{cls:"rsbCards iScroll",data:[],initComponent:function(){var a=this;Ext.apply(a,{items:[{xtype:"component",name:"summInfo",tpl:this.summTpl,data:this.data}]});this.callParent()},summTpl:'<table class="describe-table no-border decision-info"><tbody><tr><td style="width: 40%;"><span class="label">'+reference.lang.rsb.cards.debt.object.objectInfo.summa+':</span></td><td><span class="text">{summa}</span></td></tr><tr><td><span class="label">'+reference.lang.rsb.cards.debt.object.objectInfo.unpaidSumm+':</span></td><td><span class="text">{unpaidSumma}</span></td></tr><tr><td><span class="label">'+reference.lang.rsb.cards.debt.object.objectInfo.period+':</span></td><td><span class="text">{period}</span></td></tr></tbody></table> '},0,["rsbCardsDebtObjectsInfo"],["component","container","box","rsbCardsDebtObjectsInfo"],{component:true,container:true,box:true,rsbCardsDebtObjectsInfo:true},["widget.rsbCardsDebtObjectsInfo"],[[LkIp.view.Scrolling.prototype.mixinId||LkIp.view.Scrolling.$className,LkIp.view.Scrolling]],[LkIp.view.Rsb.Cards.Debt.Objects,"ObjectsInfo"],0));(Ext.cmd.derive("LkIp.view.Rsb.Cards.Debt.Objects.Index",Ext.Container,{cls:"rsbCardsDebtObject iScroll",initComponent:function(){var a=this;Ext.apply(a,{items:[{xtype:"component",name:"rsbCardsTitle",cls:"rsbCardsTitle",tpl:'<div class="pageTitle">'+reference.lang.rsb.cards.debt.title+'</div><div class="kbkName">{imyaKbk}</div>',data:{imyaKbk:""}},{cls:"clear"},{xtype:"rsbCardInfo"},{xtype:"rsbDebtDecisionInfo",margin:"15 0"},{xtype:"component",id:"backToDebt",html:reference.lang.rsb.cards.debt.object.backToDebt},{xtype:"tabpanel",cls:"tabs-block tabs-block-border-bottom",id:"debtObjectTabPanel",margin:"15 0 0",plain:true,activeTab:5,hidden:true,items:[{title:reference.lang.rsb.cards.debt.object.tabs.tax,type:"tab",vidPl:1,itemId:"tax",xtype:"rsbCardsDebtObjectsInfo",disabled:true},{title:reference.lang.rsb.cards.debt.object.tabs.penni,type:"tab",vidPl:2,itemId:"penni",xtype:"rsbCardsDebtObjectsInfo",disabled:true},{title:reference.lang.rsb.cards.debt.object.tabs.penalty,type:"tab",vidPl:3,itemId:"penalty",xtype:"rsbCardsDebtObjectsInfo",disabled:true},{title:reference.lang.rsb.cards.debt.object.tabs.percent,type:"tab",vidPl:4,itemId:"percent",xtype:"rsbCardsDebtObjectsInfo",disabled:true}]},{xtype:"container",itemId:"mainGridBlock",hidden:true,items:[{xtype:"defaultFilterPanel",id:"debtObjectFilterPanel",data:[{cls:"first-column fl-l",items:[{labelWidth:120,width:400,xtype:"filterSelect",lang:reference.lang.filters.paymentDate,tpl:'<tpl for="."><tpl if="code &gt; 0"><li data-qtip="{name}" data-qclass="qtip-resize" class="x-boundlist-item" role="option">{value}</li></tpl><tpl if="code == 0"><li class="x-boundlist-item" role="option">{value}</li></tpl></tpl>',displayField:"value",name:"paymentDate",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"debtObjectPaymentDateStore",data:[{code:"0",value:reference.lang.filters.paymentDate.value.all},{code:"1",value:reference.lang.filters.paymentDate.value.already},{code:"2",value:reference.lang.filters.paymentDate.value.future}]}}]}]},{xtype:"component",html:LkIp.Utils.header(reference.lang.rsb.cards.debt.object.titleBeforeMainGrid,4),margin:"15 0 0 0"},{xtype:"container",cls:"grid-with-status-bar two-rows",items:[{xtype:"gridStatusBar",tabBar:{layout:{type:"hbox",align:"stretch"},defaults:{flex:1,height:64},height:65},page:"DebtObject",data:[{title:reference.lang.rsb.cards.debt.object.statusBar.graphDebt,itemId:"tab-graph-debt"},{title:reference.lang.rsb.cards.debt.object.statusBar.graphPercent,itemId:"tab-graph-percent"},{title:reference.lang.rsb.cards.debt.object.statusBar.infoWriteOff,itemId:"tab-info-write-off"}]},{xtype:"gridtable",itemId:"graphDebtPercentGrid",store:"Rsb.Cards.Debt.Object.GraphDebtPercent.GridStore",height:350,pageSize:10,columns:[{text:reference.lang.rsb.cards.debt.object.gridGraphDebtPercent.srokUpl,dataIndex:"@SrokUpl",flex:1,renderer:function(b){return !Ext.isEmpty(b)?LkIp.Utils.getDate(b):""}},{text:reference.lang.rsb.cards.debt.object.gridGraphDebtPercent.summPlat,menuDisabled:true,columns:[{text:reference.lang.rsb.cards.debt.object.gridGraphDebtPercent.vsego,dataIndex:"@SummaPlat",width:150,renderer:function(b){return !Ext.isEmpty(b)?LkIp.Utils.numberConvert(b):""}},{text:reference.lang.rsb.cards.debt.object.gridGraphDebtPercent.uplacheno,dataIndex:"@SummaUplPlat",width:150,renderer:function(b){return !Ext.isEmpty(b)?LkIp.Utils.numberConvert(b):""}},{text:reference.lang.rsb.cards.debt.object.gridGraphDebtPercent.ostatok,dataIndex:"@OstKUplate",width:150,renderer:function(b){return !Ext.isEmpty(b)?LkIp.Utils.numberConvert(b):""}}]}]},{xtype:"gridtable",itemId:"graphWriteOffGrid",store:"Rsb.Cards.Debt.Object.GraphWriteOff.GridStore",height:350,columns:[{text:reference.lang.rsb.cards.debt.object.gridGraphWriteOff.summaSpis,dataIndex:"@SummaZadolj",width:150,renderer:function(b){return !Ext.isEmpty(b)?LkIp.Utils.numberConvert(b):""}},{text:reference.lang.rsb.cards.debt.object.gridGraphWriteOff.nomerDok,dataIndex:"@NomerDok",width:150},{text:reference.lang.rsb.cards.debt.object.gridGraphWriteOff.dataDok,dataIndex:"@DataDok",width:150,renderer:function(b){return !Ext.isEmpty(b)?LkIp.Utils.getDate(b):""}},{text:reference.lang.rsb.cards.debt.object.gridGraphWriteOff.osnDok,dataIndex:"@OsnSpisZadolj",flex:1}]}]},{xtype:"container",itemId:"subGridBlock",hidden:true,items:[{xtype:"component",html:LkIp.Utils.header(reference.lang.rsb.cards.debt.object.titleBeforeSubGrid,4),margin:"15 0 0 0"},{xtype:"gridtable",itemId:"graphInfoGrid",store:"Rsb.Cards.Debt.Object.GraphInfo.GridStore",height:350,columns:[{text:reference.lang.rsb.cards.debt.object.gridGraphInfo.platDok,menuDisabled:true,columns:[{text:reference.lang.rsb.cards.debt.object.gridGraphInfo.nomerDok,dataIndex:"@NomerDok",width:150},{text:reference.lang.rsb.cards.debt.object.gridGraphInfo.dataDok,dataIndex:"@DataDok",width:150,renderer:function(b){return !Ext.isEmpty(b)?LkIp.Utils.getDate(b):""}}]},{text:reference.lang.rsb.cards.debt.object.gridGraphInfo.summaPlat,dataIndex:"@SummaPlat",width:150,renderer:function(b){return !Ext.isEmpty(b)?LkIp.Utils.numberConvert(b):""}},{text:reference.lang.rsb.cards.debt.object.gridGraphInfo.naimDok,dataIndex:"@NaimDok",flex:1}]}]}]}]});this.callParent()}},0,["rsbCardsDebtObj"],["component","container","box","rsbCardsDebtObj"],{component:true,container:true,box:true,rsbCardsDebtObj:true},["widget.rsbCardsDebtObj"],[[LkIp.view.Scrolling.prototype.mixinId||LkIp.view.Scrolling.$className,LkIp.view.Scrolling]],[LkIp.view.Rsb.Cards.Debt.Objects,"Index"],0));(Ext.cmd.derive("LkIp.view.Rsb.Cards.Budget.Index",Ext.Container,{cls:"rsbCardsBudget iScroll",initComponent:function(){var a=this;Ext.apply(a,{items:[{xtype:"component",name:"rsbCardsTitle",cls:"rsbCardsTitle",tpl:'<div class="pageTitle">'+reference.lang.rsb.cards.budget.title+'</div><div class="kbkName">{imyaKbk}</div>',data:{imyaKbk:""}},{cls:"clear"},{xtype:"rsbCardInfo"},{xtype:"treepanel",id:"rsbCardsBudgetGrid",cls:"tree-grid border-table",sortableColumns:false,useArrows:true,rootVisible:false,singleExpand:false,enableColumnMove:false,columnLines:true,rowLines:true,store:{extend:"Ext.data.TreeStore",model:"LkIp.model.Rsb.Budget",autoDestroy:true,storeId:"cardsBudgetGridStore",reader:{type:"json",root:"children"},root:{children:[]}},viewConfig:{getRowClass:function(b){var c=["TekuschPlat"];return !b.get("leaf")||Ext.Array.contains(c,b.get("defaultNodeKey"))?"bold-row":""}},columns:{defaults:{align:"right",renderer:function(b){b=Ext.isEmpty(b)?0:b;return LkIp.Utils.numberConvert(b)}},items:[{xtype:"treecolumn",text:reference.lang.rsb.cards.budget.headers.name,dataIndex:"name",align:"left",width:300,renderer:function(b){return b}},{text:LkIp.Utils.rouble(reference.lang.rsb.cards.budget.headers.total),flex:1,dataIndex:"@Vsego"},{text:LkIp.Utils.rouble(reference.lang.rsb.cards.budget.headers.tax),flex:1,dataIndex:"@Nalog"},{text:LkIp.Utils.rouble(reference.lang.rsb.cards.budget.headers.penni),flex:1,dataIndex:"@Peni"},{text:LkIp.Utils.rouble(reference.lang.rsb.cards.budget.headers.penalty),flex:1,dataIndex:"@SHtrafyi",hidden:true},{text:LkIp.Utils.rouble(reference.lang.rsb.cards.budget.headers.percent),flex:1,dataIndex:"@Protsentyi",hidden:true},{text:LkIp.Utils.rouble(reference.lang.rsb.cards.budget.headers.percentAdditional),flex:1,dataIndex:"@ProtsentyiZaPolzByudjSr",hidden:true}]}},{margin:"15 0 0 0",xtype:"component",name:"goToOperationsButton",tpl:'<a href="#!/rsb/cards/operations?{fidCard}" class="simple-button">'+reference.lang.rsb.cards.budget.operationsButton+"</a>",data:{fidCard:""}}]});this.callParent()}},0,["rsbCardsBudget"],["rsbCardsBudget","component","container","box"],{rsbCardsBudget:true,component:true,container:true,box:true},["widget.rsbCardsBudget"],[[LkIp.view.Scrolling.prototype.mixinId||LkIp.view.Scrolling.$className,LkIp.view.Scrolling]],[LkIp.view.Rsb.Cards.Budget,"Index"],0));(Ext.cmd.derive("LkIp.view.Rsb.Overpayment.Grid",LkIp.view.Default.Grid,{itemId:"rsbOverpaymentGrid",store:"Rsb.Overpayment.GridStore",ttipTpl:'<span class="text-tooltip">{0}</span>',initComponent:function(){var a=this;Ext.apply(a,{columns:[{text:reference.lang.rsb.overpayment.grid.kodNO,dataIndex:"@KodNO",width:85,renderer:function(b){return Ext.isEmpty(b)?"":LkIp.Utils.noRenderer(b)}},{text:reference.lang.rsb.overpayment.grid.naimenKBK,dataIndex:"@ImyaKBK",width:200},{text:reference.lang.rsb.overpayment.grid.kodKBK,dataIndex:"@KodKBK",width:170},{text:reference.lang.rsb.overpayment.grid.oKATO_OKTMO,dataIndex:"@OKATO_OKTMO",width:105},{text:reference.lang.rsb.overpayment.grid.tipPl,dataIndex:"@TipPlNaim",width:70},{text:Ext.String.format(this.ttipTpl,reference.lang.rsb.overpayment.grid.summa),dataIndex:"@Summa",width:130,renderer:function(b){return LkIp.Utils.numberConvert(b)},listeners:{afterrender:function(){LkIp.Utils.tooltip(this.getEl(),reference.lang.rsb.overpayment.grid.summaTtip)}}},{text:Ext.String.format(this.ttipTpl,reference.lang.rsb.overpayment.grid.summaPeresch),width:130,dataIndex:"@SummaPeresch",renderer:function(b){return LkIp.Utils.numberConvert(b)},listeners:{afterrender:function(){LkIp.Utils.tooltip(this.getEl(),reference.lang.rsb.overpayment.grid.summaPereschTtip)}}},{text:reference.lang.rsb.overpayment.grid.statusIP,dataIndex:"@KodStatus",width:100,hidden:true,renderer:function(d,c,b){c.tdAttr='data-qtip="'+b.get("@Status")+'"';return d}}]});this.callParent(arguments)},getRowClass:function(a){var b=a.get("@SummaPeresch");if(Ext.isEmpty(b)||b==0){return"disabled-row"}}},0,["rsbOverpaymentGridIndex"],["panel","rsbOverpaymentGridIndex","gridtable","component","tablepanel","container","grid","box","gridpanel"],{panel:true,rsbOverpaymentGridIndex:true,gridtable:true,component:true,tablepanel:true,container:true,grid:true,box:true,gridpanel:true},["widget.rsbOverpaymentGridIndex"],0,[LkIp.view.Rsb.Overpayment,"Grid"],0));(Ext.cmd.derive("LkIp.view.Rsb.Overpayment.Index",Ext.Container,{cls:"rsbOverpayment iScroll",initComponent:function(){var b=this,a=[];if(!LkIp.User.isInspectorWithCodeNO()){a.push({lang:reference.lang.filters.no,name:"codeNO",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"rsbOverpaymentNoStore"}})}a.push({lang:reference.lang.filters.kbk,name:"kbk",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"rsbOverpaymentKbkStore"}},{lang:reference.lang.filters.statusIP,name:"statusIP",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"rsbOverpaymentStatusIPStore"}});Ext.apply(b,{items:[{xtype:"note",text:reference.lang.rsb.overpayment.pageInfo,style:{marginTop:"0px !important"}},{xtype:"component",html:LkIp.Utils.header(reference.lang.pages.instruction,3),margin:"15 0 0 0"},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"1",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.rsb.overpayment.instruction.step1},{xtype:"component",html:"<p>"+reference.lang.rsb.overpayment.instruction.step1Description+"</p>"},{xtype:"component",html:LkIp.Utils.header(reference.lang.rsb.overpayment.grid.title,4),margin:"15 0"},{xtype:"defaultFilterPanel",id:"rsbOverpaymentFilterPanel",data:[{cls:"first-column fl-l",defaults:{labelWidth:140,width:400,xtype:"filterSelect"},items:a},{cls:"second-column fl-l",defaults:{xtype:"filterSelect",tpl:'<tpl for="."><tpl if="code &gt; 0"><li data-qtip="{name}" data-qclass="qtip-resize" class="x-boundlist-item" role="option">{value}</li></tpl><tpl if="code == 0"><li class="x-boundlist-item" role="option">{value}</li></tpl></tpl>',displayField:"value",labelWidth:100,width:300},items:[{lang:reference.lang.filters.typePayment,name:"typePayment",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"rsbOverpaymentTypePaymentStore"}}]}]},{xtype:"rsbOverpaymentGridIndex",margin:"0 0 15 0"},LkIp.User.isActiveUser()||LkIp.User.isInspector()?{xtype:"button",disabled:true,name:"rsbOverpaymentStatementButton",text:reference.lang.rsb.overpayment.statementButton}:{cls:"display-none"}]}]}]});this.callParent()}},0,["rsbOverpayment"],["component","container","rsbOverpayment","box"],{component:true,container:true,rsbOverpayment:true,box:true},["widget.rsbOverpayment"],[[LkIp.view.Scrolling.prototype.mixinId||LkIp.view.Scrolling.$className,LkIp.view.Scrolling]],[LkIp.view.Rsb.Overpayment,"Index"],0));(Ext.cmd.derive("LkIp.view.Rsb.Overpayment.StatusGrid",LkIp.view.Default.Grid,{itemId:"overpaymentStatusGrid",store:"Rsb.Overpayment.StatusStore",initComponent:function(){var a=this;Ext.apply(a,{columns:[{text:reference.lang.rsb.overpayment.status.grid.fio,dataIndex:"@Imya",width:300},{text:reference.lang.rsb.overpayment.status.grid.summ,dataIndex:"@SummPereplat",width:200},{text:reference.lang.rsb.overpayment.status.grid.date,dataIndex:"@DataOznakomleniya",width:250}]});this.callParent(arguments)}},0,["overpaymentStatusGrid"],["panel","gridtable","component","tablepanel","container","overpaymentStatusGrid","grid","box","gridpanel"],{panel:true,gridtable:true,component:true,tablepanel:true,container:true,overpaymentStatusGrid:true,grid:true,box:true,gridpanel:true},["widget.overpaymentStatusGrid"],0,[LkIp.view.Rsb.Overpayment,"StatusGrid"],0));(Ext.cmd.derive("LkIp.view.Rsb.Overpayment.Status",Ext.Container,{cls:"overpaymentStatus iScroll",initComponent:function(){var a=this;Ext.apply(a,{items:[{xtype:"defaultFilterPanel",id:"rsbOverpaymentStatusFilters",data:[{xtype:"defaultDateFilter",dateFieldName:"date",iWidth:400,labelWidth:150,shortWidth:300,lang:reference.lang.rsb.overpayment.status.date,dateInnerFieldsMargin:"2 0 0 5"}]},{xtype:"overpaymentStatusGrid",margin:"15 0 0 0"}]});this.callParent()}},0,["overpaymentStatus"],["component","container","overpaymentStatus","box"],{component:true,container:true,overpaymentStatus:true,box:true},["widget.overpaymentStatus"],[[LkIp.view.Scrolling.prototype.mixinId||LkIp.view.Scrolling.$className,LkIp.view.Scrolling]],[LkIp.view.Rsb.Overpayment,"Status"],0));(Ext.cmd.derive("LkIp.view.Envd.Form",Ext.Container,{layout:{type:"auto"},cls:"envd-form",required:'<span class="form-required-field" data-qtip="'+reference.lang.form.required+'">*</span>',margin:"10 0 0",initComponent:function(){var a=LkIp.Utils.getNowDate();Ext.apply(this,{items:[{xtype:"checkboxgroup",cls:"checkbox-group",labelWidth:500,labelAlign:"top",labelPad:"10",vertical:true,columns:1,columnWidth:"100%",fieldLabel:reference.lang.envd.form.chooseDocuments,labelCls:"fieldset-title",hidden:true,items:[{boxLabel:this.lang.mainFile,name:"mainFile",checked:true,readOnly:true}]},{xtype:"component",cls:"fieldset-title",html:reference.lang.envd.form.fillMissParts,margin:"0 0 10"},{xtype:"container",cls:"field-container",defaults:{width:650,labelWidth:400,padding:"10 0 0"},items:[{xtype:"displayfield",name:"fullName",submitValue:true,fieldLabel:reference.lang.envd.form.fio,value:LkIp.User.get("fullName")},{xtype:"displayfield",name:"inn",submitValue:true,fieldLabel:reference.lang.envd.form.inn,value:LkIp.User.get("inn")},{xtype:"displayfield",name:"ogrnip",submitValue:true,fieldLabel:reference.lang.envd.form.ogrnip,value:LkIp.User.get("ogrn")},{xtype:"displayfield",name:"date",submitValue:true,fieldLabel:reference.lang.envd.form.date,value:a},{xtype:"filterSelect",name:"no",itemId:"no",allowBlank:false,displayField:"fullName",tpl:'<tpl for="."><tpl if="code != 0"><li data-qtip="{qtip}" class="x-boundlist-item" role="option">{fullName}</li></tpl><tpl if="code == 0"><li class="x-boundlist-item" role="option">{value}</li></tpl></tpl>',fieldLabel:reference.lang.envd.form.no,afterLabelTextTpl:this.required,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"envdNoStore-"+this.type}},{xtype:"filterSelect",hidden:true,itemId:"reasonDeregistration",name:"reasonDeregistration",allowBlank:false,disabled:true,fieldLabel:reference.lang.envd.form.reasonDeregistration,afterLabelTextTpl:this.required,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"envdReasonDeregistrationStore"}},{xtype:"filterDate",name:"dateTax",hidden:false,allowBlank:false,fieldLabel:new Ext.Template(reference.lang.envd.form.dateTax).apply(this.lang),maxValue:a,value:a,afterLabelTextTpl:this.required,width:550},{xtype:"textfield",hidden:true,itemId:"email",vtype:"email",name:"email",allowBlank:false,disabled:true,fieldLabel:reference.lang.envd.form.email,afterLabelTextTpl:this.required},{xtype:"container",margin:"0 0 5",width:"100%",items:[{xtype:"component",width:400,html:reference.lang.envd.form.addActivityInfo+this.required,cls:"activity-info-label fl-l fieldset-title"},{cls:"clear"},{xtype:"container",itemId:"activityContainer"},{cls:"clear"},{xtype:"button",margin:"15 0 0",itemId:"addActivity",componentCls:"fl-l",html:reference.lang.envd.form.addActivityBtn}]}]}]});this.callParent()}},0,["envdForm"],["envdForm","component","container","box"],{envdForm:true,component:true,container:true,box:true},["widget.envdForm"],0,[LkIp.view.Envd,"Form"],0));(Ext.cmd.derive("LkIp.view.Envd.Layout",Ext.Container,{layout:{type:"auto"},cls:"envd-layout",initComponent:function(){var a=new Ext.Template(reference.lang.envd.note);Ext.apply(this,{items:[{xtype:"form",itemId:"envd-form-"+this.type,items:[{xtype:"component",tpl:"<p>"+reference.lang.envd.pageInfo+"</p>",data:this.lang},{xtype:"container",layout:{type:"auto"},margin:"20 0 0 0",items:[{xtype:"component",html:LkIp.Utils.header(reference.lang.pages.instruction,3),cls:"fl-l"},{xtype:"component",cls:"fl-r individual-help-link",html:reference.lang.envd.help}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"1",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.pages.steps.step1Statement},{xtype:"envdForm",lang:this.lang,type:this.type}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"2",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.envd.step2},{xtype:"component",html:"<p>"+reference.lang.envd.step2Description+"</p>"}]},{xtype:"container",layout:"hbox",defaults:{xtype:"button",formBind:true},items:[{name:"envdShowButton",text:reference.lang.buttons.pdf},{margin:"0 0 0 15",rel:"submit",name:"envdSignButton",formBind:true,disabled:true,text:reference.lang.buttons.signSend}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"3",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.pages.steps.step3Statement},{xtype:"component",html:"<p>"+reference.lang.pages.steps.step3DescriptionStatement+"</p>"}]}]}]}]});this.callParent()}},0,["envdLayout"],["envdLayout","component","container","box"],{envdLayout:true,component:true,container:true,box:true},["widget.envdLayout"],0,[LkIp.view.Envd,"Layout"],0));(Ext.cmd.derive("LkIp.view.Envd.Registration.Index",Ext.Container,{cls:"envdRegistration iScroll",initComponent:function(){var a=this;Ext.apply(a,{items:{xtype:"envdLayout",lang:reference.lang.envd.registration,type:"registration"}});this.callParent()}},0,["envdRegistration"],["component","container","envdRegistration","box"],{component:true,container:true,envdRegistration:true,box:true},["widget.envdRegistration"],[[LkIp.view.Scrolling.prototype.mixinId||LkIp.view.Scrolling.$className,LkIp.view.Scrolling]],[LkIp.view.Envd.Registration,"Index"],0));(Ext.cmd.derive("LkIp.view.Envd.Deregistration.Index",Ext.Container,{cls:"envdDeregistration iScroll",initComponent:function(){var a=this;Ext.apply(a,{items:{xtype:"envdLayout",lang:reference.lang.envd.deregistration,type:"deregistration"}});this.callParent()}},0,["envdDeregistration"],["component","container","envdDeregistration","box"],{component:true,container:true,envdDeregistration:true,box:true},["widget.envdDeregistration"],[[LkIp.view.Scrolling.prototype.mixinId||LkIp.view.Scrolling.$className,LkIp.view.Scrolling]],[LkIp.view.Envd.Deregistration,"Index"],0));(Ext.cmd.derive("LkIp.view.Default.PageMenu",Ext.Container,{cls:"iScroll",initComponent:function(){var a=[];Ext.Array.each(this.data,function(c,b){c.description=c.description||"";if((b%2)==0){a.push({xtype:"component",cls:"first-column fl-l menuItem",html:'<a class="'+(Ext.isEmpty(c.href)?"link not-active-link":"link")+(!Ext.isEmpty(c.cls)?" "+c.cls:"")+'" '+(!Ext.isEmpty(c.href)?'href="'+c.href+'"':"")+">"+c.title+'</a><div class="description">'+c.description+"</div>"})}else{a.push({xtype:"component",cls:"second-column fl-l menuItem",html:'<a class="'+(Ext.isEmpty(c.href)?"link not-active-link":"link")+(!Ext.isEmpty(c.cls)?" "+c.cls:"")+'" '+(!Ext.isEmpty(c.href)?'href="'+c.href+'"':"")+">"+c.title+'</a><div class="description">'+c.description+"</div>"});a.push({cls:"clear"})}});Ext.apply(this,{items:[{xtype:"component",html:this.title},{xtype:"container",cls:"pageMenu",id:this.page+"PageMenu",items:a}]});this.callParent(arguments)}},0,["pageMenu"],["component","container","pageMenu","box"],{component:true,container:true,pageMenu:true,box:true},["widget.pageMenu"],[[LkIp.view.Scrolling.prototype.mixinId||LkIp.view.Scrolling.$className,LkIp.view.Scrolling]],[LkIp.view.Default,"PageMenu"],0));(Ext.cmd.derive("LkIp.view.Rsb.Clarify.Index",Ext.Container,{cls:"clarify iScroll",initComponent:function(){var a=[];a.push({title:reference.lang.pages.rsb.clarify.unexpay.title,href:"#!/rsb/unexpay"},{title:reference.lang.rsb.clarify.other.title,componentCls:LkIp.User.isActiveUser()?"":"not-active-link certificate-tooltip",href:LkIp.User.isActiveUser()?"#!/rsb/clarify/other":"#"});Ext.apply(this,{items:[{xtype:"pageMenu",title:reference.lang.rsb.clarify.header,page:"clarify",data:a}]});this.callParent(arguments)}},0,["clarify"],["component","container","clarify","box"],{component:true,container:true,clarify:true,box:true},["widget.clarify"],[[LkIp.view.Scrolling.prototype.mixinId||LkIp.view.Scrolling.$className,LkIp.view.Scrolling]],[LkIp.view.Rsb.Clarify,"Index"],0));(Ext.cmd.derive("LkIp.view.Rsb.Clarify.Unexpay.Grid",LkIp.view.Default.Grid,{id:"rsbUnexpayGrid",store:"Rsb.Clarify.Unexpay.GridStore",ttipTpl:'<span class="text-tooltip">{0}</span>',errorTpl:'<span class="error-cell-value">{0}</span>',initComponent:function(){var a=this;Ext.apply(a,{columns:[{text:"",locked:true,dataIndex:"@EstUvedoml",sortable:false,width:37,align:"center",draggable:false,renderer:function(d,e,b){var c="",f=b.get("@EstUvedoml");if(!Ext.isEmpty(b.get("@UvedomlDokFid"))){c='<span class="exclamation-cell"></span>';if(0==f){e.tdAttr='data-qtip="'+reference.lang.rsb.clarify.unexpay.uvedoml0+'"'}else{if(0<f){e.tdAttr='data-qtip="'+reference.lang.rsb.clarify.unexpay.uvedoml1+'"'}}}else{e.tdAttr='data-qtip="'+reference.lang.rsb.clarify.unexpay.uvedomlNull+'"'}return c}},{text:reference.lang.rsb.clarify.unexpay.grid.platDokNomer,dataIndex:"@PlatDokNomer",locked:true,width:70},{text:reference.lang.rsb.clarify.unexpay.grid.platDokData,locked:true,dataIndex:"@PlatDokData",width:100,renderer:function(b){return !Ext.isEmpty(b)?LkIp.Utils.getDate(b):""}},{text:reference.lang.rsb.clarify.unexpay.grid.platDokSumma,locked:true,dataIndex:"@PlatDokSumma",width:150,renderer:function(b){return Ext.isEmpty(b)?"":LkIp.Utils.numberConvert(b)}},{text:reference.lang.rsb.clarify.unexpay.grid.platDokName,dataIndex:"@PlatDokName",width:150,renderer:function(b){if(!Ext.isEmpty(b)){return LkIp.Utils.ucfirst(b)}return""}},{text:reference.lang.rsb.clarify.unexpay.grid.platDokINNPlat,dataIndex:"@PlatDokINNPlat",width:100},{text:reference.lang.rsb.clarify.unexpay.grid.platDokNaimenPlat,dataIndex:"@PlatDokNaimenPlat",width:200},{text:reference.lang.rsb.clarify.unexpay.grid.platDokINNPol,dataIndex:"@PlatDokINNPol",width:100,renderer:function(c,d,b){c=c||"-";if(Ext.Array.contains(b.get("@PrichNePlat"),"08")||Ext.Array.contains(b.get("@PrichNePlat"),"10")){return Ext.String.format(a.errorTpl,c)}else{return c}}},{text:reference.lang.rsb.clarify.unexpay.grid.platDokKPPPol,dataIndex:"@PlatDokKPPPol",width:100,renderer:function(c,d,b){c=c||"-";if(Ext.Array.contains(b.get("@PrichNePlat"),"09")||Ext.Array.contains(b.get("@PrichNePlat"),"10")){return Ext.String.format(a.errorTpl,c)}else{return c}}},{text:reference.lang.rsb.clarify.unexpay.grid.platDokNaimenPol,dataIndex:"@PlatDokNaimenPol",width:200},{text:reference.lang.rsb.clarify.unexpay.grid.platDokStatusPlat,dataIndex:"@PlatDokStatusPlat",width:150,renderer:function(d,c,b){c.tdAttr='data-qtip="'+b.get("@PlatDokNaimenStatusPlat")+'"';if(Ext.Array.contains(b.get("@PrichNePlat"),"15")){return Ext.String.format(a.errorTpl,d)}else{return d}}},{text:reference.lang.rsb.clarify.unexpay.grid.platDokKBK,dataIndex:"@PlatDokKBK",width:170,renderer:function(d,e,b){var c=b.get("@PlatDokNaimenKBK");if(d===c){c="\u041d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e \u043d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435 \u043d\u0430\u043b\u043e\u0433\u0430"}e.tdAttr='data-qtip="'+c+'"';d=d||"-";if(Ext.Array.contains(b.get("@PrichNePlat"),"01")||Ext.Array.contains(b.get("@PrichNePlat"),"02")||Ext.Array.contains(b.get("@PrichNePlat"),"13")||Ext.Array.contains(b.get("@PrichNePlat"),"14")){return Ext.String.format(a.errorTpl,d)}else{return d}}},{text:reference.lang.rsb.clarify.unexpay.grid.platDokOKATO_OKTMO,dataIndex:"@PlatDokOKATO_OKTMO",width:150,renderer:function(c,d,b){c=c||"-";if(Ext.Array.contains(b.get("@PrichNePlat"),"03")){return Ext.String.format(a.errorTpl,c)}else{return c}}},{text:reference.lang.rsb.clarify.unexpay.grid.platDokOsnPlat,dataIndex:"@PlatDokOsnPlat",width:100,renderer:function(c,d,b){c=c||"-";if(Ext.Array.contains(b.get("@PrichNePlat"),"12")){return Ext.String.format(a.errorTpl,c)}else{return c}}},{text:reference.lang.rsb.clarify.unexpay.grid.platDokNalPeriod,dataIndex:"@PlatDokNalPeriod",width:100,renderer:function(c,d,b){c=c||"-";if(Ext.Array.contains(b.get("@PrichNePlat"),"16")){return Ext.String.format(a.errorTpl,c)}else{return c}}},{text:reference.lang.rsb.clarify.unexpay.grid.platDokOsn,menuDisabled:true,columns:[{text:reference.lang.rsb.clarify.unexpay.grid.platDokNomerDokNaprav,dataIndex:"@PlatDokNomerDokNaprav",width:100,sortable:false,renderer:function(c,d,b){c=c||"-";if(Ext.Array.contains(b.get("@PrichNePlat"),"16")){return Ext.String.format(a.errorTpl,c)}else{return c}}},{text:reference.lang.rsb.clarify.unexpay.grid.platDokDataDokNaprav,dataIndex:"@PlatDokDataDokNaprav",width:100,renderer:function(c,d,b){c=!Ext.isEmpty(c)?LkIp.Utils.getDate(c):"-";if(Ext.Array.contains(b.get("@PrichNePlat"),"16")){return Ext.String.format(a.errorTpl,c)}else{return c}},sortable:false}],listeners:{render:function(){this.setWidth(200)}}},{text:reference.lang.rsb.clarify.unexpay.grid.platDokTipPlat,dataIndex:"@PlatDokTipPlat",width:100,renderer:function(c,d,b){c=c||"-";return c}},{text:reference.lang.rsb.clarify.unexpay.grid.platDokNapravPlat,dataIndex:"@PlatDokNapravPlat",width:170}]});a.callParent();a.on({itemmouseenter:a.itemmouseenterAction})},getRowClass:function(a){if(a.get("@EstZayavl")>0){return"disabled-row"}},itemmouseenterAction:function(b,a,c){if(a.get("@EstZayavl")>0){Ext.fly(c).set({"data-qtip":reference.lang.rsb.clarify.unexpay.rowWithStatementTtip})}}},0,["rsbUnexpayGridIndex"],["panel","rsbUnexpayGridIndex","gridtable","component","tablepanel","container","grid","box","gridpanel"],{panel:true,rsbUnexpayGridIndex:true,gridtable:true,component:true,tablepanel:true,container:true,grid:true,box:true,gridpanel:true},["widget.rsbUnexpayGridIndex"],0,[LkIp.view.Rsb.Clarify.Unexpay,"Grid"],0));(Ext.cmd.derive("LkIp.view.Rsb.Clarify.Unexpay.NoTpl",Ext.Component,{tpl:'<table class="describe-table"><tbody><tr><th colspan="2">'+reference.lang.rsb.clarify.unexpay.no.title+'</th> </tr><tr class="no-border"><td class="small-column"><span class="label">'+reference.lang.rsb.clarify.unexpay.no.code+'</span></td><td><span class="text">'+LkIp.Utils.noRenderer("{code}")+' </span></td></tr><tr class="no-border"><td class="small-column"><span class="label">'+reference.lang.rsb.clarify.unexpay.no.inn_kpp+'</span></td><td><span class="text">{inn_kpp}</span></td></tr><tr class="no-border"><td class="small-column"><span class="label">'+reference.lang.rsb.clarify.unexpay.no.name+'</span></td><td><span class="text">{name}</span></td></tr><tr class="no-border"><td class="small-column"><span class="label">'+reference.lang.rsb.clarify.unexpay.no.address+'</span></td><td><span class="text">{address}</span></td></tr></tbody></table><hr/>',data:{code:"-",inn_kpp:"-",name:"-",address:"-"}},0,["unexpayNoTpl"],["unexpayNoTpl","component","box"],{unexpayNoTpl:true,component:true,box:true},["widget.unexpayNoTpl"],0,[LkIp.view.Rsb.Clarify.Unexpay,"NoTpl"],0));(Ext.cmd.derive("LkIp.view.Rsb.Clarify.Unexpay.NotifyTpl",Ext.Component,{tpl:'<table class="describe-table"><tbody><tr><th colspan="2">'+reference.lang.rsb.clarify.unexpay.notice.title+'</th> </tr><tr class="no-border"><td class="small-column"><span class="label">'+reference.lang.rsb.clarify.unexpay.notice.number+'</span></td><td><span class="text">{number}</span></td></tr><tr class="no-border"><td class="small-column"><span class="label">'+reference.lang.rsb.clarify.unexpay.notice.date+'</span></td><td><span class="text">{date}</span></td></tr></tbody></table> <hr/>',data:{number:"-",date:"-"}},0,["unexpayNotifyTpl"],["component","unexpayNotifyTpl","box"],{component:true,unexpayNotifyTpl:true,box:true},["widget.unexpayNotifyTpl"],0,[LkIp.view.Rsb.Clarify.Unexpay,"NotifyTpl"],0));(Ext.cmd.derive("LkIp.view.Rsb.Clarify.Unexpay.Index",Ext.container.Container,{cls:"rsbUnexpay iScroll",initComponent:function(){var a=this;Ext.apply(a,{items:[{xtype:"note",text:reference.lang.rsb.clarify.unexpay.info,style:{marginTop:"0px !important"}},{xtype:"component",html:LkIp.Utils.header(reference.lang.rsb.clarify.unexpay.grid.header,4),margin:"15 0"},!LkIp.User.isInspectorWithCodeNO()?{xtype:"defaultFilterPanel",id:"rsbUnexpayFilterPanel",data:[{defaults:{labelWidth:140,width:500,xtype:"filterSelect"},items:[{lang:reference.lang.filters.no,name:"codeNO",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"rsbUnexpayNoStore"}}]}]}:{cls:"display-none"},{xtype:"rsbUnexpayGridIndex"},LkIp.User.isActiveUser()?{xtype:"container",margin:"15 0",layout:{type:"auto"},items:[{xtype:"button",disabled:true,name:"rsbUnexpayStatementButton",text:reference.lang.rsb.clarify.unexpay.buttons.unexpay,margin:"0 15 0 0"},{xtype:"button",hidden:true,name:"rsbUnexpayNotifyButton",text:reference.lang.rsb.clarify.unexpay.buttons.notice}]}:{cls:"display-none"},{xtype:"unexpayNoTpl",name:"rsbUnexpayNoTpl",hidden:true},{xtype:"unexpayNotifyTpl",margin:"15 0",name:"rsbUnexpayUvedomlTpl",hidden:true},{xtype:"component",margin:"15 0 0",cls:"link4-icon",style:{padding:"3px 0 0 30px",height:"35px"},html:'<a href="#!/rsb/unexpay/decisions">'+reference.lang.pages.rsb.unexpayDecisions.menuTitle+"</a>"}]});this.callParent()}},0,["rsbUnexpay"],["component","container","box","rsbUnexpay"],{component:true,container:true,box:true,rsbUnexpay:true},["widget.rsbUnexpay"],[[LkIp.view.Scrolling.prototype.mixinId||LkIp.view.Scrolling.$className,LkIp.view.Scrolling]],[LkIp.view.Rsb.Clarify.Unexpay,"Index"],0));(Ext.cmd.derive("LkIp.view.Rsb.Overpayment.CardInfo",Ext.Container,{cardTpl:'<table class="describe-table"><tbody><tr><th colspan="2">'+reference.lang.rsb.overpayment.cardInfo.title+'</th> </tr><tr class="no-border"><td class="small-column"><span class="label">'+reference.lang.rsb.overpayment.cardInfo.taxName+'</span></td><td><span class="text">{taxName}</span></td></tr><tr class="no-border"><td class="small-column"><span class="label">'+reference.lang.rsb.overpayment.cardInfo.paymentType+'</span></td><td><span class="text">{paymentType}</span></td></tr><tr class="no-border"><td class="small-column"><span class="label">'+reference.lang.rsb.overpayment.cardInfo.kbkOkato+'</span></td><td><span class="text">{kbkOkato}</span></td></tr><tr class="no-border"><td class="small-column"><span class="label">'+reference.lang.rsb.overpayment.cardInfo.no+'</span></td><td><span class="text">{no}</span></td></tr><tr class="no-border"><td class="small-column"><span class="label">'+reference.lang.rsb.overpayment.cardInfo.status+'</span></td><td><span class="text">{status}</span></td></tr><tr class="no-border"><td class="small-column"><span class="label">'+reference.lang.rsb.overpayment.cardInfo.summa+'</span></td><td><span class="text">{summa}</span></td></tr></tbody></table> ',initComponent:function(){Ext.apply(this,{items:[{xtype:"component",tpl:this.cardTpl,name:"rsbOverpaymentCardTpl",data:{taxName:"-",paymentType:"-",kbkOkato:"-",no:"-",status:"-",summa:"-"}}]});this.callParent()}},0,["rsbOverpaymentCardInfo"],["rsbOverpaymentCardInfo","component","container","box"],{rsbOverpaymentCardInfo:true,component:true,container:true,box:true},["widget.rsbOverpaymentCardInfo"],0,[LkIp.view.Rsb.Overpayment,"CardInfo"],0));(Ext.cmd.derive("LkIp.view.Default.CompositeFields.EditField",Ext.Container,{enteredValue:"",required:true,defaultField:{xtype:"textfield",name:"enterValue",cls:"fl-l"},defaultFieldName:"a_b_c",formFieldName:undefined,actionField:undefined,enteredValueBlock:{},enterBtn:{},hideDeleteBtn:false,layout:"auto",initComponent:function(){var a=this,b=typeof a.actionField!=="undefined"&&Ext.isObject(a.actionField)?Ext.apply(a.actionField,{name:"enterValue"}):a.defaultField;a.formFieldName=typeof a.formFieldName!=="undefined"&&!Ext.isEmpty(a.formFieldName)?a.formFieldName:a.defaultFieldName;Ext.apply(this,{cls:"fl-l",items:[Ext.apply({xtype:"button",itemId:"enterBtn",html:reference.lang.buttons.enter,handler:function(){a.showEditBlock()}},a.enterBtn),{xtype:"container",itemId:"editBlock",cls:"fl-l",hidden:true,items:[Ext.apply(b,{required:a.required}),{xtype:"button",cls:"blue-button fl-l",itemId:"saveValue",margin:"0 0 0 15",html:reference.lang.buttons.ok,listeners:{click:function(){a.showEnteredValue()}}}]},{xtype:"container",itemId:"changeBlock",cls:"fl-l",hidden:true,items:[Ext.apply({xtype:"component",cls:"text fl-l",style:{maxWidth:"170px"},name:"enteredValue",tpl:"{value}"},a.enteredValueBlock),{xtype:"button",itemId:"changeBtn",cls:"blue-button fl-l",margin:"0 5 0 0",html:reference.lang.buttons.change,handler:function(){a.showEditBlock()}},{xtype:"button",itemId:"deleteBtn",hidden:this.hideDeleteBtn,cls:"blue-button fl-l",html:"X",handler:function(){a.resetValue()}}]},{xtype:"hiddenfield",type:"formFieldValue",name:a.formFieldName,value:"",allowBlank:a.required},{cls:"clear"}]});this.callParent()},showEnteredValue:function(){var c=this,b=c.down('[name="enterValue"]').getRawValue(),a=c.down('[name="enterValue"]').getValue();if(!c.down('[name="enterValue"]').isValid()){LkIp.Msg.error("\u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0432 \u043f\u043e\u043b\u0435 \u0432\u0432\u0435\u0434\u0435\u043d\u043e \u043d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e.");return}if("filterDate"===c.down('[name="enterValue"]').xtype){a=b}Ext.suspendLayouts();c.down("#editBlock").hide();c.setValue(b,a);Ext.resumeLayouts(true)},showEditBlock:function(){var a=this;Ext.suspendLayouts();a.down('[name="enterValue"]').setValue(a.enteredValue);a.down("#editBlock").show();a.down("#enterBtn").hide();a.down("#changeBlock").hide();a.fireEvent("notEnterValue",a.itemId,a);Ext.resumeLayouts(true)},setValue:function(b,a){a=a||b;var c=this;Ext.suspendLayouts();if(!Ext.isEmpty(b)){c.enteredValue=a;c.down('[name="enteredValue"]').update({value:b});c.down('[name="'+c.formFieldName+'"]').setValue(a);c.down("#changeBlock").show();c.down("#editBlock").hide();c.down("#enterBtn").hide();c.fireEvent("enteredValue",c.itemId,c)}else{c.enteredValue="";c.down("#enterBtn").show();c.down('[name="'+c.formFieldName+'"]').setValue("");if(c.required){c.fireEvent("notEnterValue",false,c)}else{c.fireEvent("enteredValue",c.itemId,c)}}Ext.resumeLayouts(true);return this},getValue:function(){return this.enteredValue},resetValue:function(){var a=this;Ext.suspendLayouts();a.enteredValue="";a.down('[name="'+a.formFieldName+'"]').setValue("");a.down("#editBlock").hide();a.down("#changeBlock").hide();a.down("#enterBtn").show();if(a.required){a.fireEvent("notEnterValue",false,a)}else{a.fireEvent("enteredValue",a.itemId,a)}Ext.resumeLayouts(true)}},0,["editField"],["editField","component","container","box"],{editField:true,component:true,container:true,box:true},["widget.editField"],0,[LkIp.view.Default.CompositeFields,"EditField"],0));Ext.apply(Ext.form.field.VTypes,{length:function(c,b){var a=b.up("#editBlock").down("#saveValue");if(c.length!=b.maxLength){a.disable()}else{a.enable()}return true}});Ext.apply(Ext.form.field.VTypes,{bigSum:function(c,b){var a=b.up("#editBlock").down("#saveValue");if(b.bigSum){a.disable();return false}else{a.enable();return true}},bigSumText:reference.lang.rsb.overpayment.statement.errors.bigSumma});(Ext.cmd.derive("LkIp.view.Rsb.Overpayment.Statement.InfoOffset",Ext.Container,{initComponent:function(){Ext.apply(this,{items:[{xtype:"container",cls:"describe-container",items:[{xtype:"component",cls:"header",html:this.firstTitle},{xtype:"container",items:[{xtype:"component",cls:"label small-column fl-l",html:reference.lang.rsb.overpayment.statement.nomer},{xtype:"component",itemId:"emptyNumber",cls:"text column fl-l",html:"-"},{xtype:"editField",formFieldName:"statementNumber",itemId:"statementNumber",required:false,cls:"column fl-l",hidden:true}]},{xtype:"container",items:[{xtype:"component",cls:"label small-column fl-l",html:reference.lang.rsb.overpayment.statement.data},{xtype:"component",cls:"text column fl-l",itemId:"statementDate",tpl:"{date}",data:{date:"-"}}]}]},{xtype:"container",margin:"15 0",cls:"describe-container",items:[{xtype:"component",cls:"header",html:this.secondTitle},{xtype:"container",items:[{xtype:"component",cls:"label small-column fl-l",html:this.summaText},{xtype:"component",itemId:"emptySumma",cls:"text column fl-l",html:"-"},{xtype:"editField",hideDeleteBtn:true,formFieldName:"statementSumma",itemId:"statementSumma",cls:"column fl-l",hidden:true,actionField:{vtype:"bigSum",xtype:"textfield",name:"enterValue",bigSum:false,cls:"fl-l"}}]},{xtype:"container",items:[{xtype:"component",cls:"label small-column fl-l",html:reference.lang.rsb.overpayment.cardInfo.taxName},{xtype:"component",cls:"text column fl-l",itemId:"taxName",tpl:"{taxName}",data:{taxName:"-"}}]},{xtype:"container",items:[{xtype:"component",cls:"label small-column fl-l",html:reference.lang.rsb.overpayment.cardInfo.paymentType},{xtype:"component",cls:"text column fl-l",itemId:"paymentType",tpl:"{paymentType}",data:{paymentType:"-"}}]},{xtype:"container",items:[{xtype:"component",cls:"label small-column fl-l",html:reference.lang.rsb.overpayment.cardInfo.kbkOkato},{xtype:"component",cls:"text column fl-l",itemId:"kbkOkato",tpl:"{kbkOkato}",data:{kbkOkato:"-"}}]},{xtype:"container",items:[{xtype:"component",cls:"label small-column fl-l",html:reference.lang.rsb.overpayment.cardInfo.no},{xtype:"component",cls:"text column fl-l",itemId:"no",tpl:"{no}",data:{no:"-"}}]}]}]});this.callParent()},setData:function(b){var a=this;Ext.suspendLayouts();a.down("#emptyNumber").hide();a.down("#statementNumber").show();a.down("#statementDate").update({date:LkIp.Utils.getNowDate()});a.down("#emptySumma").hide();a.down("#statementSumma").setValue(b.summa).show();a.down("#taxName").update({taxName:b.taxName});a.down("#paymentType").update({paymentType:b.paymentType});a.down("#kbkOkato").update({kbkOkato:b.kbkOkato});a.down("#no").update({no:b.no});Ext.resumeLayouts(true)},removeData:function(){var a=this;Ext.suspendLayouts();a.down("#emptyNumber").show();a.down("#statementNumber").hide();a.down("#statementDate").update({date:"-"});a.down("#emptySumma").show();a.down("#statementSumma").hide();a.down("#taxName").update({taxName:"-"});a.down("#paymentType").update({paymentType:"-"});a.down("#kbkOkato").update({kbkOkato:"-"});a.down("#no").update({no:"-"});Ext.resumeLayouts(true)}},0,["rsbOverpaymentInfoOffset"],["component","container","box","rsbOverpaymentInfoOffset"],{component:true,container:true,box:true,rsbOverpaymentInfoOffset:true},["widget.rsbOverpaymentInfoOffset"],0,[LkIp.view.Rsb.Overpayment.Statement,"InfoOffset"],0));(Ext.cmd.derive("LkIp.view.Rsb.Overpayment.Statement.OffsetFutureTab",Ext.Container,{cls:"rsbOverpaymentOffsetFuture iScroll",initComponent:function(){var a=[];if(!LkIp.User.isInspectorWithCodeNO()){a.push({lang:reference.lang.filters.no,name:"codeNO",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"rsbOffsetFutureNoStore"}})}a.push({lang:reference.lang.filters.statusIP,name:"statusIP",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"rsbOffsetFutureStatusIPStore"}},{lang:reference.lang.filters.kbk,name:"kbk",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"rsbOffsetFutureKbkStore"}});Ext.apply(this,{items:[{xtype:"note",text:reference.lang.rsb.overpayment.statement.onOffsetFuture.note},{xtype:"defaultFilterPanel",id:"rsbOverpaymentOffsetFutureFilterPanel",data:[{cls:"first-column fl-l",defaults:{labelWidth:140,width:400,xtype:"filterSelect"},items:a}]},{xtype:"component",margin:"15 0 0 0",html:LkIp.Utils.header(reference.lang.rsb.overpayment.statement.onOffsetFuture.gridTitle,4)},{xtype:"gridtable",height:400,itemId:"rsbOverpaymentStatementFutureGrid",store:"Rsb.Overpayment.Statement.OffsetFuture.GridStore",columns:[{text:reference.lang.rsb.cards.grid.no,dataIndex:"@KodNO",width:80,renderer:LkIp.Utils.noRenderer},{text:reference.lang.rsb.cards.grid.nameKbk,dataIndex:"@ImyaKBK",flex:1},{text:reference.lang.rsb.cards.grid.codeKbk,dataIndex:"@KodKBK",width:170},{text:reference.lang.rsb.cards.grid.okatoOktmo,dataIndex:"@OKATO_OKTMO",width:100},{text:reference.lang.rsb.cards.grid.statusIP,dataIndex:"@KodStatus",width:150,renderer:function(d,c,b){c.tdAttr='data-qtip="'+b.get("@ImyaStatus")+'"';return d}},{text:reference.lang.rsb.cards.grid.dataSostRasch,dataIndex:"@DataSostRasch",width:100,renderer:function(b){return !Ext.isEmpty(b)?LkIp.Utils.getDate(b):""}},{text:reference.lang.rsb.cards.grid.dataOtkrKart,dataIndex:"@DataOtkrKart",hidden:true,width:100,renderer:function(b){return !Ext.isEmpty(b)?LkIp.Utils.getDate(b):""}}]},{xtype:"button",html:reference.lang.buttons.choose,rel:"choose",disabled:true},{xtype:"rsbOverpaymentInfoOffset",itemId:"statementInfo",margin:"15 0 0",firstTitle:reference.lang.rsb.overpayment.statement.infoOffset.future.firstTitle,secondTitle:reference.lang.rsb.overpayment.statement.infoOffset.future.secondTitle,summaText:reference.lang.rsb.overpayment.statement.infoOffset.future.summa},{xtype:"button",text:reference.lang.buttons.exclude,rel:"exclude",disabled:true},{xtype:"button",margin:"0 0 0 15",text:reference.lang.buttons.pdf,rel:"showPdf",disabled:true,listeners:{enable:function(b){if(LkIp.User.isInspector()){b.disable()}}}}]});this.callParent()}},0,["rsbOverpaymentOffsetFuture"],["component","container","box","rsbOverpaymentOffsetFuture"],{component:true,container:true,box:true,rsbOverpaymentOffsetFuture:true},["widget.rsbOverpaymentOffsetFuture"],0,[LkIp.view.Rsb.Overpayment.Statement,"OffsetFutureTab"],0));(Ext.cmd.derive("LkIp.view.Rsb.Overpayment.Statement.OffsetDebtTab",Ext.Container,{cls:"rsbOverpaymentOffsetDebt iScroll",initComponent:function(){var a=[];if(!LkIp.User.isInspectorWithCodeNO()){a.push({lang:reference.lang.filters.no,name:"codeNO",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"rsbOffsetDebtNoStore"}})}a.push({lang:reference.lang.filters.statusIP,name:"statusIP",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"rsbOffsetDebtStatusIPStore"}},{lang:reference.lang.filters.kbk,name:"kbk",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"rsbOffsetDebtKbkStore"}});Ext.apply(this,{items:[{xtype:"container",cls:"note",items:[{xtype:"container",cls:"note-icon fl-l"},{xtype:"component",cls:"note-text fl-l",name:"offsetDebtNote",html:reference.lang.rsb.overpayment.statement.onOffsetDebt.note}]},{xtype:"defaultFilterPanel",id:"rsbOverpaymentOffsetDebtFilterPanel",data:[{cls:"first-column fl-l",defaults:{labelWidth:140,width:400,xtype:"filterSelect"},items:a},{cls:"second-column fl-l",defaults:{xtype:"filterSelect",tpl:'<tpl for="."><tpl if="code &gt; 0"><li data-qtip="{name}" data-qclass="qtip-resize" class="x-boundlist-item" role="option">{value}</li></tpl><tpl if="code == 0"><li class="x-boundlist-item" role="option">{value}</li></tpl></tpl>',displayField:"value",labelWidth:100,width:300},items:[{lang:reference.lang.filters.typePayment,name:"typePayment",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"rsbOffsetDebtTypePaymentStore"}}]}]},{xtype:"component",margin:"15 0 0 0",html:LkIp.Utils.header(reference.lang.rsb.overpayment.statement.onOffsetDebt.gridTitle,4)},{xtype:"rsbOverpaymentGridIndex",height:400,itemId:"rsbOverpaymentStatementDebtGrid",store:"Rsb.Overpayment.Statement.OffsetDebt.GridStore"},{xtype:"button",html:reference.lang.buttons.choose,rel:"choose",disabled:true},{xtype:"rsbOverpaymentInfoOffset",itemId:"statementInfo",margin:"15 0 0",firstTitle:reference.lang.rsb.overpayment.statement.infoOffset.debt.firstTitle,secondTitle:reference.lang.rsb.overpayment.statement.infoOffset.debt.secondTitle,summaText:reference.lang.rsb.overpayment.statement.infoOffset.debt.summa},{xtype:"button",text:reference.lang.buttons.exclude,rel:"exclude",disabled:true},{xtype:"button",margin:"0 0 0 15",text:reference.lang.buttons.pdf,rel:"showPdf",disabled:true,listeners:{enable:function(b){if(LkIp.User.isInspector()){b.disable()}}}}]});this.callParent()}},0,["rsbOverpaymentOffsetDebt"],["component","container","rsbOverpaymentOffsetDebt","box"],{component:true,container:true,rsbOverpaymentOffsetDebt:true,box:true},["widget.rsbOverpaymentOffsetDebt"],0,[LkIp.view.Rsb.Overpayment.Statement,"OffsetDebtTab"],0));(Ext.cmd.derive("LkIp.view.Rsb.Overpayment.Statement.InfoReturn",Ext.Container,{initComponent:function(){Ext.apply(this,{items:[{xtype:"container",cls:"describe-container",items:[{xtype:"component",cls:"header",html:reference.lang.rsb.overpayment.statement.infoReturn.title},{xtype:"container",items:[{xtype:"component",cls:"label small-column fl-l",html:reference.lang.rsb.overpayment.statement.nomer},{xtype:"editField",itemId:"statementNumber",required:false,cls:"column fl-l"}]},{xtype:"container",items:[{xtype:"component",cls:"label small-column fl-l",html:reference.lang.rsb.overpayment.statement.data},{xtype:"component",cls:"text column fl-l",itemId:"statementDate",html:LkIp.Utils.getNowDate()}]},{xtype:"container",items:[{xtype:"component",cls:"label small-column fl-l",html:reference.lang.rsb.overpayment.statement.infoReturn.summa},{xtype:"editField",itemId:"statementSumma",hideDeleteBtn:true,cls:"column fl-l",actionField:{vtype:"bigSum",xtype:"textfield",name:"enterValue",bigSum:false,cls:"fl-l"}}]}]},{xtype:"tabpanel",cls:"tabs-block tabs-block-border tabs-block-border-bottom",border:1,id:"overpaymentStatementReturnTabPanel",plain:true,items:[{title:reference.lang.rsb.overpayment.statement.infoReturn.paymentAccount.title,type:"tab",cls:"describe-container",border:false,itemId:"tab-payment-account",items:[{xtype:"container",border:false,cls:"column fl-l no-border",layout:{type:"auto"},items:[{xtype:"container",items:[{xtype:"component",cls:"label small-column fl-l",html:reference.lang.rsb.overpayment.statement.infoReturn.bankName},{xtype:"editField",hideDeleteBtn:true,itemId:"bankName",actionField:{xtype:"filterSelect",lang:reference.lang.filters.bankName,displayField:"@NaimBanka",valueField:"@NaimBanka",tpl:'<tpl for="."><tpl><li data-qtip="{qtip}" class="x-boundlist-item" role="option">{shortName}</li></tpl></tpl>',store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Rsb.Overpayment.PaymentAccounts",autoDestroy:true,storeId:"returnPaymentBankName"},typeAhead:false,editable:false,labelWidth:0,width:200,name:"selectValue",cls:"dropdown-text fl-l"},cls:"selectField column fl-l",formFieldName:"bankName",enteredValueBlock:{width:200}}]},{xtype:"container",items:[{xtype:"component",cls:"label small-column fl-l",html:reference.lang.rsb.overpayment.statement.infoReturn.paymentAccount.accountNomer},{xtype:"editField",itemId:"accountNumber",hideDeleteBtn:true,actionField:{xtype:"filterSelect",lang:reference.lang.filters.accountNumber,displayField:"@NomSchBank",valueField:"@NomSchBank",tpl:'<tpl for="."><tpl><li class="x-boundlist-item" role="option">{code}</li></tpl></tpl>',store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Rsb.Overpayment.PaymentAccounts",autoDestroy:true,storeId:"returnPaymentAccountNumber"},typeAhead:false,editable:false,labelWidth:0,width:200,name:"selectValue",cls:"dropdown-text fl-l"},cls:"selectField column fl-l",formFieldName:"accountNumber",enteredValueBlock:{width:200}}]}]},{xtype:"container",cls:"small-column fl-l",layout:{type:"auto"},items:[{xtype:"container",items:[{xtype:"component",cls:"label small-column fl-l",html:reference.lang.rsb.overpayment.statement.infoReturn.innKpp},{xtype:"component",itemId:"innKpp",tpl:"{innKpp}",data:{innKpp:"- / -"},cls:"small-column fl-l"}]},{xtype:"container",items:[{xtype:"component",cls:"label small-column fl-l",html:reference.lang.rsb.overpayment.statement.infoReturn.bik},{xtype:"component",itemId:"bik",cls:"small-column fl-l",tpl:"{bik}",data:{bik:"-"}}]}]}]},{title:reference.lang.rsb.overpayment.statement.infoReturn.personalAccount.title,type:"tab",itemId:"tab-personal-account",cls:"describe-container",items:[{xtype:"container",border:false,cls:"column fl-l no-border",layout:{type:"auto"},items:[{xtype:"container",items:[{xtype:"component",cls:"label small-column fl-l",html:reference.lang.rsb.overpayment.statement.infoReturn.personalAccount.fkName},{xtype:"editField",hideDeleteBtn:true,itemId:"fkName",actionField:{xtype:"filterSelect",lang:reference.lang.filters.bankName,displayField:"@NaimFinOrg",valueField:"@NaimFinOrg",tpl:'<tpl for="."><tpl><li data-qtip="{qtip}" class="x-boundlist-item" role="option">{shortName}</li></tpl></tpl>',store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Rsb.Overpayment.PersonalAccounts",autoDestroy:true,storeId:"returnPersonalNameFk"},typeAhead:false,editable:false,labelWidth:0,width:200,name:"selectValue",cls:"dropdown-text fl-l"},cls:"selectField column fl-l",formFieldName:"fkName",enteredValueBlock:{width:200}}]},{xtype:"container",items:[{xtype:"component",cls:"label small-column fl-l",html:reference.lang.rsb.overpayment.statement.infoReturn.personalAccount.accountNomer},{xtype:"editField",itemId:"fkNumber",hideDeleteBtn:true,actionField:{xtype:"filterSelect",lang:reference.lang.filters.accountNumber,displayField:"@NomSchFK",valueField:"@NomSchFK",tpl:'<tpl for="."><tpl><li class="x-boundlist-item" role="option">{code}</li></tpl></tpl>',store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Rsb.Overpayment.PersonalAccounts",autoDestroy:true,storeId:"returnPersonalFkNumber"},typeAhead:false,editable:false,labelWidth:0,width:200,name:"selectValue",cls:"dropdown-text fl-l"},cls:"selectField column fl-l",formFieldName:"fkNumber",enteredValueBlock:{width:200}}]}]},{xtype:"container",cls:"mid-column fl-l",layout:{type:"auto"},items:[{xtype:"container",items:[{xtype:"component",cls:"label column fl-l",html:reference.lang.rsb.overpayment.statement.infoReturn.personalAccount.innKpp},{xtype:"component",itemId:"innKppFk",tpl:"{innKppFk}",data:{innKppFk:"- / -"},cls:"fl-l"}]},{xtype:"container",items:[{xtype:"component",cls:"label column fl-l",html:reference.lang.rsb.overpayment.statement.infoReturn.bankName},{xtype:"component",itemId:"bankName",cls:"mid-column fl-l",tpl:"{bankName}",data:{bankName:"-"}}]},{xtype:"container",items:[{xtype:"component",cls:"label column fl-l",html:reference.lang.rsb.overpayment.statement.infoReturn.innKpp},{xtype:"component",itemId:"innKpp",tpl:"{innKpp}",data:{innKpp:"- / -"},cls:"fl-l"}]},{xtype:"container",items:[{xtype:"component",cls:"label column fl-l",html:reference.lang.rsb.overpayment.statement.infoReturn.bik},{xtype:"component",itemId:"bik",cls:"fl-l",tpl:"{bik}",data:{bik:"-"}}]}]}]}]}]});this.callParent()},updatePaymentAccount:function(b){var a=this.down("#tab-payment-account");b=b||"";Ext.suspendLayouts();if(!Ext.isEmpty(b)){a.down("#bankName").setValue(b.bankName);a.down("#innKpp").update({innKpp:b.innKpp});a.down("#bik").update({bik:b.bik})}else{a.down("#innKpp").update({innKpp:"- / -"});a.down("#bik").update({bik:"-"})}Ext.resumeLayouts(true)},updatePersonalAccount:function(b){var a=this.down("#tab-personal-account");b=b||"";Ext.suspendLayouts();if(!Ext.isEmpty(b)){a.down("#fkName").setValue(b.fkName);a.down("#innKppFk").update({innKppFk:b.innKppFk});a.down("#bankName").update({bankName:b.bankName});a.down("#innKpp").update({innKpp:b.innKpp});a.down("#bik").update({bik:b.bik})}else{a.down("#innKppFk").update({innKppFk:"- / -"});a.down("#bankName").update({bankName:"-"});a.down("#innKpp").update({innKpp:"- / -"});a.down("#bik").update({bik:"-"})}Ext.resumeLayouts(true)}},0,["rsbOverpaymentInfoReturn"],["component","container","rsbOverpaymentInfoReturn","box"],{component:true,container:true,rsbOverpaymentInfoReturn:true,box:true},["widget.rsbOverpaymentInfoReturn"],0,[LkIp.view.Rsb.Overpayment.Statement,"InfoReturn"],0));(Ext.cmd.derive("LkIp.view.Rsb.Overpayment.Statement.ReturnTab",Ext.Container,{cls:"rsbOverpaymentReturn iScroll",initComponent:function(){Ext.apply(this,{items:[{xtype:"note",itemId:"returnNote",tpl:reference.lang.rsb.overpayment.statement.onReturn.note},{xtype:"rsbOverpaymentInfoReturn",itemId:"statementInfo",margin:"15 0"},{xtype:"button",text:reference.lang.buttons.pdf,rel:"showPdf",disabled:true,listeners:{enable:function(a){if(LkIp.User.isInspector()){a.disable()}}}}]});this.callParent()}},0,["rsbOverpaymentReturn"],["component","container","box","rsbOverpaymentReturn"],{component:true,container:true,box:true,rsbOverpaymentReturn:true},["widget.rsbOverpaymentReturn"],0,[LkIp.view.Rsb.Overpayment.Statement,"ReturnTab"],0));(Ext.cmd.derive("LkIp.view.Rsb.Overpayment.Statement.Index",Ext.Container,{cls:"rsbOverpaymentStatement iScroll",initComponent:function(){Ext.apply(this,{items:[{xtype:"button",rel:"back",html:reference.lang.buttons.returnToFirst,margin:"0 0 15 0"},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"2",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.pages.steps.step1Statement},{xtype:"component",html:"<p>"+reference.lang.rsb.overpayment.instruction.step2Description+"</p>"}]}]},{xtype:"rsbOverpaymentCardInfo",margin:"0 0 15 70"},{xtype:"tabpanel",cls:"tabs-block tabs-block-no-border small-font",border:1,id:"overpaymentStatementTabPanel",margin:"0 0 15 70",layout:"fit",defaults:{padding:"10 20 10 20"},tabBar:{layout:{type:"hbox",align:"stretch"},defaults:{flex:1,height:64},height:65},plain:true,hidden:true,items:[{title:reference.lang.rsb.overpayment.statement.onOffsetFuture.title,type:"tab",itemId:"tab-offset-future",xtype:"rsbOverpaymentOffsetFuture"},{title:reference.lang.rsb.overpayment.statement.onOffsetDebt.title,type:"tab",itemId:"tab-offset-debt",xtype:"rsbOverpaymentOffsetDebt"},{title:reference.lang.rsb.overpayment.statement.onReturn.title,type:"tab",itemId:"tab-return",xtype:"rsbOverpaymentReturn"}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"3",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.pages.steps.step2Statement},{xtype:"component",html:"<p>"+reference.lang.pages.steps.step2DescriptionStatement+"</p>"}]}]},{xtype:"button",html:reference.lang.buttons.signSend,rel:"sign",disabled:true,margin:"0 0 20 70"},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"4",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.pages.steps.step3Statement},{xtype:"component",html:"<p>"+reference.lang.pages.steps.step3DescriptionStatement+"</p>"}]}]}]});this.callParent()}},0,["rsbOverpaymentStatement"],["rsbOverpaymentStatement","component","container","box"],{rsbOverpaymentStatement:true,component:true,container:true,box:true},["widget.rsbOverpaymentStatement"],[[LkIp.view.Scrolling.prototype.mixinId||LkIp.view.Scrolling.$className,LkIp.view.Scrolling]],[LkIp.view.Rsb.Overpayment.Statement,"Index"],0));(Ext.cmd.derive("LkIp.view.Rsb.Clarify.Unexpay.Notify.Index",Ext.Container,{cls:"rsbUnexpayNotify iScroll",initComponent:function(){var a=this;Ext.apply(a,{items:[{xtype:"unexpayNoTpl",name:"rsbNotifyNoTpl"},{xtype:"unexpayNotifyTpl",margin:"15 0",name:"rsbNotifyUvedomlTpl"},{xtype:"component",margin:"15 0",name:"rsbNotifyDocumentTpl",tpl:'<table class="describe-table"><tbody><tr><th colspan="2">'+reference.lang.rsb.clarify.unexpay.notify.document.title+'</th> </tr><tr class="no-border"><td class="small-column"><span class="label">'+reference.lang.rsb.clarify.unexpay.notify.document.number+'</span></td><td><span class="text">{number}</span></td></tr><tr class="no-border"><td class="small-column"><span class="label">'+reference.lang.rsb.clarify.unexpay.notify.document.date+'</span></td><td><span class="text">{date}</span></td></tr><tr class="no-border"><td class="small-column"><span class="label">'+reference.lang.rsb.clarify.unexpay.notify.document.summ+'</span></td><td><span class="text">{summ}</span></td></tr></tbody></table> ',data:{number:"-",date:"-",summ:"-"}},{xtype:"container",margin:"15 0",layout:{type:"hbox"},items:[{xtype:"button",name:"rsbNotifySignButton",text:reference.lang.buttons.signSend,margin:"0 15 0 0"},{xtype:"button",name:"rsbNotifySignShow",text:reference.lang.buttons.pdf}]}]});this.callParent()}},0,["rsbUnexpayNotify"],["rsbUnexpayNotify","component","container","box"],{rsbUnexpayNotify:true,component:true,container:true,box:true},["widget.rsbUnexpayNotify"],[[LkIp.view.Scrolling.prototype.mixinId||LkIp.view.Scrolling.$className,LkIp.view.Scrolling]],[LkIp.view.Rsb.Clarify.Unexpay.Notify,"Index"],0));(Ext.cmd.derive("LkIp.view.Rsb.UnexpayDecisions.Index",Ext.Container,{cls:"rsbUnexpayDecisions iScroll",initComponent:function(){var b=this,a=[];if(!LkIp.User.isInspectorWithCodeNO()){a.push({labelWidth:140,width:400,xtype:"filterSelect",lang:reference.lang.filters.no,name:"codeNO",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"rsbUnexpayDecisionsNoStore"}})}Ext.apply(b,{items:[{xtype:"defaultFilterPanel",id:"rsbUnexpayDecisionsFilterPanel",data:[{cls:a.length>0?"first-column fl-l":"display-none",items:a},{cls:"second-column fl-l",items:[{xtype:"defaultDateFilter",dateFieldName:"date_decision",lang:reference.lang.filters.dateDecision,dateFieldMargin:"5 0 0 0"}]}]},{xtype:"gridtable",id:"rsbUnexpayDecisionsGrid",store:"Rsb.UnexpayDecisions.GridStore",columns:[{text:reference.lang.rsb.unexpayDecisions.grid.kodNo,dataIndex:"@KodNO",width:90,renderer:LkIp.Utils.noRenderer},{text:reference.lang.rsb.unexpayDecisions.grid.svedResh,menuDisabled:true,listeners:{render:function(){this.setWidth(140)}},columns:[{text:reference.lang.rsb.unexpayDecisions.grid.nomer,dataIndex:"@NomerResh",width:60},{text:reference.lang.rsb.unexpayDecisions.grid.data,dataIndex:"@DataResh",width:80,renderer:function(c){return !Ext.isEmpty(c)?LkIp.Utils.getDate(c):""}}]},{text:reference.lang.rsb.unexpayDecisions.grid.dokOsn,listeners:{render:function(){this.setWidth(250)}},menuDisabled:true,columns:[{text:reference.lang.rsb.unexpayDecisions.grid.nomer,dataIndex:"@NomerDokOsnov",width:60},{text:reference.lang.rsb.unexpayDecisions.grid.data,dataIndex:"@DataDokOsnov",width:80,renderer:function(c){return !Ext.isEmpty(c)?LkIp.Utils.getDate(c):""}},{text:reference.lang.rsb.unexpayDecisions.grid.naimen,dataIndex:"@NaimenDokOsnov",width:110,renderer:function(c){if(!Ext.isEmpty(c)){return LkIp.Utils.ucfirst(c)}return""}}]},{text:reference.lang.rsb.unexpayDecisions.grid.svedPlatDok,listeners:{render:function(){this.setWidth(230)}},menuDisabled:true,columns:[{text:reference.lang.rsb.unexpayDecisions.grid.summa,dataIndex:"@Summa",width:90,renderer:function(c){return LkIp.Utils.numberConvert(c)}},{text:reference.lang.rsb.unexpayDecisions.grid.nomer,dataIndex:"@NomerDok",width:60},{text:reference.lang.rsb.unexpayDecisions.grid.data,dataIndex:"@DataDok",width:80,renderer:function(c){return !Ext.isEmpty(c)?LkIp.Utils.getDate(c):""}}]},{text:reference.lang.rsb.unexpayDecisions.grid.svedUtoch,xtype:"templatecolumn",flex:1,tpl:'<tpl if="KPPPlat">'+reference.lang.rsb.unexpayDecisions.grid.kppPlat+': {KPPPlat}<br /></tpl><tpl if="INNKPPPol">'+reference.lang.rsb.unexpayDecisions.grid.innKppPol+': {INNKPPPol}<br /></tpl><tpl if="StatusPlat">'+reference.lang.rsb.unexpayDecisions.grid.status+': {StatusPlat}<br /></tpl><tpl if="KBK">'+reference.lang.rsb.unexpayDecisions.grid.kbk+': {KBK}<br /></tpl><tpl if="OKATO_OKTMO">'+reference.lang.rsb.unexpayDecisions.grid.oktmo+': {OKATO_OKTMO}<br /></tpl><tpl if="OsnPlat">'+reference.lang.rsb.unexpayDecisions.grid.osnPlat+': {OsnPlat}<br /></tpl><tpl if="NalPeriod">'+reference.lang.rsb.unexpayDecisions.grid.nalPeriod+': {NalPeriod}<br /></tpl><tpl if="NomerDokNaprav">'+reference.lang.rsb.unexpayDecisions.grid.nomerDokOsn+': {NomerDokNaprav}<br /></tpl><tpl if="DataDokNaprav">'+reference.lang.rsb.unexpayDecisions.grid.dataDokOsn+': {DataDokNaprav}<br /></tpl><tpl if="TipPl">'+reference.lang.rsb.unexpayDecisions.grid.tipPl+": {TipPl}</tpl>"}]}]});this.callParent()}},0,["rsbUnexpayDecisions"],["component","rsbUnexpayDecisions","container","box"],{component:true,rsbUnexpayDecisions:true,container:true,box:true},["widget.rsbUnexpayDecisions"],[[LkIp.view.Scrolling.prototype.mixinId||LkIp.view.Scrolling.$className,LkIp.view.Scrolling]],[LkIp.view.Rsb.UnexpayDecisions,"Index"],0));(Ext.cmd.derive("LkIp.view.Rsb.Clarify.Unexpay.Statement.EditPeriod",Ext.Container,{enteredValue:"",required:true,layout:"auto",initComponent:function(){var a=this;Ext.apply(a,{cls:"fl-l",items:[{xtype:"button",itemId:"enterBtn",html:reference.lang.buttons.enter,handler:function(){a.showEditBlock()}},{xtype:"container",itemId:"editBlock",cls:"fl-l",hidden:true,items:[{xtype:"form",itemId:"form_u_statement_period",cls:"fl-l",style:{width:"80%"},items:[{xtype:"radiofield",cls:"no-period-type-radio",boxLabel:reference.lang.rsb.clarify.unexpay.statement.filters.period.taxPeriod,name:"u_statement_period_type",inputValue:2,width:200,labelWidth:170,checked:true,listeners:{change:function(c,d){var e=d?2:1,b=e==1?2:1;c.up("form").down("#u_statement_period_type_"+e).enable();c.up("form").down("#u_statement_period_type_"+b).disable()}}},{xtype:"container",itemId:"u_statement_period_type_2",disabled:false,layout:"hbox",defaults:{xtype:"simpleSelect",width:60,style:{marginRight:"5px"},queryMode:"local",editable:false},items:[{itemId:"period",store:a.getNoPeriodStore(),value:"mc",listeners:{change:{fn:a.changePeriodField,scope:a}}},{itemId:"periodValue",store:a.getValuesForNoPeriod(),value:"0"},{itemId:"year",store:a.getYears(),value:0,width:70}]},{xtype:"radiofield",cls:"no-period-type-radio",boxLabel:reference.lang.rsb.clarify.unexpay.statement.filters.period.datePeriod,name:"u_statement_period_type",inputValue:1,width:200,labelWidth:170},{xtype:"container",itemId:"u_statement_period_type_1",disabled:true,items:{xtype:"filterDate",itemId:"u_statement_period_type_1_date",width:100,hidden:false}}]},{xtype:"button",cls:"blue-button fl-l",itemId:"saveValue",margin:"0 0 0 15",html:reference.lang.buttons.ok,handler:function(){a.showEnteredValue()}}]},{xtype:"container",itemId:"changeBlock",cls:"fl-l",hidden:true,items:[{xtype:"component",cls:"text fl-l",name:"enteredValue",style:{maxWidth:"170px"},tpl:"{value}"},{xtype:"button",itemId:"changeBtn",cls:"blue-button fl-l",margin:"0 5 0 0",html:reference.lang.buttons.change,handler:function(){a.showEditBlock()}},{xtype:"button",itemId:"deleteBtn",cls:"blue-button fl-l",html:"X",handler:function(){a.resetValue()}}]},{xtype:"hiddenfield",type:"formFieldValue",name:"no_period",value:"",allowBlank:a.required},{cls:"clear"}]});this.callParent()},getNoPeriodStore:function(){return[["mc",reference.lang.rsb.clarify.unexpay.statement.filters.period.mc],["kb",reference.lang.rsb.clarify.unexpay.statement.filters.period.kb],["pl",reference.lang.rsb.clarify.unexpay.statement.filters.period.pl],["gd",reference.lang.rsb.clarify.unexpay.statement.filters.period.gd]]},getValuesForNoPeriod:function(a){a=a||"mc";switch(a){case"kb":return[["0","01"],["1","02"],["2","03"],["3","04"]];break;case"pl":return[["0","01"],["1","02"]];break;case"gd":return[["0","00"]];break;case"mc":default:return[["0","01"],["1","02"],["2","03"],["3","04"],["4","05"],["5","06"],["6","07"],["7","08"],["8","09"],["9","10"],["10","11"],["11","12"]];break}},changePeriodField:function(b,c){var a=b.up("form").down("#periodValue");a.getStore().loadData(this.getValuesForNoPeriod(c));a.reset()},getYears:function(f){f=f||1900;var c=new Date(),b=c.getFullYear(),d=0,a=[];for(var e=b;e>=f;e--){a[d]=[d,e];d=d+1}return a},showEnteredValue:function(){var a=this,b=a.getNoPeriodValue();Ext.suspendLayouts();a.down("#editBlock").hide();a.setValue(b);Ext.resumeLayouts(true)},getNoPeriodValue:function(){var b=this,a=b.down("#form_u_statement_period").getForm().getValues();if(1==a.u_statement_period_type){return b.down("#u_statement_period_type_1_date").getRawValue()}else{return b.down("#period").getRawValue()+"."+b.down("#periodValue").getRawValue()+"."+b.down("#year").getRawValue()}},showEditBlock:function(){var a=this;Ext.suspendLayouts();a.down("#editBlock").show();a.down("#enterBtn").hide();a.down("#changeBlock").hide();a.fireEvent("notEnterValue",a.itemId,a);Ext.resumeLayouts(true)},setValue:function(b){var a=this;Ext.suspendLayouts();if(!LkIp.Utils.isEmpty(b)){a.enteredValue=b;a.down('[name="enteredValue"]').update({value:b});a.down('[name="no_period"]').setValue(b);a.down("#changeBlock").show();a.down("#editBlock").hide();a.down("#enterBtn").hide();a.fireEvent("enteredValue",a.itemId,a)}else{a.enteredValue="";a.down("#enterBtn").show();a.down('[name="no_period"]').setValue("");if(a.required){a.fireEvent("notEnterValue",false,a)}else{a.fireEvent("enteredValue",a.itemId,a)}}Ext.resumeLayouts(true);return this},getValue:function(){return this.enteredValue},resetValue:function(){var a=this;Ext.suspendLayouts();a.enteredValue="";a.down('[name="no_period"]').setValue("");a.down("#editBlock").hide();a.down("#changeBlock").hide();a.down("#enterBtn").show();if(a.required){a.fireEvent("notEnterValue",false,a)}else{a.fireEvent("enteredValue",a.itemId,a)}Ext.resumeLayouts(true)}},0,["editPeriod"],["editPeriod","component","container","box"],{editPeriod:true,component:true,container:true,box:true},["widget.editPeriod"],0,[LkIp.view.Rsb.Clarify.Unexpay.Statement,"EditPeriod"],0));Ext.apply(Ext.form.field.VTypes,{length:function(b,a){return b.length==a.maxLength},passwordText:"Length do not match"});(Ext.cmd.derive("LkIp.mixins.Rsb.Unexpay.PaymentInfo",Ext.Base,{setData:function(d,e){var c=this;Ext.suspendLayouts();c.down("#name_plat").update({platDokName:c.checkEmpty(d["@PlatDokName"])});c.down("#nomer_plat").update({platDokNomer:c.checkEmpty(d["@PlatDokNomer"])});c.down("#data_plat").update({platDokData:LkIp.Utils.getDate(c.checkEmpty(d["@PlatDokData"]))});c.down("#summa_plat").update({platDokSumma:LkIp.Utils.numberConvert(c.checkEmpty(d["@PlatDokSumma"]))});c.down("#inn_plat").update({platDokINNPlat:c.checkEmpty(d["@PlatDokINNPlat"])});c.down("#naimen_plat").update({platDokNaimenPlat:c.checkEmpty(d["@PlatDokNaimenPlat"])});c.down("#naimen_pol").update({platDokNaimenPol:c.checkEmpty(d["@PlatDokNaimenPol"])});c.down("#naprav_plat").update({platDokNapravPlat:c.checkEmpty(d["@PlatDokNapravPlat"])});c.down("#inn_pol").update({platDokINNPol:c.checkRow(e,"inn_pol")?c.error(c.checkEmpty(d["@PlatDokINNPol"])):c.checkEmpty(d["@PlatDokINNPol"])});c.down("#kpp_pol").update({platDokKPPPol:c.checkRow(e,"kpp_pol")?c.error(c.checkEmpty(d["@PlatDokKPPPol"])):c.checkEmpty(d["@PlatDokKPPPol"])});c.down("#kbk_pol").update({platDokKBK:c.checkRow(e,"kbk_pol")?c.error(c.checkEmpty(d["@PlatDokKBK"])):c.checkEmpty(d["@PlatDokKBK"])});c.down("#oktmo_pol").update({platDokOKATO_OKTMO:c.checkRow(e,"oktmo_pol")?c.error(c.checkEmpty(d["@PlatDokOKATO_OKTMO"])):c.checkEmpty(d["@PlatDokOKATO_OKTMO"])});c.down("#osn_plat").update({platDokOsnPlat:c.checkRow(e,"osn_plat")?c.error(c.checkEmpty(d["@PlatDokOsnPlat"])):c.checkEmpty(d["@PlatDokOsnPlat"])});c.down("#nal_period").update({platDokNalPeriod:c.checkRow(e,"nal_period")?c.error(c.checkEmpty(d["@PlatDokNalPeriod"])):c.checkEmpty(d["@PlatDokNalPeriod"])});c.down("#nomer_doc_naprav").update({platDokNomerDokNaprav:c.checkRow(e,"nomer_doc_naprav")?c.error(c.checkEmpty(d["@PlatDokNomerDokNaprav"])):c.checkEmpty(d["@PlatDokNomerDokNaprav"])});var b=Ext.isEmpty(d["@PlatDokDataDokNaprav"])?"-":LkIp.Utils.getDate(d["@PlatDokDataDokNaprav"]);c.down("#data_doc_naprav").update({platDokDataDokNaprav:c.checkRow(e,"data_doc_naprav")?c.error(b):b});c.down("#tip_plat").update({platDokTipPlat:c.checkRow(e,"tip_plat")?c.error(c.checkEmpty(d["@PlatDokTipPlat"])):c.checkEmpty(d["@PlatDokTipPlat"])});var a=!Ext.isEmpty(d["@PlatDokStatusPlat"])?d["@PlatDokStatusPlat"]+"-"+d["@PlatDokNaimenStatusPlat"]:"-";c.down("#status_plat").update({statusPlat:c.checkRow(e,"status_plat")?c.error(a):a});Ext.resumeLayouts(true)},checkRow:function(d,c){var b=false,a=c+"_label",e=c+"_value";if(Ext.Array.contains(d,c)){b=true;this.down("#"+a).addCls("red");this.down("#"+e).required=true}return b},checkEmpty:function(a){return Ext.isEmpty(a)?"-":a},removeData:function(){var a=this;Ext.suspendLayouts();a.down("#name_plat").update({platDokName:""});a.down("#nomer_plat").update({platDokNomer:""});a.down("#data_plat").update({platDokData:""});a.down("#summa_plat").update({platDokSumma:""});a.down("#inn_plat").update({platDokINNPlat:""});a.down("#naimen_plat").update({platDokNaimenPlat:""});a.down("#naimen_pol").update({platDokNaimenPol:""});a.down("#naprav_plat").update({platDokNapravPlat:""});a.down("#inn_pol").update({platDokINNPol:""});a.down("#inn_pol_value").resetValue();a.down("#inn_pol_label").removeCls("red");a.down("#kpp_pol").update({platDokKPPPol:""});a.down("#kpp_pol_value").resetValue();a.down("#kpp_pol_label").removeCls("red");a.down("#kbk_pol").update({platDokKBK:""});a.down("#kbk_pol_value").resetValue();a.down("#kbk_pol_label").removeCls("red");a.down("#oktmo_pol").update({platDokOKATO_OKTMO:""});a.down("#oktmo_pol_value").resetValue();a.down("#oktmo_pol_label").removeCls("red");a.down("#osn_plat").update({platDokOsnPlat:""});a.down("#osn_plat_value").resetValue();a.down("#osn_plat_label").removeCls("red");a.down("#nal_period").update({platDokNalPeriod:""});a.down("#nal_period_value").resetValue();a.down("#nal_period_label").removeCls("red");a.down("#nomer_doc_naprav").update({platDokNomerDokNaprav:""});a.down("#nomer_doc_naprav_value").resetValue();a.down("#nomer_doc_naprav_label").removeCls("red");a.down("#data_doc_naprav").update({platDokDataDokNaprav:""});a.down("#data_doc_naprav_value").resetValue();a.down("#data_doc_naprav_label").removeCls("red");a.down("#status_plat").update({statusPlat:""});a.down("#status_plat_value").resetValue();a.down("#status_plat_label").removeCls("red");Ext.resumeLayouts(true)}},0,0,0,0,0,0,[LkIp.mixins.Rsb.Unexpay,"PaymentInfo"],0));(Ext.cmd.derive("LkIp.view.Rsb.Clarify.Unexpay.Statement.Index",Ext.Container,{cls:"rsbUnexpayStatement iScroll",initComponent:function(){var b=this,a=LkIp.Utils.getNowDate();Ext.apply(b,{items:[{xtype:"component",html:"<p>"+reference.lang.rsb.clarify.unexpay.statement.info+"</p>"},{xtype:"component",html:LkIp.Utils.header(reference.lang.pages.instruction,3),margin:"15 0 0 0"},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"1",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.pages.steps.step1Statement}]}]},{xtype:"note",text:reference.lang.rsb.clarify.unexpay.statement.step1help},{xtype:"component",html:LkIp.Utils.header(reference.lang.rsb.clarify.unexpay.statement.document.title,4)},{xtype:"unexpayNoTpl",name:"rsbUStatementNoTpl"},{xtype:"unexpayNotifyTpl",margin:"15 0",name:"rsbUStatementUvedomlTpl"},{xtype:"form",itemId:"rsbUnexpayStatementForm",defaults:{xtype:"container"},margin:"0 0 20 0",items:[{cls:"table-layout",margin:"15 0",layout:{type:"table",columns:2},defaults:{xtype:"component"},items:[{html:reference.lang.rsb.clarify.unexpay.statement.statementTable.title,cellCls:"header",colspan:2},{html:reference.lang.rsb.clarify.unexpay.statement.statementTable.number,cellCls:"label small-column no-border"},{xtype:"editField",formFieldName:"statement_number",itemId:"statement_number",required:false,cellCls:"no-border",actionField:{xtype:"textfield",name:"enterValue",cls:"fl-l",maxLength:20,enforceMaxLength:true}},{html:reference.lang.rsb.clarify.unexpay.statement.statementTable.date,cellCls:"label small-column"},{xtype:"displayfield",componentCls:"text",itemId:"statementDate",value:a,padding:10}]},{cls:"table-layout three-columns",margin:"15 0",layout:{type:"table",columns:3},defaults:{xtype:"component"},items:[{html:reference.lang.rsb.clarify.unexpay.statement.document.details,cellCls:"header small-column"},{html:reference.lang.rsb.clarify.unexpay.statement.document.defaultValues,cellCls:"header"},{html:reference.lang.rsb.clarify.unexpay.statement.document.specifiedValues,cellCls:"header small-column"},{html:reference.lang.rsb.clarify.unexpay.grid.platDokName},{tpl:"{platDokName}",itemId:"name_plat"},{},{html:reference.lang.rsb.clarify.unexpay.grid.platDokNomerFull},{tpl:"{platDokNomer}",itemId:"nomer_plat"},{},{html:reference.lang.rsb.clarify.unexpay.grid.platDokDataFull},{tpl:"{platDokData}",itemId:"data_plat"},{},{html:reference.lang.rsb.clarify.unexpay.grid.platDokSummaFull},{tpl:"{platDokSumma}",itemId:"summa_plat"},{},{html:reference.lang.rsb.clarify.unexpay.grid.platDokINNPlat},{tpl:"{platDokINNPlat}",itemId:"inn_plat"},{},{html:reference.lang.rsb.clarify.unexpay.grid.platDokNaimenPlat},{tpl:"{platDokNaimenPlat}",itemId:"naimen_plat"},{},{html:reference.lang.rsb.clarify.unexpay.grid.platDokINNPol,itemId:"inn_pol_label"},{tpl:"{platDokINNPol}",itemId:"inn_pol"},{xtype:"editField",formFieldName:"inn_pol",itemId:"inn_pol_value",required:false,actionField:{xtype:"textfield",name:"enterValue",cls:"fl-l",maxLength:10,minLength:10,enforceMaxLength:true,maskRe:/[0-9]/,vtype:"length"}},{html:reference.lang.rsb.clarify.unexpay.grid.platDokKPPPol,itemId:"kpp_pol_label"},{tpl:"{platDokKPPPol}",itemId:"kpp_pol"},{xtype:"editField",formFieldName:"kpp_pol",itemId:"kpp_pol_value",required:false,actionField:{xtype:"textfield",name:"enterValue",cls:"fl-l",maxLength:9,minLength:9,enforceMaxLength:true,maskRe:/[0-9]/,vtype:"length"}},{html:reference.lang.rsb.clarify.unexpay.grid.platDokNaimenPol},{tpl:"{platDokNaimenPol}",itemId:"naimen_pol"},{},{html:reference.lang.rsb.clarify.unexpay.grid.platDokKBK,itemId:"kbk_pol_label"},{tpl:"{platDokKBK}",itemId:"kbk_pol"},{xtype:"editField",formFieldName:"kbk_pol",itemId:"kbk_pol_value",required:false,actionField:{xtype:"textfield",name:"enterValue",cls:"fl-l",maxLength:20,minLength:20,enforceMaxLength:true,maskRe:/[0-9]/,vtype:"length",width:200}},{html:reference.lang.rsb.clarify.unexpay.grid.platDokOKATO_OKTMO,itemId:"oktmo_pol_label"},{tpl:"{platDokOKATO_OKTMO}",itemId:"oktmo_pol"},{xtype:"editField",formFieldName:"oktmo_pol",itemId:"oktmo_pol_value",required:false,actionField:{xtype:"textfield",name:"enterValue",cls:"fl-l",maxLength:8,minLength:8,enforceMaxLength:true,maskRe:/[0-9]/,vtype:"length"}},{html:reference.lang.rsb.clarify.unexpay.grid.platDokOsnPlat,itemId:"osn_plat_label"},{tpl:"{platDokOsnPlat}",itemId:"osn_plat"},{xtype:"editField",formFieldName:"osn_plat",itemId:"osn_plat_value",required:false,actionField:{xtype:"filterSelect",displayField:"value",tpl:'<tpl for="."><tpl><li data-qtip="{qtip}" class="x-boundlist-item" role="option">{value}</li></tpl></tpl>',store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"u_statement_osn_plat_store"},typeAhead:false,editable:false,labelWidth:0,width:200,componentCls:"fl-l"}},{html:reference.lang.rsb.clarify.unexpay.grid.platDokNalPeriod,itemId:"nal_period_label"},{tpl:"{platDokNalPeriod}",itemId:"nal_period"},{xtype:"editPeriod",itemId:"nal_period_value",required:false},{html:reference.lang.rsb.clarify.unexpay.grid.platDokNomerDokNapravFull,itemId:"nomer_doc_naprav_label"},{tpl:"{platDokNomerDokNaprav}",itemId:"nomer_doc_naprav"},{xtype:"editField",formFieldName:"nomer_doc_naprav",itemId:"nomer_doc_naprav_value",required:false,actionField:{xtype:"textfield",name:"enterValue",cls:"fl-l",maxLength:20,enforceMaxLength:true}},{html:reference.lang.rsb.clarify.unexpay.grid.platDokDataDokNapravFull,itemId:"data_doc_naprav_label"},{tpl:"{platDokDataDokNaprav}",itemId:"data_doc_naprav"},{xtype:"editField",formFieldName:"data_doc_naprav",itemId:"data_doc_naprav_value",required:false,actionField:{xtype:"filterDate",labelWidth:0,width:150,minValue:"01.01.1995",componentCls:"fl-l",hidden:false}},{html:reference.lang.rsb.clarify.unexpay.grid.platDokTipPlat,itemId:"tip_plat_label"},{tpl:"{platDokTipPlat}",itemId:"tip_plat"},{},{html:reference.lang.rsb.clarify.unexpay.grid.platDokStatusPlat,itemId:"status_plat_label"},{tpl:"{statusPlat}",itemId:"status_plat"},{xtype:"editField",formFieldName:"status_plat",itemId:"status_plat_value",required:false,actionField:{xtype:"filterSelect",tpl:'<tpl for="."><tpl><li data-qtip="{qtip}" class="x-boundlist-item" role="option">{filterValue}</li></tpl></tpl>',store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"u_statement_status_plat_store"},labelWidth:0,width:200,componentCls:"fl-l"}},{html:reference.lang.rsb.clarify.unexpay.grid.platDokNapravPlat,itemId:"naprav_plat_label"},{tpl:"{platDokNapravPlat}",itemId:"naprav_plat",colspan:2}]},{xtype:"note",itemId:"u_statement_require_help",text:reference.lang.rsb.clarify.unexpay.statement.requiredhelp},{xtype:"note",itemId:"u_statement_require_one_enter-help",hidden:true,text:reference.lang.rsb.clarify.unexpay.statement.editOneField},{xtype:"note",itemId:"u_statement_edit_help",hidden:true,text:reference.lang.rsb.clarify.unexpay.statement.editHelp},{xtype:"component",html:"<p>"+reference.lang.rsb.clarify.unexpay.statement.step1ShowHelp+"</p>"},{xtype:"button",rel:"submit",disabled:true,name:"rsbUnexpayStatementShowButton",text:reference.lang.buttons.pdf}]},{cls:"clear"},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"2",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.pages.steps.step2Statement},{xtype:"component",html:"<p>"+reference.lang.pages.steps.step2DescriptionStatement+"</p>"},{xtype:"button",rel:"submit",disabled:true,name:"rsbUnexpayStatementSignButton",text:reference.lang.buttons.signSend}]}]},{cls:"clear"},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"3",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.pages.steps.step3Statement},{xtype:"component",html:"<p>"+reference.lang.pages.steps.step3DescriptionStatement+"</p>"}]}]}]});b.callParent()},error:function(a){return Ext.String.format('<span class="red">{0}</span>',a)}},0,["rsbUnexpayStatement"],["rsbUnexpayStatement","component","container","box"],{rsbUnexpayStatement:true,component:true,container:true,box:true},["widget.rsbUnexpayStatement"],[[LkIp.view.Scrolling.prototype.mixinId||LkIp.view.Scrolling.$className,LkIp.view.Scrolling],[LkIp.mixins.Rsb.Unexpay.PaymentInfo.prototype.mixinId||LkIp.mixins.Rsb.Unexpay.PaymentInfo.$className,LkIp.mixins.Rsb.Unexpay.PaymentInfo]],[LkIp.view.Rsb.Clarify.Unexpay.Statement,"Index"],0));(Ext.cmd.derive("LkIp.view.Rsb.OverpaymentDecisions.Index",Ext.Container,{cls:"rsbOverpaymentDecisions iScroll",initComponent:function(){var a=this,b=[];if(!LkIp.User.isInspectorWithCodeNO()){b.push({labelWidth:140,width:400,xtype:"filterSelect",lang:reference.lang.filters.no,name:"codeNO",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"rsbOverpaymentDecisionsNoStore"}})}Ext.apply(a,{items:[{xtype:"defaultFilterPanel",id:"rsbOverpaymentDecisionsFilterPanel",data:[{cls:b.length>0?"first-column fl-l":"display-none",items:b},{cls:"second-column fl-l",items:[{xtype:"defaultDateFilter",dateFieldName:"date_decision",lang:reference.lang.filters.dateDecision,dateFieldMargin:"5 0 0 0"}]}]},{xtype:"container",cls:"grid-with-status-bar",items:[{xtype:"gridStatusBar",page:"OverpaymentDecisions",data:[{title:reference.lang.rsb.overpaymentDecisions.gridStatus.offsetTab,itemId:"tab-offset",typeDecisions:"1"},{title:reference.lang.rsb.overpaymentDecisions.gridStatus.returnTab,itemId:"tab-return",typeDecisions:"2"}]},{xtype:"gridtable",id:"rsbOverpaymentDecisionsOffsetGrid",store:"Rsb.OverpaymentDecisions.GridStore",columns:[{text:reference.lang.rsb.overpaymentDecisions.grid.kodNo,dataIndex:"@KodNO",width:90,renderer:LkIp.Utils.noRenderer},{text:reference.lang.rsb.overpaymentDecisions.grid.summaResh,dataIndex:"@SummaResh",width:100,renderer:function(c){return LkIp.Utils.numberConvert(c)}},{text:reference.lang.rsb.overpaymentDecisions.grid.svedResh,menuDisabled:true,listeners:{render:function(){this.setWidth(170)}},columns:[{text:reference.lang.rsb.overpaymentDecisions.grid.nomer,dataIndex:"@NomerResh",width:80},{text:reference.lang.rsb.overpaymentDecisions.grid.data,dataIndex:"@DataResh",width:90,renderer:function(c){return !Ext.isEmpty(c)?LkIp.Utils.getDate(c):""}}]},{text:reference.lang.rsb.overpaymentDecisions.grid.dokOsn,listeners:{render:function(){this.setWidth(170)}},menuDisabled:true,columns:[{text:reference.lang.rsb.overpaymentDecisions.grid.nomer,dataIndex:"@NomerDokOsnov",width:80},{text:reference.lang.rsb.overpaymentDecisions.grid.data,dataIndex:"@DataDokOsnov",width:90,renderer:function(c){return !Ext.isEmpty(c)?LkIp.Utils.getDate(c):""}}]},{text:reference.lang.rsb.overpaymentDecisions.grid.svedOverpayment,listeners:{render:function(){this.setWidth(340)}},menuDisabled:true,columns:[{text:reference.lang.rsb.overpaymentDecisions.grid.kbk,dataIndex:"@KBKPerepl",width:170},{text:reference.lang.rsb.overpaymentDecisions.grid.oktmo,dataIndex:"@OKATO_OKTMOPerepl",width:90},{text:reference.lang.rsb.overpaymentDecisions.grid.tipPl,dataIndex:"@TipPlPerepl",width:80}]},{text:reference.lang.rsb.overpaymentDecisions.grid.svedZachet,listeners:{render:function(){this.setWidth(390)}},menuDisabled:true,columns:[{text:reference.lang.rsb.overpaymentDecisions.grid.kbk,dataIndex:"@KBKZachet",width:170},{text:reference.lang.rsb.overpaymentDecisions.grid.oktmo,dataIndex:"@OKATO_OKTMOZachet",width:150},{text:reference.lang.rsb.overpaymentDecisions.grid.tipPl,dataIndex:"@TipPlZachet",width:70}]}]},{xtype:"gridtable",id:"rsbOverpaymentDecisionsReturnGrid",store:"Rsb.OverpaymentDecisions.GridStore",hidden:true,columns:[{text:reference.lang.rsb.overpaymentDecisions.grid.kodNo,dataIndex:"@KodNO",width:90,renderer:LkIp.Utils.noRenderer},{text:reference.lang.rsb.overpaymentDecisions.grid.summaResh,dataIndex:"@SummaResh",width:100,renderer:function(c){return LkIp.Utils.numberConvert(c)}},{text:reference.lang.rsb.overpaymentDecisions.grid.svedResh,menuDisabled:true,listeners:{render:function(){this.setWidth(170)}},columns:[{text:reference.lang.rsb.overpaymentDecisions.grid.nomer,dataIndex:"@NomerResh",width:80},{text:reference.lang.rsb.overpaymentDecisions.grid.data,dataIndex:"@DataResh",width:90,renderer:function(c){return !Ext.isEmpty(c)?LkIp.Utils.getDate(c):""}}]},{text:reference.lang.rsb.overpaymentDecisions.grid.dokOsn,listeners:{render:function(){this.setWidth(170)}},menuDisabled:true,columns:[{text:reference.lang.rsb.overpaymentDecisions.grid.nomer,dataIndex:"@NomerDokOsnov",width:80},{text:reference.lang.rsb.overpaymentDecisions.grid.data,dataIndex:"@DataDokOsnov",width:90,renderer:function(c){return !Ext.isEmpty(c)?LkIp.Utils.getDate(c):""}}]},{text:reference.lang.rsb.overpaymentDecisions.grid.svedOverpayment,listeners:{render:function(){this.setWidth(320)}},menuDisabled:true,columns:[{text:reference.lang.rsb.overpaymentDecisions.grid.kbk,dataIndex:"@KBKPerepl",width:170},{text:reference.lang.rsb.overpaymentDecisions.grid.oktmo,dataIndex:"@OKATO_OKTMOPerepl",width:80},{text:reference.lang.rsb.overpaymentDecisions.grid.tipPl,dataIndex:"@TipPlPerepl",width:70}]},{text:reference.lang.rsb.overpaymentDecisions.grid.svedVozvrat,menuDisabled:true,listeners:{render:function(){this.setWidth(300)}},columns:[{text:reference.lang.rsb.overpaymentDecisions.grid.nomerScheta,dataIndex:"@NomSchet",width:150},{text:reference.lang.rsb.overpaymentDecisions.grid.naimenBank,dataIndex:"@NaimBank",width:150},{text:reference.lang.rsb.overpaymentDecisions.grid.innKpp,dataIndex:"@INKPP",width:150,hidden:true,listeners:{show:function(){this.ownerCt.setWidth(this.ownerCt.getWidth()+150)},hide:function(){this.ownerCt.setWidth(this.ownerCt.getWidth()-150)}}},{text:reference.lang.rsb.overpaymentDecisions.grid.bik,dataIndex:"@BIKBank",width:90,hidden:true,listeners:{show:function(){this.ownerCt.setWidth(this.ownerCt.getWidth()+90)},hide:function(){this.ownerCt.setWidth(this.ownerCt.getWidth()-90)}}}]}]}]}]});this.callParent()}},0,["rsbOverpaymentDecisions"],["component","container","rsbOverpaymentDecisions","box"],{component:true,container:true,rsbOverpaymentDecisions:true,box:true},["widget.rsbOverpaymentDecisions"],[[LkIp.view.Scrolling.prototype.mixinId||LkIp.view.Scrolling.$className,LkIp.view.Scrolling]],[LkIp.view.Rsb.OverpaymentDecisions,"Index"],0));(Ext.cmd.derive("LkIp.view.Rsb.SuspendedDecisions.Grid",LkIp.view.Default.Grid,{itemId:"rsbSuspendedDecisionsGrid",store:"Rsb.SuspendedDecisions.GridStore",initComponent:function(){var a=this;Ext.apply(a,{columns:[{text:reference.lang.rsb.suspendedDecisions.grid.kodNo,dataIndex:"@KodNO",width:100,sortable:false,renderer:LkIp.Utils.noRenderer},{text:reference.lang.rsb.suspendedDecisions.grid.svedResh,listeners:{render:function(){this.setWidth(180)}},menuDisabled:true,columns:[{text:reference.lang.rsb.suspendedDecisions.grid.nomer,dataIndex:"@NomerResh",width:90},{text:reference.lang.rsb.suspendedDecisions.grid.data,dataIndex:"@DataResh",width:90,renderer:function(b){return !Ext.isEmpty(b)?LkIp.Utils.getDate(b):""}}]},{text:reference.lang.rsb.suspendedDecisions.grid.naimenBanka,dataIndex:"@NaimBanka",flex:1},{text:reference.lang.rsb.suspendedDecisions.grid.nomerScheta,dataIndex:"@NomerScheta",width:300,renderer:function(c){var b="";Ext.Array.each(c,function(d){b+=d+"</br>"});return b}},{text:reference.lang.rsb.suspendedDecisions.grid.osnResh,dataIndex:"@OsnovanieVyistResh",width:150,hidden:true}]});this.callParent(arguments)}},0,["rsbSuspendedDecisionsGrid"],["panel","gridtable","component","tablepanel","container","grid","box","gridpanel","rsbSuspendedDecisionsGrid"],{panel:true,gridtable:true,component:true,tablepanel:true,container:true,grid:true,box:true,gridpanel:true,rsbSuspendedDecisionsGrid:true},["widget.rsbSuspendedDecisionsGrid"],0,[LkIp.view.Rsb.SuspendedDecisions,"Grid"],0));(Ext.cmd.derive("LkIp.view.Rsb.PvzDecisions.Index",Ext.Container,{cls:"rsbPvzDecisions iScroll",initComponent:function(){var a=this;Ext.apply(a,{items:[!LkIp.User.isInspectorWithCodeNO()?{xtype:"defaultFilterPanel",id:"rsbPvzDecisionsFilterPanel",data:[{cls:"first-column fl-l",items:[{labelWidth:140,width:400,xtype:"filterSelect",lang:reference.lang.filters.no,name:"codeNO",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"rsbPvzDecisionsNoStore"}}]}]}:{cls:"display-none"},{xtype:"gridtable",id:"rsbPvzDecisionsGrid",store:"Rsb.PvzDecisions.GridStore",columns:[{text:reference.lang.rsb.pvzDecisions.grid.kodNo,dataIndex:"@KodNO",width:100,renderer:LkIp.Utils.noRenderer},{text:reference.lang.rsb.pvzDecisions.grid.osnResh,menuDisabled:true,listeners:{render:function(){this.setWidth(350)}},columns:[{text:reference.lang.rsb.pvzDecisions.grid.nomerData,dataIndex:"@OsnResh",width:350,renderer:function(c){var b="";Ext.Array.each(c,function(d){b+=d["@Nomer"]+" / "+LkIp.Utils.getDate(d["@Data"])+"</br>"});return b}}]},{text:reference.lang.rsb.pvzDecisions.grid.svedResh,listeners:{render:function(){this.setWidth(180)}},menuDisabled:true,columns:[{text:reference.lang.rsb.pvzDecisions.grid.nomer,dataIndex:"@NomerResh",width:90},{text:reference.lang.rsb.pvzDecisions.grid.data,dataIndex:"@DataResh",width:90,renderer:function(b){return !Ext.isEmpty(b)?LkIp.Utils.getDate(b):""}}]},{text:LkIp.Utils.rouble(reference.lang.rsb.pvzDecisions.grid.summaZadolj),dataIndex:"@SummaZadolj",width:200,renderer:function(b){return LkIp.Utils.numberConvert(b)}},{text:LkIp.Utils.rouble(reference.lang.rsb.pvzDecisions.grid.summaOstatok),dataIndex:"@SummNevzZadolj",flex:1,renderer:function(b){return LkIp.Utils.numberConvert(b)}}]},{xtype:"container",itemId:"suspendedBlock",hidden:true,items:[{xtype:"component",html:LkIp.Utils.header(reference.lang.rsb.pvzDecisions.suspendedTitle,4),margin:"10 0 0 0"},{xtype:"rsbSuspendedDecisionsGrid",store:"Rsb.PvzDecisions.Suspended.GridStore"}]}]});this.callParent()}},0,["rsbPvzDecisions"],["component","container","rsbPvzDecisions","box"],{component:true,container:true,rsbPvzDecisions:true,box:true},["widget.rsbPvzDecisions"],[[LkIp.view.Scrolling.prototype.mixinId||LkIp.view.Scrolling.$className,LkIp.view.Scrolling]],[LkIp.view.Rsb.PvzDecisions,"Index"],0));(Ext.cmd.derive("LkIp.view.Rsb.SuspendedDecisions.Index",Ext.Container,{cls:"rsbSuspendedDecisions iScroll",initComponent:function(){var a=this;Ext.apply(a,{items:[!LkIp.User.isInspectorWithCodeNO()?{xtype:"defaultFilterPanel",id:"rsbSuspendedDecisionsFilterPanel",data:[{cls:"first-column fl-l",items:[{labelWidth:140,width:400,xtype:"filterSelect",lang:reference.lang.filters.no,name:"codeNO",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"rsbSuspendedDecisionsNoStore"}}]}]}:{cls:"display-none"},{xtype:"rsbSuspendedDecisionsGrid"}]});this.callParent()}},0,["rsbSuspendedDecisions"],["component","container","box","rsbSuspendedDecisions"],{component:true,container:true,box:true,rsbSuspendedDecisions:true},["widget.rsbSuspendedDecisions"],[[LkIp.view.Scrolling.prototype.mixinId||LkIp.view.Scrolling.$className,LkIp.view.Scrolling]],[LkIp.view.Rsb.SuspendedDecisions,"Index"],0));(Ext.cmd.derive("LkIp.view.Rsb.DebitDecisions.Index",Ext.Container,{cls:"rsbDebitDecisions iScroll",initComponent:function(){var b=this,a=[];if(!LkIp.User.isInspectorWithCodeNO()){a.push({lang:reference.lang.filters.no,name:"codeNO",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"rsbDebitDecisionsNoStore"}})}a.push({lang:reference.lang.rsb.debitDecisions.filters.reasonDecision,name:"reason",tpl:'<tpl for="."><tpl if="code != 0"><li data-qtip="{qtip}" class="x-boundlist-item" role="option">{value}</li></tpl><tpl if="code == 0"><li class="x-boundlist-item" role="option">{value}</li></tpl></tpl>',displayField:"value",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"rsbDebitDecisionsReasonStore"}});Ext.apply(b,{items:[{xtype:"defaultFilterPanel",id:"rsbDebitDecisionsFilterPanel",data:[{cls:"first-column fl-l",defaults:{labelWidth:140,width:400,xtype:"filterSelect"},items:a},{cls:"second-column fl-l",items:[{labelWidth:100,width:400,xtype:"filterSelect",lang:reference.lang.filters.kbk,name:"kbk",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"rsbDebitDecisionsKbkStore"}}]}]},{xtype:"gridtable",id:"rsbDebitDecisionsGrid",store:"Rsb.DebitDecisions.GridStore",columns:[{text:reference.lang.rsb.debitDecisions.grid.kodNo,dataIndex:"@KodNO",width:90,renderer:LkIp.Utils.noRenderer},{text:reference.lang.rsb.debitDecisions.grid.svedResh,menuDisabled:true,columns:[{text:reference.lang.rsb.debitDecisions.grid.nomer,dataIndex:"@NomerResh",width:80},{text:reference.lang.rsb.debitDecisions.grid.data,dataIndex:"@DataResh",width:90,renderer:function(c){return !Ext.isEmpty(c)?LkIp.Utils.getDate(c):""}}]},{text:reference.lang.rsb.debitDecisions.grid.osnovanie,dataIndex:"@Osnovanie",width:230,renderer:function(c){if(!Ext.isEmpty(c)){return LkIp.Utils.ucfirst(c)}return""}},{text:reference.lang.rsb.debitDecisions.grid.naimenKbk,dataIndex:"@NaimenKBK",width:200},{text:reference.lang.rsb.debitDecisions.grid.kbk,dataIndex:"@KBK",width:170},{text:reference.lang.rsb.debitDecisions.grid.oktmo,dataIndex:"@OKATO_OKTMO",width:110},{text:reference.lang.rsb.debitDecisions.grid.summa,dataIndex:"@Summa",width:80,renderer:function(c){return !Ext.isEmpty(c)?LkIp.Utils.numberConvert(c):"-"}},{text:reference.lang.rsb.debitDecisions.grid.nalog,dataIndex:"@Nalog",width:80,renderer:function(c){return !Ext.isEmpty(c)?LkIp.Utils.numberConvert(c):"-"}},{text:reference.lang.rsb.debitDecisions.grid.peni,dataIndex:"@Peni",width:80,renderer:function(c){return !Ext.isEmpty(c)?LkIp.Utils.numberConvert(c):"-"}},{text:reference.lang.rsb.debitDecisions.grid.shtraf,dataIndex:"@Shtraf",width:80,renderer:function(c){return !Ext.isEmpty(c)?LkIp.Utils.numberConvert(c):"-"}},{text:reference.lang.rsb.debitDecisions.grid.protsent,dataIndex:"@Protsent",width:80,renderer:function(c){return !Ext.isEmpty(c)?LkIp.Utils.numberConvert(c):"-"}}]}]});this.callParent()}},0,["rsbDebitDecisions"],["component","container","box","rsbDebitDecisions"],{component:true,container:true,box:true,rsbDebitDecisions:true},["widget.rsbDebitDecisions"],[[LkIp.view.Scrolling.prototype.mixinId||LkIp.view.Scrolling.$className,LkIp.view.Scrolling]],[LkIp.view.Rsb.DebitDecisions,"Index"],0));(Ext.cmd.derive("LkIp.view.Rsb.Clarify.Other.Index",Ext.Container,{cls:"rsbClarifyOther iScroll",required:'<span class="form-required-field" data-qtip="'+reference.lang.form.required+'">*</span>',initComponent:function(){var a=this;Ext.apply(a,{items:[{xtype:"component",tpl:"<p>"+reference.lang.rsb.clarify.other.info+"</p>"},{xtype:"component",html:LkIp.Utils.header(reference.lang.pages.instruction,3)},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"1",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.pages.steps.step1Statement},{xtype:"component",html:"<p>"+reference.lang.rsb.clarify.other.details.title+"</p>"},{xtype:"form",itemId:"rsbClarifyOtherFindForm",items:[{xtype:"container",defaults:{labelWidth:250,width:400},items:[{xtype:"textfield",name:"number",fieldLabel:reference.lang.rsb.clarify.other.details.number,listeners:{change:function(c){var d=c.up("form"),f=d.down('[name="summ"]').getValue(),e=c.getValue(),b=d.down('[name="rsbClarifyOtherFindButton"]');if(d.isValid()){if(Ext.isEmpty(e)&&Ext.isEmpty(f)){b.disable()}else{b.enable()}}}}},{xtype:"filterDate",fieldLabel:reference.lang.rsb.clarify.other.details.date,hidden:false,name:"date",allowBlank:false,afterLabelTextTpl:a.required},{xtype:"numberfield",name:"summ",fieldLabel:reference.lang.rsb.clarify.other.details.summ,hideTrigger:true,listeners:{change:function(c){var e=c.up("form"),d=e.down('[name="number"]').getValue(),f=c.getValue(),b=e.down('[name="rsbClarifyOtherFindButton"]');if(e.isValid()){if(Ext.isEmpty(f)&&Ext.isEmpty(d)){b.disable()}else{b.enable()}}}}}]},{xtype:"button",margin:"15 0 0",rel:"submit",disabled:true,formBind:true,name:"rsbClarifyOtherFindButton",text:reference.lang.buttons.find}]},{xtype:"note",text:reference.lang.rsb.clarify.other.help},{xtype:"container",itemId:"rsbClarifyOtherPaymentContainer",items:[{xtype:"container",itemId:"rsbClarifyOtherPaymentGridContainer",layout:{type:"auto"},hidden:true,items:[{xtype:"component",itemId:"rsbClarifyOtherGridHeader",html:LkIp.Utils.header(reference.lang.rsb.clarify.other.gridHeader,4)},{xtype:"rsbUnexpayGridIndex",margin:"15 0",id:"rsbClarifyOtherGrid",queryMode:"local",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Rsb.Clarify.Unexpay.Grid",autoDestroy:true,storeId:"rsbClarifyOtherGridStore"},limitFilter:false,getFileAction:false,paging:false,contextMenu:false},{xtype:"button",disabled:true,name:"rsbClarifyOtherChooseButton",text:reference.lang.rsb.clarify.other.choose,margin:"0 15 0 0"}]},{xtype:"container",itemId:"rsbClarifyOtherPaymentEditContainer",hidden:true,items:[{xtype:"note",text:reference.lang.rsb.clarify.other.editHelp},{xtype:"component",itemId:"rsbClarifyOtherPaymentHeader",html:LkIp.Utils.header(reference.lang.rsb.clarify.other.paymentHeader,4)},{xtype:"form",itemId:"rsbClarifyOtherPaymentForm",items:[{cls:"table-layout three-columns",margin:"15 0",layout:{type:"table",columns:3},defaults:{xtype:"component"},items:[{html:reference.lang.rsb.clarify.unexpay.statement.document.details,cellCls:"header small-column"},{html:reference.lang.rsb.clarify.unexpay.statement.document.defaultValues,cellCls:"header"},{html:reference.lang.rsb.clarify.unexpay.statement.document.specifiedValues,cellCls:"header small-column"},{html:reference.lang.rsb.clarify.unexpay.grid.platDokName},{tpl:"{platDokName}",itemId:"name_plat"},{},{html:reference.lang.rsb.clarify.unexpay.grid.platDokNomerFull},{tpl:"{platDokNomer}",itemId:"nomer_plat"},{},{html:reference.lang.rsb.clarify.unexpay.grid.platDokDataFull},{tpl:"{platDokData}",itemId:"data_plat"},{},{html:reference.lang.rsb.clarify.unexpay.grid.platDokSummaFull},{tpl:"{platDokSumma}",itemId:"summa_plat"},{},{html:reference.lang.rsb.clarify.unexpay.grid.platDokINNPlat},{tpl:"{platDokINNPlat}",itemId:"inn_plat"},{},{html:reference.lang.rsb.clarify.unexpay.grid.platDokNaimenPlat},{tpl:"{platDokNaimenPlat}",itemId:"naimen_plat"},{},{html:reference.lang.rsb.clarify.unexpay.grid.platDokINNPol,itemId:"inn_pol_label"},{tpl:"{platDokINNPol}",itemId:"inn_pol"},{xtype:"editField",formFieldName:"inn_pol",itemId:"inn_pol_value",required:false,actionField:{xtype:"textfield",name:"enterValue",cls:"fl-l",maxLength:10,minLength:10,enforceMaxLength:true,maskRe:/[0-9]/,vtype:"length"}},{html:reference.lang.rsb.clarify.unexpay.grid.platDokKPPPol,itemId:"kpp_pol_label"},{tpl:"{platDokKPPPol}",itemId:"kpp_pol"},{xtype:"editField",formFieldName:"kpp_pol",itemId:"kpp_pol_value",required:false,actionField:{xtype:"textfield",name:"enterValue",cls:"fl-l",maxLength:9,minLength:9,enforceMaxLength:true,maskRe:/[0-9]/,vtype:"length"}},{html:reference.lang.rsb.clarify.unexpay.grid.platDokNaimenPol},{tpl:"{platDokNaimenPol}",itemId:"naimen_pol"},{},{html:reference.lang.rsb.clarify.unexpay.grid.platDokKBK,itemId:"kbk_pol_label"},{tpl:"{platDokKBK}",itemId:"kbk_pol"},{xtype:"editField",formFieldName:"kbk_pol",itemId:"kbk_pol_value",required:false,actionField:{xtype:"textfield",name:"enterValue",cls:"fl-l",maxLength:20,minLength:20,enforceMaxLength:true,maskRe:/[0-9]/,vtype:"length"}},{html:reference.lang.rsb.clarify.unexpay.grid.platDokOKATO_OKTMO,itemId:"oktmo_pol_label"},{tpl:"{platDokOKATO_OKTMO}",itemId:"oktmo_pol"},{xtype:"editField",formFieldName:"oktmo_pol",itemId:"oktmo_pol_value",required:false,actionField:{xtype:"textfield",name:"enterValue",cls:"fl-l",maxLength:8,minLength:8,enforceMaxLength:true,maskRe:/[0-9]/,vtype:"length"}},{html:reference.lang.rsb.clarify.unexpay.grid.platDokOsnPlat,itemId:"osn_plat_label"},{tpl:"{platDokOsnPlat}",itemId:"osn_plat"},{xtype:"editField",formFieldName:"osn_plat",itemId:"osn_plat_value",required:false,actionField:{xtype:"filterSelect",displayField:"value",tpl:'<tpl for="."><tpl><li data-qtip="{qtip}" class="x-boundlist-item" role="option">{value}</li></tpl></tpl>',store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"u_clarify_other_osn_plat_store"},typeAhead:false,editable:false,labelWidth:0,width:170,componentCls:"fl-l"},enteredValueBlock:{width:160}},{html:reference.lang.rsb.clarify.unexpay.grid.platDokNalPeriod,itemId:"nal_period_label"},{tpl:"{platDokNalPeriod}",itemId:"nal_period"},{xtype:"editPeriod",itemId:"nal_period_value",required:false},{html:reference.lang.rsb.clarify.unexpay.grid.platDokNomerDokNapravFull,itemId:"nomer_doc_naprav_label"},{tpl:"{platDokNomerDokNaprav}",itemId:"nomer_doc_naprav"},{xtype:"editField",formFieldName:"nomer_doc_naprav",itemId:"nomer_doc_naprav_value",required:false,actionField:{xtype:"textfield",name:"enterValue",cls:"fl-l",maxLength:20,enforceMaxLength:true}},{html:reference.lang.rsb.clarify.unexpay.grid.platDokDataDokNapravFull,itemId:"data_doc_naprav_label"},{tpl:"{platDokDataDokNaprav}",itemId:"data_doc_naprav"},{xtype:"editField",formFieldName:"data_doc_naprav",itemId:"data_doc_naprav_value",required:false,actionField:{xtype:"filterDate",minValue:"01.01.1995",labelWidth:0,width:150,componentCls:"fl-l",hidden:false}},{html:reference.lang.rsb.clarify.unexpay.grid.platDokTipPlat,itemId:"tip_plat_label"},{tpl:"{platDokTipPlat}",itemId:"tip_plat"},{},{html:reference.lang.rsb.clarify.unexpay.grid.platDokStatusPlat,itemId:"status_plat_label"},{tpl:"{statusPlat}",itemId:"status_plat"},{xtype:"editField",formFieldName:"status_plat",itemId:"status_plat_value",required:false,actionField:{xtype:"filterSelect",tpl:'<tpl for="."><tpl><li data-qtip="{qtip}" class="x-boundlist-item" role="option">{filterValue}</li></tpl></tpl>',store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"u_clarify_other_status_plat_store"},labelWidth:0,width:170,componentCls:"fl-l"}},{html:reference.lang.rsb.clarify.unexpay.grid.platDokNapravPlat,itemId:"naprav_plat_label"},{tpl:"{platDokNapravPlat}",itemId:"naprav_plat",colspan:2}]}]},{xtype:"note",itemId:"u_clarify_other_edit_help",hidden:true,text:reference.lang.rsb.clarify.unexpay.statement.editHelp},{xtype:"note",itemId:"u_clarify_other_enter_one_field_help",text:reference.lang.rsb.clarify.unexpay.statement.editOneField},{xtype:"component",html:"<p>"+reference.lang.rsb.clarify.other.showHelp+"</p>"},{xtype:"button",rel:"submit",disabled:true,name:"rsbClarifyOtherShowButton",text:reference.lang.buttons.pdf}]}]}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"2",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.pages.steps.step2Statement},{xtype:"component",html:"<p>"+reference.lang.rsb.clarify.other.step2Description+"</p>"},{xtype:"button",rel:"submit",disabled:true,formBind:true,name:"rsbClarifyOtherSignButton",text:reference.lang.buttons.signSend}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"3",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.pages.steps.step3Statement},{xtype:"component",html:"<p>"+reference.lang.pages.steps.step3DescriptionStatement+"</p>"}]}]}]});this.callParent()},checkRow:function(b,a){return false}},0,["rsbClarifyOther"],["rsbClarifyOther","component","container","box"],{rsbClarifyOther:true,component:true,container:true,box:true},["widget.rsbClarifyOther"],[[LkIp.view.Scrolling.prototype.mixinId||LkIp.view.Scrolling.$className,LkIp.view.Scrolling],[LkIp.mixins.Rsb.Unexpay.PaymentInfo.prototype.mixinId||LkIp.mixins.Rsb.Unexpay.PaymentInfo.$className,LkIp.mixins.Rsb.Unexpay.PaymentInfo]],[LkIp.view.Rsb.Clarify.Other,"Index"],0));(Ext.cmd.derive("LkIp.view.Partnership.Index",Ext.Container,{id:"partnership",cls:"partnership",initComponent:function(){Ext.apply(this,{items:[{xtype:"form",itemId:"partnership-form",items:[{xtype:"component",html:reference.lang.partnership.info},{xtype:"container",layout:{type:"auto"},margin:"20 0 0 0",items:[{xtype:"component",html:LkIp.Utils.header(reference.lang.pages.instruction,3),cls:"fl-l"}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"1",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.partnership.step1}]},{layout:"auto",margin:"10 0",defaults:{labelWidth:400,width:650,padding:"10 0 0"},cls:"fields-container",items:[{xtype:"displayfield",name:"fullName",fieldLabel:reference.lang.partnership.fio,value:LkIp.User.get("fullName")},{xtype:"displayfield",name:"inn",fieldLabel:reference.lang.partnership.inn,value:LkIp.User.get("inn")},{xtype:"displayfield",name:"ogrnip",fieldLabel:reference.lang.partnership.ogrnip,value:LkIp.User.get("ogrn")},{xtype:"displayfield",name:"date",fieldLabel:reference.lang.partnership.date,value:LkIp.Utils.getNowDate()},{xtype:"filterSelect",lang:"no",name:"no",tpl:'<tpl for="."><tpl if="code != 0"><li data-qtip="{qtip}" class="x-boundlist-item" role="option">{fullName}</li></tpl><tpl if="code == 0"><li class="x-boundlist-item" role="option">{value}</li></tpl></tpl>',fieldLabel:reference.lang.partnership.no,afterLabelTextTpl:LkIp.Utils.requiredLabel(),allowBlank:false,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"partnershipNoStore"}},{xtype:"radiogroup",cls:"checkbox-group",labelAlign:"top",vertical:true,columns:1,columnWidth:"100%",fieldLabel:reference.lang.partnership.reasonPartnership,afterLabelTextTpl:LkIp.Utils.requiredLabel(),allowBlank:false,defaults:{margin:"0 0 0 25",name:"reasonPartnership"},items:[{boxLabel:reference.lang.partnership.reason.start,checked:true,inputValue:1},{boxLabel:reference.lang.partnership.reason.change,inputValue:2}]},{xtype:"filterDate",name:"reasonPartnerShipDateStart",hidden:false,allowBlank:false,width:550,maxValue:undefined,fieldLabel:reference.lang.partnership.reasonPartnershipDate,afterLabelTextTpl:LkIp.Utils.requiredLabel()},{xtype:"numberfield",hideTrigger:true,allowBlank:false,afterLabelTextTpl:LkIp.Utils.requiredLabel(),name:"percent",fieldLabel:reference.lang.partnership.percent,width:550,afterBodyEl:" %",minValue:0,allowExponential:false,labelWidth:400},{xtype:"filterDate",name:"reasonPartnerShipDateEnd",hidden:false,allowBlank:true,maxValue:undefined,width:550,fieldLabel:reference.lang.partnership.reasonPartnershipEndDate}]},{xtype:"component",cls:"partnership-form-header",html:reference.lang.partnership.organizationTitle},{xtype:"textfield",allowBlank:false,afterLabelTextTpl:LkIp.Utils.requiredLabel(),name:"organizationName",fieldLabel:reference.lang.partnership.organizationName,labelWidth:400,width:650,padding:"10 0 0"},{xtype:"container",itemId:"chooseRussian",defaults:{xtype:"textfield",labelWidth:400,allowBlank:false,afterLabelTextTpl:LkIp.Utils.requiredLabel(),enforceMaxLength:true,width:550,padding:"10 0 0"},cls:"fields-container",margin:"0",items:[{name:"innUl",maxLength:12,minLength:10,maskRe:/[0-9]/,fieldLabel:reference.lang.partnership.innUl},{name:"kppUl",maxLength:9,minLength:9,fieldLabel:reference.lang.partnership.kppUl},{name:"ogrnUl",maxLength:13,minLength:13,maskRe:/[0-9]/,fieldLabel:reference.lang.partnership.ogrnUl}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"2",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.partnership.step2},{xtype:"component",html:"<p>"+reference.lang.partnership.step2Description+"</p>"}]},{xtype:"container",layout:"hbox",defaults:{xtype:"button",formBind:true},items:[{name:"partnershipShowButton",itemId:"partnershipShowButton",text:reference.lang.buttons.pdf,margin:"0 15 0 0"},{name:"partnershipSignButton",formBind:true,disabled:true,text:reference.lang.buttons.signSend}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"3",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.partnership.step3},{xtype:"component",html:"<p>"+reference.lang.partnership.step3Description+"</p>"}]}]}]}]});this.callParent()}},0,["partnership"],["component","container","box","partnership"],{component:true,container:true,box:true,partnership:true},["widget.partnership"],0,[LkIp.view.Partnership,"Index"],0));(Ext.cmd.derive("LkIp.view.Rsb.Reconciliation.Index",Ext.Container,{cls:"rsbReconciliation iScroll",initComponent:function(){var a=[],b=[];if(!LkIp.User.isInspectorWithCodeNO()){a.push({lang:reference.lang.filters.no,name:"codeNO",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"rsbReconciliationNoStore"}});b.push({lang:reference.lang.filters.no,name:"codeNO",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"rsbReconciliationStatementNoStore"}})}a.push({lang:reference.lang.rsb.reconciliation.filters.reason,tpl:'<tpl for="."><tpl if="code != 0"><li data-qtip="{qtip}" class="x-boundlist-item" role="option">{value}</li></tpl><tpl if="code == 0"><li class="x-boundlist-item" role="option">{value}</li></tpl></tpl>',displayField:"value",name:"reason",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"rsbReconciliationReasonStore"}},{lang:reference.lang.rsb.reconciliation.filters.section,tpl:'<tpl for="."><tpl if="code != 0"><li data-qtip="{qtip}" class="x-boundlist-item" role="option">{value}</li></tpl><tpl if="code == 0"><li class="x-boundlist-item" role="option">{value}</li></tpl></tpl>',displayField:"value",name:"section",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"rsbReconciliationSectionStore",data:[{code:0,value:reference.lang.rsb.reconciliation.sectionValue.all},{code:1,value:reference.lang.rsb.reconciliation.sectionValue.oneAndTwo},{code:2,value:reference.lang.rsb.reconciliation.sectionValue.one},{code:3,value:reference.lang.rsb.reconciliation.sectionValue.two}]}});b.push({lang:reference.lang.rsb.reconciliation.filters.reason,tpl:'<tpl for="."><tpl if="code != 0"><li data-qtip="{qtip}" class="x-boundlist-item" role="option">{value}</li></tpl><tpl if="code == 0"><li class="x-boundlist-item" role="option">{value}</li></tpl></tpl>',displayField:"value",name:"reason",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"rsbReconciliationStatementReasonStore"}},{lang:reference.lang.filters.kbk,name:"kbk",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"rsbReconciliationStatementKbkStore"}},{lang:reference.lang.filters.statusIP,name:"statusIP",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"rsbReconciliationStatementStatusIPStore"}});Ext.apply(this,{items:[{xtype:"tabpanel",cls:"tabs-block tabs-block-border-bottom",id:"reconciliationTabPanel",plain:true,items:[{title:reference.lang.rsb.reconciliation.commonTab,type:"tab",cls:"common-tab",itemId:"tab-reconciliation-common",items:[{xtype:"component",html:"<p>"+reference.lang.rsb.reconciliation.helpText+"</p>"},{xtype:"component",html:LkIp.Utils.header(reference.lang.rsb.reconciliation.grid.title,4),margin:"15 0 0 0"},{xtype:"defaultFilterPanel",id:"rsbReconciliationFilterPanel",data:[{cls:"first-column fl-l",defaults:{labelWidth:135,width:380,xtype:"filterSelect"},items:a},{cls:"second-column fl-l",items:[{xtype:"defaultDateFilter",dateFieldName:"dateStart",labelWidth:135,lang:reference.lang.rsb.reconciliation.filters.dateStart},{xtype:"defaultDateFilter",dateFieldName:"dateFinish",labelWidth:135,margin:"5 0 0",lang:reference.lang.rsb.reconciliation.filters.dateFinish},{xtype:"defaultDateFilter",dateFieldName:"dateStartPeriod",labelWidth:135,margin:"5 0 0",lang:reference.lang.rsb.reconciliation.filters.dateStartPeriod},{xtype:"defaultDateFilter",dateFieldName:"dateFinishPeriod",labelWidth:135,lang:reference.lang.rsb.reconciliation.filters.dateFinishPeriod}]}]},{xtype:"gridtable",id:"rsbReconciliationGrid",store:"Rsb.Reconciliation.GridStore",columns:[{text:reference.lang.rsb.reconciliation.grid.kodNo,dataIndex:"@KodNO",width:100,renderer:LkIp.Utils.noRenderer},{text:reference.lang.rsb.reconciliation.grid.nomerAkt,dataIndex:"@NomerAktaSver",width:90},{text:reference.lang.rsb.reconciliation.grid.nomerZayavl,dataIndex:"@NomerZayavl",width:100},{text:reference.lang.rsb.reconciliation.grid.dataZayavl,dataIndex:"@DataZayavl",width:100,renderer:function(c){return !Ext.isEmpty(c)?LkIp.Utils.getDate(c):""}},{text:reference.lang.rsb.reconciliation.grid.razdel,dataIndex:"@FormaSver",width:85,renderer:function(c){switch(c){case"0":return reference.lang.rsb.reconciliation.sectionValue.oneAndTwo;case"1":return reference.lang.rsb.reconciliation.sectionValue.one;case"2":return reference.lang.rsb.reconciliation.sectionValue.two}}},{text:reference.lang.rsb.reconciliation.grid.dataNachSver,dataIndex:"@DataNachSver",width:85,renderer:function(c){return !Ext.isEmpty(c)?LkIp.Utils.getDate(c):""}},{text:reference.lang.rsb.reconciliation.grid.dataKonSver,dataIndex:"@DataKonSver",width:95,renderer:function(c){return !Ext.isEmpty(c)?LkIp.Utils.getDate(c):""}},{text:reference.lang.rsb.reconciliation.grid.prichOkonSver,dataIndex:"@PrichOkonSver",width:150},{text:reference.lang.rsb.reconciliation.grid.dataNachPeriod,dataIndex:"@DataNachSverPeriod",width:100,renderer:function(c){return !Ext.isEmpty(c)?LkIp.Utils.getDate(c):""}},{text:reference.lang.rsb.reconciliation.grid.dataKonPeriod,dataIndex:"@DataKonSverPeriod",width:100,renderer:function(c){return !Ext.isEmpty(c)?LkIp.Utils.getDate(c):""}}]},{xtype:"button",text:reference.lang.rsb.reconciliation.buttons.object,icon:"",cls:"blue-button",itemId:"objectBtn",margin:"15 0",disabled:true,type:"toolbarButtons"},{xtype:"container",layout:"hbox",defaults:{xtype:"component",cls:"link4-icon",width:450,style:{padding:"0px 35px"}},items:[{html:(LkIp.User.isActiveUser()?'<a href="#!/rsb/reconciliation/statement">':'<a class="not-active-link certificate-tooltip">')+reference.lang.rsb.reconciliation.buttons.statement+"</a>",margin:"0 60 0 0"},{html:(LkIp.User.isActiveUser()?'<a href="#!/information/service/reconciliation">':'<a class="not-active-link certificate-tooltip">')+reference.lang.rsb.reconciliation.buttons.informationAct+"</a>"}]}]},{title:reference.lang.rsb.reconciliation.sectionTab,type:"tab",itemId:"tab-reconciliation-section",items:[{xtype:"component",html:LkIp.Utils.header(reference.lang.rsb.reconciliation.grid.titleStatement,4),margin:"15 0 0 0"},{xtype:"defaultFilterPanel",id:"rsbReconciliationStatementFilterPanel",margin:"15 0 0",data:[{cls:"first-column fl-l",defaults:{labelWidth:135,width:380,xtype:"filterSelect"},items:b},{cls:"second-column fl-l",items:[{labelWidth:135,width:350,xtype:"filterSelect",tpl:'<tpl for="."><tpl if="code != 0"><li data-qtip="{qtip}" class="x-boundlist-item" role="option">{value}</li></tpl><tpl if="code == 0"><li class="x-boundlist-item" role="option">{value}</li></tpl></tpl>',displayField:"value",lang:reference.lang.rsb.reconciliation.filters.section,name:"section",margin:"10 0 0",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"rsbReconciliationStatementSectionStore",data:[{code:0,value:reference.lang.rsb.reconciliation.sectionValue.all},{code:1,value:reference.lang.rsb.reconciliation.sectionValue.oneAndTwo},{code:2,value:reference.lang.rsb.reconciliation.sectionValue.one},{code:3,value:reference.lang.rsb.reconciliation.sectionValue.two}]}},{xtype:"defaultDateFilter",dateFieldName:"dateStartPeriod",labelWidth:135,lang:reference.lang.rsb.reconciliation.filters.dateStartPeriod},{xtype:"defaultDateFilter",dateFieldName:"dateFinishPeriod",margin:"5 0 0",labelWidth:135,lang:reference.lang.rsb.reconciliation.filters.dateFinishPeriod}]}]},{xtype:"gridtable",id:"rsbReconciliationStatementGrid",store:"Rsb.Reconciliation.StatementGridStore",columns:[{text:reference.lang.rsb.reconciliation.grid.kodNo,dataIndex:"@KodNO",width:95,renderer:LkIp.Utils.noRenderer},{text:reference.lang.rsb.reconciliation.grid.nomerAkt,dataIndex:"@NomerAkt",width:90},{text:reference.lang.rsb.reconciliation.grid.dataAkt,dataIndex:"@DataAkt",width:90,renderer:function(c){return !Ext.isEmpty(c)?LkIp.Utils.getDate(c):""}},{text:reference.lang.rsb.reconciliation.grid.naimKBK,dataIndex:"@NaimKBK",width:200},{text:reference.lang.rsb.reconciliation.grid.kbk,dataIndex:"@KBK",width:200},{text:reference.lang.rsb.reconciliation.grid.oktmo,dataIndex:"@OKATO_OKTMO",width:150},{text:reference.lang.rsb.reconciliation.grid.razdel,dataIndex:"@FormaSver",width:100,renderer:function(c){switch(c){case"0":return reference.lang.rsb.reconciliation.sectionValue.oneAndTwo;case"1":return reference.lang.rsb.reconciliation.sectionValue.one;case"2":return reference.lang.rsb.reconciliation.sectionValue.two}}},{text:reference.lang.rsb.reconciliation.grid.prichOkonSver,dataIndex:"@PrichOkonSver",width:120}]}]}]}]});this.callParent()}},0,["rsbReconciliation"],["component","container","box","rsbReconciliation"],{component:true,container:true,box:true,rsbReconciliation:true},["widget.rsbReconciliation"],[[LkIp.view.Scrolling.prototype.mixinId||LkIp.view.Scrolling.$className,LkIp.view.Scrolling]],[LkIp.view.Rsb.Reconciliation,"Index"],0));(Ext.cmd.derive("LkIp.view.Rsb.Reconciliation.Object.Index",Ext.Container,{cls:"rsbReconciliationObject iScroll",initComponent:function(){Ext.apply(this,{items:[{xtype:"component",itemId:"objectInfo",tpl:'<table class="describe-table"><tbody><tr><th colspan="4">'+reference.lang.rsb.reconciliation.object.info.title+'</th> </tr><tr class="no-border"><td class="small-column"><span class="label">'+reference.lang.rsb.reconciliation.object.info.nomerDataZayavl+'</span></td><td class="border-column"><span class="text">{nomerZayavl}/{dataZayavl}</span></td><td class="small-column"><span class="label">'+reference.lang.rsb.reconciliation.object.info.nomerAkt+'</span></td><td><span class="text">{nomerAkt}</span></td></tr><tr class="no-border"><td class="small-column"><span class="label">'+reference.lang.rsb.reconciliation.object.info.razdel+'</span></td><td class="border-column"><span class="text">{razdel}</span></td><td class="small-column"><span class="label">'+reference.lang.rsb.reconciliation.object.info.prichOkonSver+'</span></td><td><span class="text">{prichOkonSver}</span></td></tr><tr class="no-border"><td class="small-column"><span class="label">'+reference.lang.rsb.reconciliation.object.info.dataSver+'</span></td><td class="border-column"><span class="text">{dataNach} - {dataKon}</span></td><td class="small-column"><span class="label">'+reference.lang.rsb.reconciliation.object.info.period+'</span></td><td><span class="text">{dataNachPeriod} - {dataKonPeriod}</span></td></tr></tbody></table> ',data:{nomerZayavl:"-",dataZayavl:"-",nomerAkt:"-",razdel:"-",prichOkonSver:"-",dataNach:"-",dataKon:"-",dataNachPeriod:"-",dataKonPeriod:"-"}},{xtype:"defaultFilterPanel",id:"rsbReconciliationObjectFilterPanel",margin:"15 0 0",data:[{cls:"first-column fl-l",defaults:{labelWidth:135,width:380,xtype:"filterSelect"},items:[{labelWidth:80,width:400,xtype:"filterSelect",lang:reference.lang.filters.kbk,name:"kbk",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"rsbReconciliationObjectKbkStore"}}]},{cls:"second-column fl-l",items:[]}]},{xtype:"component",html:LkIp.Utils.header(reference.lang.rsb.reconciliation.object.grid.title,4),margin:"15 0 0 0"},{xtype:"gridtable",id:"rsbReconciliationObjectGrid",store:"Rsb.Reconciliation.Object.GridStore",columns:[{text:reference.lang.rsb.reconciliation.grid.kodNo,dataIndex:"@KodNO",width:90,renderer:LkIp.Utils.noRenderer},{text:reference.lang.rsb.reconciliation.grid.dataAkt,dataIndex:"@DataAkt",width:90,renderer:function(a){return !Ext.isEmpty(a)?LkIp.Utils.getDate(a):""}},{text:reference.lang.rsb.reconciliation.grid.naimKBK,dataIndex:"@NaimKBK",width:200},{text:reference.lang.rsb.reconciliation.grid.kbk,dataIndex:"@KBK",width:200},{text:reference.lang.rsb.reconciliation.grid.oktmo,dataIndex:"@OKATO_OKTMO",width:150},{text:reference.lang.rsb.reconciliation.grid.razdel,dataIndex:"@FormaSver",width:100,renderer:function(a){switch(a){case"0":return reference.lang.rsb.reconciliation.sectionValue.oneAndTwo;case"1":return reference.lang.rsb.reconciliation.sectionValue.one;case"2":return reference.lang.rsb.reconciliation.sectionValue.two}}},{text:reference.lang.rsb.reconciliation.grid.prichOkonSver,dataIndex:"@PrichOkonSver",width:120}]}]});this.callParent()}},0,["rsbReconciliationObject"],["component","container","box","rsbReconciliationObject"],{component:true,container:true,box:true,rsbReconciliationObject:true},["widget.rsbReconciliationObject"],[[LkIp.view.Scrolling.prototype.mixinId||LkIp.view.Scrolling.$className,LkIp.view.Scrolling]],[LkIp.view.Rsb.Reconciliation.Object,"Index"],0));(Ext.cmd.derive("LkIp.view.PersonalData.Update.Index",Ext.Container,{cls:"userinfoUpdate",initComponent:function(){Ext.apply(this,{items:[{xtype:"component",html:reference.lang.userinfo.update.info,margin:"10 0"},{xtype:"form",itemId:"userinfoUpdateForm",items:[{xtype:"container",cls:"table-layout border three-columns",margin:"15 0",layout:{type:"table",columns:3},defaults:{xtype:"component"},items:[{html:reference.lang.userinfo.update.table.headerName,cellCls:"header small-column"},{html:reference.lang.userinfo.update.table.headerFNS,cellCls:"header"},{html:reference.lang.userinfo.update.table.headerTaxpayer,cellCls:"header small-column"},{html:reference.lang.userinfo.update.table.surname},{tpl:"{surname}",itemId:"surname"},{xtype:"textfield",name:"surname",width:270,validator:function(a){return LkIp.Utils.checkForRussianName(a)}},{html:reference.lang.userinfo.update.table.name},{tpl:"{name}",itemId:"name"},{xtype:"textfield",name:"name",width:270,validator:function(a){return LkIp.Utils.checkForRussianName(a)}},{html:reference.lang.userinfo.update.table.patronymic},{tpl:"{patronymic}",itemId:"patronymic"},{xtype:"textfield",name:"patronymic",width:270,validator:function(a){return LkIp.Utils.checkForRussianName(a)}},{html:reference.lang.userinfo.update.table.birthDate},{tpl:"{birthDate}",itemId:"birthDate"},{xtype:"datefield",format:"d.m.Y",name:"birthDate",cls:"select-field"},{html:reference.lang.userinfo.update.table.email},{colspan:2,xtype:"textfield",padding:"10 20",name:"email",vtype:"email",width:270,allowBlank:false,value:LkIp.User.get("email")},{html:reference.lang.userinfo.update.table.documentType},{tpl:"{documentType}",itemId:"documentType"},{xtype:"textfield",name:"documentType",width:270},{html:reference.lang.userinfo.update.table.documentNumber},{tpl:"{documentNumber}",itemId:"documentNumber"},{xtype:"textfield",name:"documentNumber",width:270},{html:reference.lang.userinfo.update.table.documentDate},{tpl:"{documentDate}",itemId:"documentDate"},{xtype:"datefield",format:"d.m.Y",name:"documentDate",cls:"select-field"},{html:reference.lang.userinfo.update.table.documentByWho},{tpl:"{documentByWho}",itemId:"documentByWho"},{xtype:"textfield",name:"documentByWho",width:270},{html:reference.lang.userinfo.update.table.address},{tpl:"{address}",itemId:"address"},{xtype:"textfield",name:"address",width:270}]},{xtype:"textarea",name:"additionalInfo",id:"additionalInfo",fieldLabel:reference.lang.userinfo.update.additionalInfo,labelAlign:"top",labelPad:"10",labelSeparator:"",cols:150,rows:5},{xtype:"hiddenfield",name:"codeNo",itemId:"codeNo",value:"",allowBlank:false},{xtype:"button",rel:"submit",formBind:true,margin:"15 0 0 0",name:"userinfoUpdateSendButton",text:reference.lang.buttons.send}]}]});this.callParent()},updateTableData:function(b){var a=this,d=b.SvedFL,c=b.SvedUchet["@KodNalOrg"];Ext.suspendLayouts();a.down("#surname").update({surname:!Ext.isEmpty(d)&&!Ext.isEmpty(d.FIO)&&!Ext.isEmpty(d.FIO["@Familiya"])?d.FIO["@Familiya"]:"-"});a.down("#name").update({name:!Ext.isEmpty(d)&&!Ext.isEmpty(d.FIO)&&!Ext.isEmpty(d.FIO["@Imya"])?d.FIO["@Imya"]:"-"});a.down("#patronymic").update({patronymic:!Ext.isEmpty(d)&&!Ext.isEmpty(d.FIO)&&!Ext.isEmpty(d.FIO["@Otchestvo"])?d.FIO["@Otchestvo"]:"-"});a.down("#birthDate").update({birthDate:!Ext.isEmpty(d)&&!Ext.isEmpty(d["@DataRojd"])?LkIp.Utils.getDate(d["@DataRojd"]):"-"});a.down("#documentType").update({documentType:!Ext.isEmpty(d)&&!Ext.isEmpty(d.UdLichn)&&!Ext.isEmpty(d.UdLichn["@Naimenovanie"])?d.UdLichn["@Naimenovanie"]:"-"});a.down("#documentNumber").update({documentNumber:!Ext.isEmpty(d)&&!Ext.isEmpty(d.UdLichn)&&!Ext.isEmpty(d.UdLichn["@SerNomDok"])?d.UdLichn["@SerNomDok"]:"-"});a.down("#documentDate").update({documentDate:!Ext.isEmpty(d)&&!Ext.isEmpty(d.UdLichn)&&!Ext.isEmpty(d.UdLichn["@DataDok"])?LkIp.Utils.getDate(d.UdLichn["@DataDok"]):"-"});a.down("#documentByWho").update({documentByWho:!Ext.isEmpty(d)&&!Ext.isEmpty(d.UdLichn)&&!Ext.isEmpty(d.UdLichn["@NaimOrgVyidDok"])?d.UdLichn["@NaimOrgVyidDok"]:"-"});a.down("#address").update({address:!Ext.isEmpty(d)&&!Ext.isEmpty(d.Address)?d.Address:"-"});a.down("#codeNo").setValue(!Ext.isEmpty(c)?c:"");Ext.resumeLayouts(true)}},0,["personalDataUpdate"],["personalDataUpdate","component","container","box"],{personalDataUpdate:true,component:true,container:true,box:true},["widget.personalDataUpdate"],0,[LkIp.view.PersonalData.Update,"Index"],0));(Ext.cmd.derive("LkIp.view.Rsb.CompliedReqs.GridReqs",LkIp.view.Default.Grid,{store:"Rsb.CompliedReqs.GridStore",plugins:[{ptype:"rowexpander",rowBodyTpl:new Ext.XTemplate('<table class="describe-table decision-info"><tbody><tr class="no-border"><td class="small-column"><span class="label">'+reference.lang.rsb.compliedreqs.grid.no+'</span></td><td class="small-column"><span class="text">{KodNO:this.formatNo} - {NaimNO}</span></td><td class="small-column"><span class="label">'+reference.lang.rsb.compliedreqs.grid.summCommon+'</span></td><td><span class="text">{ObschSumma:this.formatNumber}</span></td></tr><tr class="no-border"><td class="small-column"><span class="label">'+reference.lang.rsb.compliedreqs.grid.dateSost+'</span></td><td><span class="text">{DataSost:this.formatDate}</span></td><td class="small-column"><span class="label">'+reference.lang.rsb.compliedreqs.grid.summTrebovanie+'</span></td><td><span class="text">{SummaNal:this.formatNumber}</span></td></tr><tr class="no-border"><td class="small-column"><span class="label">'+reference.lang.rsb.compliedreqs.grid.srokUpl+'</span></td><td><span class="text">{SrokUpl:this.formatDate}</span></td><td class="small-column"><span class="label">'+reference.lang.rsb.compliedreqs.grid.peni+'</span></td><td><span class="text">{Peni:this.formatNumber}</span></td></tr><tr class="no-border"><td class="small-column"><span class="label">'+reference.lang.rsb.compliedreqs.grid.osnovanie+'</span></td><td><span class="text">{NaimOsnovanie}</span></td><td class="small-column"><span class="label">'+reference.lang.rsb.compliedreqs.grid.shtraf+'</span></td><td><span class="text">{SHtrafyi:this.formatNumber}</span></td></tr><tr class="no-border"><td class="small-column"></td><td></td><td class="small-column"><span class="label">'+reference.lang.rsb.compliedreqs.grid.procent+'</span></td><td><span class="text">{Protsentyi:this.formatNumber}</span></td></tr></tbody></table> ',{formatNumber:function(a){return Ext.isEmpty(a)?"-":LkIp.Utils.numberConvert(a)},formatDate:function(a){return Ext.isEmpty(a)?"-":LkIp.Utils.getDate(a)},formatNo:function(a){return LkIp.Utils.noRenderer(a)}})}],gridHeight:undefined,initComponent:function(){var a=this;Ext.apply(a,{columns:[{text:reference.lang.rsb.compliedreqs.grid.kodNO,width:100,dataIndex:"KodNO",renderer:function(b){return LkIp.Utils.noRenderer(b)}},{text:reference.lang.rsb.compliedreqs.grid.requirement,menuDisabled:true,columns:[{text:reference.lang.rsb.compliedreqs.grid.nomerTreb,width:150,dataIndex:"NomerTreb",sortable:true},{text:reference.lang.rsb.compliedreqs.grid.dataTreb,dataIndex:"DataTreb",width:100,renderer:function(b){return LkIp.Utils.getDate(b)},sortable:true}]},{text:"",menuDisabled:true,flex:1,sort:false}],viewConfigListeners:{expandBody:function(e,b,c){var d=this.ownerCt;if(typeof a.gridHeight=="undefined"){a.gridHeight=d.getHeight()}a.gridHeight+=250;d.setHeight(a.gridHeight);LkIp.app.getController("Content").initNoTooltips()},collapseBody:function(e,b,c){var d=this.ownerCt;a.gridHeight-=250;d.setHeight(a.gridHeight);LkIp.app.getController("Content").hideNoTooltips()}}});a.callParent()}},0,["rsbCompliedReqsGrid"],["panel","gridtable","component","tablepanel","container","grid","box","rsbCompliedReqsGrid","gridpanel"],{panel:true,gridtable:true,component:true,tablepanel:true,container:true,grid:true,box:true,rsbCompliedReqsGrid:true,gridpanel:true},["widget.rsbCompliedReqsGrid"],0,[LkIp.view.Rsb.CompliedReqs,"GridReqs"],0));(Ext.cmd.derive("LkIp.view.Rsb.CompliedReqs.GridReqInfo",LkIp.view.Default.Grid,{store:"Rsb.CompliedReqs.GridInfoStore",getFileAction:false,initComponent:function(){var a=this;Ext.apply(a,{columns:[{text:reference.lang.rsb.compliedreqs.requirementGrid.kbkName,width:170,dataIndex:"@NaimKBK"},{text:reference.lang.rsb.compliedreqs.requirementGrid.kbk,width:170,dataIndex:"@KodKBK"},{text:reference.lang.rsb.compliedreqs.requirementGrid.okato,width:100,dataIndex:"@OKATO_OKTMO"},{text:reference.lang.rsb.compliedreqs.requirementGrid.status,width:100,dataIndex:"@KodStatus",renderer:function(d,c,b){c.tdAttr='data-qtip="'+b.get("@NaimStatus")+'"';return d}},{text:reference.lang.rsb.compliedreqs.requirementGrid.srokUpl,width:100,dataIndex:"@SrokUpl",renderer:function(b){return Ext.isEmpty(b)?"":LkIp.Utils.getDate(b)}},{text:reference.lang.rsb.compliedreqs.requirementGrid.summIn,menuDisabled:true,columns:[{text:Ext.String.format('<span class="text-tooltip">{0}</span>',reference.lang.rsb.compliedreqs.requirementGrid.nalog),width:100,dataIndex:"@NalogSummTreb",sort:true,renderer:function(b){return Ext.isEmpty(b)?"":LkIp.Utils.numberConvert(b)},listeners:{afterrender:function(){LkIp.Utils.tooltip(this.getEl(),reference.lang.rsb.compliedreqs.nalogHelp)}}},{text:reference.lang.rsb.compliedreqs.requirementGrid.peni,width:100,dataIndex:"@PeniSummTreb",sort:true,renderer:function(b){return Ext.isEmpty(b)?"":LkIp.Utils.numberConvert(b)}},{text:reference.lang.rsb.compliedreqs.requirementGrid.shtraf,width:100,dataIndex:"@ShtrafSummTreb",sort:true,renderer:function(b){return Ext.isEmpty(b)?"":LkIp.Utils.numberConvert(b)}},{text:reference.lang.rsb.compliedreqs.requirementGrid.procent,width:100,dataIndex:"@ProtsentSummTreb",sort:true,renderer:function(b){return Ext.isEmpty(b)?"":LkIp.Utils.numberConvert(b)}}],listeners:{render:function(b){this.setWidth(400)}}},{text:reference.lang.rsb.compliedreqs.requirementGrid.summOst,menuDisabled:true,columns:[{text:reference.lang.rsb.compliedreqs.requirementGrid.nalog,width:100,dataIndex:"@NalogNeoplOst",sort:true,renderer:function(b){return Ext.isEmpty(b)?"":LkIp.Utils.numberConvert(b)}},{text:reference.lang.rsb.compliedreqs.requirementGrid.peni,width:100,dataIndex:"@PeniNeoplOst",sort:true,renderer:function(b){return Ext.isEmpty(b)?"":LkIp.Utils.numberConvert(b)}},{text:reference.lang.rsb.compliedreqs.requirementGrid.shtraf,width:100,dataIndex:"@ShtrafNeoplOst",sort:true,renderer:function(b){return Ext.isEmpty(b)?"":LkIp.Utils.numberConvert(b)}},{text:reference.lang.rsb.compliedreqs.requirementGrid.procent,width:100,dataIndex:"@ProtsentNeoplOst",sort:true,renderer:function(b){return Ext.isEmpty(b)?"":LkIp.Utils.numberConvert(b)}}],listeners:{render:function(b){this.setWidth(400)}}}]});a.callParent()}},0,["rsbCompliedReqInfoGrid"],["panel","rsbCompliedReqInfoGrid","gridtable","component","tablepanel","container","grid","box","gridpanel"],{panel:true,rsbCompliedReqInfoGrid:true,gridtable:true,component:true,tablepanel:true,container:true,grid:true,box:true,gridpanel:true},["widget.rsbCompliedReqInfoGrid"],0,[LkIp.view.Rsb.CompliedReqs,"GridReqInfo"],0));(Ext.cmd.derive("LkIp.view.Rsb.CompliedReqs.Index",Ext.Container,{cls:"rsbCompliedReqs iScroll",initComponent:function(){var a=this;Ext.apply(a,{items:[!LkIp.User.isInspectorWithCodeNO()?{xtype:"defaultFilterPanel",itemId:"rsbCompliedReqsFilterPanel",data:[{defaults:{labelWidth:140,width:500,xtype:"filterSelect"},items:[{lang:reference.lang.filters.no,name:"codeNO",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"rsbCompliedReqsNoStore"}}]}]}:{cls:"display-none"},{xtype:"rsbCompliedReqsGrid",itemId:"rsbCompliedReqsGrid"},{xtype:"button",disabled:true,name:"rsbCompliedReqsChooseButton",text:reference.lang.rsb.compliedreqs.button,margin:"0 15 0 0"},{xtype:"container",itemId:"requirementContainer",hidden:true,items:[{xtype:"component",html:LkIp.Utils.header(reference.lang.rsb.compliedreqs.requirementTitle,4),margin:"15 0 0 0"},{xtype:"rsbCompliedReqInfoGrid",itemId:"rsbCompliedReqInfoGrid"}]}]});this.callParent()}},0,["rsbCompliedReqs"],["component","container","rsbCompliedReqs","box"],{component:true,container:true,rsbCompliedReqs:true,box:true},["widget.rsbCompliedReqs"],[[LkIp.view.Scrolling.prototype.mixinId||LkIp.view.Scrolling.$className,LkIp.view.Scrolling]],[LkIp.view.Rsb.CompliedReqs,"Index"],0));(Ext.cmd.derive("LkIp.view.Default.Form.RestrictInfoField",Ext.form.field.Display,{labelWidth:150,width:700,fieldLabel:" ",labelSeparator:"",restrictSize:undefined,restrictExtensions:[],restrictSizeText:reference.lang.form.restrict.size,restrictExtensionsText:reference.lang.form.restrict.ext,cls:"form-restrict-info",initComponent:function(){this.checkRestrictions();this.callParent(arguments)},checkRestrictions:function(){if(!Ext.isEmpty(this.restrictSize)||!Ext.isEmpty(this.restrictExtensions)){this.value="(";this.checkSizeRestriction();this.checkExtensionRestriction();this.value+=")"}},checkSizeRestriction:function(){if(!Ext.isEmpty(this.restrictSize)){this.value+=this.restrictSizeText+" "+this.restrictSize+", "}},checkExtensionRestriction:function(){if(!Ext.isEmpty(this.restrictExtensions)){this.value+=this.restrictExtensionsText+" "+Ext.Array.map(this.restrictExtensions,function(a,b){a="."+a;return a}).join(", ")}}},0,["restrictinfofield"],["displayfield","field","component","box","restrictinfofield"],{displayfield:true,field:true,component:true,box:true,restrictinfofield:true},["widget.restrictinfofield"],0,[LkIp.view.Default.Form,"RestrictInfoField"],0));(Ext.cmd.derive("LkIp.view.StateRegistration.Index",Ext.Container,{required:'<span class="form-required-field" data-qtip="'+reference.lang.form.required+'">*</span>',initComponent:function(){Ext.apply(this,{items:[{xtype:"container",items:[{xtype:"component",html:reference.lang.stateRegistration.info,cls:"fl-l",width:"75%"},{xtype:"container",cls:"fl-r",width:"25%",defaults:{xtype:"component",cls:"individual-help-link"},items:[LkIp.User.isActiveUser()?{html:'<a href="#!/egrip/request" class="link">'+reference.lang.stateRegistration.egripRequest+"</a>"}:{cls:"display-none"},{html:'<a href="#!/profile" class="link">'+reference.lang.stateRegistration.egripInfo+"</a>"}]},{cls:"clear"}]},{xtype:"container",layout:{type:"auto"},margin:"20 0 0 0",items:[{xtype:"component",html:LkIp.Utils.header(reference.lang.pages.instruction,3),cls:"fl-l"}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"1",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.stateRegistration.step1},{xtype:"component",html:"<p>"+reference.lang.stateRegistration.step1Description+"</p>"}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"2",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.pages.steps.step2Statement},{xtype:"component",html:"<p>"+reference.lang.stateRegistration.step2Description+"</p>"}]},{xtype:"form",itemId:"stateRegistration-form",layout:"auto",border:false,cls:"form-file-field",defaults:{margin:"0 0 10 0"},items:[{xtype:"component",html:reference.lang.stateRegistration.fileLabel+this.required},{xtype:"filefield",name:"stateRegistrationMessage",fieldLabel:undefined,labelWidth:0,width:700,regex:/(.)+((\.zip)(\w)?)$/i,regexText:reference.lang.form.file.error.zip,emptyText:reference.lang.stateRegistration.emptyFile,allowBlank:false},{xtype:"hiddenfield",name:"filename"},{xtype:"hiddenfield",name:"originalFilename"},{xtype:"button",rel:"submit",formBind:true,name:"signButton",text:reference.lang.buttons.send}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"3",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.pages.steps.step3Statement},{xtype:"component",html:"<p>"+reference.lang.pages.steps.step3DescriptionStatement+"</p>"}]}]}]});this.callParent()}},0,["stateRegistration"],["stateRegistration","component","container","box"],{stateRegistration:true,component:true,container:true,box:true},["widget.stateRegistration"],0,[LkIp.view.StateRegistration,"Index"],0));(Ext.cmd.derive("LkIp.view.Information.Service.Index",Ext.Container,{cls:"informationService iScroll",initComponent:function(){var a=this;Ext.apply(a,{items:[{xtype:"pageMenu",title:reference.lang.informationService.chooseInformationService,data:[{title:reference.lang.pages.informationService.paymentsStatus.title,href:"#!/information/service/paymentsStatus"},{title:reference.lang.pages.informationService.reconciliation.title,href:"#!/information/service/reconciliation"},{title:reference.lang.pages.informationService.obligation.title,href:"#!/information/service/obligation"},{title:reference.lang.pages.informationService.operations.title,href:"#!/information/service/operations"},{title:reference.lang.pages.informationService.accounting.title,href:"#!/information/service/accounting"}]}]});this.callParent()}},0,["informationService"],["component","container","box","informationService"],{component:true,container:true,box:true,informationService:true},["widget.informationService"],[[LkIp.view.Scrolling.prototype.mixinId||LkIp.view.Scrolling.$className,LkIp.view.Scrolling]],[LkIp.view.Information.Service,"Index"],0));(Ext.cmd.derive("LkIp.view.Information.Service.Layout",Ext.Container,{cls:"information-service-layout",lang:undefined,step1:undefined,initComponent:function(){var b=new Ext.Template(reference.lang.informationService.description),a=[{xtype:"component",cls:"step-header",html:typeof this.lang.step1Header!="undefined"?this.lang.step1Header:reference.lang.pages.steps.step1}];if(!Ext.isEmpty(this.step1)){Ext.Array.each(this.step1,function(d,c){a.push(d)})}a.push({xtype:"button",margin:"15 0 0 0",disabled:true,formBind:true,name:"ISShowButton",text:reference.lang.buttons.pdf});Ext.apply(this,{items:[{xtype:"component",html:"<p>"+b.apply({statementName:this.lang.statementName,moreInfo:!Ext.isEmpty(this.lang.moreInfo)?this.lang.moreInfo:""})+"</p>"},{xtype:"component",html:LkIp.Utils.header(reference.lang.pages.instruction,3),margin:"15 0 0 0"},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"1",cls:"step-number"},{xtype:"container",items:a}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"2",cls:"step-number"},{xtype:"container",defaults:{xtype:"component"},items:[{cls:"step-header",html:typeof this.lang.step2Header!="undefined"?this.lang.step2Header:reference.lang.pages.steps.step2},{html:"<p>"+(typeof this.lang.step2Description!="undefined"?this.lang.step2Description:reference.lang.pages.steps.step2Description)+"</p>"},{xtype:"button",margin:"15 0 0 0",disabled:true,formBind:true,name:"ISSignButton",text:reference.lang.buttons.signSend}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"3",cls:"step-number"},{xtype:"container",defaults:{xtype:"component"},items:[{cls:"step-header",html:typeof this.lang.step3Header!="undefined"?this.lang.step3Header:reference.lang.pages.steps.step3},{html:"<p>"+(typeof this.lang.step3Description!="undefined"?this.lang.step3Description:reference.lang.pages.steps.step3Description)+"</p>"}]}]}]});this.callParent()}},0,["ISLayout"],["component","container","ISLayout","box"],{component:true,container:true,ISLayout:true,box:true},["widget.ISLayout"],0,[LkIp.view.Information.Service,"Layout"],0));(Ext.cmd.derive("LkIp.view.Information.Service.Step1Conditions",Ext.form.Panel,{componentCls:"information-service-condition",initComponent:function(){Ext.apply(this,{defaults:{labelWidth:550,allowBlank:false},items:this.data});delete this.data;this.callParent()}},0,["ISCondition"],["panel","ISCondition","form","component","container","box"],{panel:true,ISCondition:true,form:true,component:true,container:true,box:true},["widget.ISCondition"],0,[LkIp.view.Information.Service,"Step1Conditions"],0));(Ext.cmd.derive("LkIp.view.Information.Service.PaymentsStatus.Index",Ext.form.Panel,{cls:"IS-container ISPaymentsStatus iScroll",initComponent:function(){var b=this,a=new Ext.Template(reference.lang.informationService.step1CommonDescription);Ext.apply(b,{items:[{xtype:"ISLayout",lang:reference.lang.informationService.paymentsStatus,step1:[{xtype:"component",html:"<p>"+a.apply({whatToDo:reference.lang.informationService.paymentsStatus.step1whatToDo})+"</p>"},{xtype:"ISCondition",itemId:"ISPaymentsStatusCondition",data:[{xtype:"filterDate",name:"date",fieldLabel:reference.lang.informationService.step1Date,hidden:false,width:700,maxValue:new Date()},{xtype:"filterSelect",fieldLabel:reference.lang.informationService.step1No,emptyText:reference.lang.informationService.emptyTextNo,name:"codeNO",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"ISPaymentsStatusNoStore"},width:800,editable:false,typeAhead:false}]}]}]});b.callParent()}},0,["ISPaymentsStatus"],["panel","form","component","container","ISPaymentsStatus","box"],{panel:true,form:true,component:true,container:true,ISPaymentsStatus:true,box:true},["widget.ISPaymentsStatus"],[[LkIp.view.Scrolling.prototype.mixinId||LkIp.view.Scrolling.$className,LkIp.view.Scrolling]],[LkIp.view.Information.Service.PaymentsStatus,"Index"],0));(Ext.cmd.derive("LkIp.view.Information.Service.Obligation.Index",Ext.form.Panel,{cls:"IS-container ISObligation iScroll",initComponent:function(){var b=this,a=new Ext.Template(reference.lang.informationService.step1CommonDescription);Ext.apply(b,{items:[{xtype:"ISLayout",lang:reference.lang.informationService.obligation,step1:[{xtype:"component",html:"<p>"+a.apply({whatToDo:reference.lang.informationService.obligation.step1whatToDo})+"</p>"},{xtype:"ISCondition",itemId:"ISObligationCondition",data:[{xtype:"radiogroup",itemId:"answerTypeGroup",fieldLabel:reference.lang.informationService.obligation.answerType,defaults:{name:"answerType",componentCls:"fl-l"},cls:"select-field",items:[{xtype:"radiofield",boxLabel:reference.lang.informationService.obligation.personal,inputValue:1,checked:true},{xtype:"radiofield",boxLabel:reference.lang.informationService.obligation.mail,inputValue:2}],width:750},{xtype:"filterDate",name:"date",fieldLabel:reference.lang.informationService.step1Date,hidden:false,width:700,maxValue:new Date()},{xtype:"displayfield",width:900,fieldLabel:reference.lang.informationService.obligation.no,value:"",name:"codeNO",cls:"select-field",submitValue:true}]}]}]});b.callParent()}},0,["ISObligation"],["panel","ISObligation","form","component","container","box"],{panel:true,ISObligation:true,form:true,component:true,container:true,box:true},["widget.ISObligation"],[[LkIp.view.Scrolling.prototype.mixinId||LkIp.view.Scrolling.$className,LkIp.view.Scrolling]],[LkIp.view.Information.Service.Obligation,"Index"],0));(Ext.cmd.derive("LkIp.view.Information.Service.Accounting.Index",Ext.form.Panel,{cls:"IS-container ISAccounting iScroll",initComponent:function(){var a=this;Ext.apply(a,{items:[{xtype:"ISLayout",lang:reference.lang.informationService.accounting,step1:[{xtype:"component",html:"<p>"+reference.lang.informationService.step1CommonShortDescription+"</p>"},{xtype:"ISCondition",itemId:"ISAccountingCondition",data:[{xtype:"filterDate",name:"dateStart",fieldLabel:Ext.String.format('<span class="text-tooltip">{0}</span>',reference.lang.informationService.accounting.startDate),hidden:false,width:700,maxValue:new Date(),listeners:{render:function(b){LkIp.Utils.tooltip(b.getEl().down(".text-tooltip"),reference.lang.informationService.accounting.dateTtip)}}},{xtype:"filterDate",name:"dateEnd",fieldLabel:Ext.String.format('<span class="text-tooltip">{0}</span>',reference.lang.informationService.accounting.finishDate),hidden:false,width:700,maxValue:new Date(),listeners:{render:function(b){LkIp.Utils.tooltip(b.getEl().down(".text-tooltip"),reference.lang.informationService.accounting.dateTtip)}}},{xtype:"radiogroup",itemId:"accountingCondition",fieldLabel:reference.lang.informationService.accounting.accountingCondition,defaults:{name:"accountingConditionType"},cls:"select-field",vertical:true,columns:1,items:[{xtype:"radiofield",boxLabel:reference.lang.informationService.accounting.condition.allDeclaration,inputValue:1,checked:true},{xtype:"radiofield",boxLabel:reference.lang.informationService.accounting.condition.first,inputValue:2},{xtype:"radiofield",boxLabel:reference.lang.informationService.accounting.condition.correct,inputValue:3}],width:900},{xtype:"filterSelect",fieldLabel:reference.lang.informationService.step1No,emptyText:reference.lang.informationService.emptyTextNo,name:"codeNO",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"ISAccountingNoStore"},width:800,editable:false,typeAhead:false}]}]}]});a.callParent()}},0,["ISAccounting"],["panel","ISAccounting","form","component","container","box"],{panel:true,ISAccounting:true,form:true,component:true,container:true,box:true},["widget.ISAccounting"],[[LkIp.view.Scrolling.prototype.mixinId||LkIp.view.Scrolling.$className,LkIp.view.Scrolling]],[LkIp.view.Information.Service.Accounting,"Index"],0));(Ext.cmd.derive("LkIp.view.Information.Service.Grid",LkIp.view.Default.Grid,{initComponent:function(){var a=this;Ext.apply(a,{selModel:Ext.create("Ext.selection.CheckboxModel",{ignoreRightMouseSelection:true,checkOnly:true,listeners:{beforeselect:function(c,b){return b.get("selected")!=1||a.itemId!="ISMainGrid"},beforedeselect:function(c,b){return b.get("selected")!=1||a.itemId!="ISMainGrid"},select:function(b){var c;if(a.itemId=="ISMainGrid"){c=a.up("#ISGridConditionStep").down('[name="ISChooseOneButton"]')}else{c=a.up("#ISGridConditionStep").down('[name="ISRemoveOneButton"]')}c.enable()},deselect:function(b){var c;if(a.itemId=="ISMainGrid"){c=a.up("#ISGridConditionStep").down('[name="ISChooseOneButton"]')}else{c=a.up("#ISGridConditionStep").down('[name="ISRemoveOneButton"]')}if(b.getCount()>0){c.enable()}else{c.disable()}}}}),columns:[{text:reference.lang.rsb.cards.grid.nameKbk,dataIndex:"@ImyaKBK",flex:1},{text:reference.lang.rsb.cards.grid.codeKbk,dataIndex:"@KodKBK",width:190},{text:reference.lang.rsb.cards.grid.okatoOktmo,dataIndex:"@OKATO_OKTMO",width:100},{text:reference.lang.rsb.cards.grid.dataSostRasch,dataIndex:"@DataSostRasch",width:100,renderer:function(b){return !Ext.isEmpty(b)?LkIp.Utils.getDate(b):""}},{text:reference.lang.rsb.cards.grid.statusIP,dataIndex:"@KodStatus",hidden:true,width:150,renderer:function(d,c,b){c.tdAttr='data-qtip="'+b.get("@ImyaStatus")+'"';return d}},{text:reference.lang.rsb.cards.grid.dataOtkrKart,hidden:true,dataIndex:"@DataOtkrKart",width:100,renderer:function(b){return !Ext.isEmpty(b)?LkIp.Utils.getDate(b):""}}]});this.callParent(arguments)},getRowClass:function(a){if(a.get("selected")==1){return"disabled-row"}}},0,["ISGrid"],["ISGrid","panel","gridtable","component","tablepanel","container","grid","box","gridpanel"],{ISGrid:true,panel:true,gridtable:true,component:true,tablepanel:true,container:true,grid:true,box:true,gridpanel:true},["widget.ISGrid"],0,[LkIp.view.Information.Service,"Grid"],0));(Ext.cmd.derive("LkIp.view.Information.Service.GridLayout",Ext.Container,{lang:undefined,step1help:undefined,initComponent:function(){var b=this,a=new Ext.Template(reference.lang.informationService.gridHelp);Ext.apply(b,{items:[{xtype:"ISLayout",lang:b.lang,step1:[{xtype:"component",html:"<p>"+b.description+"</p>"},{xtype:"textfield",allowBlank:false,hidden:true,itemId:"checkChosenCards",name:"checkChosenCards"},{xtype:"note",hidden:Ext.isEmpty(b.step1help),text:b.step1help},Ext.apply({xtype:"ISCondition"},b.condition),{xtype:"container",itemId:"ISGridConditionStep",hidden:true,items:[{xtype:"component",itemId:"ISTextHelp",html:"<p>"+a.apply({statementName:b.lang.statementName})+"</p>"},{xtype:"component",html:"<p>"+reference.lang.informationService.chooseHelp+"</p>"},{xtype:"note",text:reference.lang.informationService.chooseAllNote},{xtype:"container",itemId:"ISChooseCardsStep",items:[{xtype:"component",margin:"0 0 5",html:LkIp.Utils.header(reference.lang.informationService.gridHeader,4)},{xtype:"defaultFilterPanel",itemId:"ISFilterPanel",data:b.filterData},{xtype:"ISGrid",itemId:"ISMainGrid",store:b.mainGridStore,getFileAction:false,height:400}]},{xtype:"container",layout:{type:"hbox"},defaults:{xtype:"button",margin:"0 15 0 0",disabled:true},itemId:"ISActionButtons",items:[{disabled:false,name:"ISChooseAllButton",text:"",componentCls:"simple-icon-button",iconCls:"arrow-double-down-white-icon"},{name:"ISChooseOneButton",text:reference.lang.buttons.choose},{name:"ISRemoveOneButton",text:reference.lang.buttons.exclude},{name:"ISRemoveAllButton",text:"",componentCls:"simple-icon-button",iconCls:"arrow-double-up-white-icon"}]},{xtype:"container",itemId:"ISChosenCardsStep",items:[{xtype:"component",html:"<p>"+reference.lang.informationService.deselectHelp+"</p>"},{xtype:"component",html:LkIp.Utils.header(reference.lang.informationService.gridSelectionHeader,4)},{xtype:"ISGrid",itemId:"ISSubGrid",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Rsb.Cards.Grid",autoDestroy:true,storeId:b.subGridStoreId},autoHeight:true,height:"auto",maxHeight:400,limitFilter:false,paging:false,getFileAction:false,getRowClass:function(){return""}}]},{xtype:"note",hidden:true,itemId:"ISChoosenAllCards",text:typeof b.lang.all!="undefined"?b.lang.all:reference.lang.informationService.all},{xtype:"component",html:"<p>"+reference.lang.informationService.gridSelectionAfterHelp+"</p>"}]}]}]});b.callParent()}},0,["ISGridLayout"],["ISGridLayout","component","container","box"],{ISGridLayout:true,component:true,container:true,box:true},["widget.ISGridLayout"],0,[LkIp.view.Information.Service,"GridLayout"],0));(Ext.cmd.derive("LkIp.view.Information.Service.Reconciliation.Index",Ext.form.Panel,{cls:"IS-container ISReconciliation iScroll",initComponent:function(){var a=this;Ext.apply(a,{items:[{xtype:"ISGridLayout",lang:reference.lang.informationService.reconciliation,description:reference.lang.informationService.reconciliation.step1Description,condition:{itemId:"ISReconciliationCondition",data:[{xtype:"radiogroup",itemId:"reconciliationTypeGroup",fieldLabel:reference.lang.informationService.reconciliation.step1Section,defaults:{xtype:"radiofield",name:"statementType"},cls:"select-field",vertical:true,columns:1,items:[{boxLabel:reference.lang.informationService.reconciliation.section1,inputValue:52,checked:true},{boxLabel:reference.lang.informationService.reconciliation.section2,inputValue:53},{boxLabel:reference.lang.informationService.reconciliation.section3,inputValue:54}],width:750},{xtype:"filterDate",name:"date",fieldLabel:reference.lang.informationService.step1Date,hidden:false,width:700,maxValue:new Date()},{xtype:"filterSelect",fieldLabel:reference.lang.informationService.step1No,emptyText:reference.lang.informationService.emptyTextNo,name:"codeNO",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"ISReconciliationNoStore"},width:800,editable:false,typeAhead:false}]},filterData:[{cls:"first-column fl-l",defaults:{labelWidth:140,width:400,xtype:"filterSelect"},items:[{lang:reference.lang.filters.statusIP,name:"statusIP",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"ISReconciliationStatusIPStore"}},{lang:reference.lang.filters.kbk,name:"kbk",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"ISReconciliationKbkStore"}}]}],mainGridStore:"Information.Service.Reconciliation.GridStore",subGridStoreId:"ISReconciliationSubGridStore"}]});a.callParent()}},0,["ISReconciliation"],["panel","form","component","container","box","ISReconciliation"],{panel:true,form:true,component:true,container:true,box:true,ISReconciliation:true},["widget.ISReconciliation"],[[LkIp.view.Scrolling.prototype.mixinId||LkIp.view.Scrolling.$className,LkIp.view.Scrolling]],[LkIp.view.Information.Service.Reconciliation,"Index"],0));(Ext.cmd.derive("LkIp.view.Information.Service.Operations.Index",Ext.form.Panel,{cls:"IS-container ISOperations iScroll",initComponent:function(){var a=this;Ext.apply(a,{items:[{xtype:"ISGridLayout",lang:reference.lang.informationService.operations,description:reference.lang.informationService.step1CommonShortDescription,condition:{itemId:"ISOperationsCondition",data:[{xtype:"filterSelect",tpl:'<tpl for="."><li class="x-boundlist-item" role="option">{value}</li></tpl>',displayField:"value",width:700,name:"date",fieldLabel:reference.lang.informationService.operations.year,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"ISReconciliationYearStore"},getSendValue:function(){return"31.12."+this.value},editable:false,typeAhead:false},{xtype:"radiogroup",itemId:"operationsTypeGroup",fieldLabel:reference.lang.informationService.operations.accountingCondition,defaults:{xtype:"radiofield",name:"operationsType"},cls:"select-field",vertical:true,columns:1,items:[{boxLabel:reference.lang.informationService.operations.condition.paymentTypeYes,inputValue:1,checked:true},{boxLabel:reference.lang.informationService.operations.condition.paymentTypeNo,inputValue:2}],width:850},{xtype:"filterSelect",fieldLabel:reference.lang.informationService.step1No,emptyText:reference.lang.informationService.emptyTextNo,name:"codeNO",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"ISOperationsNoStore"},width:800,editable:false,typeAhead:false}]},filterData:[{cls:"first-column fl-l",defaults:{labelWidth:140,width:400,xtype:"filterSelect"},items:[{lang:reference.lang.filters.statusIP,name:"statusIP",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"ISOperationsStatusIPStore"}},{lang:reference.lang.filters.kbk,name:"kbk",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"ISOperationsKbkStore"}}]}],mainGridStore:"Information.Service.Operations.GridStore",subGridStoreId:"ISOperationsSubGridStore"}]});a.callParent()}},0,["ISOperations"],["panel","form","component","container","box","ISOperations"],{panel:true,form:true,component:true,container:true,box:true,ISOperations:true},["widget.ISOperations"],[[LkIp.view.Scrolling.prototype.mixinId||LkIp.view.Scrolling.$className,LkIp.view.Scrolling]],[LkIp.view.Information.Service.Operations,"Index"],0));(Ext.cmd.derive("LkIp.view.Rsb.Reconciliation.Statement.Index",Ext.form.Panel,{cls:"IS-container rsbRStatement iScroll",initComponent:function(){var a=this;Ext.apply(a,{items:[{xtype:"ISGridLayout",lang:reference.lang.rsb.reconciliation.statement,description:reference.lang.rsb.reconciliation.statement.step1Description,step1help:reference.lang.rsb.reconciliation.statement.step1help,condition:{itemId:"rsbRStatementCondition",data:[{xtype:"displayfield",fieldLabel:reference.lang.rsb.reconciliation.statement.dateStatement,value:LkIp.Utils.getNowDate(),width:700},{xtype:"radiogroup",itemId:"reconciliationTypeGroup",fieldLabel:reference.lang.rsb.reconciliation.statement.reconciliationTypeLabel,defaults:{xtype:"radiofield",name:"reconciliationType"},cls:"select-field",vertical:true,columns:1,items:[{boxLabel:reference.lang.rsb.reconciliation.statement.reconciliationTypes.type1,inputValue:1,checked:true},{boxLabel:reference.lang.rsb.reconciliation.statement.reconciliationTypes.type2,inputValue:2},{boxLabel:reference.lang.rsb.reconciliation.statement.reconciliationTypes.type3,inputValue:3}],width:750},{xtype:"radiogroup",itemId:"getTypeGroup",fieldLabel:reference.lang.rsb.reconciliation.statement.getTypeLabel,defaults:{xtype:"radiofield",name:"getType"},cls:"select-field",vertical:true,columns:1,items:[{boxLabel:reference.lang.rsb.reconciliation.statement.getTypes.personal,inputValue:1,checked:true},{boxLabel:reference.lang.rsb.reconciliation.statement.getTypes.mail,inputValue:2}],width:750},{xtype:"filterDate",name:"date",fieldLabel:Ext.String.format("<span class='text-tooltip'>{0}</span>",reference.lang.rsb.reconciliation.statement.reconciliationDate),hidden:false,width:700,maxValue:new Date(),minValue:"01.01."+(Ext.Date.format(new Date(),"Y")-3),listeners:{render:function(b){LkIp.Utils.tooltip(b.getEl().down(".text-tooltip"),reference.lang.rsb.reconciliation.statement.reconciliationDateTtip)}}},{xtype:"filterSelect",fieldLabel:reference.lang.rsb.reconciliation.statement.noLabel,emptyText:reference.lang.informationService.emptyTextNo,name:"codeNO",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"rsbRStatementNoStore"},width:800,editable:false,typeAhead:false}]},filterData:[{cls:"first-column fl-l",defaults:{labelWidth:140,width:400,xtype:"filterSelect"},items:[{lang:reference.lang.filters.statusIP,name:"statusIP",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"rsbRStatementStatusIPStore"}},{lang:reference.lang.filters.kbk,name:"kbk",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"rsbRStatementKbkStore"}}]},{cls:"second-column fl-l",items:[]}],mainGridStore:"Rsb.Reconciliation.Statement.GridStore",subGridStoreId:"rsbRStatementSubGridStore"}]});a.callParent()}},0,["rsbRStatement"],["panel","form","component","container","rsbRStatement","box"],{panel:true,form:true,component:true,container:true,rsbRStatement:true,box:true},["widget.rsbRStatement"],[[LkIp.view.Scrolling.prototype.mixinId||LkIp.view.Scrolling.$className,LkIp.view.Scrolling]],[LkIp.view.Rsb.Reconciliation.Statement,"Index"],0));(Ext.cmd.derive("LkIp.model.Filters.SelectFilters",Ext.data.Model,{fields:["code","value","type",{name:"qtip",type:"string",convert:function(b,a){return a.get("value")}},{name:"fullName",type:"string",convert:function(c,a){var b=a.get("code");return(0!==b?b+"-":"")+a.get("value")}},{name:"shortName",type:"string",convert:function(b,a){var c=a.get("value");return a.get("code")+"-"+Ext.String.ellipsis(c,40,true)}},{name:"shortValue",type:"string",convert:function(b,a){return Ext.String.ellipsis(a.get("value"),40,true)}},{name:"filterValue",type:"string",convert:function(d,a){var b="",c=a.get("code");if("0"!=c){b=c+"-"}return b+a.get("value")}}],idProperty:"code"},0,0,0,0,0,0,[LkIp.model.Filters,"SelectFilters"],0));(Ext.cmd.derive("LkIp.view.Feedback.Index",Ext.Container,{cls:"feedback iScroll",required:'<span class="form-required-field" data-qtip="'+reference.lang.form.required+'">*</span>',initComponent:function(){var c=this,a=LkIp.User.head.SvedFL.AdrRF,b="";if(!Ext.isEmpty(a["@Ulitsa"])){b+=a["@Ulitsa"]}if(!Ext.isEmpty(a["@Dom"])){if(!Ext.isEmpty(b)){b+=", "}b+=a["@Dom"]}Ext.apply(this,{items:[{xtype:"component",html:LkIp.Utils.header(reference.lang.feedback.header+" "+LkIp.Utils.getNowDate(),4)},{xtype:"note",text:reference.lang.pages.complaints.info,margin:"0 0 15"},{xtype:"form",itemId:"feedbackForm",layout:{type:"auto"},rel:"form",border:false,fieldDefaults:{labelAlign:"left",labelWidth:250,margin:5},items:[{xtype:"fieldset",title:reference.lang.feedback.form.no,items:[{xtype:"filterSelect",lang:reference.lang.filters.no,name:"selectNo",fieldLabel:reference.lang.feedback.form.selectNo,afterLabelTextTpl:this.required,width:600,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"feedbackSelectNoStore"},formScope:this,validator:this.validateNo},{xtype:"filterSelect",name:"chooseNo",enableKeyEvents:true,fieldLabel:reference.lang.feedback.form.chooseNo,afterLabelTextTpl:this.required,width:600,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"feedbackChooseNoStore"},formScope:this,validator:this.validateNo,hideTrigger:true,maskRe:undefined,forceSelection:false}]},{xtype:"fieldset",title:reference.lang.feedback.form.sender,defaults:{xtype:"displayfield"},items:[{fieldLabel:reference.lang.feedback.form.surname,name:"surname",value:LkIp.User.get("surname")},{fieldLabel:reference.lang.feedback.form.name,name:"name",value:LkIp.User.get("name")},{fieldLabel:reference.lang.feedback.form.patronymic,name:"patronymic",value:LkIp.User.get("patronymic")},{fieldLabel:reference.lang.feedback.form.inn,name:"inn",value:LkIp.User.get("inn")},{fieldLabel:reference.lang.feedback.form.ogrnIp,name:"ogrnIp",value:LkIp.User.get("ogrn")},{xtype:"textfield",name:"phone",fieldLabel:reference.lang.feedback.form.phone,width:450,maskRe:/\d/,maxLength:20,minLength:8,allowBlank:true,afterLabelTextTpl:""}]},{xtype:"fieldset",title:reference.lang.feedback.form.post,itemId:"postFieldset",checkboxToggle:true,checkboxName:"postAnswer",collapsed:true,listeners:{afterrender:function(d){d.legend.items.getAt(0).addCls("blue-checkbox")}},items:[{xtype:"container",layout:"anchor",id:"answerType-mail",defaults:{xtype:"textfield",width:600},items:[{xtype:"filterSelect",lang:reference.lang.feedback.form.subjectRf,name:"subjectRF",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"feedbackRegionsStore"},valueField:"value"},{fieldLabel:reference.lang.feedback.form.city,afterLabelTextTpl:this.required,name:"city",formScope:this,validator:this.validateAnswerMail,value:!Ext.isEmpty(a["@Gorod"])?a["@Gorod"]:""},{fieldLabel:reference.lang.feedback.form.address,afterLabelTextTpl:this.required,name:"address",formScope:this,validator:this.validateAnswerMail,value:b},{fieldLabel:reference.lang.feedback.form.postCode,afterLabelTextTpl:this.required,name:"postCode",maskRe:/[0-9]/,formScope:this,validator:this.validateAnswerMail,value:!Ext.isEmpty(a["@Indeks"])?a["@Indeks"]:""}]}]},{xtype:"fieldset",title:reference.lang.feedback.form.feedbackInfo,defaults:{xtype:"textareafield",anchor:"100%",enforceMaxLength:true},items:[{fieldLabel:reference.lang.feedback.form.feedbackOrgans,name:"authorities",maxLength:200},{fieldLabel:reference.lang.feedback.form.feedbackText,name:"content",maxLength:5000,allowBlank:false,rows:8,afterLabelTextTpl:this.required},{xtype:"form",rel:"fileUpload",itemId:"fileUpload",layout:{type:"anchor"},border:false,items:[{xtype:"container",anchor:"100%",layout:{type:"anchor"},items:[{anchor:"100%",xtype:"filefield",name:"file",itemId:"file",clearOnSubmit:false,fieldLabel:reference.lang.feedback.form.file,buttonText:reference.lang.form.file.buttonDefault,msgTarget:"side",componentCls:"fl-l"},{xtype:"button",scale:"small",componentCls:"fl-l",anchor:"10%",disabled:true,hidden:true,text:reference.lang.buttons.reset,itemId:"resetFile",height:Ext.isIE8?24:26,margin:"6 0 0"}]},{xtype:"component",cls:"gray",margin:"0 0 0 260",html:reference.lang.feedback.form.fileRestriction}]},{xtype:"hiddenfield",name:"filename"}]},{xtype:"button",text:reference.lang.buttons.send,rel:"submit",formBind:true,name:"feedbackSend",disabled:true}]}]});this.callParent()},validateAnswerMail:function(a){if(this.formScope.down('[name="postAnswer"]').getValue()&&Ext.isEmpty(a)){return reference.lang.form.requiredField}return true},validateNo:function(){if(LkIp.Utils.isEmpty(this.formScope.down('[name="selectNo"]').getValue())&&LkIp.Utils.isEmpty(this.formScope.down('[name="chooseNo"]').getValue())){return reference.lang.feedback.form.errorNo}return true}},0,["feedback"],["feedback","component","container","box"],{feedback:true,component:true,container:true,box:true},["widget.feedback"],[[LkIp.view.Scrolling.prototype.mixinId||LkIp.view.Scrolling.$className,LkIp.view.Scrolling]],[LkIp.view.Feedback,"Index"],0));(Ext.cmd.derive("LkIp.view.Default.ListGrid",Ext.grid.Panel,{columnLines:false,height:"100%",cls:"border-table list-grid commonInfo",viewConfig:{autoScroll:false,stripeRows:true,enableTextSelection:true,disableSelection:true,overItemCls:""},storeId:undefined,layout:{type:"auto"},hideHeaders:true,sortableColumns:false,enableColumnMove:false,enableColumnResize:false,grayLabel:false,initComponent:function(){var a=this;Ext.apply(this,{store:{extend:"Ext.data.ArrayStore",fields:[{name:"key",type:"string"},{name:"value",type:"string"}],autoDestroy:true,storeId:a.storeId,listeners:{datachanged:function(){LkIp.app.getController("Content").initNoTooltips()}}},columns:[{width:250,dataIndex:"key",renderer:function(c,b){if(a.grayLabel){b.tdCls="gray"}return c+":"}},{flex:1,dataIndex:"value"}]});a.callParent()}},0,["listtable"],["panel","component","listtable","tablepanel","container","grid","box","gridpanel"],{panel:true,component:true,listtable:true,tablepanel:true,container:true,grid:true,box:true,gridpanel:true},["widget.listtable"],0,[LkIp.view.Default,"ListGrid"],0));(Ext.cmd.derive("LkIp.view.Default.LVTabBar",Ext.tab.Panel,{cls:"vertical-tab iScroll",tabs:[],layout:"auto",tabPosition:"left",autoHeight:true,minHeight:150,plain:true,tabBar:{width:240},initComponent:function(){var a=this;Ext.apply(a,{items:a.tabs});a.callParent(arguments)}},0,["left-vertical-tab-bar"],["tabpanel","panel","component","container","box","left-vertical-tab-bar"],{tabpanel:true,panel:true,component:true,container:true,box:true,"left-vertical-tab-bar":true},["widget.left-vertical-tab-bar"],0,[LkIp.view.Default,"LVTabBar"],0));(Ext.cmd.derive("LkIp.view.Profile.Index",Ext.container.Container,{cls:"profile iScroll",initComponent:function(){var a=this,b=LkIp.User.isClosedUser(),c=LkIp.User.isEcrInspector();Ext.apply(a,{items:[Ext.apply(a.generateCommonBlock(),{hidden:c}),{xtype:"component",margin:"15 0 0",html:LkIp.Utils.header(reference.lang.profile.egripHeader,4)},a.generateEgripBlock(),{xtype:"component",margin:"15 0 0",hidden:LkIp.User.isEcrInspector(),html:LkIp.Utils.header(reference.lang.profile.egrnHeader,4)},Ext.apply(a.generateEgrnBlock(),{hidden:c})]});a.callParent()},generateEgrnBlock:function(){return{xtype:"container",cls:"blue-back",layout:{type:"hbox"},items:[{xtype:"container",width:"80%",items:[{xtype:"component",padding:"25 20 10",itemId:"profile-inspections",style:{lineHeight:"1.5em"},tpl:'<span class="fl-l">{code}-</span><span class="fl-l">{name}, <br/>{adres} <br/> \u043a.\u0442\u0435\u043b: {phone}</span>',data:{code:"",name:"",adres:"",phone:""}},{xtype:"component",cls:"clear profile-all-link",padding:"10 20",html:'<a href="#!/egrn/account">'+reference.lang.index.profileWidget.allInspections+"</a>"}]},(LkIp.User.isActiveUser()?{xtype:"component",cls:"link4-icon",padding:"9 0 0 30",margin:"15 0 0",height:35,itemId:"linkToFeedback",tpl:'<a href="#!/feedback{code}" class="link">'+reference.lang.profile.links.feedback+"</a>",data:{code:""}}:{cls:"display-none"})]}},generateCommonBlock:function(){var d=LkIp.User.isClosedUser(),c=LkIp.User.isActiveUser(),b=LkIp.User.isActiveUser(),e=LkIp.User.isInspector(),a=[];a.push({title:reference.lang.profile.commonInfoHeader,xtype:"container",itemId:"commonUserInfo-body",items:[{xtype:"listtable",storeId:"commonInfoGrid",minHeight:160,margin:"0 0 15"},{xtype:"component",html:reference.lang.egrn.account.userInfoBlock.tabFL.error+(b?'<a class="link4-icon link" style="margin: 2px 0 0 15px;padding:3px 0 5px 35px;" href="#!/personaldata/update">':'<a class="link4-icon link not-active-link certificate-tooltip" style="margin: 2px 0 0 15px;padding:3px 0 5px 35px;">')+reference.lang.egrn.account.userInfoBlock.tabFL.sendPersonalData+"</a>"}]});if(!d){a.push({title:reference.lang.profile.contactInfoHeader,xtype:"form",componentCls:"profile-setting-contact",itemId:"contactUserInfo-body",defaults:{xtype:"container",defaults:{labelWidth:200,padding:"10 20",width:550}},items:[(!Ext.isEmpty(LkIp.User.get("serial"))?{xtype:"container",cls:"blue-back",items:[{xtype:"displayfield",fieldLabel:reference.lang.profile.tabpanel.settings.serial,value:LkIp.User.get("serial").toUpperCase()}]}:{cls:"display-none"}),{xtype:"container",items:[{xtype:e?"displayfield":"textfield",fieldLabel:reference.lang.profile.tabpanel.settings.email,padding:"10 20",name:"email",vtype:"email",value:LkIp.User.get("email"),componentCls:"fl-l"},{xtype:"container",padding:"10 20 10 10",cls:"fl-r",width:200,hidden:true,itemId:"send-activation-email-el",items:{xtype:"button",padding:0,itemId:"send-activation-email",text:reference.lang.profile.activation.button}}]},{xtype:"component",padding:"0 20 10",itemId:"emailConfirmation",cls:"red",hidden:true,html:reference.lang.profile.activation.text},{xtype:"container",cls:"blue-back",items:[{xtype:e?"displayfield":"textfield",name:"address",fieldLabel:reference.lang.profile.tabpanel.settings.adres,value:LkIp.User.get("address")}]},{xtype:"container",items:[{xtype:e?"displayfield":"textfield",padding:"10 20",fieldLabel:reference.lang.profile.tabpanel.settings.phone,name:"phone",value:!Ext.isEmpty(LkIp.User.get("phone"))?LkIp.User.get("phone"):"",vtype:"phone",maxLength:20}]},(!e?{xtype:"container",cls:"blue-back",items:[{xtype:"radiogroup",margin:"0",itemId:"subscription-check",type:"get-info-group",fieldLabel:reference.lang.profile.tabpanel.notification.getInfoOnEmail,items:[{boxLabel:reference.lang.yes,name:"getInfo",inputValue:1},{boxLabel:reference.lang.no,name:"getInfo",inputValue:2,checked:true}]},{xtype:"container",itemId:"container-notify-settings",hidden:true,items:[{xtype:"checkboxgroup",cls:"checkbox-group",itemId:"eventsNotifyTest",labelWidth:500,labelAlign:"top",vertical:true,columns:1,columnWidth:600,defaults:{width:600},fieldLabel:reference.lang.profile.tabpanel.notification.events.title,items:[{boxLabel:reference.lang.profile.tabpanel.notification.chooseAll,name:"allEvents",type:"all",inputValue:"all"},{boxLabel:reference.lang.profile.tabpanel.notification.events.changeStatus,name:"doc.status",inputValue:"doc.status"},{boxLabel:reference.lang.profile.tabpanel.notification.events.answer,name:"doc.answer",inputValue:"doc.answer"}]},{xtype:"checkboxgroup",cls:"checkbox-group",itemId:"groupsNotifyTest",margin:"10 0 0 0",labelWidth:500,labelAlign:"top",vertical:true,columns:1,columnWidth:600,labelStyle:"margin-bottom: 5px;",defaults:{width:600},fieldLabel:reference.lang.profile.tabpanel.notification.groups.title,items:[{boxLabel:reference.lang.profile.tabpanel.notification.chooseAll,name:"allGroups",type:"all",inputValue:"all"},{boxLabel:reference.lang.profile.tabpanel.notification.groups.egrip,name:"egrip.docs",inputValue:"egrip.docs"},{boxLabel:reference.lang.profile.tabpanel.notification.groups.no,name:"egrn.docs",inputValue:"egrn.docs"},{boxLabel:reference.lang.profile.tabpanel.notification.groups.rsb,name:"rsb.adddocs",inputValue:"rsb.adddocs"},{boxLabel:reference.lang.profile.tabpanel.notification.groups.informationService,name:"rsb.viewdocs",inputValue:"rsb.viewdocs"},{boxLabel:reference.lang.profile.tabpanel.notification.groups.feedback,name:"rsb.feedback",inputValue:"rsb.feedback"},{boxLabel:reference.lang.profile.tabpanel.notification.groups.kkt,name:"kkt",inputValue:"kkt"}]}]}]}:{cls:"display-none"}),{xtype:"button",margin:"15 0 15 20",rel:"submit",formBind:true,disabled:true,listeners:{enable:function(f){if(e){f.disable()}}},text:reference.lang.buttons.save}]})}if(c){a.push({title:reference.lang.profile.accountInfoHeader,xtype:"form",componentCls:"profile-setting-contact",itemId:"accountUserInfo-body",defaults:{xtype:"container",labelWidth:200,margin:"0 0 0 20"},items:[{xtype:"component",margin:"15 0 0 20",padding:0,html:LkIp.Utils.header(reference.lang.profile.password.header,4)},{xtype:"component",width:"100%",html:reference.lang.registration.setPassword.passwordStart},{margin:"15 0 0 20",cls:"check",width:"100%",itemId:"password-rules",items:{xtype:"container",cls:"check-steps",defaults:{xtype:"container",cls:"block-with-icon check-step failed"},items:[{itemId:"password-bigLetters",items:[{cls:"check-icon",items:{xtype:"component",itemId:"password-bigLetters-icon",cls:"exclamation-16-icon"}},{xtype:"component",html:reference.lang.registration.setPassword.bigLetters}]},{itemId:"password-smallLetters",items:[{cls:"check-icon",items:{xtype:"component",itemId:"password-smallLetters-icon",cls:"exclamation-16-icon"}},{xtype:"component",html:reference.lang.registration.setPassword.smallLetters}]},{itemId:"password-numbers",items:[{cls:"check-icon",items:{xtype:"component",itemId:"password-numbers-icon",cls:"exclamation-16-icon"}},{xtype:"component",html:reference.lang.registration.setPassword.numbers}]},{itemId:"password-specialChars",items:[{cls:"check-icon",items:{xtype:"component",itemId:"password-specialChars-icon",cls:"exclamation-16-icon"}},{xtype:"component",html:reference.lang.registration.setPassword.specialChars}]},{itemId:"password-minLength",items:[{cls:"check-icon",items:{xtype:"component",itemId:"password-minLength-icon",cls:"exclamation-16-icon"}},{xtype:"component",html:reference.lang.registration.setPassword.minLength}]}]}},{margin:"15 0 0 20",xtype:"textfield",name:"password",itemId:"password",fieldLabel:reference.lang.registration.passwordLabel,afterLabelTextTpl:"",inputType:"password",allowBlank:false,minLength:7,width:550,vtype:"passwordLetters"},{margin:"15 0 0 20",xtype:"textfield",name:"password_confirmed",itemId:"password_confirmed",initialPassField:"password",fieldLabel:reference.lang.registration.passwordConfirmedLabel,afterLabelTextTpl:"",inputType:"password",allowBlank:false,minLength:7,width:550,vtype:"password"},{xtype:"container",margin:"15 0 15 20",items:[{xtype:"button",width:100,formBind:true,disabled:true,name:"clickSetPassword",componentCls:"fl-l",text:reference.lang.buttons.save,listeners:{enable:function(f){if(e){f.disable()}}}},!e?{xtype:"component",cls:"fl-r exit-link",html:'<a href="#!/user/deactivate">'+reference.lang.profile.deactivate.title+"</a>"}:{cls:"display-none"}]}]})}else{if(!e){a.push({title:reference.lang.profile.accountInfoHeader,xtype:"form",componentCls:"profile-setting-contact",itemId:"accountUserInfo-body",defaults:{xtype:"container",labelWidth:200,margin:"0 0 0 20"},items:[{xtype:"component",cls:"exit-link",html:'<a href="#!/user/deactivate">'+reference.lang.profile.deactivate.title+"</a>"}]})}}return{xtype:"container",items:[{xtype:"left-vertical-tab-bar",itemId:"commonInfoTabs",minHeight:200,tabs:a}]}},generateEgripBlock:function(){var b=this,d=LkIp.User.isEcrInspector(),a=LkIp.User.isActiveUser(),c=LkIp.User.isActiveUser();return{xtype:"container",items:[{xtype:"left-vertical-tab-bar",minHeight:300,tabs:[{title:reference.lang.profile.egrip.headers.commonInfo,xtype:"container",itemId:"commonEgripInfo-body",defaults:{xtype:"container",cls:"fl-l"},items:[{style:{width:"70%",marginRight:"5%"},items:[{xtype:"component",html:LkIp.Utils.header(reference.lang.profile.egrip.commonInfo.header,5)},{xtype:"listtable",storeId:"egripCommonInfo",minHeight:550}]},{style:{width:"25%"},hidden:d,items:[{xtype:"component",cls:"link4-icon",padding:"0 0 0 30",margin:"15 0 0",html:(c?'<a href="#!/egrip/request" class="link">':'<a class="not-active-link certificate-tooltip">')+reference.lang.profile.links.egripRequest+"</a>"},(c?{xtype:"container",defaults:{xtype:"component",cls:"link4-icon",padding:"0 0 0 30",margin:"15 0 0"},items:[{html:'<a href="#!/stateRegistration" class="link">'+reference.lang.profile.links.change+"</a>"},{html:'<a href="#!/stateRegistration" class="link">'+reference.lang.profile.links.stop+"</a>"}]}:{cls:"display-none"})]}]},{title:reference.lang.profile.egrip.headers.okvedInfo,xtype:"container",itemId:"okvedEgripInfo-body",items:[{xtype:"component",html:LkIp.Utils.header(reference.lang.profile.egrip.okvedInfo.headerMain,5)},{xtype:"gridtable",paging:false,getFileAction:false,limitFilter:false,contextMenu:false,store:{extend:"Ext.data.ArrayStore",fields:[{name:"code",type:"string"},{name:"type",type:"string"},{name:"name",type:"string"},{name:"grnip",type:"string"},{name:"date",type:"date"}],autoDestroy:true,storeId:"egripInfoMainOkved"},columns:[{text:reference.lang.egrip.info.columns.SvOKVED.activityName,flex:1,dataIndex:"name",renderer:LkIp.Utils.stringWrap},{text:reference.lang.egrip.info.columns.SvOKVED.code,width:150,dataIndex:"code"},{text:reference.lang.egrip.info.columns.grnip,width:150,dataIndex:"grnip"},{text:reference.lang.egrip.info.columns.grnipDate,width:150,xtype:"datecolumn",format:"d.m.Y",dataIndex:"date"}]},{xtype:"container",padding:"15 0 0",items:[{xtype:"component",cls:"fl-l",padding:"6 0 0",html:LkIp.Utils.header(reference.lang.profile.egrip.okvedInfo.headerSub,5)},{xtype:"component",cls:"link4-icon fl-r",padding:"6 0 0 30",height:"30px",hidden:!c,html:'<a href="#!/stateRegistration" class="link">'+reference.lang.profile.links.change+"</a>"}]},{xtype:"gridtable",paging:false,getFileAction:false,limitFilter:false,contextMenu:false,store:{extend:"Ext.data.ArrayStore",fields:[{name:"code",type:"string"},{name:"type",type:"string"},{name:"name",type:"string"},{name:"grnip",type:"string"},{name:"date",type:"date"}],autoDestroy:true,storeId:"egripInfoSubOkved"},columns:[{text:reference.lang.egrip.info.columns.SvOKVED.activityName,flex:1,dataIndex:"name",renderer:LkIp.Utils.stringWrap},{text:reference.lang.egrip.info.columns.SvOKVED.code,width:150,dataIndex:"code"},{text:reference.lang.egrip.info.columns.grnip,width:150,dataIndex:"grnip"},{text:reference.lang.egrip.info.columns.grnipDate,width:150,xtype:"datecolumn",format:"d.m.Y",dataIndex:"date"}]}]},{title:reference.lang.profile.egrip.headers.zapInfo,xtype:"container",itemId:"zapEgripInfo-body",items:[{xtype:"container",cls:"profile-filters",items:[{xtype:"component",html:reference.lang.profile.filters.header},{xtype:"container",layout:"hbox",items:[{xtype:"container",layout:"hbox",margin:"0 10 0 0",items:[{xtype:"component",html:reference.lang.profile.filters.dateEgrip+":",margin:"5 10 0 0"},{xtype:"filterDate",name:"egripDate_from",componentCls:"input-field fl-l",fieldLabel:"\u0441",labelWidth:10,hideEmptyLabel:false,margin:"1 0 0 5",hidden:false},{xtype:"filterDate",name:"egripDate_to",componentCls:"input-field fl-l",fieldLabel:"\u043f\u043e",labelWidth:15,hideEmptyLabel:false,margin:"1 0 0 5",hidden:false}]},{xtype:"button",text:reference.lang.buttons.find,rel:"findZap",componentCls:"small-button",handler:function(){this.fireEvent("findRow","egripDate")}}]}]},{xtype:"gridtable",paging:false,getFileAction:false,limitFilter:false,contextMenu:false,store:{extend:"Ext.data.ArrayStore",fields:[{name:"ogrn",type:"string"},{name:"status"},{name:"event",type:"string"},{name:"regOrganName",type:"string"},{name:"organCode",type:"string"},{name:"grnip",type:"string"},{name:"date",type:"date",convert:function(f,e){return LkIp.Utils.getDate(f)}},{name:"dateSet",type:"date"}],groupField:"date",autoDestroy:true,storeId:"egripInfoRecord"},myViewConfig:{stripeRows:true},features:[{ftype:"grouping",groupHeaderTpl:"{name}",collapsible:false,enableGroupingMenu:false}],columns:[{text:reference.lang.egrip.info.columns.SvZap.event,flex:1,dataIndex:"event",renderer:LkIp.Utils.stringWrap},{text:reference.lang.egrip.info.columns.SvZap.no,width:250,dataIndex:"regOrganName",renderer:function(f,g,e){return LkIp.Utils.noRenderer(e.get("organCode"))+" - "+f}},{text:reference.lang.egrip.info.columns.SvZap.status,width:150,dataIndex:"",renderer:function(f,i,e){var g=e.get("status"),h="";if(!Ext.isEmpty(g)){Ext.Array.each(g,function(j){h+='<div class="profile-status">'+j.status+'</div><div class="gray">'+LkIp.Utils.getDate(j.date)+" "+j.grnip+"</div>"})}return h}}]}]},{title:reference.lang.profile.egrip.headers.svidInfo,xtype:"container",itemId:"svidEgripInfo-body",items:[{xtype:"container",cls:"profile-filters",items:[{xtype:"component",html:reference.lang.profile.filters.header},{xtype:"container",layout:"hbox",items:[{xtype:"container",layout:"hbox",margin:"0 10 0 0",items:[{xtype:"component",html:reference.lang.profile.filters.dateSvid+":",margin:"5 10 0 0"},{xtype:"filterDate",name:"svidDate_from",componentCls:"input-field fl-l",fieldLabel:"\u0441",labelWidth:10,hideEmptyLabel:false,margin:"1 0 0 5",hidden:false},{xtype:"filterDate",name:"svidDate_to",componentCls:"input-field fl-l",fieldLabel:"\u043f\u043e",labelWidth:15,hideEmptyLabel:false,margin:"1 0 0 5",hidden:false}]},{xtype:"button",text:reference.lang.buttons.find,rel:"findSvid",componentCls:"small-button",handler:function(){this.fireEvent("findRow","svidDate")}}]}]},{xtype:"gridtable",paging:false,getFileAction:false,limitFilter:false,contextMenu:false,store:{extend:"Ext.data.ArrayStore",fields:[{name:"ogrn",type:"string"},{name:"seria",type:"string"},{name:"number",type:"string"},{name:"date",type:"date",convert:function(f,e){return LkIp.Utils.getDate(f)}},{name:"organName",type:"string"},{name:"organCode",type:"string"},{name:"grnip",type:"string"},{name:"egripDate",type:"date"}],groupField:"date",autoDestroy:true,storeId:"egripInfoSvid"},myViewConfig:{stripeRows:true},features:[{ftype:"grouping",groupHeaderTpl:"{name}",collapsible:false,enableGroupingMenu:false}],columns:[{text:reference.lang.egrip.info.columns.SvSvid.seria,width:110,dataIndex:"seria"},{text:reference.lang.egrip.info.columns.SvSvid.number,width:110,dataIndex:"number"},{text:reference.lang.egrip.info.columns.SvSvid.no,width:250,dataIndex:"organName",renderer:function(f,g,e){return LkIp.Utils.noRenderer(e.get("organCode"))+" - "+f}},{text:reference.lang.egrip.info.columns.SvSvid.infoZap,flex:1,dataIndex:"",renderer:function(g,i,f){var j=f.get("grnip"),h=f.get("egripDate"),e="";if(!Ext.isEmpty(h)){e+='<div class="gray">'+LkIp.Utils.getDate(h)+"</div>"}if(!Ext.isEmpty(j)){e+='<div class="gray">'+j+"</div>"}return e}}]}]}]}]}}},0,["profile"],["component","container","box","profile"],{component:true,container:true,box:true,profile:true},["widget.profile"],[[LkIp.view.Scrolling.prototype.mixinId||LkIp.view.Scrolling.$className,LkIp.view.Scrolling]],[LkIp.view.Profile,"Index"],0));Ext.apply(Ext.form.field.VTypes,{passwordLetters:function(m,l){var j=l.up("form"),g="QWERTYUIOPLKJHGFDSAZXCVBNM\u0419\u0426\u0423\u041a\u0415\u041d\u0413\u0428\u0429\u0417\u0425\u042a\u0424\u042b\u0412\u0410\u041f\u0420\u041e\u041b\u0414\u0416\u042d\u042f\u0427\u0421\u041c\u0418\u0422\u042c\u0411\u042e",b="qwertyuiopasdfghjklzxcvbnm\u0439\u0446\u0443\u043a\u0435\u043d\u0433\u0448\u0449\u0437\u0445\u044a\u0444\u044b\u0432\u0430\u043f\u0440\u043e\u043b\u0434\u0436\u044d\u044f\u0447\u0441\u043c\u0438\u0442\u044c\u0431\u044e",n="0123456789",d="#$^&*_-+%@",h=false,a=false,k=false,e=false,c=m.length,f=0;for(;f<c;f++){if(!h&&g.indexOf(m[f])>-1){h=true;continue}if(!a&&b.indexOf(m[f])>-1){a=true;continue}if(!k&&n.indexOf(m[f])>-1){k=true;continue}if(!e&&d.indexOf(m[f])>-1){e=true;continue}}if(h){j.down("#password-bigLetters").removeCls("failed").addCls("success");j.down("#password-bigLetters-icon").removeCls("exclamation-16-icon").addCls("ok-16-icon")}else{j.down("#password-bigLetters").removeCls("success").addCls("failed");j.down("#password-bigLetters-icon").removeCls("ok-16-icon").addCls("exclamation-16-icon")}if(a){j.down("#password-smallLetters").removeCls("failed").addCls("success");j.down("#password-smallLetters-icon").removeCls("exclamation-16-icon").addCls("ok-16-icon")}else{j.down("#password-smallLetters").removeCls("success").addCls("failed");j.down("#password-smallLetters-icon").removeCls("ok-16-icon").addCls("exclamation-16-icon")}if(k){j.down("#password-numbers").removeCls("failed").addCls("success");j.down("#password-numbers-icon").removeCls("exclamation-16-icon").addCls("ok-16-icon")}else{j.down("#password-numbers").removeCls("success").addCls("failed");j.down("#password-numbers-icon").removeCls("ok-16-icon").addCls("exclamation-16-icon")}if(e){j.down("#password-specialChars").removeCls("failed").addCls("success");j.down("#password-specialChars-icon").removeCls("exclamation-16-icon").addCls("ok-16-icon")}else{j.down("#password-specialChars").removeCls("success").addCls("failed");j.down("#password-specialChars-icon").removeCls("ok-16-icon").addCls("exclamation-16-icon")}if(c>=7){j.down("#password-minLength").removeCls("failed").addCls("success");j.down("#password-minLength-icon").removeCls("exclamation-16-icon").addCls("ok-16-icon")}else{j.down("#password-minLength").removeCls("success").addCls("failed");j.down("#password-minLength-icon").removeCls("ok-16-icon").addCls("exclamation-16-icon")}return a&&h&&k&&e&&c>=7},password:function(c,b){if(b.initialPassField){var a=b.up("form").down("#"+b.initialPassField);return(c==a.getValue())}return true},phone:function(b,a){return/^[0-9\+\(\)\-\ ]+$/.test(b)},phoneText:reference.lang.registration.phoneError,passwordText:reference.lang.registration.passwordConfirmationError,passwordLettersText:reference.lang.registration.passwordLettersError});(Ext.cmd.derive("LkIp.view.Deactivate.Index",Ext.container.Container,{cls:"deactivate iScroll",initComponent:function(){Ext.apply(this,{items:[{xtype:"component",html:LkIp.Utils.header(reference.lang.profile.deactivate.header,3)},{xtype:"component",html:reference.lang.profile.deactivate.info},{margin:"15 0 0 0",xtype:"button",name:"deactivateUser",text:reference.lang.profile.deactivate.deactivateAction}]});this.callParent(arguments)}},0,["deactivate"],["component","container","box","deactivate"],{component:true,container:true,box:true,deactivate:true},["widget.deactivate"],[[LkIp.view.Scrolling.prototype.mixinId||LkIp.view.Scrolling.$className,LkIp.view.Scrolling]],[LkIp.view.Deactivate,"Index"],0));(Ext.cmd.derive("LkIp.view.Rsb.Cards.Details.CardInfoLayout",Ext.container.Container,{cardData:{},tableForTabTpl:'<table class="describe-table no-border"><tr><td>'+reference.lang.rsb.cards.details.tax+'</td><td><tpl if="nalogWidth &gt; 0"><span class="summ colored-summ">{[LkIp.Utils.numberConvert(values.nalog)]} '+reference.lang.rsb.cards.details.currency+'</span><tpl else><span class="summ">{[LkIp.Utils.numberConvert(values.nalog)]} '+reference.lang.rsb.cards.details.currency+"</span></tpl></td></tr><tr><td>"+reference.lang.rsb.cards.details.fines+'</td><td><tpl if="peniWidth &gt; 0"><span class="summ colored-summ">{[LkIp.Utils.numberConvert(values.peni)]} '+reference.lang.rsb.cards.details.currency+'</span><tpl else><span class="summ">{[LkIp.Utils.numberConvert(values.peni)]} '+reference.lang.rsb.cards.details.currency+"</span></tpl></td></tr><tr><td>"+reference.lang.rsb.cards.details.penalty+'</td><td><tpl if="shtrafWidth &gt; 0"><span class="summ colored-summ">{[LkIp.Utils.numberConvert(values.shtraf)]} '+reference.lang.rsb.cards.details.currency+'<span><tpl else><span class="summ">{[LkIp.Utils.numberConvert(values.shtraf)]} '+reference.lang.rsb.cards.details.currency+"<span></tpl></td></tr><tr><td>"+reference.lang.rsb.cards.details.percents+'</td><td><tpl if="percentWidth &gt; 0"><span class="summ colored-summ">{[LkIp.Utils.numberConvert(values.percent)]} '+reference.lang.rsb.cards.details.currency+'</span><tpl else><span class="summ">{[LkIp.Utils.numberConvert(values.percent)]} '+reference.lang.rsb.cards.details.currency+"</span></tpl></td></tr><tr><td>"+reference.lang.rsb.cards.details.budgetPercents+'</td><td><tpl if="percentBudjWidth &gt; 0"><span class="summ colored-summ">{[LkIp.Utils.numberConvert(values.percentBudj)]} '+reference.lang.rsb.cards.details.currency+'</span></td><tpl else><span class="summ">{[LkIp.Utils.numberConvert(values.percentBudj)]} '+reference.lang.rsb.cards.details.currency+"</span></td></tpl></td></tr></table>",cardInfoTpl:'<table class="card-info describe-table no-border"><thead><tr><tpl if="hideOktmo == 0 || isNdfl &gt; 0"><th>'+reference.lang.rsb.cards.details.okato+'</th></tpl><tpl if="nameNo"><th>'+reference.lang.rsb.cards.details.taxAgency+'</th></tpl></tr></thead><tbody><tr><tpl if="hideOktmo == 0 || isNdfl &gt; 0"><td>{oktmo}</td></tpl><td>{nameNo}</td></tr></tbody></table>',futurepaymentTpl:'<tpl for="."><div class="futurepayment-item"><div class="fl-l clock-icon"></div><div class="payment-block fl-l"><span class="period">'+reference.lang.rsb.cards.details.pendingCharges+'</span><span>{paymentInfo}</span><tpl if="uregZd == 1">'+(!LkIp.User.isClosedUser()?'<span class="graph-link"><a href="#!/rsb/cards/debt?{fidCard}">'+reference.lang.rsb.cards.details.paymentSchedules+"</a></span>":"")+'</tpl></div><div class="clear"></div></div></tpl>',initComponent:function(){var a=this;Ext.apply(this,{margin:"5 0 0",itemId:"cardFid-"+a.cardData.fid,id:"cardFid-"+a.cardData.fid,items:[{xtype:"component",html:new Ext.XTemplate(a.cardInfoTpl).apply(a.cardData)},(!Ext.isEmpty(a.cardData.futurepayment)?{xtype:"container",cls:"futurepayment-block",defaults:{xtype:"component"},items:[{html:a.formFuturepaymentBlock(a.cardData.futurepayment,a.cardData.fid)}]}:{cls:"display-none"}),{xtype:"tabpanel",cls:"tabs-block",itemId:"card-info-tabpanel",plain:true,tabBar:{layout:{type:"hbox",align:"stretch"},defaults:{flex:1,height:59},height:60},bodyCls:"tabsContent",items:[{title:Ext.String.format('<div class="tab-header"><div>'+reference.lang.rsb.cards.details.debt+'</div><div class="summ-block"><span class="orange-minus-icon">{0}</span></div></div>',LkIp.Utils.numberConvert(a.cardData.debt.total)),type:"tab",itemId:"debt-tab",cls:"debt-tab",xtype:"container",layout:{type:"auto"},defaults:{xtype:"container",width:"50%",cls:"fl-l"},items:[{xtype:"component",html:reference.lang.rsb.cards.details.debtNone,hidden:0!=a.cardData.debt.total},(a.cardData.debt.main.vsego>0?{width:"100%",items:[{xtype:"component",componentCls:"sub-title",html:reference.lang.rsb.cards.details.principal,margin:"0 0 10 0"},{xtype:"component",html:a.drawTableWithGraph(a.cardData.debt.main,a.cardData.debt.maxValue)}]}:{cls:"display-none"}),(a.cardData.debt.uregZd.vsego>0?{items:[{xtype:"component",componentCls:"sub-title",html:reference.lang.rsb.cards.details.structDebt,margin:"0 0 10 0"},{xtype:"component",html:a.drawTableWithGraph(a.cardData.debt.uregZd,a.cardData.debt.maxValue)}]}:{cls:"display-none"}),{width:"100%",xtype:"component",itemId:"kbkToPay-debt",tpl:'<div class="kbk-pay fl-r" data-kbk="{KBK}" style="cursor: pointer!important;"><div class="fl-l" style="margin: 5px 0 0 0;">\u041a\u0411\u041a \u0434\u043b\u044f \u043e\u043f\u043b\u0430\u0442\u044b</div><div class="fl-l blue-exclamation-icon" style="margin: 0 0 0 10px;"></div></div>'}]},{title:Ext.String.format('<div class="tab-header"><div>'+reference.lang.rsb.cards.details.overpayment+'</div><div class="summ-block"><span class="blue-plus-icon">{0}</span></div></div>',LkIp.Utils.numberConvert(a.cardData.overpayment.total)),type:"tab",itemId:"overpayment-tab",cls:"overpayment-tab",xtype:"container",items:[{xtype:"component",html:reference.lang.rsb.cards.details.overpaymentNone,hidden:0!=a.cardData.overpayment.total},(0!=a.cardData.overpayment.total?{defaults:{xtype:"container",cls:"fl-l"},items:[{width:"50%",items:[{xtype:"component",componentCls:"sub-title",html:reference.lang.rsb.cards.details.possibleSums,margin:"0 0 10 0"},{xtype:"component",html:a.drawTableWithGraph(a.cardData.overpayment,a.cardData.overpayment.maxValue)}]},{xtype:"button",componentCls:"big-button "+(!LkIp.User.isActiveUser()?"certificate-tooltip":""),margin:"25 0 0",text:'<div class="button-text">'+Ext.String.format(reference.lang.rsb.cards.details.statement,"<br/>")+"</div>",itemId:"overpaymentBtn",disabled:!LkIp.User.isActiveUser(),type:"cardBtn",hidden:a.cardData.overpayment.overpaymentCheck==0}]}:{cls:"display-none"}),{xtype:"component",itemId:"kbkToPay-over",tpl:'<div class="kbk-pay fl-r" data-kbk="{KBK}" style="cursor: pointer!important;"><div class="fl-l" style="margin: 5px 0 0 0;">\u041a\u0411\u041a \u0434\u043b\u044f \u043e\u043f\u043b\u0430\u0442\u044b</div><div class="fl-l blue-exclamation-icon" style="margin: 0 0 0 10px;"></div></div>'}]}]},{xtype:"component",margin:"15 0 0",html:'<a href="#!/rsb/cards/operations?'+a.cardData.fid+'">'+reference.lang.pages.rsb.cards.operations.menuTitle+"</a>"}]});this.callParent()},drawTableWithGraph:function(a,b){if(Ext.isIE8){a.nalogWidth=a.nalog/b*78;a.peniWidth=a.peni/b*78;a.shtrafWidth=a.shtraf/b*78;a.percentWidth=a.percent/b*78;a.percentBudjWidth=a.percent/b*78}else{Ext.Object.each(a,function(c,d){a[c+"Width"]=d/b*78})}return new Ext.XTemplate(this.tableForTabTpl).apply(a)},formFuturepaymentBlock:function(a,c){var b=[];Ext.Array.each(a,function(d){b.push({fidCard:c,paymentName:d.paymentName,uregZd:d.uregZd,paymentInfo:"\u043d\u0435 \u043f\u043e\u0437\u0434\u043d\u0435\u0435 "+LkIp.Utils.getDate(d.limitDate)})});return new Ext.XTemplate(this.futurepaymentTpl).apply(b)}},0,["rsbCardsDetailsInfoLayout"],["component","container","box","rsbCardsDetailsInfoLayout"],{component:true,container:true,box:true,rsbCardsDetailsInfoLayout:true},["widget.rsbCardsDetailsInfoLayout"],0,[LkIp.view.Rsb.Cards.Details,"CardInfoLayout"],0));(Ext.cmd.derive("LkIp.view.Rsb.Cards.Details.Index",Ext.Container,{cls:"card iScroll",initComponent:function(){Ext.apply(this,{items:[{xtype:"container",layout:"hbox",items:[{xtype:"component",itemId:"name-page",cls:"full-name-KBK",tpl:"<h3>{fullName}</h3>"},{xtype:"component",itemId:"kbkTooltip",margin:"0 0 0 10",cls:"kbkTooltip blue-exclamation-icon",html:"&nbsp;"}]},{xtype:"container",itemId:"content-page"}]});this.callParent()},defaultTooltip:"<table class='index-card-info describe-table no-border'><tr><td colspan='2'><span class='label'>"+reference.lang.rsb.cards.details.nameKbk+"</span></td> </tr><tr><td colspan='2'><span class='text'>{nameKBK}</span></td> </tr><tr><td colspan='2'><span class='label'>"+reference.lang.rsb.cards.details.kbk+"</span></td> </tr><tr><td colspan='2'><span class='text'>{KBK}</span></td> </tr><tpl if='isNdfl &gt; 0'><tr><td style='width: 50%;'><span class='label'>"+reference.lang.rsb.cards.details.status+"</span></td></tr><tr><td style='width: 50%;'><span class='text'>{status} ({statusCode})</span></td></tr></tpl></table>",drawPage:function(e,g,c,f){var d=this,a=[],b=new Ext.XTemplate(d.defaultTooltip);Ext.suspendLayouts();d.down("#name-page").update({fullName:g});if(true===f){a.push({xtype:"container",cls:"multiple-rsb-cards-page",items:[{xtype:"container",itemId:"rsb-cards-grid-view",cls:"rsb-cards-grid-view",items:[{xtype:"container",itemId:"rsb-cards-grid-view-filters",cls:"rsb-cards-grid-view-filters",items:[{xtype:"textfield",emptyText:reference.lang.rsb.cards.details.numberInspection,labetWidth:0,name:"codeNoFilter",cls:"inspection-filter"},{xtype:"button",componentCls:"rsb-cards-sorting",iconCls:"arrow-down-black-icon",iconAlign:"right",text:Ext.String.format(reference.lang.rsb.cards.details.sort,'<span class="button-text">',"</span>"),name:"rsb-cards-sorting-button",handler:function(){this.fireEvent("sortCardData",this)}}]},{xtype:"gridpanel",itemId:"rsb-cards-grid-view-grid",columnLines:false,rowLines:false,cls:"border-table",stripeRows:true,autoHeight:true,hideHeaders:true,sortableColumns:false,enableColumnMove:false,enableColumnResize:false,store:{extend:"Ext.data.ArrayStore",fields:["debtSumm","overpaymentSumm","region","nameNo","codeNo","fid"],storeId:c},columns:[{flex:1,dataIndex:"",renderer:function(j,i,h){var k=h.get("debtSumm");return Ext.String.format('<div class="rsb-cards-grid-inner-text"><span class="inspection-position">{0}</span><div class="summ-table"><div class="debt-summ-grid-element"><span class="orange-minus-icon">{1}</span></div><div class="overpayment-summ-grid-element"><span class="blue-plus-icon">{2}</span></div></div></div>',Ext.isEmpty(h.get("nameNo"))?"":h.get("codeNo")+" - "+h.get("nameNo"),LkIp.Utils.rouble(LkIp.Utils.numberConvert(k)),LkIp.Utils.rouble(LkIp.Utils.numberConvert(h.get("overpaymentSumm"))))}}]},{xtype:"container",itemId:"rsb-cards-grid-view-after-grid",cls:"rsb-cards-grid-view-after-grid"},{cls:"clear"}]},{xtype:"container",itemId:"rsb-cards-card-view",cls:"rsb-cards-card-view",items:[]}]})}else{e.hideOktmo=1;a.push(Ext.create("LkIp.view.Rsb.Cards.Details.CardInfoLayout",{cardData:e}))}if(!Ext.isEmpty(d.ttip)){d.ttip.destroy();d.ttip=undefined}d.down("#content-page").add(a);d.ttip=LkIp.Utils.tooltip(d.down("#kbkTooltip"),b.apply(e),{componentCls:"index-rsb-cards-ttip"});Ext.resumeLayouts(true)}},0,["rsbCardsDetails"],["rsbCardsDetails","component","container","box"],{rsbCardsDetails:true,component:true,container:true,box:true},["widget.rsbCardsDetails"],0,[LkIp.view.Rsb.Cards.Details,"Index"],0));(Ext.cmd.derive("LkIp.view.StatementList.Index",Ext.Container,{cls:"statementList",initComponent:function(){var b=LkIp.User.isActiveUser(),a=LkIp.User.isActiveUser();Ext.apply(this,{items:[a?{xtype:"container",items:[{xtype:"component",html:reference.lang.pages.statementsList.feedback},{margin:"15 0",html:"<hr>"},{xtype:"component",html:reference.lang.pages.statementsList.onlineBooking},{margin:"15 0",html:"<hr>"}]}:{cls:"display-none"},{xtype:"component",html:reference.lang.pages.statementsList.faq},{margin:"15 0",html:"<hr>"},{xtype:"component",margin:"0 0 10",html:reference.lang.pages.statementsList.ifns},{xtype:"left-vertical-tab-bar",itemId:"servicesList",minHeight:400,tabs:[{title:reference.lang.pages.statementsList.menuInformationIP,xtype:"container",defaults:{xtype:"component",cls:"link4-icon services-inline"},items:[{html:(a?'<a href="#!/egrip/request">':'<a class="not-active-link certificate-tooltip">')+reference.lang.pages.egrip.request.title+"</a>"},{html:(a?'<a href="#!/stateRegistration">':'<a class="not-active-link certificate-tooltip">')+"\u0412\u043d\u0435\u0441\u0435\u043d\u0438\u0435 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0439 \u0432 \u0441\u0432\u0435\u0434\u0435\u043d\u0438\u044f \u043e\u0431 \u0418\u041f</a>"},{html:(a?'<a href="#!/stateRegistration">':'<a class="not-active-link certificate-tooltip">')+"\u041f\u0440\u0435\u043a\u0440\u0430\u0449\u0435\u043d\u0438\u0435 \u0434\u0435\u044f\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u0438 \u0432 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u0418\u041f</a>"},{html:(a?'<a href="#!/partnership">':'<a class="not-active-link certificate-tooltip">')+reference.lang.pages.partnership.title+"</a>"},{html:(a?'<a href="#!/foreign">':'<a class="not-active-link certificate-tooltip">')+reference.lang.pages.foreign.title+"</a>"},{html:(a?'<a href="#!/consent">':'<a class="not-active-link certificate-tooltip">')+reference.lang.pages.consent.title+"</a>"}]},{title:reference.lang.pages.statementsList.menuGetHelp,xtype:"container",defaults:{xtype:"component",cls:"link4-icon services-inline"},items:[{html:'<a href="#!/information/service/obligation">'+reference.lang.pages.informationService.obligation.titleForStatementList+"</a>"},{html:'<a href="#!/information/service/paymentsStatus">'+reference.lang.pages.informationService.paymentsStatus.titleForStatementList+"</a>"},{html:'<a href="#!/information/service/accounting">'+reference.lang.pages.informationService.accounting.titleForStatementList+"</a>"},{html:'<a href="#!/information/service/operations">'+reference.lang.pages.informationService.operations.titleForStatementList+"</a>"},{html:'<a href="#!/information/service/reconciliation">'+reference.lang.pages.informationService.reconciliation.titleForStatementList+"</a>"}]},{title:reference.lang.pages.statementsList.menuPaymentsBudget,xtype:"container",defaults:{xtype:"component",cls:"link4-icon services-inline"},items:[{html:'<a href="#!/rsb/overpayment">'+reference.lang.pages.rsb.overpayment.title+"</a>"},{html:'<a href="#!/clarify">'+reference.lang.pages.rsb.clarify.title+"</a>"},{html:'<a href="#!/rsb/reconciliation/statement">\u0417\u0430\u044f\u0432\u043b\u0435\u043d\u0438\u0435 \u043e\u0431 \u0438\u043d\u0438\u0446\u0438\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0438 \u043f\u0440\u043e\u0446\u0435\u0434\u0443\u0440\u044b \u043f\u0440\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u044f \u0441\u043e\u0432\u043c\u0435\u0441\u0442\u043d\u043e\u0439 \u0441\u0432\u0435\u0440\u043a\u0438 \u0440\u0430\u0441\u0447\u0435\u0442\u043e\u0432 \u0441 \u0431\u044e\u0434\u0436\u0435\u0442\u043e\u043c</a>'}]},{title:reference.lang.pages.statementsList.menuChangeTaxSystem,xtype:"container",items:[{xtype:"tabpanel",cls:"tabs-block tabs-block-border-bottom",itemId:"tabs-block-taxSystems",plain:true,layout:"fit",bodyCls:"tabsContent",items:[{title:reference.lang.pages.statementsList.taxSystems.envd,defaults:{xtype:"component",cls:"link4-icon services-inline",margin:"15"},xtype:"container",items:[{html:'<a href="#!/envd/registration">'+reference.lang.pages.envd.registration.title+"</a>"},{html:'<a href="#!/envd/deregistration">'+reference.lang.pages.envd.deregistration.title+"</a>"}]},{title:reference.lang.pages.statementsList.taxSystems.eshn,defaults:{xtype:"component",cls:"link4-icon services-inline",margin:"15"},xtype:"container",items:[{html:'<a href="#!/eshn/notification">'+reference.lang.pages.eshn.notification.titleForStatementList+"</a>"},{html:'<a href="#!/eshn/statement">'+reference.lang.pages.eshn.statement.titleForStatementList+"</a>"},{html:'<a href="#!/eshn/stop">'+reference.lang.pages.eshn.stop.title+"</a>"},{html:'<a href="#!/eshn/refuse">'+reference.lang.pages.eshn.refuse.title+"</a>"}]},{title:reference.lang.pages.statementsList.taxSystems.usn,defaults:{xtype:"component",cls:"link4-icon services-inline",margin:"15"},xtype:"container",items:[{html:'<a href="#!/usn/notification">'+reference.lang.pages.usn.notification.title+"</a>"},{html:'<a href="#!/usn/statement">'+reference.lang.pages.usn.statement.title+"</a>"},{html:'<a href="#!/usn/refuse">'+reference.lang.pages.usn.refuse.title+"</a>"},{html:'<a href="#!/usn/change">'+reference.lang.pages.usn.change.title+"</a>"},{html:'<a href="#!/usn/stop">'+reference.lang.pages.usn.stop.title+"</a>"}]},{title:reference.lang.pages.statementsList.taxSystems.psn,defaults:{xtype:"component",cls:"link4-icon services-inline",margin:"15"},xtype:"container",items:[{html:'<a href="#!/psn/patent">'+reference.lang.pages.psn.patent.title+"</a>"},{html:'<a href="#!/psn/orn">'+reference.lang.pages.psn.orn.titleForStatementList+"</a>"},{html:'<a href="#!/psn/stop">'+reference.lang.pages.psn.stop.title+"</a>"}]}]}]},{title:reference.lang.pages.servicesList.menuCheckFZ,xtype:"container",defaults:{xtype:"component",cls:"link4-icon services-inline"},items:[{html:(a?'<a href="#!/employees/identification">':'<a class="not-active-link certificate-tooltip">')+reference.lang.pages.employeesIdentification.servicesTitle+"</a>"}]},{title:reference.lang.pages.servicesList.menuKkt,xtype:"container",defaults:{xtype:"component",cls:"link4-icon services-inline"},items:[{html:'<a href="#!/kkt/registration">'+reference.lang.pages.informationService.kkt.registration+"</a>"},{html:'<a href="#!/kkt/fiscal-report">'+reference.lang.pages.informationService.kkt.fiscalReport+"</a>"}]}]}]});this.callParent()}},0,["statementList"],["statementList","component","container","box"],{statementList:true,component:true,container:true,box:true},["widget.statementList"],0,[LkIp.view.StatementList,"Index"],0));(Ext.cmd.derive("LkIp.view.ServicesList.Index",Ext.Container,{cls:"servicesList",initComponent:function(){var c=LkIp.User.isInspector(),b=LkIp.User.isActiveUser(),a=LkIp.User.isActiveUser();Ext.apply(this,{items:{xtype:"left-vertical-tab-bar",minHeight:520,tabs:[{title:reference.lang.pages.servicesList.menuInformationIP,xtype:"container",defaults:{xtype:"component",cls:"link4-icon services-inline"},items:[{html:(a?'<a href="#!/egrip/request">':'<a class="not-active-link certificate-tooltip">')+reference.lang.pages.egrip.request.titleForServices+"</a>"},{html:(a?'<a href="#!/stateRegistration">':'<a class="not-active-link certificate-tooltip">')+reference.lang.profile.links.change+"</a>"},{html:(a?'<a href="#!/stateRegistration">':'<a class="not-active-link certificate-tooltip">')+reference.lang.profile.links.stop+"</a>"},{html:(a?'<a href="#!/partnership">':'<a class="not-active-link certificate-tooltip">')+reference.lang.pages.partnership.titleForService+"</a>"},{html:(a?'<a href="#!/foreign">':'<a class="not-active-link certificate-tooltip">')+reference.lang.pages.foreign.servicesTitle+"</a>"},{html:(a?'<a href="#!/consent">':'<a class="not-active-link certificate-tooltip">')+reference.lang.pages.consent.title+"</a>"}]},{title:reference.lang.pages.servicesList.menuGetHelp,xtype:"container",defaults:{xtype:"component",cls:"link4-icon services-inline"},items:[{html:'<a href="#!/information/service/obligation">'+reference.lang.pages.informationService.obligation.titleForServiceList+"</a>"},{html:'<a href="#!/information/service/paymentsStatus">'+reference.lang.pages.informationService.paymentsStatus.titleForServiceList+"</a>"},{html:'<a href="#!/information/service/accounting">'+reference.lang.pages.informationService.accounting.titleForServiceList+"</a>"},{html:'<a href="#!/information/service/operations">'+reference.lang.pages.informationService.operations.titleForServiceList+"</a>"},{html:'<a href="#!/information/service/reconciliation">'+reference.lang.pages.informationService.reconciliation.titleForServiceListShort+"</a>"}]},{title:reference.lang.pages.servicesList.menuPaymentsBudget,xtype:"container",defaults:{xtype:"component",cls:"link4-icon services-inline"},items:[{html:'<a href="#!/rsb/overpayment">'+reference.lang.pages.rsb.overpayment.titleForService+"</a>"},{html:'<a href="#!/clarify">'+reference.lang.pages.rsb.clarify.titleForService+"</a>"},{html:'<a href="#!/rsb/reconciliation/statement">'+reference.lang.rsb.reconciliation.buttons.statement+"</a>"}]},{title:reference.lang.pages.servicesList.menuChangeTaxSystem,xtype:"container",items:[{xtype:"tabpanel",cls:"tabs-block tabs-block-border-bottom",itemId:"tabs-block-taxSystems",plain:true,layout:"fit",bodyCls:"tabsContent",items:[{title:reference.lang.pages.statementsList.taxSystems.envd,defaults:{xtype:"component",cls:"link4-icon services-inline",margin:"15"},xtype:"container",items:[{html:'<a href="#!/envd/registration">'+reference.lang.pages.envd.registration.title+"</a>"},{html:'<a href="#!/envd/deregistration">'+reference.lang.pages.envd.deregistration.title+"</a>"}]},{title:reference.lang.pages.statementsList.taxSystems.eshn,defaults:{xtype:"component",cls:"link4-icon services-inline",margin:"15"},xtype:"container",items:[{html:'<a href="#!/eshn/notification">'+reference.lang.pages.eshn.notification.titleForStatementList+"</a>"},{html:'<a href="#!/eshn/statement">'+reference.lang.pages.eshn.statement.titleForStatementList+"</a>"},{html:'<a href="#!/eshn/stop">'+reference.lang.pages.eshn.stop.title+"</a>"},{html:'<a href="#!/eshn/refuse">'+reference.lang.pages.eshn.refuse.title+"</a>"}]},{title:reference.lang.pages.statementsList.taxSystems.usn,defaults:{xtype:"component",cls:"link4-icon services-inline",margin:"15"},xtype:"container",items:[{html:'<a href="#!/usn/notification">'+reference.lang.pages.usn.notification.title+"</a>"},{html:'<a href="#!/usn/statement">'+reference.lang.pages.usn.statement.title+"</a>"},{html:'<a href="#!/usn/refuse">'+reference.lang.pages.usn.refuse.title+"</a>"},{html:'<a href="#!/usn/change">'+reference.lang.pages.usn.change.title+"</a>"},{html:'<a href="#!/usn/stop">'+reference.lang.pages.usn.stop.title+"</a>"}]},{title:reference.lang.pages.statementsList.taxSystems.psn,defaults:{xtype:"component",cls:"link4-icon services-inline",margin:"15"},xtype:"container",items:[{html:'<a href="#!/psn/patent">'+reference.lang.pages.psn.patent.title+"</a>"},{html:'<a href="#!/psn/orn">'+reference.lang.pages.psn.orn.titleForStatementList+"</a>"},{html:'<a href="#!/psn/stop">'+reference.lang.pages.psn.stop.title+"</a>"}]}]}]},{title:reference.lang.pages.servicesList.menuCheckFZ,xtype:"container",defaults:{xtype:"component",cls:"link4-icon services-inline"},items:[{html:(a?'<a href="#!/employees/identification">':'<a class="not-active-link certificate-tooltip">')+reference.lang.pages.employeesIdentification.servicesTitle+"</a>"}]},(!c)?{title:reference.lang.pages.servicesList.menuKkt,xtype:"container",defaults:{xtype:"component",cls:"link4-icon services-inline"},items:[{html:'<a href="#!/kkt/registration">'+reference.lang.pages.informationService.kkt.registration+"</a>"},{html:'<a href="#!/kkt/fiscal-report">'+reference.lang.pages.informationService.kkt.fiscalReport+"</a>"}]}:{cls:"display-none"},{title:reference.lang.pages.servicesList.menuApplyInspection,xtype:"container",defaults:{xtype:"component",cls:"link4-icon services-inline"},items:[(!c)?{html:'<a href="#!/feedback">'+reference.lang.profile.links.feedback+"</a>"}:{cls:"display-none"},{html:'<a href="https://service.nalog.ru/addrno.do" target="_blank">'+reference.lang.pages.nalogru.inspectionAdres+"</a>"},(!c)?{html:'<a href="#!/onlineBooking">'+reference.lang.pages.onlineBooking.title+"</a>"}:{cls:"display-none"}]},(!c)?{title:reference.lang.pages.servicesList.menuOtherServices,xtype:"container",defaults:{xtype:"component",cls:"link4-icon services-inline"},items:[LkIp.User.hasKktAccess()?{html:'<a href="#!/kkt">'+reference.lang.pages.nalogru.kkt+"</a>"}:{cls:"display-none"},{html:'<a class="i-want-address-no markirovkaLink">'+reference.lang.profile.links.markirovka+"</a>"}]}:{cls:"display-none"},{title:reference.lang.pages.servicesList.faqInfo,xtype:"container",defaults:{xtype:"component",cls:"link4-icon services-inline"},items:[{html:(a?'<a href="#!/fns/stands">':'<a class="not-active-link certificate-tooltip">')+reference.lang.pages.fnsStands.title+"</a>"},{html:(a?'<a href="#!/fns/mail">':'<a class="not-active-link certificate-tooltip">')+reference.lang.pages.fnsMail.title+"</a>"}]}]}});this.callParent(arguments)}},0,["servicesList"],["component","container","box","servicesList"],{component:true,container:true,box:true,servicesList:true},["widget.servicesList"],0,[LkIp.view.ServicesList,"Index"],0));(Ext.cmd.derive("LkIp.view.DeskAudit.Index",Ext.Container,{cls:"deskAudit iScroll",data:[],initComponent:function(){var b=this,a=[];if(!LkIp.User.isInspectorWithCodeNO()){a.push({lang:reference.lang.filters.no,name:"codeNO",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"deskAuditCodeNoStore"}})}a.push({lang:reference.lang.knp.filters.year,name:"year",tpl:'<tpl for="."><li class="x-boundlist-item" role="option">{value}</li></tpl>',displayField:"value",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"deskAuditYearStore"}},{lang:reference.lang.knp.filters.knp,name:"knp",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"deskAuditKnpStore"}});Ext.apply(b,{items:[{xtype:"defaultFilterPanel",id:"deskAuditFilterPanel",data:[{xtype:"container",margin:0,defaults:{labelWidth:180,width:500,xtype:"filterSelect"},items:a}]},{margin:"15 0",xtype:"container",cls:"grid-with-status-bar",items:[{xtype:"gridStatusBar",page:"DeskAudit",data:[{title:reference.lang.knp.statusBar.notStoppedChecks,id:"tab-not-all-finished"},{title:reference.lang.knp.statusBar.allChecks,id:"tab-all-finished"}]},{xtype:"gridtable",id:"deskAuditGrid",store:"DeskAudit.GridStore",getFileAction:false,columns:[{text:reference.lang.knp.grid.indicator,dataIndex:"",id:"indicatorColumn",width:100,hidden:true,sortable:false,renderer:this.drawIndicator},{text:reference.lang.knp.grid.codeNo,dataIndex:"@KodNalOrg",width:80,renderer:function(d,e,c){return LkIp.Utils.noRenderer(d)}},{text:reference.lang.knp.grid.docInfoText,menuDisabled:true,columns:[{text:reference.lang.knp.grid.docInfo.name,dataIndex:"@SvedDokKNDNaim",width:250,sortable:false},{text:reference.lang.knp.grid.docInfo.period,dataIndex:"@SvedDokNalPer",width:100,sortable:false},{text:reference.lang.knp.grid.docInfo.year,dataIndex:"@SvedDokOtchGod",width:100,sortable:true},{text:reference.lang.knp.grid.docInfo.number,dataIndex:"@SvedDokNomKorr",width:120,sortable:true},{text:reference.lang.knp.grid.docInfo.dateInNo,dataIndex:"@DataPostNO",width:120,sortable:true,renderer:function(c){return !Ext.isEmpty(c)?LkIp.Utils.getDate(c):""}}]},{text:reference.lang.knp.grid.sendType,dataIndex:"@SposobOtprNaim",width:150,hidden:true},{text:reference.lang.knp.grid.dateSend,dataIndex:"@DataOtpr",width:100,hidden:true,renderer:function(c){return !Ext.isEmpty(c)?LkIp.Utils.getDate(c):""}},{text:reference.lang.knp.grid.knd,dataIndex:"@SvedDokKND",width:150,hidden:true,sortable:false},{text:reference.lang.knp.grid.checkInfoText,menuDisabled:true,hidden:true,id:"checkInfoColumn",columns:[{text:reference.lang.knp.grid.checkInfo.dateStop,id:"checkInfo-dateStopColumn",dataIndex:"@SvedProvDataOkKP",hidden:true,width:100,sortable:true,renderer:function(c){return !Ext.isEmpty(c)?LkIp.Utils.getDate(c):""}},{text:reference.lang.knp.grid.checkInfo.dateTerminate,id:"checkInfo-dateTerminateColumn",dataIndex:"@SvedProvDataPrekrKP",hidden:true,sortable:true,width:100,renderer:function(c){return !Ext.isEmpty(c)?LkIp.Utils.getDate(c):""}}]}]}]}]});b.callParent()},drawIndicator:function(c,e,b){var a=Ext.isEmpty(b.get("@SvedProvDataOkKP")),d=Ext.isEmpty(b.get("@SvedProvDataPrekrKP")),f=b.get("@SvedProvNarushVyiyavl");if(a&&d){return""}if(!a&&0==f){e.tdAttr='data-qtip="\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043e\u043a\u043e\u043d\u0447\u0435\u043d\u0430. \u041d\u0430\u0440\u0443\u0448\u0435\u043d\u0438\u0439 \u043d\u0435 \u0432\u044b\u044f\u0432\u043b\u0435\u043d\u043e." data-qclass="qtip-resize" style="text-align:center;"';return'<div class="ok-16-icon" style="margin: 0 auto;"></div>'}if(!d){e.tdAttr='data-qtip="\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043f\u0440\u0435\u043a\u0440\u0430\u0449\u0435\u043d\u0430." data-qclass="qtip-resize" style="text-align:center;"';return'<div class="icon-cross" style="margin: 0 auto;"></div>'}if(!a&&1==f){e.tdAttr='data-qtip="\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043e\u043a\u043e\u043d\u0447\u0435\u043d\u0430. \u0412\u044b\u044f\u0432\u043b\u0435\u043d\u044b \u043d\u0430\u0440\u0443\u0448\u0435\u043d\u0438\u044f. *" data-qclass="qtip-resize"';return'<div class="exclamation-16-icon" style="margin: 0 auto;"></div>'}}},0,["deskAudit"],["deskAudit","component","container","box"],{deskAudit:true,component:true,container:true,box:true},["widget.deskAudit"],[[LkIp.view.Scrolling.prototype.mixinId||LkIp.view.Scrolling.$className,LkIp.view.Scrolling]],[LkIp.view.DeskAudit,"Index"],0));(Ext.cmd.derive("LkIp.model.Calculator.MOFilter",Ext.data.Model,{fields:["code","value","mo",{name:"qtip",type:"string",convert:function(b,a){return a.get("value")}},{name:"fullName",type:"string",convert:function(c,a){var b=a.get("code");return(0!==b?b+"-":"")+a.get("value")}},{name:"shortName",type:"string",convert:function(b,a){var c=a.get("value");return a.get("code")+"-"+Ext.String.ellipsis(c,40,true)}},{name:"filterValue",type:"string",convert:function(d,a){var b="",c=a.get("code");if("0"!=c){b=c+"-"}return b+a.get("value")}}],idProperty:"code"},0,0,0,0,0,0,[LkIp.model.Calculator,"MOFilter"],0));(Ext.cmd.derive("LkIp.model.Calculator.SelectFilters",LkIp.model.Filters.SelectFilters,{idProperty:"type"},0,0,0,0,0,0,[LkIp.model.Calculator,"SelectFilters"],0));(Ext.cmd.derive("LkIp.view.Calculator.Index",Ext.Container,{cls:"calculator",required:'<span class="form-required-field" data-qtip="'+reference.lang.form.required+'">*</span>',initComponent:function(){Ext.apply(this,{items:[{xtype:"container",layout:{type:"auto"},margin:"20 0 0 0",items:[{xtype:"component",html:LkIp.Utils.header(reference.lang.pages.instruction,3),cls:"fl-l"}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"1",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.calculator.instruction.step1},{xtype:"component",html:"<p>"+reference.lang.calculator.instruction.step1Description+"</p>"}]},{xtype:"form",itemId:"choose-form",cls:"calculator-choose-block",defaults:{xtype:"container",cls:"calculator-choose-item"},margin:"0 0 15",items:[{items:[{cls:"item-question",html:reference.lang.calculator.excisable},{xtype:"radiogroup",cls:"item-action",fieldLabel:"",labelSeparator:"",allowBlank:false,items:[{boxLabel:reference.lang.buttons.yes,name:"excisable",inputValue:"1"},{boxLabel:reference.lang.buttons.no,name:"excisable",inputValue:"2",checked:true}]},{xtype:"component",cls:"clear show-goods",itemId:"showMoreGoods",margin:"15 0",html:'<div><span class="page-action-link">\u041f\u0435\u0440\u0435\u0447\u0435\u043d\u044c \u043f\u043e\u0434\u0430\u043a\u0446\u0438\u0437\u043d\u044b\u0445 \u0442\u043e\u0432\u0430\u0440\u043e\u0432</span></div>'},{xtype:"component",itemId:"showMoreGoodsValue",html:'<div class="more-info-block"><ul><li>\u044d\u0442\u0438\u043b\u043e\u0432\u044b\u0439 \u0441\u043f\u0438\u0440\u0442, \u043f\u0440\u043e\u0438\u0437\u0432\u0435\u0434\u0435\u043d\u043d\u044b\u0439 \u0438\u0437 \u043f\u0438\u0449\u0435\u0432\u043e\u0433\u043e \u0438\u043b\u0438 \u043d\u0435\u043f\u0438\u0449\u0435\u0432\u043e\u0433\u043e \u0441\u044b\u0440\u044c\u044f, \u0432 \u0442\u043e\u043c \u0447\u0438\u0441\u043b\u0435 \u0434\u0435\u043d\u0430\u0442\u0443\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0439 \u044d\u0442\u0438\u043b\u043e\u0432\u044b\u0439 \u0441\u043f\u0438\u0440\u0442, \u0441\u043f\u0438\u0440\u0442-\u0441\u044b\u0440\u0435\u0446, \u0434\u0438\u0441\u0442\u0438\u043b\u043b\u044f\u0442\u044b \u0432\u0438\u043d\u043d\u044b\u0439, \u0432\u0438\u043d\u043e\u0433\u0440\u0430\u0434\u043d\u044b\u0439, \u043f\u043b\u043e\u0434\u043e\u0432\u044b\u0439, \u043a\u043e\u043d\u044c\u044f\u0447\u043d\u044b\u0439, \u043a\u0430\u043b\u044c\u0432\u0430\u0434\u043e\u0441\u043d\u044b\u0439, \u0432\u0438\u0441\u043a\u043e\u0432\u044b\u0439;</li><li>\u0441\u043f\u0438\u0440\u0442\u043e\u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0449\u0430\u044f \u043f\u0440\u043e\u0434\u0443\u043a\u0446\u0438\u044f (\u0440\u0430\u0441\u0442\u0432\u043e\u0440\u044b, \u044d\u043c\u0443\u043b\u044c\u0441\u0438\u0438, \u0441\u0443\u0441\u043f\u0435\u043d\u0437\u0438\u0438 \u0438 \u0434\u0440\u0443\u0433\u0438\u0435 \u0432\u0438\u0434\u044b \u043f\u0440\u043e\u0434\u0443\u043a\u0446\u0438\u0438 \u0432 \u0436\u0438\u0434\u043a\u043e\u043c \u0432\u0438\u0434\u0435) \u0441 \u043e\u0431\u044a\u0435\u043c\u043d\u043e\u0439 \u0434\u043e\u043b\u0435\u0439 \u044d\u0442\u0438\u043b\u043e\u0432\u043e\u0433\u043e \u0441\u043f\u0438\u0440\u0442\u0430 \u0431\u043e\u043b\u0435\u0435 9 \u043f\u0440\u043e\u0446\u0435\u043d\u0442\u043e\u0432; </li><li>\u0430\u043b\u043a\u043e\u0433\u043e\u043b\u044c\u043d\u0430\u044f \u043f\u0440\u043e\u0434\u0443\u043a\u0446\u0438\u044f (\u0432\u043e\u0434\u043a\u0430, \u043b\u0438\u043a\u0435\u0440\u043e\u0432\u043e\u0434\u043e\u0447\u043d\u044b\u0435 \u0438\u0437\u0434\u0435\u043b\u0438\u044f, \u043a\u043e\u043d\u044c\u044f\u043a\u0438, \u0432\u0438\u043d\u043e, \u0444\u0440\u0443\u043a\u0442\u043e\u0432\u043e\u0435 \u0432\u0438\u043d\u043e, \u043b\u0438\u043a\u0435\u0440\u043d\u043e\u0435 \u0432\u0438\u043d\u043e, \u0438\u0433\u0440\u0438\u0441\u0442\u043e\u0435 \u0432\u0438\u043d\u043e (\u0448\u0430\u043c\u043f\u0430\u043d\u0441\u043a\u043e\u0435), \u0432\u0438\u043d\u043d\u044b\u0435 \u043d\u0430\u043f\u0438\u0442\u043a\u0438, \u0441\u0438\u0434\u0440, \u043f\u0443\u0430\u0440\u0435, \u043c\u0435\u0434\u043e\u0432\u0443\u0445\u0430, \u043f\u0438\u0432\u043e, \u043d\u0430\u043f\u0438\u0442\u043a\u0438, \u0438\u0437\u0433\u043e\u0442\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u043c\u044b\u0435 \u043d\u0430 \u043e\u0441\u043d\u043e\u0432\u0435 \u043f\u0438\u0432\u0430, \u0438\u043d\u044b\u0435 \u043d\u0430\u043f\u0438\u0442\u043a\u0438 \u0441 \u043e\u0431\u044a\u0435\u043c\u043d\u043e\u0439 \u0434\u043e\u043b\u0435\u0439 \u044d\u0442\u0438\u043b\u043e\u0432\u043e\u0433\u043e \u0441\u043f\u0438\u0440\u0442\u0430 \u0431\u043e\u043b\u0435\u0435 0,5 \u043f\u0440\u043e\u0446\u0435\u043d\u0442\u0430; </li><li>\u0442\u0430\u0431\u0430\u0447\u043d\u0430\u044f \u043f\u0440\u043e\u0434\u0443\u043a\u0446\u0438\u044f;</li><li>\u0430\u0432\u0442\u043e\u043c\u043e\u0431\u0438\u043b\u0438 \u043b\u0435\u0433\u043a\u043e\u0432\u044b\u0435; </li><li>\u0430\u0432\u0442\u043e\u043c\u043e\u0431\u0438\u043b\u044c\u043d\u044b\u0439 \u0431\u0435\u043d\u0437\u0438\u043d; </li><li>\u0434\u0438\u0437\u0435\u043b\u044c\u043d\u043e\u0435 \u0442\u043e\u043f\u043b\u0438\u0432\u043e; </li><li>\u043c\u043e\u0442\u043e\u0440\u043d\u044b\u0435 \u043c\u0430\u0441\u043b\u0430 \u0434\u043b\u044f \u0434\u0438\u0437\u0435\u043b\u044c\u043d\u044b\u0445 \u0438 (\u0438\u043b\u0438) \u043a\u0430\u0440\u0431\u044e\u0440\u0430\u0442\u043e\u0440\u043d\u044b\u0445 (\u0438\u043d\u0436\u0435\u043a\u0442\u043e\u0440\u043d\u044b\u0445) \u0434\u0432\u0438\u0433\u0430\u0442\u0435\u043b\u0435\u0439; </li><li>\u043f\u0440\u044f\u043c\u043e\u0433\u043e\u043d\u043d\u044b\u0439 \u0431\u0435\u043d\u0437\u0438\u043d; </li><li>\u0442\u043e\u043f\u043b\u0438\u0432\u043e \u043f\u0435\u0447\u043d\u043e\u0435 \u0431\u044b\u0442\u043e\u0432\u043e\u0435, \u0432\u044b\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0435\u043c\u043e\u0435 \u0438\u0437 \u0434\u0438\u0437\u0435\u043b\u044c\u043d\u044b\u0445 \u0444\u0440\u0430\u043a\u0446\u0438\u0439 \u043f\u0440\u044f\u043c\u043e\u0439 \u043f\u0435\u0440\u0435\u0433\u043e\u043d\u043a\u0438 \u0438 (\u0438\u043b\u0438) \u0432\u0442\u043e\u0440\u0438\u0447\u043d\u043e\u0433\u043e \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0436\u0434\u0435\u043d\u0438\u044f, \u043a\u0438\u043f\u044f\u0449\u0438\u0445 \u0432 \u0438\u043d\u0442\u0435\u0440\u0432\u0430\u043b\u0435 \u0442\u0435\u043c\u043f\u0435\u0440\u0430\u0442\u0443\u0440 \u043e\u0442 280 \u0434\u043e 360 \u0433\u0440\u0430\u0434\u0443\u0441\u043e\u0432 \u0426\u0435\u043b\u044c\u0441\u0438\u044f; </li><li>\u0431\u0435\u043d\u0437\u043e\u043b, \u043f\u0430\u0440\u0430\u043a\u0441\u0438\u043b\u043e\u043b, \u043e\u0440\u0442\u043e\u043a\u0441\u0438\u043b\u043e\u043b; </li><li>\u0430\u0432\u0438\u0430\u0446\u0438\u043e\u043d\u043d\u044b\u0439 \u043a\u0435\u0440\u043e\u0441\u0438\u043d; </li><li>\u043f\u0440\u0438\u0440\u043e\u0434\u043d\u044b\u0439 \u0433\u0430\u0437 (\u0432 \u0441\u043b\u0443\u0447\u0430\u044f\u0445, \u043f\u0440\u0435\u0434\u0443\u0441\u043c\u043e\u0442\u0440\u0435\u043d\u043d\u044b\u0445 \u043c\u0435\u0436\u0434\u0443\u043d\u0430\u0440\u043e\u0434\u043d\u044b\u043c\u0438 \u0434\u043e\u0433\u043e\u0432\u043e\u0440\u0430\u043c\u0438 \u0420\u043e\u0441\u0441\u0438\u0439\u0441\u043a\u043e\u0439 \u0424\u0435\u0434\u0435\u0440\u0430\u0446\u0438\u0438).</li></ul></div>',hidden:true}]},{componentCls:"blue-back",items:[{cls:"item-question",html:reference.lang.calculator.notary},{xtype:"radiogroup",cls:"item-action",fieldLabel:"",labelSeparator:"",allowBlank:false,items:[{boxLabel:reference.lang.buttons.yes,name:"notary",inputValue:"1"},{boxLabel:reference.lang.buttons.no,name:"notary",inputValue:"2",checked:true}]}]},{items:[{cls:"item-question",html:reference.lang.calculator.eshn},{xtype:"radiogroup",cls:"item-action",fieldLabel:"",labelSeparator:"",allowBlank:false,items:[{boxLabel:reference.lang.buttons.yes,name:"eshn",inputValue:"1"},{boxLabel:reference.lang.buttons.no,name:"eshn",inputValue:"2",checked:true}]}]},{componentCls:"blue-back",items:[{cls:"item-question",html:reference.lang.calculator.residual},{xtype:"radiogroup",cls:"item-action",fieldLabel:"",labelSeparator:"",allowBlank:false,items:[{boxLabel:reference.lang.buttons.yes,name:"residual",inputValue:"1"},{boxLabel:reference.lang.buttons.no,name:"residual",inputValue:"2",checked:true}]}]},{items:[{xtype:"container",cls:"item-question",defaults:{margin:"10 0 0 0"},items:[{xtype:"numberfield",hideTrigger:true,labelWidth:300,allowBlank:false,afterLabelTextTpl:this.required,width:450,vtype:"moreThanZero",name:"income",fieldLabel:reference.lang.calculator.income,selectOnFocus:true,minValue:0,value:0,listeners:{focus:function(a){a.setValue()}}},{xtype:"component",html:reference.lang.calculator.consumption},{xtype:"container",margin:0,defaults:{margin:"10px 0 0 15px",xtype:"numberfield",hideTrigger:true,labelWidth:285,allowBlank:false,afterLabelTextTpl:this.required,selectOnFocus:true,width:435,listeners:{focus:function(a){a.setValue()},blur:function(b){var a=b.getValue();if(Ext.isEmpty(a)){b.setValue(0)}}}},items:[{name:"laborCosts",fieldLabel:reference.lang.calculator.laborCosts,allowBlank:true,value:0,afterLabelTextTpl:""},{name:"otherCosts",fieldLabel:reference.lang.calculator.otherCosts,value:0}]},{xtype:"numberfield",hideTrigger:true,allowDecimals:false,labelWidth:300,allowBlank:false,afterLabelTextTpl:this.required,width:450,name:"numberEmployees",fieldLabel:reference.lang.calculator.numberEmployees,selectOnFocus:true,value:0,listeners:{focus:function(a){a.setValue()}}}]}]},{layout:"hbox",margin:"5 10 15 0",cls:"",items:[{xtype:"component",html:reference.lang.calculator.period,margin:"5 10 0 0"},{xtype:"filterDate",name:"insuranceDate_from",componentCls:"input-field fl-l",fieldLabel:"\u0441",labelWidth:10,hideEmptyLabel:false,margin:"0 0 0 15",hidden:false,value:"01/01/2018",disabled:true},{xtype:"filterDate",name:"insuranceDate_to",componentCls:"input-field fl-l",fieldLabel:"\u043f\u043e",labelWidth:15,hideEmptyLabel:false,margin:"0 0 0 15",hidden:false,width:135,value:"31/12/2018",disabled:true}]},{padding:"0",items:[{xtype:"button",formBind:true,itemId:"chooseTaxSystems",text:reference.lang.buttons.chooseAndCalculate}]}]},{xtype:"container",itemId:"calculation-step2",hidden:true,items:[{xtype:"component",html:"2",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.calculator.instruction.step2}]},{xtype:"component",margin:"10 0",cls:"gray",style:{fontSize:"0.9em"},html:reference.lang.calculator.insuranceHelp},{xtype:"container",layout:{type:"auto"},defaults:{xtype:"container",cls:"tax-system-item fl-l"},items:[{itemId:"osn-tab",id:"osn-tab",width:"22%",style:{width:"22%!important"},items:[{xtype:"component",cls:"tax-system-header",html:reference.lang.calculator.tax.osn},{xtype:"container",cls:"tax-system-body",items:[{xtype:"component",itemId:"ndsCount",tpl:'<span class="fl-l" style="padding: 5px 0 0;">'+reference.lang.calculator.nds+'</span><span class="ndsCount fl-r counted-summ">{ndsCount}</span>',data:{ndsCount:"-"}},{cls:"clear"},{xtype:"component",margin:"5 0 0",itemId:"ndflCount",tpl:'<span class="fl-l" style="padding: 5px 0 0;">'+reference.lang.calculator.ndfl+'</span><span class="ndflCount fl-r counted-summ">{ndflCount}</span>',data:{ndflCount:"-"}}]}]},{itemId:"usnIncome-tab",id:"usnIncome-tab",style:{width:"17%!important"},items:[{xtype:"component",cls:"tax-system-header",html:reference.lang.calculator.tax.usnIncome},{xtype:"container",cls:"tax-system-body",items:[{xtype:"component",itemId:"usnIncome",tpl:"{usnIncomeCount}",cls:"counted-summ",data:{usnIncomeCount:"-"}},{xtype:"button",text:reference.lang.calculator.changeRate,itemId:"usnIncome-button",margin:"17 0 0 0",style:{width:"145px !important"}},{xtype:"component",itemId:"usnIncome-unavailable",hidden:true,html:reference.lang.calculator.unavailable}]}]},{itemId:"usnIncomeMinusCosts-tab",id:"usnIncomeMinusCosts-tab",items:[{xtype:"component",cls:"tax-system-header",html:reference.lang.calculator.tax.usnIncomeMinusCosts},{xtype:"container",cls:"tax-system-body",items:[{xtype:"component",itemId:"usnIncomeMinusCosts",tpl:"{usnIncomeMinusCosts}",cls:"counted-summ",data:{usnIncomeMinusCosts:"-"}},{xtype:"button",text:reference.lang.calculator.changeRate,itemId:"usnIncomeMinusCosts-button",margin:"17 0 0 0"},{xtype:"component",itemId:"usnIncomeMinusCosts-unavailable",hidden:true,html:reference.lang.calculator.unavailable}]}]},{itemId:"envd-tab",id:"envd-tab",items:[{xtype:"component",cls:"tax-system-header",html:reference.lang.calculator.tax.envd},{xtype:"container",cls:"tax-system-body",items:[{xtype:"component",tpl:"{nalEnvd}",itemId:"envd",cls:"counted-summ",hidden:true,data:{nalEnvd:"-"}},{xtype:"button",text:reference.lang.calculator.count,itemId:"envd-button"},{xtype:"button",text:reference.lang.calculator.change,itemId:"envd-change-button",margin:"17 0 0 0"},{xtype:"component",itemId:"envd-unavailable",hidden:true,html:reference.lang.calculator.unavailable}]}]},{itemId:"psn-tab",id:"psn-tab",items:[{xtype:"component",cls:"tax-system-header",html:reference.lang.calculator.tax.psn},{xtype:"container",cls:"tax-system-body",items:[{xtype:"component",tpl:"{psn}",itemId:"psn",cls:"counted-summ",hidden:true,data:{psn:"-"}},{xtype:"component",tpl:"\u041f\u0435\u0440\u0438\u043e\u0434: {psnPeriod} \u043c\u0435\u0441\u044f\u0446\u0435\u0432",itemId:"psn-period",hidden:true,data:{psn:"-"}},{xtype:"button",text:reference.lang.calculator.count,itemId:"psn-button"},{xtype:"button",text:reference.lang.calculator.change,itemId:"psn-change-button"},{xtype:"component",itemId:"psn-unavailable",hidden:true,html:reference.lang.calculator.unavailable}]}]}]},{xtype:"container",cls:"tax-system-info",itemId:"tax-system-tab-info-container",hidden:true,items:[{xtype:"container",itemId:"osn-tab-info",defaults:{xtype:"component",cls:"insurance-summ",margin:"0 20 0 0"},hidden:true,items:[{xtype:"container",layout:"auto",itemId:"rateIncome",items:[{cls:"field-label fl-l",html:reference.lang.calculator.rateIncome},{componentCls:"fl-l",xtype:"numberfield",decimalSeparator:",",hideTrigger:true,allowBlank:false,afterLabelTextTpl:this.required,name:"rateIncome",fieldLabel:"",labelSeparator:"",allowExponential:false,width:85,margin:"0 0 0 10",selectOnFocus:true,value:6,vtype:"rateIncome",listeners:{focus:function(a){a.setValue()}}}]},{xtype:"container",layout:"auto",itemId:"rateIncomeMinusCosts",items:[{cls:"field-label fl-l",html:reference.lang.calculator.rateIncomeMinusCosts},{componentCls:"fl-l",xtype:"numberfield",decimalSeparator:",",hideTrigger:true,allowBlank:false,afterLabelTextTpl:this.required,name:"rateIncomeMinusCosts",fieldLabel:"",labelSeparator:"",allowExponential:false,width:85,margin:"0 0 0 10",selectOnFocus:true,value:15,vtype:"rateIncomeMinusCosts",listeners:{focus:function(a){a.setValue()}}}]},{itemId:"ndsRate",html:'<div class="field-label fl-l">'+reference.lang.calculator.orn.ndsRate+'</div><div class="fl-l field-value-right">18%</div><div class="clear"></div>'},{itemId:"ndflRate",html:'<div class="field-label fl-l">'+reference.lang.calculator.orn.ndflRate+'</div><div class="fl-l field-value-right">13%</div><div class="clear"></div>'},{itemId:"insuranceCount",tpl:'<div class="field-label fl-l">'+reference.lang.calculator.insurance+'</div><div class="fl-l field-value-right">{insuranceCount}</div><div class="clear"></div>',data:{insuranceCount:"-"}},{itemId:"insuranceCountEmp",tpl:'<div class="field-label fl-l">'+reference.lang.calculator.insuranceEmp+'</div><div class="fl-l field-value-right">{insuranceCountEmp}</div><div class="clear"></div>',data:{insuranceCountEmp:"-"}},{componentCls:"formula-style",itemId:"ornNds-formula",tpl:"{formula}"},{componentCls:"formula-style",itemId:"ornNdfl-formula",tpl:"{formula}"},{componentCls:"formula-style",itemId:"usn-formula",tpl:"{formula}"},{componentCls:"formula-style",itemId:"usnMinusCosts-formula",tpl:"{formula}"}]},{xtype:"container",itemId:"envd-tab-info",hidden:true,items:[{xtype:"form",itemId:"envd-count-block",margin:"15 0",cls:"count-envd-block",items:[{xtype:"filterSelect",name:"envdActivity",allowBlank:false,itemId:"envd-count-first-step",displayField:"fullName",tpl:'<tpl for="."><tpl if="code != 0"><li data-qtip="{qtip}" class="x-boundlist-item" role="option">{fullName}</li></tpl><tpl if="code == 0"><li class="x-boundlist-item" role="option">{value}</li></tpl></tpl>',fieldLabel:reference.lang.calculator.envd.activity,afterLabelTextTpl:this.required,store:"Calculator.ActivityStore",hidden:true,width:860,labelWidth:500,maskRe:undefined,anyMatch:true},{xtype:"container",itemId:"envd-count-second-step",hidden:true,items:[{xtype:"component",cls:"bold",html:reference.lang.calculator.envd.faktPokaz},{xtype:"container",layout:"auto",margin:"15 0 10 0",itemId:"faktPokContainer",items:[{itemId:"faktPokName",tpl:"{faktPokName}",cls:"field-label fl-l"},{xtype:"numberfield",allowDecimal:false,decimalSeparator:false,decimalPrecision:0,hideTrigger:true,allowBlank:false,afterLabelTextTpl:this.required,keyNavEnabled:false,name:"faktPokValue",submitValue:true,fieldLabel:"",labelSeparator:"",width:100,componentCls:"fl-l",selectOnFocus:true,value:0,listeners:{focus:function(a){if(false!==a.editable){a.setValue()}}}}]},{xtype:"container",margin:"0 0 10",layout:"auto",items:[{cls:"field-label fl-l",html:reference.lang.calculator.envd.koef2},{componentCls:"fl-l",xtype:"numberfield",decimalSeparator:",",decimalPrecision:3,hideTrigger:true,allowBlank:false,afterLabelTextTpl:this.required,name:"korrKoef2",fieldLabel:"",labelSeparator:"",allowExponential:false,width:100,minValue:0.005,maxValue:1,selectOnFocus:true,value:1,listeners:{focus:function(a){a.setValue()}}}]},{xtype:"component",margin:"0 0 10",itemId:"vmenNal",tpl:'<div class="field-label bold fl-l">'+reference.lang.calculator.envd.vmenNal+'</div><div class="fl-l field-value-right">{vmenNal}</div><div class="clear"></div> ',data:{vmenNal:"-"}},{cls:"clear"},{xtype:"component",itemId:"show-envd-variables",margin:"15 0",html:'<div><span class="page-action-link show-envd-variables">\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435</span></div>'},{xtype:"container",itemId:"show-envd-variables-block",cls:"show-envd-variables-block",defaults:{xtype:"component",cls:"envd-variable"},hidden:true,items:[{itemId:"bazDoh",tpl:'<div class="field-label fl-l">'+reference.lang.calculator.envd.baseDoh+'</div><div class="fl-l field-value-right">{bazDoh}</div><div class="clear"></div>'},{componentCls:"blue-back",html:'<div class="field-label fl-l">'+reference.lang.calculator.envd.month+'</div><div class="fl-l field-value-right">12</div><div class="clear"></div>'},{html:'<div class="field-label fl-l">'+reference.lang.calculator.envd.koef1+'</div><div class="fl-l field-value-right">1,868</div><div class="clear"></div>'},{componentCls:"blue-back",itemId:"insuranceEnvd",tpl:'<div class="field-label fl-l">'+reference.lang.calculator.envd.insurance+'</div><div class="fl-l field-value-right">{insuranceEnvd}</div><div class="clear"></div>',data:{insuranceEnvd:"-"}},{itemId:"insuranceEmplEnvd",tpl:'<div class="field-label fl-l">'+reference.lang.calculator.envd.insuranceEmp+'</div><div class="fl-l field-value-right">{insuranceEmplEnvd}</div><div class="clear"></div>',data:{insuranceEmplEnvd:"-"},listeners:{afterrender:function(a){LkIp.Utils.tooltip(a.getEl(),reference.lang.calculator.ttipInsuranceEnvdEmpl)}}},{componentCls:"blue-back",itemId:"vmenDoh",tpl:'<div class="field-label fl-l">'+reference.lang.calculator.envd.vmenDohNal+'</div><div class="fl-l field-value-right">{vmenDoh}</div><div class="clear"></div>',data:{vmenDoh:"-"}},{html:'<div class="field-label fl-l">'+reference.lang.calculator.envd.taxRate+'</div><div class="fl-l field-value-right">15</div><div class="clear"></div>'},{componentCls:"blue-back formula-style",itemId:"envd-formula",tpl:"{formula}"}]}]}]}]},{xtype:"container",itemId:"psn-tab-info",hidden:true,items:[{xtype:"form",itemId:"psn-form",margin:"15 0",items:[{xtype:"simpleSelect",width:860,labelWidth:750,afterLabelTextTpl:this.required,name:"monthes",allowBlank:false,queryMode:"local",editable:false,fieldLabel:reference.lang.calculator.psn.monthes,store:[["1","01"],["2","02"],["3","03"],["4","04"],["5","05"],["6","06"],["7","07"],["8","08"],["9","09"],["10","10"],["11","11"],["12","12"]],value:"12"},{xtype:"filterSelect",width:860,labelWidth:500,afterLabelTextTpl:this.required,name:"regionCode",allowBlank:false,itemId:"psn-count-first-step",displayField:"value",tpl:'<tpl for="."><li class="x-boundlist-item" role="option">{value}</li></tpl>',fieldLabel:reference.lang.calculator.psn.region,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Calculator.MOFilter",autoDestroy:true,storeId:"patentRegionsStore"},valueNotFoundText:reference.lang.calculator.noData},{xtype:"filterSelect",width:860,labelWidth:500,afterLabelTextTpl:this.required,name:"regionCodeMO",allowBlank:false,itemId:"psn-count-second-step",displayField:"value",valueField:"type",tpl:'<tpl for="."><li class="x-boundlist-item" role="option">{value}</li></tpl>',fieldLabel:reference.lang.calculator.psn.mo,hidden:true,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Calculator.SelectFilters",autoDestroy:true,storeId:"patentMOStore"},valueNotFoundText:reference.lang.calculator.noData},{xtype:"filterSelect",width:860,labelWidth:500,afterLabelTextTpl:this.required,name:"activity",allowBlank:false,itemId:"psn-count-third-step",displayField:"value",tpl:'<tpl for="."><li class="x-boundlist-item" role="option">{value}</li></tpl>',fieldLabel:reference.lang.calculator.psn.activity,hidden:true,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"activityStore"},valueNotFoundText:reference.lang.calculator.noData,maskRe:undefined,anyMatch:true},{xtype:"numberfield",hideTrigger:true,labelWidth:750,allowBlank:false,afterLabelTextTpl:this.required,itemId:"psn-count-forth-step",name:"value",hidden:true,width:860,fieldLabel:reference.lang.calculator.psn.objects,allowDecimal:false,maskRe:/[0-9]/,selectOnFocus:true,vtype:"checkEmployees",listeners:{show:function(a){a.focus()},focus:function(a){a.setValue()}}},{xtype:"displayfield",labelWidth:750,itemId:"psn-count-result",hidden:true,width:860,labelClsExtra:"bold",fieldLabel:reference.lang.calculator.psn.summ,fieldBodyCls:"counted-summ",fieldStyle:"text-align:right;padding-right: 5px;"},{xtype:"component",itemId:"psn-count-text",margin:"0 0 15 0",hidden:true},{xtype:"container",hidden:true,itemId:"psn-pay-info",margin:"0 0 15 0",defaults:{xtype:"component"},items:[{html:reference.lang.calculator.psn.payInfo},{margin:"10 0 0",componentCls:"blue-back",itemId:"insurancePsn",tpl:'<div class="field-label fl-l">'+reference.lang.calculator.psn.insurance+'</div><div class="fl-l field-value-right">{insurancePsn}</div><div class="clear"></div>',data:{insurancePsn:"-"}},{itemId:"insuranceEmplPsn",tpl:'<div class="field-label fl-l">'+reference.lang.calculator.psn.insuranceEmp+'</div><div class="fl-l field-value-right">{insuranceEmplPsn}</div><div class="clear"></div>',data:{insuranceEmplPsn:"-"},listeners:{afterrender:function(a){LkIp.Utils.tooltip(a.getEl(),reference.lang.calculator.ttipInsuranceEnvdEmpl)}}}]},{xtype:"button",itemId:"psn-count-step",text:reference.lang.buttons.count,formBind:true}]}]}]},{xtype:"container",margin:"20 0 0",hidden:Ext.isEmpty(LkIp.User.get("inn")),html:Ext.String.format(reference.lang.calculator.stepTwoNoticeWithLink,(!Ext.isEmpty(LkIp.User.get("head"))?LkIp.User.get("head").SvedUchet["@KodNalOrg"].substring(0,2):LkIp.User.get("inn").substring(0,2)))},{xtype:"container",margin:"20 0 0",hidden:!Ext.isEmpty(LkIp.User.get("inn")),html:reference.lang.calculator.stepTwoNotice}]}]}]});this.callParent()}},0,["calculator"],["component","container","box","calculator"],{component:true,container:true,box:true,calculator:true},["widget.calculator"],0,[LkIp.view.Calculator,"Index"],0));Ext.apply(Ext.form.field.VTypes,{nds:function(c,b){var a=parseFloat(b.up("form").down('[name="otherCosts"]').getValue());return parseFloat(c)<=Ext.Number.correctFloat(a*0.18)},ndsText:reference.lang.calculator.ndsCountError});Ext.apply(Ext.form.field.VTypes,{moreThanZero:function(b,a){return parseFloat(b)>0},moreThanZeroText:reference.lang.calculator.moreThanZeroError});Ext.apply(Ext.form.field.VTypes,{rateIncomeMinusCosts:function(b,a){return(parseFloat(b)>=0)&&(parseFloat(b)<=15)},rateIncomeMinusCostsText:reference.lang.calculator.rateIncomeMinusCostsError});Ext.apply(Ext.form.field.VTypes,{rateIncome:function(b,a){return(parseFloat(b)>=0)&&(parseFloat(b)<=6)},rateIncomeText:reference.lang.calculator.rateIncomeError});Ext.apply(Ext.form.field.VTypes,{checkEmployees:function(b,a){if(a.fieldLabel.search("\u0421\u0440\u0435\u0434\u043d\u044f\u044f \u0447\u0438\u0441\u043b\u0435\u043d\u043d\u043e\u0441\u0442\u044c \u043d\u0430\u0435\u043c\u043d\u044b\u0445 \u0440\u0430\u0431\u043e\u0442\u043d\u0438\u043a\u043e\u0432")!==-1){if(b>=16){a.up("form").down("#psn-count-text").show().update('<span class="bold">'+reference.lang.calculator.objectValueNotice+"</span>");return false}else{a.up("form").down("#psn-count-text").hide().update("");return true}}return true},checkEmployeesText:reference.lang.calculator.objectValueError});(Ext.cmd.derive("LkIp.view.UpdateInformationBlock",Ext.window.Window,{autoHeight:true,layout:"auto",modal:true,ui:"nalogThemeWindow",title:reference.lang.msg.info,width:550,height:250,componentCls:"user-information-window-block",initComponent:function(){var a=this;Ext.apply(a,{padding:5,items:[{xtype:"component",margin:"0 0 20 0",html:reference.lang.updateUserInfoText},{xtype:"checkboxfield",boxLabel:"\u0411\u043e\u043b\u044c\u0448\u0435 \u043d\u0435 \u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c",name:"close-forever",inputValue:"1"}]});a.callParent(arguments)}},0,["updateInformationBlock"],["panel","window","component","container","updateInformationBlock","box"],{panel:true,window:true,component:true,container:true,updateInformationBlock:true,box:true},["widget.updateInformationBlock"],0,[LkIp.view,"UpdateInformationBlock"],0));(Ext.cmd.derive("LkIp.view.EducationVideo",Ext.window.Window,{autoHeight:true,layout:"auto",modal:true,ui:"nalogThemeWindow",title:reference.lang.educationVideo.title,width:550,initComponent:function(){var a=this;Ext.apply(a,{items:[{xtype:"component",style:{textAlign:"center",margin:"0 auto"},html:a.renderVideo()},{xtype:"checkboxfield",boxLabel:"\u0411\u043e\u043b\u044c\u0448\u0435 \u043d\u0435 \u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c",name:"close-video-forever",inputValue:"1"}]});a.callParent(arguments)},renderVideo:function(){var a;a='<video id="my-video" class="video-js" controls preload="auto" poster="/images/video-t.png" data-setup="{}" style="width: 100%; height: 300px;"><source src="/media/video/2017.mp4" type="video/mp4"><p class="vjs-no-js">\u0414\u043b\u044f \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0430 \u0432\u0438\u0434\u0435\u043e \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0431\u0440\u0430\u0443\u0437\u0435\u0440, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442 HTML5 video</p></video>';return a}},0,["educationVideo"],["panel","window","component","container","educationVideo","box"],{panel:true,window:true,component:true,container:true,educationVideo:true,box:true},["widget.educationVideo"],0,[LkIp.view,"EducationVideo"],0));(Ext.cmd.derive("LkIp.view.TaxSystems.Eshn.Notification.Index",Ext.Container,{cls:"eshnNotification",required:'<span class="form-required-field" data-qtip="'+reference.lang.form.required+'">*</span>',initComponent:function(){Ext.apply(this,{items:[{xtype:"form",itemId:"eshnNotificationForm",items:[{xtype:"component",tpl:"<p>"+reference.lang.taxSystem.notificationText+"</p>",data:{name:reference.lang.taxSystem.eshn.name}},{xtype:"container",layout:{type:"auto"},margin:"20 0 0 0",items:[{xtype:"component",html:LkIp.Utils.header(reference.lang.pages.instruction,3),cls:"fl-l"},{xtype:"component",cls:"fl-r",html:reference.lang.taxSystem.today+LkIp.Utils.getNowDate()}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"1",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.taxSystem.step1Notification},{xtype:"container",cls:"field-container",defaults:{width:665,labelWidth:400,padding:"10 0 0"},items:[{xtype:"displayfield",name:"fullName",submitValue:true,fieldLabel:reference.lang.taxSystem.fio,value:LkIp.User.get("fullName")},{xtype:"displayfield",name:"inn",submitValue:true,fieldLabel:reference.lang.taxSystem.inn,value:LkIp.User.get("inn")},{xtype:"textfield",name:"phone",itemId:"phone",fieldLabel:reference.lang.taxSystem.phone,value:LkIp.User.get("phone")},{xtype:"filterSelect",name:"no",itemId:"no",allowBlank:false,displayField:"fullName",tpl:'<tpl for="."><tpl if="code != 0"><li data-qtip="{qtip}" class="x-boundlist-item" role="option">{fullName}</li></tpl><tpl if="code == 0"><li class="x-boundlist-item" role="option">{value}</li></tpl></tpl>',fieldLabel:reference.lang.taxSystem.codeNo,afterLabelTextTpl:this.required,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"eshnNotificationNoStore"}},{xtype:"filterSelect",tpl:'<tpl for="."><tpl if="code != 0"><li data-qtip="{qtip}" class="x-boundlist-item" role="option">{shortName}</li></tpl><tpl if="code == 0"><li class="x-boundlist-item" role="option">{value}</li></tpl></tpl>',itemId:"userIndicator",name:"userIndicator",allowBlank:false,fieldLabel:reference.lang.taxSystem.eshn.userIndicator,afterLabelTextTpl:this.required,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"userIndicatorStore"}},{xtype:"displayfield",itemId:"visibleDate",fieldLabel:reference.lang.taxSystem.eshn.date},{xtype:"filterDate",name:"date",hidden:false,allowBlank:false,fieldLabel:reference.lang.taxSystem.eshn.date,vtype:"date30",afterLabelTextTpl:this.required}]},{xtype:"note",itemId:"dateChangeText",hidden:true,text:reference.lang.taxSystem.eshn.dateChangeHelp},{xtype:"component",itemId:"dateText",cls:"gray",hidden:true,html:reference.lang.taxSystem.eshn.dateDescription},{xtype:"note",itemId:"eshnHelpBlock",hidden:true,text:reference.lang.taxSystem.eshn.help},{xtype:"container",itemId:"eshnIncome",hidden:true,items:[{xtype:"component",html:reference.lang.taxSystem.eshn.incomePart},{xtype:"container",layout:"hbox",items:[{xtype:"numberfield",hideTrigger:true,minValue:0,maxValue:100,name:"incomeValue",itemId:"incomeValue",disabled:true,fieldLabel:reference.lang.taxSystem.eshn.incomeLabel,allowBlank:false,afterLabelTextTpl:this.required,width:250,margin:"12 15 0 0"},{xtype:"filterSelect",tpl:'<tpl for="."><tpl if="code != 0"><li data-qtip="{qtip}" class="x-boundlist-item" role="option">{shortName}</li></tpl><tpl if="code == 0"><li class="x-boundlist-item" role="option">{value}</li></tpl></tpl>',itemId:"incomePeriod",name:"incomePeriod",allowBlank:false,disabled:true,fieldLabel:reference.lang.taxSystem.eshn.incomePart2,afterLabelTextTpl:this.required,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"incomePeriodStore"},width:400}]}]}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"2",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.taxSystem.step2},{xtype:"component",html:"<p>"+reference.lang.taxSystem.step2Description+"</p>"}]},{xtype:"container",layout:"hbox",defaults:{xtype:"button",formBind:true},items:[{name:"eshnShowButton",text:reference.lang.buttons.pdf},{margin:"0 0 0 15",rel:"submit",formBind:true,disabled:true,name:"eshnSignButton",text:reference.lang.buttons.signSend}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"3",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.pages.steps.step3Default},{xtype:"component",html:"<p>"+reference.lang.taxSystem.step3NotificationDescription+"</p>"}]}]}]}]});this.callParent(arguments)}},0,["eshnNotification"],["component","container","eshnNotification","box"],{component:true,container:true,eshnNotification:true,box:true},["widget.eshnNotification"],0,[LkIp.view.TaxSystems.Eshn.Notification,"Index"],0));Ext.apply(Ext.form.field.VTypes,{date30:function(e,d){var c=LkIp.Utils.getDateObject(e),b=Ext.Date.add(c,Ext.Date.DAY,30),a=new Date();return b>a},date30Text:reference.lang.taxSystem.eshn.dateError});(Ext.cmd.derive("LkIp.view.TaxSystems.Eshn.Statement.Index",Ext.Container,{cls:"eshnStatement",required:'<span class="form-required-field" data-qtip="'+reference.lang.form.required+'">*</span>',initComponent:function(){Ext.apply(this,{items:[{xtype:"form",itemId:"eshnStatementForm",items:[{xtype:"component",tpl:"<p>"+reference.lang.taxSystem.notificationText+"</p>",data:{name:reference.lang.taxSystem.eshn.statement.name}},{xtype:"container",layout:{type:"auto"},margin:"20 0 0 0",items:[{xtype:"component",html:LkIp.Utils.header(reference.lang.pages.instruction,3),cls:"fl-l"},{xtype:"component",cls:"fl-r",html:reference.lang.taxSystem.today+LkIp.Utils.getNowDate()}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"1",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.taxSystem.step1Message},{xtype:"container",cls:"field-container",defaults:{width:665,labelWidth:400,padding:"10 0 0"},items:[{xtype:"displayfield",name:"fullName",submitValue:true,fieldLabel:reference.lang.taxSystem.fio,value:LkIp.User.get("fullName")},{xtype:"displayfield",name:"inn",submitValue:true,fieldLabel:reference.lang.taxSystem.inn,value:LkIp.User.get("inn")},{xtype:"textfield",fieldLabel:reference.lang.taxSystem.phone,name:"phone",value:!Ext.isEmpty(LkIp.User.get("phone"))?LkIp.User.get("phone"):""},{xtype:"filterSelect",name:"no",itemId:"no",allowBlank:false,displayField:"fullName",tpl:'<tpl for="."><tpl if="code != 0"><li data-qtip="{qtip}" class="x-boundlist-item" role="option">{fullName}</li></tpl><tpl if="code == 0"><li class="x-boundlist-item" role="option">{value}</li></tpl></tpl>',fieldLabel:reference.lang.taxSystem.codeNo,afterLabelTextTpl:this.required,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"eshnStatementNoStore"}},{xtype:"filterDate",hidden:false,name:"date",allowBlank:false,afterLabelTextTpl:this.required,width:550,fieldLabel:reference.lang.taxSystem.eshn.statement.date,maxValue:undefined,minValue:"01.01.2013"}]},{xtype:"component",html:reference.lang.taxSystem.eshn.statement.nkrf},{xtype:"container",layout:"hbox",items:[{xtype:"numberfield",hideTrigger:true,minValue:0,maxValue:9,name:"nkrfParagraph",itemId:"nkrfParagraph",fieldLabel:reference.lang.taxSystem.eshn.statement.nkrfParagraph,width:100,labelWidth:40,margin:"12 15 0 0",allowDecimal:false},{xtype:"numberfield",hideTrigger:true,minValue:0,maxValue:9,name:"nkrfSubPoint",itemId:"nkrfSubPoint",fieldLabel:reference.lang.taxSystem.eshn.statement.nkrfSubPoint,width:140,labelWidth:70,margin:"12 15 0 0",allowDecimal:false},{xtype:"filterSelect",displayField:"value",tpl:'<tpl for="."><tpl if="code != 0"><li class="x-boundlist-item" role="option">{value}</li></tpl><tpl if="code == 0"><li class="x-boundlist-item" role="option">{value}</li></tpl></tpl>',itemId:"nkrfPoint",name:"nkrfPoint",allowBlank:false,fieldLabel:reference.lang.taxSystem.eshn.statement.nkrfPoint,afterLabelTextTpl:this.required,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"eshnStatementNkrfPoint"},labelWidth:50,width:120,editable:false,typeAhead:false},{xtype:"component",margin:"15 0 0 15",html:reference.lang.taxSystem.eshn.statement.nkrfContinue}]},{xtype:"component",cls:"gray",style:{fontSize:"11px"},html:reference.lang.taxSystem.eshn.statement.nkrfMoreInfo}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"2",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.taxSystem.step2Message},{xtype:"component",html:"<p>"+reference.lang.taxSystem.step2DescriptionMessage+"</p>"}]},{xtype:"container",layout:"hbox",defaults:{xtype:"button",formBind:true},items:[{name:"eshnShowButton",text:reference.lang.buttons.pdf},{margin:"0 0 0 15",rel:"submit",formBind:true,disabled:true,name:"eshnSignButton",text:reference.lang.buttons.signSend}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"3",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.pages.steps.step3Default},{xtype:"component",html:"<p>"+reference.lang.pages.steps.step3DescriptionMessage+"</p>"}]}]}]}]});this.callParent(arguments)}},0,["eshnStatement"],["eshnStatement","component","container","box"],{eshnStatement:true,component:true,container:true,box:true},["widget.eshnStatement"],0,[LkIp.view.TaxSystems.Eshn.Statement,"Index"],0));(Ext.cmd.derive("LkIp.view.TaxSystems.Eshn.Stop.Index",Ext.Container,{cls:"eshnStop",required:'<span class="form-required-field" data-qtip="'+reference.lang.form.required+'">*</span>',initComponent:function(){Ext.apply(this,{items:[{xtype:"form",itemId:"eshnStopForm",items:[{xtype:"component",tpl:"<p>"+reference.lang.taxSystem.eshn.stop.notificationText+"</p>",data:{name:reference.lang.taxSystem.eshn.stop.name}},{xtype:"container",layout:{type:"auto"},margin:"20 0 0 0",items:[{xtype:"component",html:LkIp.Utils.header(reference.lang.pages.instruction,3),cls:"fl-l"},{xtype:"component",cls:"fl-r",html:reference.lang.taxSystem.today+LkIp.Utils.getNowDate()}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"1",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.taxSystem.step1Notification},{xtype:"container",cls:"field-container",defaults:{width:665,labelWidth:400,padding:"10 0 0"},items:[{xtype:"displayfield",name:"fullName",submitValue:true,fieldLabel:reference.lang.taxSystem.fio,value:LkIp.User.get("fullName")},{xtype:"displayfield",name:"inn",submitValue:true,fieldLabel:reference.lang.taxSystem.inn,value:LkIp.User.get("inn")},{xtype:"textfield",fieldLabel:reference.lang.taxSystem.phone,name:"phone",value:!Ext.isEmpty(LkIp.User.get("phone"))?LkIp.User.get("phone"):""},{xtype:"filterSelect",name:"no",itemId:"no",allowBlank:false,displayField:"fullName",tpl:'<tpl for="."><tpl if="code != 0"><li data-qtip="{qtip}" class="x-boundlist-item" role="option">{fullName}</li></tpl><tpl if="code == 0"><li class="x-boundlist-item" role="option">{value}</li></tpl></tpl>',fieldLabel:reference.lang.taxSystem.codeNo,afterLabelTextTpl:this.required,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"eshnStopNoStore"}},{xtype:"filterDate",hidden:false,name:"date",allowBlank:false,afterLabelTextTpl:this.required,width:550,fieldLabel:reference.lang.taxSystem.eshn.stop.date,maxValue:undefined,minValue:undefined}]}]}]},{xtype:"note",itemId:"dateNotification",text:reference.lang.taxSystem.eshn.stop.dateNotification,hidden:true},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"2",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.taxSystem.step2},{xtype:"component",html:"<p>"+reference.lang.taxSystem.step2Description+"</p>"}]},{xtype:"container",layout:"hbox",defaults:{xtype:"button",formBind:true},items:[{name:"eshnShowButton",text:reference.lang.buttons.pdf},{margin:"0 0 0 15",rel:"submit",formBind:true,disabled:true,name:"eshnSignButton",text:reference.lang.buttons.signSend}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"3",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.pages.steps.step3Default},{xtype:"component",html:"<p>"+reference.lang.pages.steps.step3DescriptionNotification+"</p>"}]}]}]}]});this.callParent(arguments)}},0,["eshnStop"],["eshnStop","component","container","box"],{eshnStop:true,component:true,container:true,box:true},["widget.eshnStop"],0,[LkIp.view.TaxSystems.Eshn.Stop,"Index"],0));(Ext.cmd.derive("LkIp.view.TaxSystems.Eshn.Refuse.Index",Ext.Container,{cls:"eshnRefuse",required:'<span class="form-required-field" data-qtip="'+reference.lang.form.required+'">*</span>',initComponent:function(){Ext.apply(this,{items:[{xtype:"form",itemId:"eshnRefuseForm",items:[{xtype:"component",tpl:"<p>"+reference.lang.taxSystem.eshn.refuse.notificationText+"</p>",data:{name:reference.lang.taxSystem.eshn.refuse.name}},{xtype:"container",layout:{type:"auto"},margin:"20 0 0 0",items:[{xtype:"component",html:LkIp.Utils.header(reference.lang.pages.instruction,3),cls:"fl-l"},{xtype:"component",cls:"fl-r",html:reference.lang.taxSystem.today+LkIp.Utils.getNowDate()}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"1",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.taxSystem.step1Notification},{xtype:"container",cls:"field-container",defaults:{width:665,labelWidth:400,padding:"10 0 0"},items:[{xtype:"displayfield",name:"fullName",submitValue:true,fieldLabel:reference.lang.taxSystem.fio,value:LkIp.User.get("fullName")},{xtype:"displayfield",name:"inn",submitValue:true,fieldLabel:reference.lang.taxSystem.inn,value:LkIp.User.get("inn")},{xtype:"textfield",fieldLabel:reference.lang.taxSystem.phone,name:"phone",value:!Ext.isEmpty(LkIp.User.get("phone"))?LkIp.User.get("phone"):""},{xtype:"filterSelect",name:"no",itemId:"no",allowBlank:false,displayField:"fullName",tpl:'<tpl for="."><tpl if="code != 0"><li data-qtip="{qtip}" class="x-boundlist-item" role="option">{fullName}</li></tpl><tpl if="code == 0"><li class="x-boundlist-item" role="option">{value}</li></tpl></tpl>',fieldLabel:reference.lang.taxSystem.codeNo,afterLabelTextTpl:this.required,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"eshnRefuseNoStore"}}]},{xtype:"component",html:reference.lang.taxSystem.eshn.refuse.text1},{xtype:"container",layout:"hbox",items:[{xtype:"component",margin:"15 15 0 0",html:reference.lang.taxSystem.eshn.refuse.text2},{xtype:"numberfield",hideTrigger:true,maxLength:4,enforceMaxLength:true,name:"year",itemId:"year",fieldLabel:"",width:100,labelWidth:0,margin:"12 0 0 0",allowBlank:false,vtype:"year2012",allowDecimal:false,fieldIsInvalid:false},{xtype:"component",margin:"15 15 0 0",html:reference.lang.taxSystem.eshn.refuse.text3}]}]}]},{xtype:"note",hidden:true,itemId:"dateNotification",text:reference.lang.taxSystem.eshn.refuse.dateInfo},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"2",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.taxSystem.step2},{xtype:"component",html:"<p>"+reference.lang.taxSystem.step2Description+"</p>"}]},{xtype:"container",layout:"hbox",defaults:{xtype:"button",formBind:true},items:[{name:"eshnShowButton",itemId:"eshnShowButton",text:reference.lang.buttons.pdf},{margin:"0 0 0 15",rel:"submit",formBind:true,disabled:true,name:"eshnSignButton",itemId:"eshnSignButton",text:reference.lang.buttons.signSend}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"3",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.pages.steps.step3Default},{xtype:"component",html:"<p>"+reference.lang.pages.steps.step3DescriptionNotification+"</p>"}]}]}]}]});this.callParent(arguments)}},0,["eshnRefuse"],["component","container","box","eshnRefuse"],{component:true,container:true,box:true,eshnRefuse:true},["widget.eshnRefuse"],0,[LkIp.view.TaxSystems.Eshn.Refuse,"Index"],0));Ext.apply(Ext.form.field.VTypes,{year2012:function(b,a){return b>2012},year2012Text:reference.lang.taxSystem.eshn.refuse.year2012});(Ext.cmd.derive("LkIp.view.TaxSystems.Usn.Notification.Index",Ext.Container,{cls:"usnNotification",required:'<span class="form-required-field" data-qtip="'+reference.lang.form.required+'">*</span>',initComponent:function(){Ext.apply(this,{items:[{xtype:"note",itemId:"loginAccessRestriction",hidden:true,text:reference.lang.loginAccess},{xtype:"form",itemId:"usnNotificationForm",items:[{xtype:"component",tpl:"<p>"+reference.lang.taxSystem.notificationText+"</p>",data:{name:reference.lang.taxSystem.usn.name}},{xtype:"container",layout:{type:"auto"},margin:"20 0 0 0",items:[{xtype:"component",html:LkIp.Utils.header(reference.lang.pages.instruction,3),cls:"fl-l"},{xtype:"component",cls:"fl-r",html:reference.lang.taxSystem.today+"<br/>"+LkIp.Utils.getNowDate()}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"1",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.taxSystem.step1Notification},{xtype:"container",cls:"field-container",defaults:{labelWidth:500,padding:"10 0 0"},items:[{xtype:"displayfield",name:"fullName",submitValue:true,fieldLabel:reference.lang.taxSystem.fio,value:LkIp.User.get("fullName")},{xtype:"displayfield",name:"inn",submitValue:true,fieldLabel:reference.lang.taxSystem.inn,value:LkIp.User.get("inn")},{xtype:"textfield",name:"phone",itemId:"phone",width:765,fieldLabel:reference.lang.taxSystem.usn.phone,value:LkIp.User.get("phone")},{xtype:"filterSelect",name:"no",itemId:"no",allowBlank:false,displayField:"fullName",width:765,tpl:'<tpl for="."><tpl if="code != 0"><li data-qtip="{qtip}" class="x-boundlist-item" role="option">{fullName}</li></tpl><tpl if="code == 0"><li class="x-boundlist-item" role="option">{value}</li></tpl></tpl>',fieldLabel:reference.lang.taxSystem.codeNo,afterLabelTextTpl:this.required,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"usnNotificationNoStore"}},{xtype:"radiogroup",name:"statusGroup",itemId:"statusGroup",rel:"tax-status",allowBlank:false,columns:1,items:[{boxLabel:reference.lang.taxSystem.usn.newIp,componentCls:"radioBtn",name:"statusIp",itemId:"statusGroupNew",inputValue:"2",checked:true},{boxLabel:reference.lang.taxSystem.usn.fromEnvd,componentCls:"radioBtn",name:"statusIp",itemId:"statusGroupFromEnvd",inputValue:"3"},{boxLabel:reference.lang.taxSystem.usn.fromOther,componentCls:"radioBtn",name:"statusIp",inputValue:"1"}]},{padding:"10",xtype:"note",hidden:true,itemId:"dateError",text:reference.lang.taxSystem.usn.dateError},{padding:"10",xtype:"note",hidden:true,itemId:"dateChangeText",text:reference.lang.taxSystem.usn.dateChangeText},{cls:"clear"},{xtype:"filterDate",name:"endEnvdDate",itemId:"endEnvdDate",fieldLabel:reference.lang.taxSystem.usn.endEnvdDate,afterLabelTextTpl:this.required,width:765,setValueAfterShow:false,maxValue:null,editable:false,disabled:true},{xtype:"filterDate",name:"startDate",hidden:false,itemId:"startDate",submitValue:true,width:765,allowBlank:false,vtype:"date30",afterLabelTextTpl:this.required,fieldLabel:reference.lang.taxSystem.usn.startDate},{xtype:"displayfield",name:"startDate",itemId:"startDate2",submitValue:true,hidden:true,disabled:true,labelWidth:505,fieldLabel:reference.lang.taxSystem.usn.startDate,value:LkIp.Utils.getNowDate()},{xtype:"filterSelect",tpl:'<tpl for="."><li class="x-boundlist-item" role="option">{value}</li></tpl>',itemId:"taxObject",name:"taxObject",allowBlank:false,width:765,fieldLabel:reference.lang.taxSystem.usn.taxObject,afterLabelTextTpl:this.required,displayField:"value",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"usnTaxObjectStore"}},{xtype:"component",itemId:"newIpNotice",html:reference.lang.taxSystem.usn.newIpNotice,cls:"gray"},{xtype:"numberfield",name:"income",itemId:"income",hideTrigger:true,minValue:0,width:765,fieldLabel:reference.lang.taxSystem.usn.income,afterLabelTextTpl:this.required,hidden:true,disabled:true},{xtype:"textfield",name:"prNP",itemId:"prNP",hidden:true,value:"2"}]}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"2",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.taxSystem.step2},{xtype:"component",html:"<p>"+reference.lang.taxSystem.step2Description+"</p>"}]},{xtype:"container",layout:"hbox",defaults:{xtype:"button",formBind:true},items:[{name:"usnShowButton",itemId:"usnShowButton",text:reference.lang.buttons.pdf},{margin:"0 0 0 15",rel:"submit",formBind:true,disabled:true,name:"usnSignButton",itemId:"usnSignButton",text:reference.lang.buttons.signSend}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"3",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.taxSystem.step3},{xtype:"component",html:"<p>"+reference.lang.taxSystem.step3NotificationDescription+"</p>"}]}]}]}]});this.callParent(arguments)}},0,["usnNotification"],["component","container","box","usnNotification"],{component:true,container:true,box:true,usnNotification:true},["widget.usnNotification"],0,[LkIp.view.TaxSystems.Usn.Notification,"Index"],0));(Ext.cmd.derive("LkIp.view.TaxSystems.Usn.Statement.Index",Ext.Container,{cls:"usnStatement",required:'<span class="form-required-field" data-qtip="'+reference.lang.form.required+'">*</span>',initComponent:function(){Ext.apply(this,{items:[{xtype:"form",itemId:"usnStatementForm",items:[{xtype:"component",tpl:"<p>"+reference.lang.taxSystem.notificationText+"</p>",data:{name:reference.lang.taxSystem.usn.statement.name}},{xtype:"container",layout:{type:"auto"},margin:"20 0 0 0",items:[{xtype:"component",html:LkIp.Utils.header(reference.lang.pages.instruction,3),cls:"fl-l"},{xtype:"component",cls:"fl-r gray",html:reference.lang.taxSystem.today+"<br/>"+LkIp.Utils.getNowDate()}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"1",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.taxSystem.step1Message},{xtype:"container",cls:"field-container",defaults:{width:765,labelWidth:500,padding:"10 0 0"},items:[{xtype:"displayfield",name:"fullName",submitValue:true,fieldLabel:reference.lang.taxSystem.fio,value:LkIp.User.get("fullName")},{xtype:"displayfield",name:"inn",submitValue:true,fieldLabel:reference.lang.taxSystem.inn,value:LkIp.User.get("inn")},{xtype:"textfield",fieldLabel:reference.lang.taxSystem.phone,name:"phone",value:!Ext.isEmpty(LkIp.User.get("phone"))?LkIp.User.get("phone"):""},{xtype:"filterSelect",name:"no",itemId:"no",allowBlank:false,displayField:"fullName",tpl:'<tpl for="."><tpl if="code != 0"><li data-qtip="{qtip}" class="x-boundlist-item" role="option">{fullName}</li></tpl><tpl if="code == 0"><li class="x-boundlist-item" role="option">{value}</li></tpl></tpl>',fieldLabel:reference.lang.taxSystem.codeNo,afterLabelTextTpl:this.required,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"usnStatementNoStore"}},{xtype:"filterDate",hidden:false,name:"date",width:650,fieldLabel:reference.lang.taxSystem.usn.statement.date,maxValue:undefined,allowBlank:false,afterLabelTextTpl:this.required}]},{xtype:"component",html:reference.lang.taxSystem.usn.statement.nkrfBefore+this.required,margin:"10 0"},{xtype:"checkboxfield",boxLabel:reference.lang.taxSystem.usn.statement.nkrf1,name:"reasonOneBox",itemId:"reasonOneBox",margin:"0 0 0 -5",checked:true},{xtype:"container",itemId:"reasonOne",items:[{xtype:"container",layout:"hbox",margin:"0 0 0 25",defaults:{margin:"0 10 0 0"},items:[{xtype:"numberfield",hideTrigger:true,minValue:0,name:"subPoint",itemId:"subPoint",fieldLabel:reference.lang.taxSystem.usn.statement.nkrf1SubPoint,width:110,labelWidth:70,margin:"2 10 0 0"},{xtype:"filterSelect",displayField:"value",tpl:'<tpl for="."><tpl if="code != 0"><li class="x-boundlist-item" role="option">{value}</li></tpl><tpl if="code == 0"><li class="x-boundlist-item" role="option">{value}</li></tpl></tpl>',name:"point",itemId:"point",fieldLabel:reference.lang.taxSystem.usn.statement.nkrf1Point,width:115,labelWidth:55,editable:false,typeAhead:false,allowBlank:false,afterLabelTextTpl:this.required,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"usnStatementNkrfPoint"}},{xtype:"filterSelect",displayField:"value",tpl:'<tpl for="."><tpl if="code != 0"><li class="x-boundlist-item" role="option">{value}</li></tpl><tpl if="code == 0"><li class="x-boundlist-item" role="option">{value}</li></tpl></tpl>',itemId:"article",name:"article",allowBlank:false,fieldLabel:reference.lang.taxSystem.usn.statement.nkrf1Article,afterLabelTextTpl:this.required,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"usnStatementNkrfArticle"},labelWidth:55,width:155,editable:false,typeAhead:false},{xtype:"component",margin:"7 0 0 0",html:reference.lang.taxSystem.usn.statement.nkrf1Title}]},{xtype:"component",cls:"gray",margin:"5 0 0 25",style:{fontSize:"11px"},html:reference.lang.taxSystem.usn.statement.nkrf1MoreInfo},{xtype:"container",layout:"hbox",margin:"10 0 0 25",defaults:{margin:"0 10 0 0"},items:[{xtype:"filterSelect",displayField:"value",tpl:'<tpl for="."><tpl if="code != 0"><li class="x-boundlist-item" role="option">{value}</li></tpl><tpl if="code == 0"><li class="x-boundlist-item" role="option">{value}</li></tpl></tpl>',name:"periodReasonOne",itemId:"nkrf1Period",fieldLabel:reference.lang.taxSystem.usn.statement.nkrf1During,width:200,labelWidth:75,editable:false,typeAhead:false,allowBlank:false,afterLabelTextTpl:this.required,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"usnStatementNkrfPeriodOne"}},{xtype:"numberfield",hideTrigger:true,minValue:0,name:"yearReasonOne",itemId:"nkrf1Year",fieldLabel:reference.lang.taxSystem.usn.statement.nkrfPeriod,width:280,labelWidth:225,afterLabelTextTpl:this.required,allowBlank:false},{xtype:"component",margin:"7 0 0 0",html:reference.lang.taxSystem.usn.statement.nkrfYear}]}]},{xtype:"checkboxfield",boxLabel:reference.lang.taxSystem.usn.statement.nkrf2,name:"reasonTwoBox",itemId:"reasonTwoBox",margin:"15 0 0 -5"},{xtype:"container",layout:"hbox",margin:"0 0 0 25",itemId:"reasonTwo",defaults:{margin:"0 10 0 0",disabled:true},items:[{xtype:"filterSelect",displayField:"value",tpl:'<tpl for="."><tpl if="code != 0"><li class="x-boundlist-item" role="option">{value}</li></tpl><tpl if="code == 0"><li class="x-boundlist-item" role="option">{value}</li></tpl></tpl>',name:"periodReasonTwo",itemId:"nkrf2Period",fieldLabel:reference.lang.taxSystem.usn.statement.nkrf2Sum,width:415,labelWidth:290,editable:false,typeAhead:false,allowBlank:false,afterLabelTextTpl:this.required,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"usnStatementNkrfPeriodTwo"}},{xtype:"numberfield",hideTrigger:true,minValue:0,name:"yearReasonTwo",itemId:"nkrf2Year",fieldLabel:reference.lang.taxSystem.usn.statement.nkrfPeriod,width:280,labelWidth:225,afterLabelTextTpl:this.required,allowBlank:false},{xtype:"component",margin:"7 0 0 0",html:reference.lang.taxSystem.usn.statement.nkrfYear}]}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"2",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.taxSystem.step2Message},{xtype:"component",html:"<p>"+reference.lang.taxSystem.step2DescriptionMessage+"</p>"}]},{xtype:"container",layout:"hbox",defaults:{xtype:"button",formBind:true},items:[{name:"usnShowButton",itemId:"usnShowButton",text:reference.lang.buttons.pdf},{margin:"0 0 0 15",rel:"submit",formBind:true,disabled:true,name:"usnSignButton",itemId:"usnSignButton",text:reference.lang.buttons.signSend}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"3",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.pages.steps.step3Default},{xtype:"component",html:"<p>"+reference.lang.pages.steps.step3DescriptionMessage+"</p>"}]}]}]}]});this.callParent(arguments)}},0,["usnStatement"],["component","container","box","usnStatement"],{component:true,container:true,box:true,usnStatement:true},["widget.usnStatement"],0,[LkIp.view.TaxSystems.Usn.Statement,"Index"],0));(Ext.cmd.derive("LkIp.view.TaxSystems.Usn.Refuse.Index",Ext.Container,{cls:"usnRefuse",required:'<span class="form-required-field" data-qtip="'+reference.lang.form.required+'">*</span>',initComponent:function(){Ext.apply(this,{items:[{xtype:"form",itemId:"usnRefuseForm",items:[{xtype:"component",tpl:"<p>"+reference.lang.taxSystem.notificationText+"</p>",data:{name:reference.lang.taxSystem.usn.refuse.name}},{xtype:"container",layout:{type:"auto"},margin:"20 0 0 0",items:[{xtype:"component",html:LkIp.Utils.header(reference.lang.pages.instruction,3),cls:"fl-l"},{xtype:"component",cls:"fl-r",html:reference.lang.taxSystem.today+LkIp.Utils.getNowDate()}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"1",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.taxSystem.step1Notification},{xtype:"container",cls:"field-container",defaults:{width:665,labelWidth:400,padding:"10 0 0"},items:[{xtype:"displayfield",name:"fullName",submitValue:true,fieldLabel:reference.lang.taxSystem.fio,value:LkIp.User.get("fullName")},{xtype:"displayfield",name:"inn",submitValue:true,fieldLabel:reference.lang.taxSystem.inn,value:LkIp.User.get("inn")},{xtype:"textfield",fieldLabel:reference.lang.taxSystem.phone,name:"phone",value:!Ext.isEmpty(LkIp.User.get("phone"))?LkIp.User.get("phone"):""},{xtype:"filterSelect",name:"no",itemId:"no",allowBlank:false,displayField:"fullName",tpl:'<tpl for="."><tpl if="code != 0"><li data-qtip="{qtip}" class="x-boundlist-item" role="option">{fullName}</li></tpl><tpl if="code == 0"><li class="x-boundlist-item" role="option">{value}</li></tpl></tpl>',fieldLabel:reference.lang.taxSystem.codeNo,afterLabelTextTpl:this.required,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"usnRefuseNoStore"}}]},{xtype:"container",layout:"hbox",items:[{xtype:"component",margin:"15 15 0 0",html:reference.lang.taxSystem.usn.refuse.text},{xtype:"numberfield",hideTrigger:true,maxLength:4,enforceMaxLength:true,name:"year",itemId:"year",fieldLabel:"",width:100,labelWidth:0,margin:"12 0 0 0",allowBlank:false,vtype:"year2010",allowDecimal:false},{xtype:"component",margin:"15 15 0 15",html:reference.lang.taxSystem.usn.refuse.textYear}]},{xtype:"component",html:reference.lang.taxSystem.usn.refuse.text2}]}]},{xtype:"note",hidden:true,itemId:"dateNotification",text:reference.lang.taxSystem.usn.refuse.dateInfo},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"2",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.taxSystem.step2},{xtype:"component",html:"<p>"+reference.lang.taxSystem.step2Description+"</p>"}]},{xtype:"container",layout:"hbox",defaults:{xtype:"button",formBind:true},items:[{name:"usnShowButton",itemId:"usnShowButton",text:reference.lang.buttons.pdf},{margin:"0 0 0 15",rel:"submit",formBind:true,disabled:true,name:"usnSignButton",itemId:"usnSignButton",text:reference.lang.buttons.signSend}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"3",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.pages.steps.step3Default},{xtype:"component",html:"<p>"+reference.lang.pages.steps.step3DescriptionNotification+"</p>"}]}]}]}]});this.callParent(arguments)}},0,["usnRefuse"],["usnRefuse","component","container","box"],{usnRefuse:true,component:true,container:true,box:true},["widget.usnRefuse"],0,[LkIp.view.TaxSystems.Usn.Refuse,"Index"],0));Ext.apply(Ext.form.field.VTypes,{year2010:function(b,a){return b>=2010},year2010Text:reference.lang.taxSystem.usn.refuse.year2010});(Ext.cmd.derive("LkIp.view.TaxSystems.Usn.Change.Index",Ext.Container,{cls:"usnChange",required:'<span class="form-required-field" data-qtip="'+reference.lang.form.required+'">*</span>',initComponent:function(){Ext.apply(this,{items:[{xtype:"form",itemId:"usnChangeForm",items:[{xtype:"component",tpl:"<p>"+reference.lang.taxSystem.usn.change.notificationText+"</p>",data:{name:reference.lang.taxSystem.usn.change.name}},{xtype:"container",layout:{type:"auto"},margin:"20 0 0 0",items:[{xtype:"component",html:LkIp.Utils.header(reference.lang.pages.instruction,3),cls:"fl-l"},{xtype:"component",cls:"fl-r",html:reference.lang.taxSystem.today+LkIp.Utils.getNowDate()}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"1",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.taxSystem.step1Notification},{xtype:"container",cls:"field-container",defaults:{width:665,labelWidth:400,padding:"10 0 0"},items:[{xtype:"displayfield",name:"fullName",submitValue:true,fieldLabel:reference.lang.taxSystem.fio,value:LkIp.User.get("fullName")},{xtype:"displayfield",name:"inn",submitValue:true,fieldLabel:reference.lang.taxSystem.inn,value:LkIp.User.get("inn")},{xtype:"textfield",fieldLabel:reference.lang.taxSystem.phone,name:"phone",value:!Ext.isEmpty(LkIp.User.get("phone"))?LkIp.User.get("phone"):""},{xtype:"filterSelect",name:"no",itemId:"no",allowBlank:false,displayField:"fullName",tpl:'<tpl for="."><tpl if="code != 0"><li data-qtip="{qtip}" class="x-boundlist-item" role="option">{fullName}</li></tpl><tpl if="code == 0"><li class="x-boundlist-item" role="option">{value}</li></tpl></tpl>',fieldLabel:reference.lang.taxSystem.codeNo,afterLabelTextTpl:this.required,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"usnChangeNoStore"}},{xtype:"component",tpl:reference.lang.taxSystem.usn.change.text,data:{year:parseInt(Ext.Date.format(new Date(),"Y"))+1}},{xtype:"filterSelect",tpl:'<tpl for="."><li class="x-boundlist-item" role="option">{value}</li></tpl>',itemId:"object",name:"object",allowBlank:false,fieldLabel:reference.lang.taxSystem.usn.change.object,afterLabelTextTpl:this.required,displayField:"value",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"usnChangeObjectStore"}}]}]}]},{xtype:"note",hidden:true,itemId:"objectNotification",text:reference.lang.taxSystem.usn.change.objectInfo},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"2",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.taxSystem.step2},{xtype:"component",html:"<p>"+reference.lang.taxSystem.step2Description+"</p>"}]},{xtype:"container",layout:"hbox",defaults:{xtype:"button",formBind:true},items:[{name:"usnShowButton",text:reference.lang.buttons.pdf},{margin:"0 0 0 15",rel:"submit",formBind:true,disabled:true,name:"usnSignButton",text:reference.lang.buttons.signSend}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"3",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.pages.steps.step3Default},{xtype:"component",html:"<p>"+reference.lang.pages.steps.step3DescriptionNotification+"</p>"}]}]}]}]});this.callParent(arguments)}},0,["usnChange"],["component","container","usnChange","box"],{component:true,container:true,usnChange:true,box:true},["widget.usnChange"],0,[LkIp.view.TaxSystems.Usn.Change,"Index"],0));(Ext.cmd.derive("LkIp.view.TaxSystems.Usn.Stop.Index",Ext.Container,{cls:"usnStop",required:'<span class="form-required-field" data-qtip="'+reference.lang.form.required+'">*</span>',initComponent:function(){Ext.apply(this,{items:[{xtype:"form",itemId:"usnStopForm",items:[{xtype:"component",tpl:"<p>"+reference.lang.taxSystem.usn.stop.notificationText+"</p>",data:{name:reference.lang.taxSystem.usn.stop.name}},{xtype:"container",layout:{type:"auto"},margin:"20 0 0 0",items:[{xtype:"component",html:LkIp.Utils.header(reference.lang.pages.instruction,3),cls:"fl-l"},{xtype:"component",cls:"fl-r",html:reference.lang.taxSystem.today+LkIp.Utils.getNowDate()}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"1",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.taxSystem.step1Notification},{xtype:"container",cls:"field-container",defaults:{width:665,labelWidth:400,padding:"10 0 0"},items:[{xtype:"displayfield",name:"fullName",submitValue:true,fieldLabel:reference.lang.taxSystem.fio,value:LkIp.User.get("fullName")},{xtype:"displayfield",name:"inn",submitValue:true,fieldLabel:reference.lang.taxSystem.inn,value:LkIp.User.get("inn")},{xtype:"textfield",fieldLabel:reference.lang.taxSystem.phone,name:"phone",value:!Ext.isEmpty(LkIp.User.get("phone"))?LkIp.User.get("phone"):""},{xtype:"filterSelect",name:"no",itemId:"no",allowBlank:false,displayField:"fullName",tpl:'<tpl for="."><tpl if="code != 0"><li data-qtip="{qtip}" class="x-boundlist-item" role="option">{fullName}</li></tpl><tpl if="code == 0"><li class="x-boundlist-item" role="option">{value}</li></tpl></tpl>',fieldLabel:reference.lang.taxSystem.codeNo,afterLabelTextTpl:this.required,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"usnStopNoStore"}},{xtype:"filterDate",hidden:false,name:"date",allowBlank:false,afterLabelTextTpl:this.required,width:550,fieldLabel:reference.lang.taxSystem.usn.stop.date,maxValue:undefined,minValue:undefined}]}]}]},{xtype:"note",itemId:"dateNotification",text:reference.lang.taxSystem.usn.stop.dateNotification,hidden:true},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"2",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.taxSystem.step2},{xtype:"component",html:"<p>"+reference.lang.taxSystem.step2Description+"</p>"}]},{xtype:"container",layout:"hbox",defaults:{xtype:"button",formBind:true},items:[{name:"usnShowButton",text:reference.lang.buttons.pdf},{margin:"0 0 0 15",rel:"submit",formBind:true,disabled:true,name:"usnSignButton",text:reference.lang.buttons.signSend}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"3",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.pages.steps.step3Default},{xtype:"component",html:"<p>"+reference.lang.pages.steps.step3DescriptionNotification+"</p>"}]}]}]}]});this.callParent(arguments)}},0,["usnStop"],["component","container","usnStop","box"],{component:true,container:true,usnStop:true,box:true},["widget.usnStop"],0,[LkIp.view.TaxSystems.Usn.Stop,"Index"],0));(Ext.cmd.derive("LkIp.model.TaxSystems.Psn.SelectFilters",Ext.data.Model,{fields:["code","value","type","regionCode",{name:"qtip",type:"string",convert:function(b,a){return a.get("value")}},{name:"fullName",type:"string",convert:function(c,a){var b=a.get("code");return(0!==b?b+"-":"")+a.get("value")}},{name:"shortName",type:"string",convert:function(b,a){var c=a.get("value");return a.get("code")+"-"+Ext.String.ellipsis(c,40,true)}},{name:"filterValue",type:"string",convert:function(d,a){var b="",c=a.get("code");if("0"!=c){b=c+"-"}return b+a.get("value")}}],idProperty:"code"},0,0,0,0,0,0,[LkIp.model.TaxSystems.Psn,"SelectFilters"],0));(Ext.cmd.derive("LkIp.view.TaxSystems.Psn.Patent.Index",Ext.Container,{cls:"psnPatent",required:'<span class="form-required-field" data-qtip="'+reference.lang.form.required+'">*</span>',bottomFormLabelWidth:350,bottomFormFieldWidth:640,initComponent:function(){var a=450,c=a+5,b=77;if(!Ext.isEmpty(LkIp.User.get("head"))&&!Ext.isEmpty(LkIp.User.get("head")["SvedUchet"])){b=LkIp.User.get("head")["SvedUchet"]["@KodNalOrg"].substring(0,2)}Ext.apply(this,{items:[{xtype:"form",layout:"anchor",itemId:"psnPatentForm",items:[{xtype:"component",tpl:"<p>"+reference.lang.taxSystem.notificationText+"</p>",data:{name:reference.lang.taxSystem.psn.patent.name}},{xtype:"container",layout:{type:"auto"},margin:"20 0 0 0",items:[{xtype:"component",html:LkIp.Utils.header(reference.lang.pages.instruction,3),cls:"fl-l"},{xtype:"component",cls:"fl-r",html:reference.lang.taxSystem.today+LkIp.Utils.getNowDate()}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"1",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.taxSystem.step1Statement},{xtype:"container",cls:"field-container",items:[{xtype:"fieldset",title:reference.lang.taxSystem.psn.patent.personalData,defaults:{xtype:"displayfield",submitValue:true,anchor:"100%",labelWidth:a,padding:"10 0 0"},items:[{name:"fullName",fieldLabel:reference.lang.taxSystem.fio,value:LkIp.User.get("fullName")},{name:"inn",fieldLabel:reference.lang.taxSystem.inn,value:LkIp.User.get("inn")},{fieldLabel:reference.lang.taxSystem.ogrnip,name:"ogrnIp",value:LkIp.User.get("ogrn")},{xtype:"container",layout:"auto",margin:"10 0 0",defaults:{componentCls:"fl-l",xtype:"component"},items:[{html:"<span>"+reference.lang.taxSystem.address+"</span>"+LkIp.Utils.requiredLabel(),itemId:"addressLabel",width:a},{xtype:"container",width:280,margin:"0 0 0 5",items:[{xtype:"component",html:typeof LkIp.User.get("head")["SvedFL"]=="undefined"?'<span class="red">\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0437\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u0430\u0434\u0440\u0435\u0441</span>':LkIp.User.get("head")["SvedFL"]["Address"],itemId:"userAddressString"},{xtype:"container",hidden:typeof LkIp.User.get("head")["SvedFL"]!="undefined",items:[{xtype:"button",idBlock:"addressDescription",margin:"0",itemId:"editUserAddress",scale:"small",html:reference.lang.buttons.enterAddress}]}]}]},{xtype:"textfield",name:"phone",itemId:"phone",maxLength:20,enforceMaxLength:true,fieldLabel:reference.lang.taxSystem.phone,value:LkIp.User.get("phone"),anchor:"85%"}]},{xtype:"fieldset",title:reference.lang.taxSystem.psn.patent.no,items:[{xtype:"filterSelect",name:"no",itemId:"no",allowBlank:false,displayField:"fullName",tpl:'<tpl for="."><tpl if="code != 0"><li data-qtip="{qtip}" class="x-boundlist-item" role="option">{fullName}</li></tpl><tpl if="code == 0"><li class="x-boundlist-item" role="option">{value}</li></tpl></tpl>',fieldLabel:reference.lang.taxSystem.codeNo,afterLabelTextTpl:this.required,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"psnPatentNoStore"},labelWidth:a,anchor:"85%"}]},{xtype:"fieldset",title:reference.lang.taxSystem.psn.patent.patentPeriod,defaults:{afterLabelTextTpl:this.required,allowBlank:false,anchor:"85%",labelWidth:a},items:[{xtype:"filterDate",name:"dateStart",itemId:"dateStart",fieldLabel:reference.lang.taxSystem.psn.patent.dateStart,hidden:false,anchor:"70%",minValue:Ext.Date.add(new Date(),Ext.Date.DAY,10),maxValue:undefined,value:Ext.Date.add(new Date(),Ext.Date.DAY,10),listeners:{change:function(d){var e=d.up("form").down("#period");if(!Ext.isEmpty(e.getValue())){e.validate()}}}},{xtype:"simpleSelect",queryMode:"local",editable:false,itemId:"period",name:"period",fieldLabel:reference.lang.taxSystem.psn.patent.period,emptyText:reference.lang.taxSystem.psn.patent.periodEmpty,store:this.getPeriods(),anchor:"70%",disableTooltip:true,vtype:"dateStart"}]},{xtype:"fieldset",title:reference.lang.taxSystem.psn.patent.patentData,defaults:{afterLabelTextTpl:this.required,allowBlank:false,anchor:"85%",labelWidth:a},items:[{xtype:"filterSelect",name:"activity",itemId:"activity",allowBlank:false,displayField:"fullName",tpl:'<tpl for="."><li class="x-boundlist-item" role="option">{fullName}</li></tpl>',fieldLabel:reference.lang.taxSystem.psn.patent.activity,emptyText:reference.lang.taxSystem.psn.patent.activityEmpty,afterLabelTextTpl:this.required,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.TaxSystems.Psn.SelectFilters",autoDestroy:true,storeId:"psnPatentActivitiesStore"},maskRe:undefined,anyMatch:true},{xtype:"component",style:{marginTop:"-10px"},itemId:"linkToNalogActivities",tpl:'<a class="link" href="http://www.nalog.ru/rn{regionCode}/about_fts/docs/4034163/" target="_blank">\u041a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440 \u0432\u0438\u0434\u043e\u0432 \u043f\u0440\u0435\u0434\u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u043e\u0439 \u0434\u0435\u044f\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u0438 (\u0434\u043b\u044f \u043e\u0437\u043d\u0430\u043a\u043e\u043c\u043b\u0435\u043d\u0438\u044f)</a>',data:{regionCode:b}},{xtype:"filterSelect",name:"employee",itemId:"employee",allowBlank:false,displayField:"value",emptyText:reference.lang.taxSystem.psn.patent.employeeEmpty,tpl:'<tpl for="."><li data-qtip="{qtip}" class="x-boundlist-item" role="option">{value}</li></tpl>',fieldLabel:reference.lang.taxSystem.psn.patent.employee,afterLabelTextTpl:this.required,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"psnPatentEmployeeStore"}},{xtype:"numberfield",hideTrigger:true,minValue:0,maxValue:99,name:"employeeCount",itemId:"employeeCount",fieldLabel:reference.lang.taxSystem.psn.patent.employeeCount,afterLabelTextTpl:this.required,allowBlank:false,disabled:true,hidden:true,allowDecimals:false},{xtype:"note",hidden:true,itemId:"employeeCountWarning",text:reference.lang.taxSystem.psn.patent.employeeCountWarning},{xtype:"container",layout:"hbox",defaults:{margin:"3 0 0",xtype:"component"},items:[{html:reference.lang.taxSystem.psn.patent.percent,listeners:{afterrender:function(d){LkIp.Utils.tooltip(d.getEl().down(".tax-rate"),reference.lang.taxSystem.psn.patent.taxRateHelp,{mouseOffset:[120,0]})}}},{xtype:"numberfield",hideTrigger:true,minValue:0,maxValue:9,name:"percent",labelWidth:0,width:50,margin:"0 5",value:6,allowDecimals:false},{html:reference.lang.taxSystem.psn.patent.percent2}]},{xtype:"textfield",width:"100%",labelWidth:0,name:"percentReason",value:reference.lang.taxSystem.psn.patent.percentReasonDefault,maxLength:255,enforceMaxLength:true,allowBlank:true,margin:"3 0 0"},{xtype:"component",style:{textAlign:"center"},margin:"0 0 15",html:reference.lang.taxSystem.psn.patent.percentReason},this.drawPage("vehicle"),this.drawPage("placement"),this.drawPage("address")]}]}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"2",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.taxSystem.step2Statement},{xtype:"component",html:"<p>"+reference.lang.taxSystem.step2DescriptionStatement+"</p>"}]},{xtype:"container",layout:"hbox",defaults:{xtype:"button",formBind:true},items:[{name:"psnPatentShowButton",text:reference.lang.buttons.pdf},{margin:"0 0 0 15",rel:"submit",formBind:true,disabled:true,name:"psnPatentSignButton",text:reference.lang.buttons.signSend}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"3",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.pages.steps.step3Default},{xtype:"component",html:"<p>"+reference.lang.pages.steps.step3DescriptionStatement+"</p>"}]}]}]}]});this.callParent(arguments)},drawPage:function(a){return{xtype:"container",hidden:true,itemId:a+"Part",items:[{xtype:"component",html:reference.lang.taxSystem.psn.patent[a]["info"]},{xtype:"container",defaults:{style:{marginTop:"10px"}},items:[{xtype:"container",itemId:a+"Container",items:[]},{xtype:"button",itemId:"add"+a,componentCls:"fl-l",html:reference.lang.taxSystem.psn.patent[a]["add"]}]}]}},getVehicleFields:function(a){var b=this;return{xtype:"container",itemId:"vehicle"+a,defaults:{allowBlank:false,afterLabelTextTpl:b.required,labelWidth:b.bottomFormLabelWidth,anchor:"85%"},items:[{xtype:"filterSelect",width:640,name:this.generateFieldName("vehicle",a,"vehicleCode"),itemId:"vehicleCode"+a,fieldLabel:reference.lang.taxSystem.psn.patent.vehicle.vehicleCode,store:"TaxSystem.Psn.Patent.VehicleCodesStore",listeners:{change:function(e,f){if(0!=f){var c=e.up("#vehicle"+a).down("#vehicleCapacity"+a),d=e.up("#vehicle"+a).down("#vehicleSeats"+a);if(f=="01"||f=="04"){c.enable().show()}else{c.disable().hide()}if(f=="02"||f=="03"){d.enable().show()}else{d.disable().hide()}}}}},{xtype:"textfield",name:this.generateFieldName("vehicle",a,"vehicleId"),itemId:"vehicleId"+a,fieldLabel:'<span class="page-action-link" style="cursor: default;">'+reference.lang.taxSystem.psn.patent.vehicle.vehicleId+"</span>",listeners:{afterrender:function(c){LkIp.Utils.tooltip(c.labelEl,reference.lang.taxSystem.psn.patent.vehicle.vehicleIdHelp)}}},{xtype:"textfield",name:this.generateFieldName("vehicle",a,"vehicleModel"),itemId:"vehicleModel"+a,fieldLabel:'<span class="page-action-link" style="cursor: default;">'+reference.lang.taxSystem.psn.patent.vehicle.vehicleModel+"</span>",listeners:{afterrender:function(c){LkIp.Utils.tooltip(c.labelEl,reference.lang.taxSystem.psn.patent.vehicle.vehicleModelHelp)}}},{xtype:"textfield",name:this.generateFieldName("vehicle",a,"vehicleRegistrationMark"),itemId:"vehicleRegistrationMark"+a,fieldLabel:reference.lang.taxSystem.psn.patent.vehicle.vehicleRegistrationMark},{xtype:"numberfield",hideTrigger:true,name:this.generateFieldName("vehicle",a,"vehicleCapacity"),itemId:"vehicleCapacity"+a,fieldLabel:reference.lang.taxSystem.psn.patent.vehicle.vehicleCapacity},{xtype:"numberfield",hideTrigger:true,name:this.generateFieldName("vehicle",a,"vehicleSeats"),itemId:"vehicleSeats"+a,fieldLabel:reference.lang.taxSystem.psn.patent.vehicle.vehicleSeats},{xtype:"container",width:"100%",margin:"5 0 5",items:[{xtype:"button",itemId:"removeVehicle",idBlock:"vehicle"+a,hidden:a==0,html:reference.lang.buttons.remove}]},{xtype:"component",width:"100%",html:"<hr>"}]}},generateFieldName:function(c,b,a,d){d=d||false;return c+"["+b+"]["+a+"]"+(d?"["+d+"]":"")},getPlacementFields:function(a){var b=this;return{xtype:"container",itemId:"placement"+a,margin:"10 0 0",defaults:{allowBlank:false,afterLabelTextTpl:b.required,labelWidth:b.bottomFormLabelWidth},items:[{xtype:"filterSelect",width:640,name:this.generateFieldName("placement",a,"placementCode"),itemId:"placementCode"+a,rel:"placementCode",fieldLabel:reference.lang.taxSystem.psn.patent.placement.type,store:"TaxSystem.Psn.Patent.PlacementTypeStore",index:a,addressRequired:false,listeners:{change:function(c,e){if(e!=0){var d=c.up("#psnPatentForm");c.addressRequired=!Ext.Array.contains(["16","17","18","19","20","21","22","29"],e+"");c.fireEvent("changeCode",c,c.addressRequired);d.getForm().checkValidity()}}}},{xtype:"filterSelect",width:640,name:this.generateFieldName("placement",a,"placementFeature"),itemId:"placementFeature"+a,rel:"placementFeature",fieldLabel:reference.lang.taxSystem.psn.patent.placement.feature,store:"TaxSystem.Psn.Patent.PlacementFeatureStore"},{xtype:"numberfield",width:640,hideTrigger:true,allowBlank:true,afterLabelTextTpl:"",name:this.generateFieldName("placement",a,"placementSquare"),itemId:"placementSquare"+a,vtype:"moreThanZero",fieldLabel:'<span class="page-action-link" style="cursor: default;">'+reference.lang.taxSystem.psn.patent.placement.square+"</span>",listeners:{afterrender:function(c){LkIp.Utils.tooltip(c.labelEl,reference.lang.taxSystem.psn.patent.squareHelp)}}},{xtype:"container",width:"100%",itemId:"address"+a,defaults:{margin:"10 0 0"},items:[]},{xtype:"container",width:"100%",margin:"5 0 5",items:[{xtype:"button",itemId:"removePlacement",idBlock:"placement"+a,hidden:a==0,html:reference.lang.buttons.remove}]},{xtype:"component",width:"100%",html:"<hr>"}]}},getAddressFields:function(a,d,b,c){b=b||false;return{xtype:"container",width:"100%",itemId:"addressDescription"+a,hideDeleteButton:false,placement:b,margin:"10 0 0",index:a,items:[{xtype:"container",layout:"auto",defaults:{style:{marginTop:"5px",marginRight:"10px"},componentCls:"fl-l",xtype:"component"},items:[{html:reference.lang.taxSystem.psn.patent.addressLabel,hidden:!b,itemId:"addressLabel"+a},{html:d,itemId:"addressString"+a},{xtype:"button",idBlock:"addressDescription"+a,index:a,margin:"0",itemId:"editAddress",placement:b,required:c,scale:"small",html:reference.lang.buttons.editAddress}]},{xtype:"container",layout:"hbox",defaults:{xtype:"button",idBlock:"addressDescription"+a,index:a,margin:"10 0 0"},items:[{itemId:"removeAddress",placement:b,hidden:b&&c,scale:b?"small":"medium",html:reference.lang.buttons.remove}]},{xtype:"component",margin:"5 0",hidden:b,width:"100%",html:"<hr>"}]}},getPeriods:function(){return[["1","01"],["2","02"],["3","03"],["4","04"],["5","05"],["6","06"],["7","07"],["8","08"],["9","09"],["10","10"],["11","11"],["12","12"]]}},0,["psnPatent"],["psnPatent","component","container","box"],{psnPatent:true,component:true,container:true,box:true},["widget.psnPatent"],0,[LkIp.view.TaxSystems.Psn.Patent,"Index"],0));Ext.apply(Ext.form.field.VTypes,{dateStart:function(i,b){var f=b.up("form"),a=f.down("#dateStart"),g=a.getValue();if(Ext.isIE8){if(i.indexOf("0")==0){i=i.substring(1)}}if(!Ext.isEmpty(g)){i=parseInt(i);var j=Ext.Date.format(g,"Y"),e=Ext.Date.add(g,Ext.Date.MONTH,i),d=Ext.Date.format(e,"Y"),c=Ext.Date.format(e,"d.m"),h=c==="01.01";return(j>=d)||h}return true},oktmo:function(a){return a.length==8||a.length==11},oktmoText:reference.lang.taxSystem.psn.patent.oktmo,dateStartText:reference.lang.taxSystem.psn.patent.periodError});(Ext.cmd.derive("LkIp.plugins.ComponentColumn.CTemplate",Ext.XTemplate,{statics:{AUTO_ID:0},copyDepth:10,cTpl:'<p id="ctemplate-{0}-{1}"></p>',isCTemplate:true,constructor:function(){var a=this;a.callParent(arguments);a.id=++a.statics().AUTO_ID;a.reset()},copyValues:function(a,d){var c=this,f,e={},b=d||c.copyDepth;if(b===1){return a}if(Ext.isArray(a)){return Ext.Array.map(a,function(g){return c.copyValues(g,b-1)})}if(!Ext.isObject(a)){return a}if(a.isComponent){f=a.getId();c.ids.push(f);return Ext.String.format(c.cTpl,f,c.id)}Ext.Object.each(a,function(g,h){e[g]=g==="$comp"?h:c.copyValues(h,b-1)});return e},doInsert:function(){var a=this.callParent(arguments);this.injectComponents();return a},doPolling:function(a){var b=this;b.pollInterval=a;if(b.pollId){clearTimeout(b.pollId)}b.pollId=Ext.defer(b.injectComponents,a,b)},getPlaceholderEl:function(a){return Ext.get("ctemplate-"+a+"-"+this.id)},injectComponents:function(){var d=this,b=d.ids,a=b.length-1,f,c,e;for(;a>=0;--a){f=b[a];c=Ext.getCmp(f);e=d.getPlaceholderEl(f);if(d.renderComponent(c,e)||!c){Ext.Array.splice(b,a,1);if(e){e.remove()}}}if(b.length){d.doPolling(d.pollInterval*1.5)}},overwrite:function(b){var d,c,a;if(Ext.isIE){d=Ext.getDom(b);while(c=d.firstChild){d.removeChild(c)}}a=this.callParent(arguments);this.injectComponents();return a},renderComponent:function(b,c){if(b&&c){var a=c.parent();if(b.rendered){b.getEl().replace(c)}else{b.render(a,c)}if(Ext.isIE6){a.repaint()}return true}return false},reset:function(){var a=this;a.ids=[];if(a.pollId){clearTimeout(a.pollId);a.pollId=null}}},1,0,0,0,0,0,[LkIp.plugins.ComponentColumn,"CTemplate"],function(b){var a=function(){var d=this,c=Ext.Array.slice(arguments);c[0]=d.copyValues(c[0]);d.doPolling(10);return d.callParent(c)};if(b.prototype.applyOut){b.override({applyOut:a})}else{b.override({applyTemplate:a});b.createAlias("apply","applyTemplate")}}));(Ext.cmd.derive("LkIp.plugins.ComponentColumn.Column",Ext.grid.column.Column,{autoWidthComponents:true,componentGC:true,hasCustomRenderer:true,lastFrameWidth:12,widthUpdateDelay:[10,400],constructor:function(a){var b=this;b.callParent(arguments);b.compIds=[];b.dataIndex=b.dataIndex||Ext.id(null,"cc-dataIndex-");b.tpl=b.createTemplate(b.tpl);b.renderer=b.createRenderer(b.renderer);b.registerColumnListeners()},addRefOwner:function(c){var b=this,a=b.refOwnerFn||(b.refOwnerFn=function(){return b});if(b.extVersion<40200){c.getBubbleTarget=a}else{c.getRefOwner=a}},applyTemplate:function(b,a){if(Ext.isDefined(a)){b[this.dataIndex]=a}return this.tpl.apply(b)},beforeViewRefresh:function(){if(Ext.isIE){var e=this.compIds,b=0,a=e.length,f,d,c;for(;b<a;b++){if((f=Ext.getCmp(e[b]))&&(d=f.getEl())&&(d=d.dom)&&(c=d.parentNode)){c.removeChild(d)}}}},calculateFrameWidth:function(a){var b=a.getEl(),c=b&&b.parent(),d=c&&c.parent();if(d){return this.lastFrameWidth=c.getFrameWidth("lr")+d.getFrameWidth("lr")}},createRenderer:function(b){var a=this;return function(e,f,c){var d=Ext.apply({},c.data,c.getAssociatedData());if(b){e=b.apply(this,arguments)}e=a.processValue(e);return a.applyTemplate(d,e)}},createTemplate:function(a){return a&&a.isTemplate?a:Ext.create("LkIp.plugins.ComponentColumn.CTemplate",a||["{",this.dataIndex,"}"])},destroyChild:function(a){a.destroy()},getRefItems:function(b){var c=this.callParent([b]),e=this.compIds,d=0,a=e.length,f;for(;d<a;d++){if(f=Ext.getCmp(e[d])){c.push(f);if(b&&f.getRefItems){c.push.apply(c,f.getRefItems(true))}}}return c},onChildAfterRender:function(a){this.resizeChild(a)},onChildBoxReady:function(a){this.resizeChild(a,false)},onChildDestroy:function(a){Ext.Array.remove(this.compIds,a.getId())},onChildResize:function(){this.redoScrollbars()},onColumnResize:function(a){a.resizeAll()},onColumnShow:function(a){a.resizeAll()},onColumnVisibilityChange:function(c){var a=c.getRefItems(),b=0,d=a.length,e=!c.isHidden();Ext.suspendLayouts&&Ext.suspendLayouts();for(;b<d;++b){a[b].setVisible(e)}Ext.resumeLayouts&&Ext.resumeLayouts(true)},onDestroy:function(){Ext.destroy(this.getRefItems());this.callParent()},onRender:function(){this.registerViewListeners();this.callParent(arguments)},onViewChange:function(){var b=this,a=b.tpl;b.suspendResizing();if(a.isCTemplate){a.injectComponents();a.reset()}b.redoScrollbars();b.resumeResizing();b.performGC()},performGC:function(){var d=this.compIds,b=d.length-1,a,c;for(;b>=0;--b){a=Ext.getCmp(d[b]);c=a&&a.getEl();if(!c||(this.componentGC&&(!c.dom||Ext.getDom(Ext.id(c))!==c.dom))){if(a&&!a.isDestroyed){a.destroy()}}}},processValue:function(d){var c=this,b=c.compIds,g,f,e,a;if(Ext.isObject(d)&&!d.isComponent&&d.xtype){d=Ext.widget(d.xtype,d)}if(d&&d.isComponent){g=d.getId();if(!Ext.Array.contains(b,g)){b.push(g)}c.addRefOwner(d);c.registerListeners(d);if(d.rendered){if(Ext.isIE){e=d.el.dom;a=e.parentNode;if(a){if(c.extVersion===40101){Ext.core.DomHelper.insertBefore(e,{tag:"p"})}a.removeChild(e)}}}else{if(c.autoWidthComponents){f=c.getWidth()-c.lastFrameWidth;f=f>4?f:4;d.setWidth(f)}}if((Ext.isIE6||Ext.isIE7)&&c.isHidden()){d.hide()}}return d},redoScrollbars:function(){var b=this,a=b.up("tablepanel");if(a){if(b.resizeQueue){b.redoScrollbarsRequired=true;return}if(b.extVersion<40100){a.invalidateScroller();a.determineScrollbars()}else{a.doLayout()}}},registerColumnListeners:function(){var a=this;if(a.autoWidthComponents){a.on("resize",a.onColumnResize);a.on("show",a.onColumnShow)}if(Ext.isIE6||Ext.isIE7){a.on({hide:a.onColumnVisibilityChange,show:a.onColumnVisibilityChange})}},registerListeners:function(a){var b=this;a.on("destroy",b.onChildDestroy,b);if(b.autoWidthComponents){a.on("afterrender",b.onChildAfterRender,b,{single:true});if(!b.extVersion<40100){a.on("boxready",b.onChildBoxReady,b,{single:true})}}a.on("resize",b.onChildResize,b)},registerViewListeners:function(){var b=this,a=b.up("tablepanel").getView();b.mon(a,"beforerefresh",b.beforeViewRefresh,b);b.mon(a,"refresh",b.onViewChange,b);b.mon(a,"itemupdate",b.onViewChange,b);b.mon(a,"itemadd",b.onViewChange,b);b.mon(a,"itemremove",b.onViewChange,b)},resizeAll:function(){var a=this;a.suspendResizing();a.resizeQueue=a.getRefItems();a.resumeResizing()},resizeChild:function(d,g){var f=this,c,e,b,a;if(f.resizingSuspended){a=f.resizeQueue;if(!Ext.Array.contains(a,d)){a.push(d)}return}c=f.calculateFrameWidth(d);if(Ext.isNumber(c)){e=f.getWidth()-c;b=d.getWidth();if(f.setChildWidth(d,e,b)){if(g!==false){Ext.each(f.widthUpdateDelay,function(h){Ext.defer(f.resizeChild,h,f,[d,false])})}}}},resumeResizing:function(){var d=this,c=0,b=d.resizeQueue,a=b.length;if(!--d.resizingSuspended){for(;c<a;++c){d.resizeChild(b[c])}d.resizeQueue=null;if(d.redoScrollbarsRequired){d.redoScrollbars()}}},setChildWidth:function(b,c,a){if(a===c){return false}b.setWidth(c);return true},suspendResizing:function(){var a=this;a.resizingSuspended=(a.resizingSuspended||0)+1;if(!a.resizeQueue){a.resizeQueue=[]}}},1,["componentcolumn"],["component","gridcolumn","container","box","headercontainer","componentcolumn"],{component:true,gridcolumn:true,container:true,box:true,headercontainer:true,componentcolumn:true},["widget.componentcolumn"],0,[LkIp.plugins.ComponentColumn,"Column"],function(b){var c=b.prototype,a=Ext.getVersion();c.extVersion=(a.getMajor()*100+a.getMinor())*100+a.getPatch();if(Ext.Element.prototype.syncContent&&a.toString()==="4.1.0"){c.extVersion=40101}}));(Ext.cmd.derive("LkIp.view.TaxSystems.Psn.Orn.Grid",LkIp.view.Default.Grid,{autoHeight:true,height:"auto",maxHeight:400,limitFilter:false,paging:false,getFileAction:false,myViewConfig:{markDirty:false},initComponent:function(){var a=this;Ext.apply(a,{selModel:Ext.create("Ext.selection.CheckboxModel",{ignoreRightMouseSelection:true,checkOnly:true,listeners:{select:function(b){a.fireEvent("selectValue",b)},deselect:function(b){a.fireEvent("deselectValue",b)}}}),columns:[{text:reference.lang.taxSystem.psn.orn.patent.number,dataIndex:"patentNumber",xtype:"componentcolumn",width:"150",renderer:function(c,d,b){if(Ext.isEmpty(c)){return{value:c,itemId:"patentNumberColumn",record:b,xtype:"textfield"}}else{return c}}},{text:reference.lang.taxSystem.psn.orn.patent.start,dataIndex:"@DataNach",width:130,renderer:function(b){return !Ext.isEmpty(b)?LkIp.Utils.getDate(b):""}},{text:reference.lang.taxSystem.psn.orn.patent.end,dataIndex:"@DataKon",width:130,renderer:function(b){return !Ext.isEmpty(b)?LkIp.Utils.getDate(b):""}},{text:reference.lang.taxSystem.psn.orn.patent.activity,dataIndex:"naimDeyat",flex:1,renderer:function(c,d,b){return b.get("@KodVidD")+" - "+c}},{text:reference.lang.taxSystem.psn.orn.patent.no,dataIndex:"@KodNalOrg",width:100,renderer:LkIp.Utils.noRenderer}]});this.callParent(arguments)},getRowClass:function(a){if(a.get("selected")==1){return"disabled-row"}}},0,["psnOrnGrid"],["panel","gridtable","component","tablepanel","container","grid","box","gridpanel","psnOrnGrid"],{panel:true,gridtable:true,component:true,tablepanel:true,container:true,grid:true,box:true,gridpanel:true,psnOrnGrid:true},["widget.psnOrnGrid"],0,[LkIp.view.TaxSystems.Psn.Orn,"Grid"],0));(Ext.cmd.derive("LkIp.model.TaxSystems.Psn.Grid",Ext.data.Model,{fields:["@NomerPt","@KodNalOrg","@DataNach","@DataKon","@KodVidD","naimDeyat","patentNumber"]},0,0,0,0,0,0,[LkIp.model.TaxSystems.Psn,"Grid"],0));(Ext.cmd.derive("LkIp.view.TaxSystems.Psn.Orn.Index",Ext.Container,{cls:"psnOrn",required:'<span class="form-required-field" data-qtip="'+reference.lang.form.required+'">*</span>',initComponent:function(){Ext.apply(this,{items:[{xtype:"form",itemId:"psnOrnForm",items:[{xtype:"component",html:reference.lang.taxSystem.psn.orn.name},{xtype:"note",text:reference.lang.taxSystem.psn.orn.noPatent,hidden:true,itemId:"noDataInfo"},{xtype:"container",layout:{type:"auto"},margin:"20 0 0 0",items:[{xtype:"component",html:LkIp.Utils.header(reference.lang.pages.instruction,3),cls:"fl-l"},{xtype:"component",cls:"fl-r",html:reference.lang.taxSystem.today+LkIp.Utils.getNowDate()}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"1",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.taxSystem.step1Statement},{xtype:"container",cls:"field-container",defaults:{width:665,labelWidth:400,padding:"10 0 0"},items:[{xtype:"displayfield",name:"fullName",submitValue:true,fieldLabel:reference.lang.taxSystem.fio,value:LkIp.User.get("fullName")},{xtype:"displayfield",name:"inn",submitValue:true,fieldLabel:reference.lang.taxSystem.inn,value:LkIp.User.get("inn")},{xtype:"textfield",fieldLabel:reference.lang.taxSystem.phone,name:"phone",itemId:"phone",value:!Ext.isEmpty(LkIp.User.get("phone"))?LkIp.User.get("phone"):""},{xtype:"filterSelect",name:"no",itemId:"no",allowBlank:false,displayField:"fullName",tpl:'<tpl for="."><tpl if="code != 0"><li data-qtip="{qtip}" class="x-boundlist-item" role="option">{fullName}</li></tpl><tpl if="code == 0"><li class="x-boundlist-item" role="option">{value}</li></tpl></tpl>',fieldLabel:reference.lang.taxSystem.codeNo,afterLabelTextTpl:this.required,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"psnOrnNoStore"}},{xtype:"container",width:"100%",items:[{xtype:"component",html:reference.lang.taxSystem.psn.orn.info},{xtype:"radiogroup",rel:"reason",fieldLabel:"",labelSeparator:"",allowBlank:false,columns:1,items:[{boxLabel:reference.lang.taxSystem.psn.orn.radio1,componentCls:"one-line-radio",name:"reason",inputValue:"1",checked:true},{boxLabel:reference.lang.taxSystem.psn.orn.radio2,componentCls:"one-line-radio",name:"reason",inputValue:"2"}]}]},{xtype:"filterDate",hidden:false,allowBlank:false,name:"date",itemId:"date",afterLabelTextTpl:this.required,width:550,fieldLabel:reference.lang.taxSystem.psn.orn.date,maxValue:undefined},{xtype:"textfield",hidden:true,itemId:"patentNumberCheck",name:"patentNumberCheck",disabled:true,allowBlank:false}]},{xtype:"component",componentCls:"bold",itemId:"patentHeader",margin:"15 0 0",html:reference.lang.taxSystem.psn.orn.patentHeader},{xtype:"container",hidden:true,itemId:"patentActivities",width:"100%",items:[{xtype:"psnOrnGrid",itemId:"psnOrnGrid",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.TaxSystems.Psn.Grid",autoDestroy:true,storeId:"psnOrnGridStore"}},{xtype:"note",hidden:true,itemId:"patentNumberError",text:reference.lang.taxSystem.psn.orn.patentError}]},{xtype:"container",margin:"10 0 0",items:[{xtype:"button",itemId:"addPatentActivity",html:reference.lang.taxSystem.psn.orn.add}]}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"2",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.taxSystem.step2Statement},{xtype:"component",html:"<p>"+reference.lang.taxSystem.step2DescriptionStatement+"</p>"}]},{xtype:"container",layout:"hbox",defaults:{xtype:"button",formBind:true},items:[{name:"psnOrnShowButton",text:reference.lang.buttons.pdf},{margin:"0 0 0 15",rel:"submit",formBind:true,disabled:true,name:"psnOrnSignButton",text:reference.lang.buttons.signSend}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"3",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.pages.steps.step3Default},{xtype:"component",html:"<p>"+reference.lang.pages.steps.step3DescriptionStatement+"</p>"}]}]}]}]});this.callParent(arguments)}},0,["psnOrn"],["component","container","psnOrn","box"],{component:true,container:true,psnOrn:true,box:true},["widget.psnOrn"],0,[LkIp.view.TaxSystems.Psn.Orn,"Index"],0));(Ext.cmd.derive("LkIp.view.TaxSystems.Psn.Stop.Index",Ext.Container,{cls:"psnStop",required:'<span class="form-required-field" data-qtip="'+reference.lang.form.required+'">*</span>',initComponent:function(){Ext.apply(this,{items:[{xtype:"form",itemId:"psnStopForm",items:[{xtype:"component",tpl:"<p>"+reference.lang.taxSystem.psn.stop.notificationText+"</p>",data:{name:reference.lang.taxSystem.psn.stop.name}},{xtype:"container",layout:{type:"auto"},margin:"20 0 0 0",items:[{xtype:"component",html:LkIp.Utils.header(reference.lang.pages.instruction,3),cls:"fl-l"},{xtype:"component",cls:"fl-r",html:reference.lang.taxSystem.today+LkIp.Utils.getNowDate()}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"1",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.taxSystem.step1Statement},{xtype:"container",cls:"field-container",defaults:{width:665,labelWidth:400,padding:"10 0 0"},items:[{xtype:"displayfield",name:"fullName",submitValue:true,fieldLabel:reference.lang.taxSystem.fio,value:LkIp.User.get("fullName")},{xtype:"displayfield",name:"inn",submitValue:true,fieldLabel:reference.lang.taxSystem.inn,value:LkIp.User.get("inn")},{xtype:"textfield",fieldLabel:reference.lang.taxSystem.phone,name:"phone",value:!Ext.isEmpty(LkIp.User.get("phone"))?LkIp.User.get("phone"):""},{xtype:"filterSelect",name:"no",itemId:"no",allowBlank:false,displayField:"fullName",tpl:'<tpl for="."><tpl if="code != 0"><li data-qtip="{qtip}" class="x-boundlist-item" role="option">{fullName}</li></tpl><tpl if="code == 0"><li class="x-boundlist-item" role="option">{value}</li></tpl></tpl>',fieldLabel:reference.lang.taxSystem.codeNo,afterLabelTextTpl:this.required,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"psnStopNoStore"}},{xtype:"filterDate",hidden:false,name:"date",allowBlank:false,afterLabelTextTpl:this.required,width:550,fieldLabel:reference.lang.taxSystem.psn.stop.date,maxValue:undefined,minValue:undefined},{xtype:"filterSelect",disabled:true,typeAhead:false,forceSelection:false,name:"patentNumber",itemId:"patentNumber",allowBlank:false,displayField:"value",tpl:'<tpl for="."><li data-qtip="{qtip}" class="x-boundlist-item" role="option">{value}</li></tpl>',fieldLabel:reference.lang.taxSystem.psn.stop.patentNumber,afterLabelTextTpl:this.required,maxLength:13,enforceMaxLength:true,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"psnStopPatentStore"}},{xtype:"filterDate",hidden:false,name:"dateGet",allowBlank:false,afterLabelTextTpl:this.required,width:550,fieldLabel:reference.lang.taxSystem.psn.stop.dateGet,maxValue:undefined,minValue:undefined}]}]}]},{xtype:"note",itemId:"dateNotification",text:reference.lang.taxSystem.psn.stop.dateNotification,hidden:true},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"2",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.taxSystem.step2Statement},{xtype:"component",html:"<p>"+reference.lang.taxSystem.step2DescriptionStatement+"</p>"}]},{xtype:"container",layout:"hbox",defaults:{xtype:"button",formBind:true},items:[{name:"psnShowButton",text:reference.lang.buttons.pdf},{margin:"0 0 0 15",rel:"submit",formBind:true,disabled:true,name:"psnSignButton",text:reference.lang.buttons.signSend}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"3",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.pages.steps.step3Default},{xtype:"component",html:"<p>"+reference.lang.pages.steps.step3DescriptionStatement+"</p>"}]}]}]}]});this.callParent(arguments)}},0,["psnStop"],["component","container","box","psnStop"],{component:true,container:true,box:true,psnStop:true},["widget.psnStop"],0,[LkIp.view.TaxSystems.Psn.Stop,"Index"],0));(Ext.cmd.derive("LkIp.model.Address.SelectFilters",Ext.data.Model,{fields:["code","value","type","index","ocatd","socr","codeNo",{name:"qtip",type:"string",convert:function(b,a){return a.get("value")}},{name:"fullName",type:"string",convert:function(b,a){return a.get("value")}},{name:"shortName",type:"string",convert:function(b,a){var c=a.get("value");return Ext.String.ellipsis(c,40,true)}},{name:"filterValue",type:"string",convert:function(b,a){return a.get("value")}}],idProperty:"code"},0,0,0,0,0,0,[LkIp.model.Address,"SelectFilters"],0));(Ext.cmd.derive("LkIp.view.AddressBlock",Ext.window.Window,{autoHeight:true,layout:"auto",modal:true,ui:"nalogThemeWindow",title:reference.lang.address.title,width:700,minHeight:400,oktmoRequired:false,data:undefined,event:undefined,insertId:undefined,checkExistEvent:undefined,selectRegion:false,required:'<span class="form-required-field" data-qtip="'+reference.lang.form.required+'">*</span>',hideOktmo:false,checkNo:true,hasCustomAddressField:false,buttonCheck:true,isKkt:false,closeAddressText:false,initComponent:function(){var a=this;Ext.apply(a,{items:[{xtype:"form",itemId:"addressForm",padding:15,defaults:{xtype:"filterSelect",width:640,labelWidth:150,maskRe:undefined,anyMatch:true,typeAhead:false,forceSelection:false},items:Ext.Array.merge(a.generateRegionField(),[{name:"district",itemId:"district",fieldLabel:reference.lang.address.district,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Address.SelectFilters",autoDestroy:true,storeId:"addressDistrictStore"},listeners:{select:function(c,d){var b=c.up("#addressForm");b.down("#city").reset();b.down("#locality").reset();b.down("#street").reset();b.down("#oktmo").reset();b.down("#house").reset();b.down("#housing").reset();b.down("#apartment").reset();b.down("#postcode").reset()}}},{name:"city",itemId:"city",fieldLabel:reference.lang.address.city,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Address.SelectFilters",autoDestroy:true,storeId:"addressCityStore"},listeners:{select:function(c,d){var b=c.up("#addressForm");b.down("#locality").reset();b.down("#street").reset();b.down("#oktmo").reset();b.down("#house").reset();b.down("#housing").reset();b.down("#apartment").reset();b.down("#postcode").reset()}}},{name:"locality",itemId:"locality",fieldLabel:reference.lang.address.locality2,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Address.SelectFilters",autoDestroy:true,storeId:"addressLocalityStore"},listeners:{select:function(c,d){var b=c.up("#addressForm");b.down("#street").reset();b.down("#oktmo").reset();b.down("#house").reset();b.down("#housing").reset();b.down("#apartment").reset();b.down("#postcode").reset()}}},{name:"street",itemId:"street",fieldLabel:reference.lang.address.street2,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Address.SelectFilters",autoDestroy:true,storeId:"addressStreetStore"},listeners:{select:function(c,d){var b=c.up("#addressForm");b.down("#house").reset();b.down("#housing").reset();b.down("#apartment").reset();b.down("#postcode").reset()}}},{xtype:"container",layout:"hbox",width:"100%",defaults:{labelWidth:150,width:300,margin:"0 15 15 0",maxLength:8,enforceMaxLength:true,xtype:"textfield",rel:"checkValidity"},items:[{itemId:"house",name:"house",fieldLabel:reference.lang.address.house2},{itemId:"housing",name:"housing",fieldLabel:reference.lang.address.housing2}]},{itemId:"apartment",name:"apartment",labelWidth:150,width:300,maxLength:8,enforceMaxLength:true,xtype:"textfield",rel:"checkValidity",fieldLabel:reference.lang.address.apartment2},{xtype:"container",layout:"hbox",width:"100%",defaults:{labelWidth:150,width:300,margin:"0 15 15 0",xtype:"numberfield",allowDecimals:false,hideTrigger:true,enforceMaxLength:true},items:[{itemId:"postcode",maxLength:6,minLength:6,name:"postcode",rel:"checkValidity",fieldLabel:reference.lang.address.postcode},{xtype:"textfield",name:"oktmo",itemId:"oktmo",hidden:a.hideOktmo,disabled:a.hideOktmo,minLength:8,maxLength:11,enforceMaxLength:true,vtype:"oktmo",maskRe:/[0-9]+/,fieldLabel:reference.lang.taxSystem.oktmo}]},{xtype:"container",layout:"hbox",defaults:{xtype:"button"},align:"right",items:[{rel:"submit",name:"saveAddress",disabled:true,formBind:true,itemId:"saveAddress",text:Ext.isEmpty(this.addAddressText)?reference.lang.buttons.addAddress:this.addAddressText},this.closeAddressText?{rel:"submit",name:"closeAddress",itemId:"closeAddress",margin:"0 0 0 15",text:reference.lang.buttons.cancel}:{cls:"display-none"}]}])}]});a.callParent(arguments)},generateRegionField:function(){var a=this;if(a.selectRegion){return[{name:"region",itemId:"region",fieldLabel:reference.lang.address.region,allowBlank:false,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Address.SelectFilters",autoDestroy:true,storeId:"addressRegionStore"},listeners:{select:function(c,d){var b=c.up("#addressForm");b.down("#district").reset();b.down("#city").reset();b.down("#locality").reset();b.down("#street").reset();b.down("#oktmo").reset();b.down("#house").reset();b.down("#housing").reset();b.down("#apartment").reset();b.down("#postcode").reset()}}}]}else{if(Ext.isEmpty(a.data.region)||Ext.isEmpty(a.data.regionName)){return[]}else{return[{xtype:"displayfield",name:"regionName",submitValue:true,itemId:"regionName",fieldLabel:reference.lang.address.region,value:a.data.regionName},{xtype:"hiddenfield",itemId:"region",name:"region",value:a.data.region,listeners:{select:function(c){var b=c.up("#addressForm");b.down("#district").reset();b.down("#city").reset();b.down("#locality").reset();b.down("#street").reset();b.down("#oktmo").reset();b.down("#house").reset();b.down("#housing").reset();b.down("#apartment").reset();b.down("#postcode").reset()}}}]}}}},0,["addressBlock"],["panel","addressBlock","window","component","container","box"],{panel:true,addressBlock:true,window:true,component:true,container:true,box:true},["widget.addressBlock"],0,[LkIp.view,"AddressBlock"],0));Ext.apply(Ext.form.field.VTypes,{oktmo:function(b,a){return b.length==8||b.length==11},oktmoText:reference.lang.oktmoError});(Ext.cmd.derive("LkIp.view.FnsMail.Index",Ext.Container,{cls:"fnsMail iScroll",initComponent:function(){var a={xtype:"pagingtoolbar",componentCls:"paging-toolbar",itemId:"paginator",store:"FnsMail.GridStore",displayMsg:reference.lang.grid.paging.allRecords+" / "+reference.lang.grid.paging.recordOnThePage,emptyMsg:reference.lang.grid.paging.empty,displayInfo:true,listeners:{afterrender:function(c){var b=["-",reference.lang.grid.paging.displayText,new Ext.form.ComboBox({itemId:"limitFilter",cls:"dropdown-text grid-limit",typeAhead:false,editable:false,mode:"remote",value:"5",width:65,style:{top:"1px!important"},store:[5,10,25,50]})];c.add(b)}}};Ext.apply(this,{items:[{xtype:"component",html:reference.lang.fnsMail.info,margin:"0 0 15 0"},{xtype:"component",html:reference.lang.fnsMail.searchHelp,margin:"0 0 15 0"},{xtype:"defaultFilterPanel",title:undefined,collapsed:false,collapsible:false,id:"fnsMailFilterPanel",data:[{margin:"10 0 0",xtype:"textfield",emptyText:reference.lang.fnsMail.searchPlaceholder,name:"searchText",itemId:"searchText",cls:"input-field-as-select",width:"100%",labelWidth:0},{cls:"fl-l",width:450,defaults:{labelWidth:90,width:410,xtype:"filterSelect",displayField:"value",tpl:'<tpl for="."><li class="x-boundlist-item" role="option">{value}</li></tpl>',maskRe:undefined,anyMatch:true},items:[{lang:reference.lang.fnsMail.taxType,name:"taxType",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.FnsMail.SelectFilters",autoDestroy:true,storeId:"taxTypeStore"}},{lang:reference.lang.fnsMail.article,name:"article",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.FnsMail.SelectFilters",autoDestroy:true,storeId:"articleStore"}}]},{cls:"fl-l",width:450,defaults:{xtype:"container",margin:"10 0 0",defaults:{xtype:"filterDate",componentCls:"fl-l",labelWidth:10,hideEmptyLabel:false,margin:"0 0 0 5",hidden:false}},items:[{items:[{xtype:"component",width:100,html:reference.lang.fnsMail.publicationDate.label},{name:"date_publication_from",fieldLabel:reference.lang.filters.from},{name:"date_publication_to",labelWidth:20,fieldLabel:reference.lang.filters.to}]},{margin:"15 0 0",items:[{xtype:"component",width:100,html:reference.lang.fnsMail.signingDate.label},{name:"date_sign_from",fieldLabel:reference.lang.filters.from},{name:"date_sign_to",labelWidth:20,fieldLabel:reference.lang.filters.to}]}]}]},{xtype:"container",cls:"border-table",itemId:"paginator-container-top",margin:"10 0",rel:"paginator-container",items:a},{xtype:"container",items:[{xtype:"component",itemId:"listOfValues",tpl:'<div class="fns-letter"><tpl for="."><div class="fns-letter-item"><div class="fns-letter-head"><div class="fns-letter-number fl-l bold">'+reference.lang.fnsMail.letterFrom+' {date_write} \u2116 {num}</div><div class="fns-letter-articles fl-r">{articles}</div></div><div class="clear"></div><div class="fns-letter-body"><div class="fns-letter-tax"><div><span class="bold">'+reference.lang.fnsMail.taxLabel+'</span> {tax_name}</div></div><div class="fns-letter-question-label"><span class="bold">'+reference.lang.fnsMail.question+'</span></div><div class="fns-letter-question">{question}</div><div class="fns-letter-answer-header-block"><div class="fns-letter-answer-label fl-l"><div><span class="bold">'+reference.lang.fnsMail.answer+'</span><div id="question-{id}" class="collapsed fns-mail-arrow fns-toggle-answer"></div></div></div><div class="fns-letter-answer-date fl-r"><div><span>'+reference.lang.fnsMail.publicationLabel+' {date_publication}</span></div></div></div><div class="clear"></div><div class="fns-letter-answer collapsed" id="answer-{id}">{answer}</div></div></div></tpl></div>'},{xtype:"component",itemId:"emptyListOfValues",hidden:true,padding:"15 0",html:reference.lang.fnsMail.emptyList}]},{xtype:"container",cls:"border-table",itemId:"paginator-container-bottom",margin:"10 0",rel:"paginator-container",items:a}]});this.callParent(arguments)}},0,["fnsMail"],["component","container","box","fnsMail"],{component:true,container:true,box:true,fnsMail:true},["widget.fnsMail"],0,[LkIp.view.FnsMail,"Index"],0));(Ext.cmd.derive("LkIp.model.FnsStands.SelectFilters",Ext.data.Model,{fields:["code","value","type","refCode",{name:"qtip",type:"string",convert:function(b,a){return a.get("value")}},{name:"fullName",type:"string",convert:function(c,a){var b=a.get("refCode");return(0!==b?b+"-":"")+a.get("value")}},{name:"shortName",type:"string",convert:function(b,a){var c=a.get("value");return a.get("refCode")+"-"+Ext.String.ellipsis(c,40,true)}},{name:"filterValue",type:"string",convert:function(d,a){var b="",c=a.get("refCode");if("0"!=c){b=c+"-"}return b+a.get("value")}}],idProperty:"code"},0,0,0,0,0,0,[LkIp.model.FnsStands,"SelectFilters"],0));(Ext.cmd.derive("LkIp.view.FnsStands.Index",Ext.Container,{cls:"fnsStands iScroll",initComponent:function(){Ext.apply(this,{items:[{xtype:"component",html:reference.lang.fnsStands.info,margin:"0 0 15 0"},{xtype:"form",componentCls:"filters-panel",title:undefined,collapsed:false,collapsible:false,id:"fnsStandsFilterPanel",buttonFormBind:true,items:[{cls:"fl-l",width:700,defaults:{labelWidth:170,width:670,xtype:"filterSelect",maskRe:undefined,typeAhead:false,anyMatch:true,allowBlank:false},items:[{lang:reference.lang.fnsStands.region,name:"region",itemId:"region",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.FnsStands.SelectFilters",autoDestroy:true,storeId:"regionStore"}},{lang:reference.lang.fnsStands.no,name:"no",itemId:"no",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.FnsStands.SelectFilters",autoDestroy:true,storeId:"noStore"}}]},{cls:"fl-l",width:200,margin:"50 0 0",items:[{xtype:"checkbox",submitValue:false,boxLabel:reference.lang.fnsStands.inspectionCheckbox,itemId:"myInspection",name:"myInspection"}]}]},{xtype:"container",margin:"15 0 0",items:[{xtype:"component",cls:"bold",html:reference.lang.fnsStands.gridHeader},{xtype:"container",itemId:"categories",cls:"fns-stands",hidden:true,items:[]},{xtype:"component",itemId:"categoriesInfo",padding:"15 0",html:reference.lang.fnsStands.chooseInfo}]}]});this.callParent(arguments)}},0,["fnsStands"],["component","container","box","fnsStands"],{component:true,container:true,box:true,fnsStands:true},["widget.fnsStands"],0,[LkIp.view.FnsStands,"Index"],0));(Ext.cmd.derive("LkIp.view.Complaints.Index",Ext.container.Container,{cls:"complaints iScroll",required:'<span class="form-required-field" data-qtip="'+reference.lang.form.required+'">*</span>',initComponent:function(){var b=this,a=typeof LkIp.User.get("head")["SvedFL"]=="undefined"?"":LkIp.User.get("head")["SvedFL"]["Address"];Ext.apply(this,{items:[{xtype:"component",html:reference.lang.pages.complaints.description},{xtype:"note",text:reference.lang.pages.complaints.info},{xtype:"form",itemId:"complaintsForm",layout:{type:"auto"},rel:"form",border:false,fieldDefaults:{labelAlign:"left",labelWidth:250,margin:5},items:[{xtype:"fieldset",title:reference.lang.pages.complaints.form.no,items:[{xtype:"filterSelect",lang:reference.lang.filters.no,name:"selectNo",fieldLabel:reference.lang.pages.complaints.form.selectNo,afterLabelTextTpl:this.required,width:600,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"complaintsSelectNoStore"},formScope:this,msgTarget:"under",validator:this.validateNo},{xtype:"filterSelect",name:"chooseNo",fieldLabel:reference.lang.pages.complaints.form.chooseNo,afterLabelTextTpl:this.required,width:600,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"complaintsChooseNoStore"},formScope:this,validator:this.validateNo,msgTarget:"under",hideTrigger:true,maskRe:undefined,forceSelection:false},{xtype:"component",itemId:"mainNoInfo",hidden:true,tpl:reference.lang.pages.complaints.kodVTpl}]},{xtype:"fieldset",title:reference.lang.pages.complaints.form.sender,defaults:{xtype:"displayfield"},items:[{fieldLabel:reference.lang.pages.complaints.form.fio,name:"surname",value:LkIp.User.get("fullName")},{fieldLabel:reference.lang.pages.complaints.form.inn,name:"inn",value:LkIp.User.get("inn")},{xtype:"textfield",name:"myAddress",fieldLabel:reference.lang.pages.complaints.form.address,value:a,anchor:"100%",allowBlank:false,msgTarget:"under",afterLabelTextTpl:this.required},{xtype:"textfield",name:"phone",fieldLabel:reference.lang.pages.complaints.form.phone,width:450,maskRe:/\d/,maxLength:20,minLength:8,allowBlank:true,afterLabelTextTpl:"",msgTarget:"under",value:LkIp.User.get("phone")},{xtype:"filterSelect",name:"answerType",itemId:"answerType",displayField:"value",fieldLabel:reference.lang.pages.complaints.form.answerType,emptyText:reference.lang.pages.complaints.form.emptyText,afterLabelTextTpl:this.required,allowBlank:false,msgTarget:"under",width:600,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"complaintsAnswerType"}},{xtype:"container",layout:"anchor",items:[{xtype:"textfield",fieldLabel:reference.lang.pages.complaints.form.email,name:"emailAddress",itemId:"emailAddress",afterLabelTextTpl:this.required,allowBlank:false,vtype:"email",hidden:true,disabled:true,width:600,formScope:this,msgTarget:"under",value:LkIp.User.get("email")},{xtype:"textfield",fieldLabel:reference.lang.pages.complaints.form.addressWhere,name:"address",itemId:"address",afterLabelTextTpl:this.required,allowBlank:false,hidden:true,disabled:true,anchor:"100%",msgTarget:"under",formScope:this}]},{xtype:"simpleSelect",afterLabelTextTpl:this.required,name:"answerFormat",itemId:"answerFormat",disabled:true,hidden:true,allowBlank:false,queryMode:"local",editable:false,msgTarget:"under",fieldLabel:reference.lang.pages.complaints.form.answerFormat,store:[["0",reference.lang.pages.complaints.form.tiff],["1",reference.lang.pages.complaints.form.pdf]],value:"1"}]},{xtype:"fieldset",title:reference.lang.pages.complaints.form.feedbackInfo,items:[{afterLabelTpl:'<div class="hint">'+reference.lang.pages.complaints.form.feedbackHint+"</div>",fieldLabel:reference.lang.pages.complaints.form.feedbackText,name:"content",maxLength:4000,allowBlank:false,msgTarget:"under",rows:8,xtype:"textareafield",anchor:"100%",enforceMaxLength:true,afterLabelTextTpl:this.required},{xtype:"form",anchor:"100%",itemId:"fileUpload",rel:"fileUpload",layout:{type:"anchor"},margin:"25 0 0",border:false,items:[{xtype:"container",anchor:"100%",layout:{type:"anchor"},items:[{anchor:"100%",xtype:"filefield",name:"file",itemId:"file",clearOnSubmit:false,afterLabelTpl:'<div class="hint">'+reference.lang.pages.complaints.form.fileHint+"</div>",fieldLabel:reference.lang.pages.complaints.form.file,buttonText:reference.lang.form.file.buttonDefault,componentCls:"fl-l"},{xtype:"button",scale:"small",componentCls:"fl-l",anchor:"10%",disabled:true,hidden:true,text:reference.lang.buttons.reset,itemId:"resetFile",height:26,margin:this.getMargin()}]},{xtype:"component",anchor:"100%",cls:"fileRestriction",margin:"0 0 0 260",html:reference.lang.pages.complaints.form.fileRestriction,name:"fileRestriction",id:"fileRestriction"}]},{xtype:"hiddenfield",name:"filename"}]},{xtype:"button",text:reference.lang.buttons.send,rel:"submit",formBind:true,name:"complaintsSend",disabled:true}]}]});this.callParent()},validateNo:function(){if(LkIp.Utils.isEmpty(this.formScope.down('[name="selectNo"]').getValue())&&LkIp.Utils.isEmpty(this.formScope.down('[name="chooseNo"]').getValue())){return reference.lang.pages.complaints.form.errorNo}return true},getMargin:function(){if(Ext.isIE){if(Ext.isIE8){return"5 0 0"}if(Ext.isIE9){return"18 0 0"}return"20 0 0"}return"18 0 0 0"}},0,["complaints"],["component","container","box","complaints"],{component:true,container:true,box:true,complaints:true},["widget.complaints"],[[LkIp.view.Scrolling.prototype.mixinId||LkIp.view.Scrolling.$className,LkIp.view.Scrolling]],[LkIp.view.Complaints,"Index"],0));(Ext.cmd.derive("LkIp.model.OnlineBooking.SelectFilters",Ext.data.Model,{fields:["code","value","type",{name:"qtip",type:"string",convert:function(b,a){return a.get("value")}},{name:"fullName",type:"string",convert:function(c,a){var b=a.get("code");return(0!==b?b+"-":"")+a.get("value")}},{name:"shortName",type:"string",convert:function(b,a){var c=a.get("value");return a.get("code")+"-"+Ext.String.ellipsis(c,40,true)}},{name:"filterValue",type:"string",convert:function(d,a){var b="",c=a.get("code");if("0"!=c){b=c+"-"}return b+a.get("value")}}],idProperty:"code"},0,0,0,0,0,0,[LkIp.model.OnlineBooking,"SelectFilters"],0));(Ext.cmd.derive("LkIp.model.OnlineBooking.NoFilter",Ext.data.Model,{fields:["code","value","type","address","phone","info","refCode","way","torm",{name:"qtip",type:"string",convert:function(b,a){return a.get("value")}},{name:"fullName",type:"string",convert:function(c,a){var b=a.get("refCode");return(0!==b?b+"-":"")+a.get("value")}},{name:"shortName",type:"string",convert:function(b,a){var c=a.get("value");return a.get("refCode")+"-"+Ext.String.ellipsis(c,40,true)}},{name:"filterValue",type:"string",convert:function(d,a){var b="",c=a.get("refCode");if("0"!=c){b=c+"-"}return b+a.get("value")}}],idProperty:"code"},0,0,0,0,0,0,[LkIp.model.OnlineBooking,"NoFilter"],0));(Ext.cmd.derive("LkIp.model.OnlineBooking.ServiceFilter",Ext.data.Model,{fields:["code","value","type","parent",{name:"qtip",type:"string",convert:function(b,a){return a.get("value")}},{name:"fullName",type:"string",convert:function(c,a){var b=a.get("code");return(0!==b?b+"-":"")+a.get("value")}},{name:"shortName",type:"string",convert:function(b,a){var c=a.get("value");return a.get("code")+"-"+Ext.String.ellipsis(c,40,true)}},{name:"filterValue",type:"string",convert:function(d,a){var b="",c=a.get("code");if("0"!=c){b=c+"-"}return b+a.get("value")}}],idProperty:"code"},0,0,0,0,0,0,[LkIp.model.OnlineBooking,"ServiceFilter"],0));(Ext.cmd.derive("LkIp.view.OnlineBooking.EditTimeWindow",Ext.window.Window,{autoHeight:true,layout:"auto",modal:true,ui:"nalogThemeWindow",title:reference.lang.onlineBooking.changeTime.header,width:960,height:520,indexPage:undefined,record:undefined,initComponent:function(){var a=this;Ext.apply(a,{items:[{xtype:"container",cls:"onlineBooking",itemId:"editTimeContainer",padding:15,items:a.indexPage.getAvailableDatesItems(400,true)}]});a.callParent(arguments)},getRecord:function(){return this.record}},0,["editTimeWindow"],["panel","window","component","container","editTimeWindow","box"],{panel:true,window:true,component:true,container:true,editTimeWindow:true,box:true},["widget.editTimeWindow"],0,[LkIp.view.OnlineBooking,"EditTimeWindow"],0));(Ext.cmd.derive("LkIp.view.OnlineBooking.Index",Ext.Container,{cls:"onlineBooking",initComponent:function(){Ext.apply(this,{items:{xtype:"form",itemId:"mainForm",items:[{xtype:"component",html:reference.lang.onlineBooking.info},{xtype:"component",hidden:true,itemId:"recordRules",html:reference.lang.onlineBooking.recordRules},{xtype:"component",html:LkIp.Utils.header(reference.lang.onlineBooking.myData.title,2)},this.loadMainForm(),{margin:"5 0",cls:"clear"},{xtype:"component",html:LkIp.Utils.header(reference.lang.onlineBooking.records.title,2)},{xtype:"container",itemId:"gridContainer",items:[this.getGrid(),{xtype:"component",itemId:"emptyRecordsList",html:reference.lang.onlineBooking.records.emptyList}]},{margin:"5 0",cls:"clear"},{xtype:"component",html:LkIp.Utils.header(reference.lang.onlineBooking.visit.title,2)},{xtype:"container",items:this.getFilterPanel()},{xtype:"container",margin:"10 0 0",itemId:"availableDatesContainer",minHeight:500,hidden:true,items:this.getAvailableDatesItems()}]}});this.callParent(arguments)},loadMainForm:function(){return{xtype:"container",cls:"field-container",margin:"-7 0 0",defaults:{width:665,labelWidth:400,padding:"10 0 0",allowBlank:false,afterLabelTextTpl:LkIp.Utils.requiredLabel()},items:[{xtype:"displayfield",name:"fullName",submitValue:true,fieldLabel:reference.lang.onlineBooking.myData.fio,value:LkIp.User.get("fullName"),afterLabelTpl:""},{xtype:"displayfield",name:"inn",submitValue:true,fieldLabel:reference.lang.onlineBooking.myData.inn,value:LkIp.User.get("inn"),afterLabelTpl:""},{xtype:"displayfield",name:"email",itemId:"email",submitValue:true,fieldLabel:reference.lang.onlineBooking.myData.email},{xtype:"textfield",readOnly:true,name:"phone",itemId:"phone",componentCls:"read-only-field",fieldLabel:reference.lang.onlineBooking.myData.phone},{xtype:"component",html:reference.lang.onlineBooking.myData.editClick}]}},getFilterPanel:function(){return[{xtype:"defaultFilterPanel",title:undefined,collapsed:false,collapsible:false,itemId:"onlineBookingFilterPanel",buttonFormBind:true,hideReset:true,applyText:reference.lang.onlineBooking.visit.showButton,data:[{cls:"fl-l",width:700,defaults:{labelWidth:170,width:670,xtype:"filterSelect",maskRe:undefined,typeAhead:false,anyMatch:true,allowBlank:false,afterLabelTextTpl:LkIp.Utils.requiredLabel(),beforeHide:function(a){a.reset()}},items:[{lang:reference.lang.onlineBooking.visit.region,name:"region",itemId:"region",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.OnlineBooking.SelectFilters",autoDestroy:true,storeId:"regionStore"}},{lang:reference.lang.onlineBooking.visit.no,name:"no",itemId:"no",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.OnlineBooking.NoFilter",autoDestroy:true,storeId:"noStore"}},{lang:reference.lang.onlineBooking.visit.torm,name:"torm",itemId:"torm",allowBlank:true,afterLabelTextTpl:"",hidden:true,disabled:true,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.OnlineBooking.NoFilter",autoDestroy:true,storeId:"tormStore"}},{lang:reference.lang.onlineBooking.visit.service,name:"service",itemId:"service",displayField:"value",hidden:true,disabled:true,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.OnlineBooking.ServiceFilter",autoDestroy:true,storeId:"serviceStore"}},{lang:reference.lang.onlineBooking.visit.subService,name:"subService",itemId:"subService",displayField:"value",hidden:true,disabled:true,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.OnlineBooking.ServiceFilter",autoDestroy:true,storeId:"subServiceStore"}}]},{cls:"fl-l",width:200,margin:"50 0 0",items:[{xtype:"checkbox",submitValue:false,boxLabel:reference.lang.onlineBooking.visit.myIfns,itemId:"myInspection",name:"myInspection"}]}]},{xtype:"note",itemId:"noComment",hidden:true,text:""}]},getGrid:function(){return{xtype:"gridtable",paging:false,getFileAction:false,limitFilter:false,contextMenu:false,itemId:"recordsList",componentCls:"appointment-list",hidden:true,store:{extend:"Ext.data.ArrayStore",fields:[{name:"noName",type:"string"},{name:"noAddress",type:"string"},{name:"noWay",type:"string"},{name:"noPhone",type:"string"},{name:"window",type:"string"},{name:"date",type:"string"},{name:"service",type:"string"},{name:"serviceName",type:"string"},{name:"subServiceName",type:"string"},{name:"pin",type:"string"},{name:"bookingId",type:"string"},{name:"email",type:"string"},{name:"phone",type:"string"},{name:"noCode",type:"string"},{name:"fns_service_id",type:"string"},{name:"originalDate",type:"string"}],autoDestroy:true,storeId:"appointmentsStore"},columns:[{text:reference.lang.onlineBooking.records.grid.date,dataIndex:"date",width:130,renderer:function(b,c,a){return b+new Ext.XTemplate(reference.lang.onlineBooking.records.grid.editContent).apply({id:a.get("bookingId")})}},{text:reference.lang.onlineBooking.records.grid.service,dataIndex:"serviceName",flex:1,renderer:function(c,d,b){var a=b.get("subServiceName");return c+(!Ext.isEmpty(a)?": "+a:"")}},{text:reference.lang.onlineBooking.records.grid.noName,dataIndex:"noName",width:180,renderer:LkIp.Utils.stringWrap},{text:reference.lang.onlineBooking.records.grid.noAddress,dataIndex:"noAddress",width:150,renderer:LkIp.Utils.stringWrap},{text:reference.lang.onlineBooking.records.grid.more,dataIndex:"",width:120,renderer:function(d,e,a){var b=a.get("window"),c=a.get("pin"),f="";if(!Ext.isEmpty(c)){f+=Ext.String.format('<div><span class="bold">'+reference.lang.onlineBooking.records.grid.pin+" {0}</span></div>",c)}if(!Ext.isEmpty(b)){f+=Ext.String.format('<div><span class="bold">'+reference.lang.onlineBooking.records.grid.window+" {0}</span></div>",b)}return f}},{text:reference.lang.onlineBooking.records.grid.actions,dataIndex:"",width:150,renderer:function(b,c,a){return new Ext.XTemplate(reference.lang.onlineBooking.records.grid.actionsContent).apply({id:a.get("bookingId")})}}]}},getAvailableDatesItems:function(a,b){a=a||undefined;b=b||false;return[{xtype:"component",itemId:"availableDatesHeader",html:reference.lang.onlineBooking.availableDates},{xtype:"container",layout:"hbox",margin:"10 0 0",itemId:"availableDatesInnerContainer",cls:"available-dates-inner-container",minHeight:500,items:[{xtype:"component",itemId:"availableDates",autoScroll:b,height:a,width:"65%",tpl:'<div class="available-dates"><tpl for="."><div class="available-date {[xindex % 2 === 0 ? "even" : "odd"]}"><div class="full-date-component">{fullDate} \u0433.</div><div class="content-container"><table><tr><td class="content-container-item day-name-component-td"><span class="day-name-component">{dayName}</span></td><td class="content-container-item time-container-td"><tpl for="times"><div id="time{id}" class="{[values.selected == 1 ? "selected-date" : "time-click-element"]} time-component fl-l">{time}</div></tpl><div class="clear"></div> </td></tr></table></div></div></tpl></div>'},{xtype:"container",margin:"0 0 0 10",defaults:{xtype:"component"},items:[{html:reference.lang.onlineBooking.openData},{style:{margin:"15px auto 5px auto"},xtype:"datepicker",disableMonthMenu:true,itemId:"bookingCalendar",format:"Y-m-d",componentCls:"tax-calendar-datepicker",keyNav:{}},{componentCls:"bold",margin:"15 0 5 0",html:reference.lang.onlineBooking.noInfo.header},{itemId:"ifnsInfo",componentCls:"noInfo",tpl:'<tpl if="torm != \'\'"><div class="block-separator">{tormName}</div><div class="block-separator"><span class="block-label">'+reference.lang.onlineBooking.noInfo.composition+'</span> <tpl else><div class="block-separator"></tpl>{noName}</div><div class="block-separator"><span class="block-label">'+reference.lang.onlineBooking.noInfo.address+'</span> {noAddress}</div><div class="block-separator "><span class="block-label">'+reference.lang.onlineBooking.noInfo.phone+'</span> {noPhone}</div><tpl if="noWay != \'\'"><div class="block-separator "><span class="block-label">'+reference.lang.onlineBooking.noInfo.way+"</span> {noWay}</div></tpl>"}]}]}]}},0,["onlineBooking"],["onlineBooking","component","container","box"],{onlineBooking:true,component:true,container:true,box:true},["widget.onlineBooking"],0,[LkIp.view.OnlineBooking,"Index"],0));(Ext.cmd.derive("LkIp.view.OverpaymentInformationBlock",Ext.window.Window,{autoHeight:true,layout:"auto",modal:true,ui:"nalogThemeWindow",title:reference.lang.msg.info,width:650,componentCls:"user-information-window-block",closable:false,initComponent:function(){var b=this,a=[];a.push({text:reference.lang.buttons.hasOverpaymentGo,name:"overpayment-btn",handler:function(c){c.fireEvent("closeOverpaymentBlock",true)},margin:"0 0 0 10"});a.push({text:reference.lang.buttons.hasOverpaymentOk,name:"overpayment-btn",handler:function(c){c.fireEvent("closeOverpaymentBlock",false)}});Ext.apply(b,{padding:5,items:[{xtype:"note",margin:"5 0",text:reference.lang.hasOverpayment},{xtype:"container",margin:"10 0 0",defaults:{xtype:"button",componentCls:"fl-r"},items:a}]});b.callParent(arguments)}},0,["overpaymentInfoBlock"],["panel","window","component","container","overpaymentInfoBlock","box"],{panel:true,window:true,component:true,container:true,overpaymentInfoBlock:true,box:true},["widget.overpaymentInfoBlock"],0,[LkIp.view,"OverpaymentInformationBlock"],0));(Ext.cmd.derive("LkIp.view.AnketaInformationBlock",Ext.window.Window,{autoHeight:true,layout:"auto",modal:true,ui:"nalogThemeWindow",title:reference.lang.msg.info,width:650,componentCls:"user-information-window-block",closable:false,bodyPadding:5,initComponent:function(){var b=this,a=[];a.push({text:reference.lang.buttons.cancel,handler:function(){b.close()},margin:"0 0 0 10"});a.push({text:reference.lang.buttons.anketa,name:"openAnketa",handler:function(c){c.fireEvent("openAnketa",true)}});Ext.apply(b,{padding:5,items:[{xtype:"note",margin:"5 0",text:reference.lang.anketa},{xtype:"container",margin:"10 0 0",defaults:{xtype:"button",componentCls:"fl-r"},items:a},{xtype:"checkboxfield",boxLabel:"\u0411\u043e\u043b\u044c\u0448\u0435 \u043d\u0435 \u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c",name:"closeAnketaForever",inputValue:"1"}]});b.callParent(arguments)}},0,["anketaInfoBlock"],["panel","window","component","anketaInfoBlock","container","box"],{panel:true,window:true,component:true,anketaInfoBlock:true,container:true,box:true},["widget.anketaInfoBlock"],0,[LkIp.view,"AnketaInformationBlock"],0));(Ext.cmd.derive("LkIp.view.Kkt.KktGrid",LkIp.view.Default.Grid,{itemId:"kktGrid",store:"Kkt.KktStore",initComponent:function(){var a=this;Ext.apply(a,{columns:[{text:"",dataIndex:"status",width:40,renderer:this.drawIndicator,sortable:false,menuText:reference.lang.kkt.grid.stateG},{text:reference.lang.kkt.grid.date,dataIndex:"date",width:95,renderer:function(b){return !Ext.isEmpty(b)?LkIp.Utils.getDate(b):""}},{text:reference.lang.kkt.grid.no,dataIndex:"no",width:65,hidden:true,sortable:true,renderer:LkIp.Utils.noRenderer},{text:reference.lang.kkt.grid.address,dataIndex:"address",flex:1,sortable:true},{text:reference.lang.kkt.grid.rnm,dataIndex:"rnm",width:155,renderer:function(d,f,c){var g=c.get("id"),e=c.get("countAttempts"),b=c.get("status");if(!Ext.isEmpty(d)){return'<span class="page-action-link rnm-click" data-kkt-id="'+g+'" data-fn-attempts="'+e+'">'+LkIp.Utils.formatRnm(d)+"</span>"}else{if(b=="13001"||b=="13003"){return"\u0418\u0434\u0435\u0442 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430.."}}return""}},{text:reference.lang.kkt.grid.model,dataIndex:"model",width:100,sortable:true},{text:reference.lang.kkt.grid.dateEndFp,dataIndex:"dateEndFp",width:115,renderer:function(b){return !Ext.isEmpty(b)?LkIp.Utils.getDate(b):""}},{text:reference.lang.kkt.grid.ofd,dataIndex:"ofdName",width:160,renderer:function(b){if(Ext.isEmpty(b)){return reference.lang.kkt.grid.offline}return b},sortable:false},{text:reference.lang.kkt.grid.state,dataIndex:"status_name",width:160,renderer:function(c,d,b){return c},sortable:true},{xtype:"actioncolumn",width:35,menuText:reference.lang.kkt.grid.history.menuName,items:[{icon:"images/document.png",tooltip:reference.lang.kkt.grid.historyTooltip,getClass:function(c,d,b){if(b.get("from_lk")==0){return"x-hide-visibility"}},handler:function(d,e,c){var b=d.getStore().getAt(e);a.fireEvent("showHistory",b)}}]}]});a.callParent(arguments)},listeners:{beforeselect:function(a){if(a.view.stopSelectionProcess){return false}}},viewConfigListeners:{beforecellmousedown:function(c,a,f,b,g,e,d){c.stopSelectionProcess=2==f||7==f||0==f}},drawIndicator:function(b,c,a){return LkIp.app.getController("Kkt.Index").drawIndicator(b)}},0,["kktGrid"],["panel","kktGrid","gridtable","component","tablepanel","container","grid","box","gridpanel"],{panel:true,kktGrid:true,gridtable:true,component:true,tablepanel:true,container:true,grid:true,box:true,gridpanel:true},["widget.kktGrid"],0,[LkIp.view.Kkt,"KktGrid"],0));(Ext.cmd.derive("LkIp.model.Kkt.SelectFilters",Ext.data.Model,{fields:["code","value","type","version",{name:"value_version",type:"string",convert:function(c,b){var c=b.get("value"),a=b.get("version");if(!Ext.isEmpty(a)){c+=", \u0412\u0435\u0440\u0441\u0438\u044f: "+a}return c}},{name:"qtip",type:"string",convert:function(b,a){return a.get("value")}},{name:"fullName",type:"string",convert:function(c,a){var b=a.get("code");return(0!==b?b+"-":"")+a.get("value")}},{name:"shortName",type:"string",convert:function(b,a){var c=a.get("value");return a.get("code")+"-"+Ext.String.ellipsis(c,40,true)}},{name:"shortValue",type:"string",convert:function(b,a){return Ext.String.ellipsis(a.get("value"),40,true)}},{name:"filterValue",type:"string",convert:function(d,a){var b="",c=a.get("code");if("0"!=c){b=c+"-"}return b+a.get("value")}}],idProperty:"code"},0,0,0,0,0,0,[LkIp.model.Kkt,"SelectFilters"],0));(Ext.cmd.derive("LkIp.view.Kkt.Index",Ext.Container,{cls:"kkt_list",initComponent:function(){Ext.apply(this,{items:[{xtype:"container",items:[{xtype:"component",html:'<h2 class="header-uppercase">'+reference.lang.pages.kkt.title+"</h2>",cls:"fl-l",width:"73%"},{xtype:"container",cls:"fl-r",width:"27%",defaults:{xtype:"component",cls:"individual-help-link"},items:[LkIp.User.isKktManufacturer()?{html:'<a href="#!/kkt/manufacturer" class="link">'+reference.lang.kkt.manufaturerLink+"</a>"}:{cls:"display-none"}]},{cls:"clear"}]},{xtype:"note",text:reference.lang.kkt.oldKktInfo},{xtype:"note",text:reference.lang.kkt.newNoticeNote,itemId:"newNoticeNote",hidden:true},{xtype:"note",hidden:!LkIp.User.isClosedUser(),text:reference.lang.errors.closedUser},{xtype:"container",hidden:!LkIp.User.isActiveUser(),items:[{xtype:"container",cls:"fl-r",style:{width:"30%"},items:[{xtype:"button",componentCls:"fl-r",name:"registerModel",menu:[{text:"\u0437\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0437\u0430\u044f\u0432\u043b\u0435\u043d\u0438\u044f \u0432\u0440\u0443\u0447\u043d\u0443\u044e",handler:function(){LkIp.Utils.goTo("#!/kkt/registration")}},{text:"\u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0438\u0437 \u0444\u0430\u0439\u043b\u0430",handler:function(){LkIp.Utils.goTo("#!/kkt/registration/file")}}],text:reference.lang.kkt.registerBtn,margin:"0 0 10 0"}]}]},{cls:"clear"},{xtype:"defaultFilterPanel",itemId:"kktFilters",data:[{cls:"first-column fl-l",defaults:{labelWidth:120,width:360,xtype:"filterSelect"},items:[{xtype:"filterSelect",lang:reference.lang.kkt.filters.no,name:"no",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"kktNoStore"},anyMatch:true,forceSelection:false,maskRe:undefined},{xtype:"textfield",maskRe:/[0-9]/,name:"rnm",maxLength:16,enforceMaxLength:true,fieldLabel:reference.lang.kkt.filters.rnm},{xtype:"filterSelect",lang:reference.lang.kkt.filters.state,name:"state",displayField:"value",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"kktStateStore"},anyMatch:true,forceSelection:false,maskRe:undefined},{xtype:"filterSelect",tpl:'<tpl for="."><tpl if="code != 0"><li data-qtip="{qtip}" class="x-boundlist-item" role="option">{value_version}</li></tpl><tpl if="code == 0"><li class="x-boundlist-item" role="option">{value_version}</li></tpl></tpl>',lang:reference.lang.kkt.filters.model,name:"model",displayField:"value_version",valueField:"value",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Kkt.SelectFilters",autoDestroy:true,storeId:"kktModelStore"},anyMatch:true,forceSelection:false,maskRe:undefined},{margin:"10 0 0",xtype:"textfield",name:"model_code",maxLength:36,enforceMaxLength:true,fieldLabel:reference.lang.kkt.filters.model_code},{xtype:"filterSelect",lang:reference.lang.kkt.filters.fn_model,name:"fn_model",displayField:"value",valueField:"value",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Kkt.SelectFilters",autoDestroy:true,storeId:"kktFnModelStore"},anyMatch:true,forceSelection:false,maskRe:undefined},{margin:"20 0 0",xtype:"textfield",maskRe:/[0-9]/,name:"fn_model_code",maxLength:16,enforceMaxLength:true,fieldLabel:reference.lang.kkt.filters.fn_model_code}]},{cls:"second-column fl-l",defaults:{labelWidth:140,width:515,xtype:"filterSelect"},items:[{xtype:"defaultDateFilter",dateFieldName:"registration_date",lang:reference.lang.kkt.filters.registration_date},{xtype:"defaultDateFilter",dateFieldName:"fn_last_date",storeType:"kkt",lang:reference.lang.kkt.filters.fn_last_date},{xtype:"filterSelect",lang:reference.lang.kkt.filters.ofd,name:"ofd",displayField:"value",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Kkt.OfdFilter",autoDestroy:true,storeId:"ofdListStore"},anyMatch:true,forceSelection:false,maskRe:undefined},{xtype:"textfield",name:"address",fieldLabel:reference.lang.kkt.filters.address}]}]},{xtype:"kktGrid"},{xtype:"container",itemId:"detailsInfo",hidden:true,margin:"15 0 0",items:[{xtype:"container",cls:"kkt_details",layout:"hbox",items:[{xtype:"form",itemId:"detailsForm",border:false,layout:"auto",width:"78%",fieldDefaults:{labelAlign:"left",labelWidth:375,width:700,margin:5},defaults:{xtype:"displayfield"},items:[{name:"date",fieldLabel:reference.lang.kkt.details.date},{name:"no_full",fieldLabel:reference.lang.kkt.details.no},{name:"address",fieldLabel:reference.lang.kkt.details.address},{name:"ofd",fieldLabel:reference.lang.kkt.details.ofd},{name:"model_kkt",fieldLabel:reference.lang.kkt.details.model_kkt},{name:"model_factory_code",fieldLabel:reference.lang.kkt.details.model_model_factory_code},{name:"rnm",fieldLabel:reference.lang.kkt.details.rnm},{name:"model_fn",fieldLabel:reference.lang.kkt.details.model_fn},{name:"model_fn_code",fieldLabel:reference.lang.kkt.details.model_model_fn_code},{name:"okved",fieldLabel:reference.lang.kkt.details.okved},{xtype:"component",html:"\u041a\u043e\u043d\u0442\u0440\u043e\u043b\u044c\u043d\u043e-\u043a\u0430\u0441\u0441\u043e\u0432\u0430\u044f \u0442\u0435\u0445\u043d\u0438\u043a\u0430 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u043a\u0430\u043a:",margin:5},{name:"kkt_info"}]},{xtype:"container",width:"22%",items:[{xtype:"button",name:"re-registerModel",text:reference.lang.kkt.reRegisterBtn,margin:"0 0 15 0",width:202},{xtype:"button",name:"deRegistration",text:reference.lang.kkt.deregistration,margin:"0 0 15 0",width:202},{xtype:"button",name:"register",text:reference.lang.kkt.registerBtn,margin:"0 0 15 0",hidden:true,width:202},{xtype:"component",itemId:"download-reg-card",tpl:'<div class="file_pdf"><a hash="{hash}" filename="{filename}" ext="{ext}" style="font-size: 11px;"class="link download-reg-card">'+reference.lang.kkt.details.download+"</a></div>"}]}]}]}]});this.callParent(arguments)}},0,["kkt"],["kkt","component","container","box"],{kkt:true,component:true,container:true,box:true},["widget.kkt"],0,[LkIp.view.Kkt,"Index"],0));(Ext.cmd.derive("LkIp.model.Kkt.OfdFilter",Ext.data.Model,{fields:["code","value","type","inn","brand",{name:"qtip",type:"string",convert:function(b,a){return a.get("value")}},{name:"fullName",type:"string",convert:function(c,a){var b=a.get("code");return(0!==b?b+"-":"")+a.get("value")}},{name:"shortName",type:"string",convert:function(b,a){var c=a.get("value");return a.get("code")+"-"+Ext.String.ellipsis(c,40,true)}},{name:"shortValue",type:"string",convert:function(b,a){return Ext.String.ellipsis(a.get("value"),40,true)}},{name:"filterValue",type:"string",convert:function(d,a){var b="",c=a.get("code");if("0"!=c){b=c+"-"}return a.get("brand")+" ("+a.get("value")+")"}}],idProperty:"code"},0,0,0,0,0,0,[LkIp.model.Kkt,"OfdFilter"],0));(Ext.cmd.derive("LkIp.model.Kkt.KktModelFilter",Ext.data.Model,{fields:["code","value","version",{name:"fullName",type:"string",convert:function(c,b){var a=b.get("version");return b.get("value")+(!Ext.isEmpty(a)?" \u0432\u0435\u0440\u0441\u0438\u044f "+a:"")}},{name:"qtip",type:"string",convert:function(b,a){return a.get("fullName")}}]},0,0,0,0,0,0,[LkIp.model.Kkt,"KktModelFilter"],0));(Ext.cmd.derive("LkIp.view.Kkt.Registration.Index",Ext.Container,{cls:"kktRegistration",componentCls:"kkt-with-address-panel",initComponent:function(){Ext.apply(this,{items:{xtype:"form",itemId:"kktRegistrationForm",layout:{type:"anchor"},rel:"form",border:false,fieldDefaults:{labelWidth:300,anchor:"100%",margin:5,msgTarget:"under"},items:[{xtype:"note",text:reference.lang.kkt.newNoticeNoteApp,itemId:"newNoticeNote",hidden:true},{xtype:"container",itemId:"steps",items:[{xtype:"container",layout:{type:"anchor"},width:"100%",anchor:"100%",cls:"instruction",items:[{xtype:"component",html:"1",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.kkt.registration.step1},{xtype:"component",html:'\u0414\u043b\u044f \u0444\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0437\u0430\u044f\u0432\u043b\u0435\u043d\u0438\u044f \u043d\u0430 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044e \u041a\u041a\u0422 \u0412\u0430\u043c \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0437\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043f\u043e\u043b\u044f \u0437\u0430\u044f\u0432\u043b\u0435\u043d\u0438\u044f, \u043f\u043e\u0442\u043e\u043c \u043d\u0430\u0436\u0430\u0442\u044c \u043d\u0430 \u043a\u043d\u043e\u043f\u043a\u0443 "\u043f\u043e\u0434\u043f\u0438\u0441\u0430\u0442\u044c \u0438 \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c" \u0434\u043b\u044f \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0438 \u0437\u0430\u044f\u0432\u043b\u0435\u043d\u0438\u044f \u0432 \u043d\u0430\u043b\u043e\u0433\u043e\u0432\u044b\u0439 \u043e\u0440\u0433\u0430\u043d.'}]},{xtype:"container",layout:"auto",width:"100%",itemId:"registrationBody",margin:"15 0 0",items:[{xtype:"note",itemId:"predefinedNote",hidden:true,text:reference.lang.kkt.registration.predefinedNote},{xtype:"fieldset",defaults:{margin:"10 0 0 5",layout:"auto",xtype:"container",defaults:{componentCls:"fl-l",xtype:"component"}},title:reference.lang.kkt.registration.addressBlock,items:[{xtype:"addressFiasBlock",itemId:"addressFIAS"},{itemId:"kktAddressBlock",hidden:true,items:[{html:'<span class="page-action-link help-tooltip" data-help="'+reference.lang.kkt.help.address+'">'+reference.lang.kkt.registration.address+"</span>",width:320},{xtype:"container",width:"60%",items:[{xtype:"component",html:"",itemId:"address"}]}]},{xtype:"textareafield",grow:true,rows:3,name:"place_name",itemId:"place_name",labelWidth:320,fieldLabel:'<span class="page-action-link help-tooltip" data-help="'+reference.lang.kkt.help.address_place+'">'+reference.lang.kkt.registration.placeName+"</span>",maxLength:254,allowBlank:false,afterLabelTextTpl:LkIp.Utils.requiredLabel(),enforceMaxLength:true}]},{xtype:"fieldset",title:reference.lang.kkt.registration.kktBlock,defaults:{margin:"10 0 0",layout:"auto",xtype:"container",defaults:{componentCls:"fl-l",margin:"0 0 0 5",xtype:"component"}},items:[{itemId:"kktBlock",items:[{html:'<span class="page-action-link help-tooltip" data-help="'+reference.lang.kkt.help.model_name+'">'+reference.lang.kkt.registration.modelFilter.label+"</span>"+LkIp.Utils.requiredLabel(),itemId:"modelKktLabel",width:300},{xtype:"container",width:"60%",items:[{xtype:"component",html:"",itemId:"modelKktString"},{xtype:"button",margin:"0",itemId:"editKkt",scale:"small",html:reference.lang.buttons.enterKkt}]}]},{xtype:"component",html:"<hr/>"},{itemId:"fnBlock",hidden:true,items:[{html:'<span class="page-action-link help-tooltip" data-help="'+reference.lang.kkt.help.model_fn+'">'+reference.lang.kkt.registration.fnFilter.label+"</span>"+LkIp.Utils.requiredLabel(),itemId:"modelFnLabel",width:300},{xtype:"container",width:"60%",items:[{xtype:"component",html:"",itemId:"modelFnString"},{xtype:"button",margin:"0",itemId:"editFn",scale:"small",html:reference.lang.buttons.enterFn}]}]}]},{xtype:"fieldset",title:reference.lang.kkt.registration.kktOptionsBlock,defaults:{xtype:"container",layout:"hbox",margin:"10 5 0"},items:[{items:[{xtype:"component",margin:"0 15 0 0",width:650,html:'<span class="page-action-link help-tooltip" data-help="'+reference.lang.kkt.registration.autoModeHelp+'">'+reference.lang.kkt.registration.autoMode+"</span>"},{margin:0,width:50,componentCls:"kkt__checkbox",xtype:"checkbox",name:"autoMode",itemId:"autoMode",inputValue:"1"}]},{items:[{xtype:"component",margin:"0 15 0 0",width:650,html:reference.lang.kkt.registration.lottery},{margin:0,width:50,componentCls:"kkt__checkbox",xtype:"checkbox",name:"lottery",itemId:"lottery",inputValue:"1"}]},{items:[{xtype:"component",margin:"0 15 0 0",width:650,html:reference.lang.kkt.registration.rates},{margin:0,width:50,componentCls:"kkt__checkbox",xtype:"checkbox",name:"rates",itemId:"rates",inputValue:"1"}]},{items:[{xtype:"component",margin:"0 15 0 0",width:650,html:reference.lang.kkt.registration.bank},{margin:0,width:50,componentCls:"kkt__checkbox",xtype:"checkbox",name:"bank",itemId:"bank",inputValue:"1"}]},{items:[{xtype:"component",margin:"0 15 0 0",width:650,html:reference.lang.kkt.registration.calculation_device},{margin:0,width:50,componentCls:"kkt__checkbox",xtype:"checkbox",name:"calculation_device",itemId:"calculation_device",inputValue:"1",listeners:{change:function(a,b){if(b){a.up("form").down("#calculation_device_number").show().enable()}else{a.up("form").down("#calculation_device_number").hide().disable()}a.up("form").isValid();a.up("form").getForm().checkValidity()}}}]},{margin:0,items:[{xtype:"textfield",fieldLabel:reference.lang.kkt.registration.calculation_device_number,name:"calculation_device_number",itemId:"calculation_device_number",msgTarget:"under",width:"100%",anchor:"100%",allowBlank:false,afterLabelTextTpl:LkIp.Utils.requiredLabel(),hidden:true,disabled:true}]},{items:[{xtype:"component",margin:"0 15 0 0",width:650,html:reference.lang.kkt.registration.internet},{margin:0,width:50,componentCls:"kkt__checkbox",xtype:"checkbox",name:"internet",itemId:"internet",inputValue:"1"}]},{margin:"0 0 0 5",layout:"auto",items:[{xtype:"component",html:'<span class="page-action-link help-tooltip" data-help="'+reference.lang.kkt.registration.web_address_help+'">'+reference.lang.kkt.registration.web_address+"</span>"+LkIp.Utils.requiredLabel(),itemId:"webAddressLabel",hidden:true},{margin:"10 0",xtype:"textareafield",grow:true,rows:3,maxLength:256,enforceMaxLength:true,name:"web_address",itemId:"web_address",vtype:"multiwebsite",msgTarget:"under",allowBlank:false,width:"100%",afterLabelTextTpl:LkIp.Utils.requiredLabel(),hidden:true,disabled:true,listeners:{show:function(a){a.up("container").down("#webAddressLabel").show()},hide:function(a){a.up("container").down("#webAddressLabel").hide()}}}]},{items:[{xtype:"component",margin:"0 15 0 0",width:650,html:reference.lang.kkt.registration.peddling},{margin:0,width:50,componentCls:"kkt__checkbox",xtype:"checkbox",name:"peddling",itemId:"peddling",inputValue:"1"}]},{items:[{xtype:"component",margin:"0 15 0 0",width:650,html:reference.lang.kkt.registration.blank},{margin:0,width:50,componentCls:"kkt__checkbox",xtype:"checkbox",name:"blank",itemId:"blank",inputValue:"1"}]},{items:[{xtype:"component",margin:"0 15 0 0",width:650,html:reference.lang.kkt.registration.akciz},{margin:0,width:50,componentCls:"kkt__checkbox",xtype:"checkbox",name:"akciz",itemId:"akciz",inputValue:"1"}]},{items:[{xtype:"component",margin:"0 15 0 0",width:650,html:reference.lang.kkt.registration.platAgent},{margin:0,width:50,componentCls:"kkt__checkbox",xtype:"checkbox",name:"payment_agent",itemId:"payment_agent",inputValue:"1"}]}]},{xtype:"fieldset",itemId:"ofdBlock",title:reference.lang.kkt.registration.ofdBlock,items:[{xtype:"filterSelect",fieldLabel:'<span class="page-action-link help-tooltip" data-help="'+reference.lang.kkt.help.ofd+'">'+reference.lang.kkt.registration.ofdFilter.label+"</span>",emptyText:reference.lang.kkt.registration.ofdFilter.empty,name:"ofd_code",itemId:"ofd_code",displayField:"value",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Kkt.OfdFilter",autoDestroy:true,storeId:"ofdForRegisterStore"},allowBlank:false,afterLabelTextTpl:LkIp.Utils.requiredLabel(),formScope:this,anyMatch:true,maskRe:undefined,forceSelection:false,margin:"0 5",editable:false},{xtype:"displayfield",itemId:"ofd_inn",hidden:true,fieldLabel:reference.lang.kkt.registration.ofdInn}]}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"2",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.kkt.registration.step2},{xtype:"component",html:"<p>"+reference.lang.kkt.registration.step2Description+"</p>"},{xtype:"note",hidden:LkIp.User.canSendKkt(),text:reference.lang.kkt.headError},{xtype:"note",hidden:!LkIp.User.isClosedUser(),text:reference.lang.errors.closedUser},{xtype:"button",text:reference.lang.buttons.pdf,rel:"submit",margin:"0 15 0 0",name:"kktRegisterPdfSubmit",disabled:true,listeners:{enable:function(a){if(!LkIp.User.canSendKkt()||!LkIp.User.isActiveUser()){a.disable()}}}},{xtype:"button",text:reference.lang.buttons.signSend,rel:"submit",name:"kktRegisterSubmit",disabled:true,listeners:{enable:function(a){if(!LkIp.User.canSendKkt()||!LkIp.User.isActiveUser()){a.disable()}}}}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"3",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.kkt.registration.step3},{xtype:"component",html:"<p>"+reference.lang.kkt.registration.step3Description+"</p>"}]}]}]}]}});this.callParent(arguments)}},0,["kktRegistration"],["component","container","box","kktRegistration"],{component:true,container:true,box:true,kktRegistration:true},["widget.kktRegistration"],0,[LkIp.view.Kkt.Registration,"Index"],0));Ext.apply(Ext.form.field.VTypes,{factoryCode:function(b,a){return/^(?=.*\d)[0-9\-]+$/.test(b)},factoryCodeText:reference.lang.kkt.registration.factoryCodeValidation});(Ext.cmd.derive("LkIp.view.Kkt.Registration.File.Index",Ext.Container,{cls:"kktRegistration",initComponent:function(){var a=this;Ext.apply(a,{items:[{xtype:"form",itemId:"kktRegistrationForm",layout:"auto",border:false,items:[{xtype:"note",hidden:LkIp.User.canSendKkt(),text:reference.lang.kkt.headError},{xtype:"note",text:reference.lang.kkt.newNoticeNoteApp,itemId:"newNoticeNote",hidden:true},{xtype:"container",layout:{type:"auto"},margin:"20 0 0 0",items:[{xtype:"component",html:LkIp.Utils.header(reference.lang.pages.instruction,3),cls:"fl-l"}]},{xtype:"container",itemId:"steps",items:[{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"1",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.kkt.registration.step1},{xtype:"note",text:reference.lang.kkt.registration.step1FileDescription},{xtype:"container",defaults:{margin:"0 0 10 0"},cls:"form-file-field",items:[{xtype:"form",rel:"fileUpload",itemId:"fileUpload",layout:{type:"anchor"},disabled:!LkIp.User.canSendKkt()||!LkIp.User.isActiveUser(),border:false,items:[{xtype:"container",anchor:"100%",layout:{type:"anchor"},items:[{anchor:"100%",xtype:"filefield",name:"file",itemId:"file",clearOnSubmit:false,buttonText:reference.lang.form.file.buttonDefault,fieldLabel:"",emptyText:reference.lang.form.file.emptyText,msgTarget:"side",componentCls:"fl-l"},{xtype:"button",scale:"small",componentCls:"fl-l",anchor:"10%",disabled:true,hidden:true,text:reference.lang.buttons.reset,itemId:"resetFile",height:Ext.isIE8?24:26}]},{xtype:"component",cls:"gray",html:reference.lang.kkt.registration.fileRestrictions}]}]},{xtype:"container",hidden:true,itemId:"gridContainer",items:[{xtype:"component",html:LkIp.Utils.header("\u0421\u043f\u0438\u0441\u043e\u043a \u0444\u0430\u0439\u043b\u043e\u0432",4)},a.getGrid()]}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"2",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.kkt.registration.step2},{xtype:"component",html:"<p>"+reference.lang.kkt.registration.step2Description+"</p>"}]},{xtype:"button",rel:"submit",itemId:"signBtn",name:"signButton",disabled:true,text:reference.lang.buttons.signSend,listeners:{enable:function(b){if(!LkIp.User.canSendKkt()||!LkIp.User.isActiveUser()){b.disable()}}}}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"3",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.pages.steps.step3Statement},{xtype:"component",html:"<p>"+reference.lang.pages.steps.step3DescriptionStatement+"</p>"}]}]}]}]}]});this.callParent(arguments)},getGrid:function(){return{xtype:"gridtable",paging:false,getFileAction:false,limitFilter:false,contextMenu:false,itemId:"fileList",store:{extend:"Ext.data.ArrayStore",fields:[{name:"name",type:"string"},{name:"fn_code",type:"string"},{name:"fn_name",type:"string"},{name:"file_status",type:"string"},{name:"model_code",type:"string"},{name:"model_name",type:"string"}],autoDestroy:true,storeId:"fileListStore"},columns:[{dataIndex:"file_status",width:50,renderer:function(a){if(Ext.isEmpty(a)){return'<div class="ok-16-icon" style="margin: 0 auto;"></div>'}return'<div class="exclamation-16-icon" style="margin: 0 auto;"></div>'}},{text:reference.lang.kkt.registration.grid.name,dataIndex:"name",width:100,renderer:LkIp.Utils.stringWrap},{text:reference.lang.kkt.registration.grid.info,dataIndex:"model_name",width:350,renderer:function(b,c,a){if(Ext.isEmpty(a.get("model_name"))){return""}return'<div class="twoColumnsStripedTable twoColumnsStripedTable__grid string-wrap-by-block"><table><tbody><tr><td><div class="twoColumnsStripedTable__td-left">'+reference.lang.kkt.registration.grid.model_name+'</div></td><td><div class="twoColumnsStripedTable__td-right">'+a.get("model_name")+'</div></td></tr><tr><td><div class="twoColumnsStripedTable__td-left">'+reference.lang.kkt.registration.grid.model_code+'</div></td><td><div class="twoColumnsStripedTable__td-right">'+a.get("model_code")+'</div></td></tr><tr><td><div class="twoColumnsStripedTable__td-left">'+reference.lang.kkt.registration.grid.fn_name+'</div></td><td><div class="twoColumnsStripedTable__td-right">'+a.get("fn_name")+'</div></td></tr><tr><td><div class="twoColumnsStripedTable__td-left">'+reference.lang.kkt.registration.grid.fn_code+'</div></td><td><div class="twoColumnsStripedTable__td-right">'+a.get("fn_code")+"</div></td></tr></tbody></table></div>"}},{text:reference.lang.kkt.registration.grid.status,dataIndex:"file_status",flex:1,renderer:LkIp.Utils.stringWrap},{xtype:"actioncolumn",width:50,items:[{icon:"/images/trash.png",handler:function(b,e,a){b.getStore().removeAt(e);var c=b.getStore().getRange(),d=[];Ext.Array.each(c,function(f){if(Ext.isEmpty(f.get("file_status"))){d.push(f.getData())}});if(d.length==0){b.up("#kktRegistrationFile").down("#signBtn").disable()}}}]}]}}},0,["kktRegistrationFile"],["component","container","kktRegistrationFile","box"],{component:true,container:true,kktRegistrationFile:true,box:true},["widget.kktRegistrationFile"],0,[LkIp.view.Kkt.Registration.File,"Index"],0));(Ext.cmd.derive("LkIp.view.Kkt.ReRegistration.Index",Ext.Container,{cls:"kktReRegistration",componentCls:"kkt-with-address-panel",initComponent:function(){Ext.apply(this,{items:[{xtype:"note",text:reference.lang.kkt.newNoticeNoteApp,itemId:"newNoticeNote",hidden:true},{xtype:"component",html:LkIp.Utils.header(reference.lang.kkt.deregistrationBlock.model_title,4)},{xtype:"component",margin:"0 0 15 0",cls:"kkt_model_info",tpl:'<table class="model_info"><tr><td style="width: 20%;" class="bold">'+reference.lang.kkt.deregistrationBlock.model_name+'</td><td style="width: 17%;">{model_kkt}</td><td class="separator"></td><td class="bold" style="width: 20%;">'+reference.lang.kkt.deregistrationBlock.model_fn+'</td><td>{model_fn}</td></tr><tr><td class="bold">'+reference.lang.kkt.deregistrationBlock.model_factory_code+'</td><td>{model_factory_code}</td><td class="separator"></td><td class="bold">'+reference.lang.kkt.deregistrationBlock.model_fn_code+'</td><td>{model_fn_code}</td></tr><tr><td style="width: 20%;" class="bold">'+reference.lang.kkt.deregistrationBlock.rnm+'</td><td>{rnm}</td><td class="separator"></td><td class="bold"></td><td></td></tr><tr><tr><td colspan="5"><hr/></td> </tr><td class="bold">'+reference.lang.kkt.deregistrationBlock.address+'</td><td colspan="4">{address}</td></tr><tr><td class="bold">'+reference.lang.kkt.deregistrationBlock.ofd+'</td><td colspan="4">{ofd}</td></tr></table>',itemId:"modelInfo",data:{model_kkt:"",model_fn:"",model_factory_code:"",model_fn_code:"",address:"",ofd:""}},{xtype:"form",itemId:"kktReRegistrationForm",layout:{type:"auto"},rel:"form",border:false,fieldDefaults:{labelAlign:"left",labelWidth:320,width:885},items:[{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"1",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.kkt.reregistration.step1}]},{xtype:"component",html:'<span class="page-action-link help-tooltip" data-help="'+reference.lang.kkt.help.reregistration_reason+'">'+reference.lang.kkt.reregistration.reason.label+"</span>"+LkIp.Utils.requiredLabel()},{xtype:"checkboxgroup",columns:1,vertical:true,labelWidth:0,alwaysEnabled:true,defaults:{name:"reason_reregistration",width:"100%",alwaysEnabled:true},allowBlank:false,blankText:"\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0432\u044b\u0431\u0440\u0430\u0442\u044c \u0445\u043e\u0442\u044f \u0431\u044b \u043e\u0434\u043d\u043e \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435.",itemId:"reason_reregistration",items:[{boxLabel:"\u041f\u0435\u0440\u0435\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u041a\u041a\u0422 \u0432 \u0441\u0432\u044f\u0437\u0438 \u0441 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435\u043c \u0430\u0434\u0440\u0435\u0441\u0430 \u0438 \u043c\u0435\u0441\u0442\u0430 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438",inputValue:"1",itemId:"changeAddress",rel:"changeAddress"},{boxLabel:"\u041f\u0435\u0440\u0435\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u041a\u041a\u0422 \u0432 \u0441\u0432\u044f\u0437\u0438 \u0441\u043e \u0441\u043c\u0435\u043d\u043e\u0439 \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440\u0430 \u0444\u0438\u0441\u043a\u0430\u043b\u044c\u043d\u044b\u0445 \u0434\u0430\u043d\u043d\u044b\u0445 ",inputValue:"2",rel:"changeOfd",itemId:"changeCheckOfd"},{boxLabel:"\u041f\u0435\u0440\u0435\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u041a\u041a\u0422 \u0432 \u0441\u0432\u044f\u0437\u0438 \u0441 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435\u043c \u0441\u0432\u0435\u0434\u0435\u043d\u0438\u0439 \u043e \u043f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u0438 \u0432 \u0441\u043e\u0441\u0442\u0430\u0432\u0435 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0430",inputValue:"3",rel:"changeCalculationDevice",itemId:"changeCalculationDevice"},{boxLabel:"\u041f\u0435\u0440\u0435\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u041a\u041a\u0422 \u0432 \u0441\u0432\u044f\u0437\u0438 \u0441 \u0437\u0430\u043c\u0435\u043d\u043e\u0439 \u0444\u0438\u0441\u043a\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043d\u0430\u043a\u043e\u043f\u0438\u0442\u0435\u043b\u044f",inputValue:"4",rel:"changeFn",itemId:"changeFn"},{boxLabel:"\u041f\u0435\u0440\u0435\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u041a\u041a\u0422 \u0432 \u0441\u0432\u044f\u0437\u0438 \u0441 \u043f\u0435\u0440\u0435\u0445\u043e\u0434\u043e\u043c \u0438\u0437 \u0430\u0432\u0442\u043e\u043d\u043e\u043c\u043d\u043e\u0433\u043e \u0440\u0435\u0436\u0438\u043c\u0430 \u0432 \u043e\u0431\u044b\u0447\u043d\u044b\u0439 \u0440\u0435\u0436\u0438\u043c ",inputValue:"5",itemId:"autoToCommon",listeners:{change:function(c,d){var b=c.up("form").down("#commonToAuto"),a=c.up("form").down("#changeCheckOfd");if(d&&b.getValue()){b.setValue(false)}a.fireEvent("change",a,d)}}},{boxLabel:"\u041f\u0435\u0440\u0435\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u041a\u041a\u0422 \u0432 \u0441\u0432\u044f\u0437\u0438 \u0441 \u043f\u0435\u0440\u0435\u0445\u043e\u0434\u043e\u043c \u0438\u0437 \u043e\u0431\u044b\u0447\u043d\u043e\u0433\u043e \u0440\u0435\u0436\u0438\u043c\u0430 \u0432 \u0430\u0432\u0442\u043e\u043d\u043e\u043c\u043d\u044b\u0439",inputValue:"6",itemId:"commonToAuto",listeners:{change:function(c,d){var b=c.up("form").down("#autoToCommon");if(d&&b.getValue()){b.setValue(false)}var a=c.up("form").down("#changeCheckOfd");if(d){a.hide();a.setValue(false)}else{a.show()}}}},{boxLabel:"\u041f\u0435\u0440\u0435\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u041a\u041a\u0422 \u0432 \u0441\u0432\u044f\u0437\u0438 \u0441 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435\u043c \u043d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u041a\u041a\u0422",inputValue:"7"},{boxLabel:"\u041f\u0435\u0440\u0435\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u041a\u041a\u0422 \u0432 \u043f\u043e \u0438\u043d\u044b\u043c \u043f\u0440\u0438\u0447\u0438\u043d\u0430\u043c",inputValue:"8",itemId:"changeOtherReasons",rel:"changeOtherReasons"}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"2",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.kkt.reregistration.step2},{xtype:"container",itemId:"kktReRegistrationStep2Container",defaults:{componentCls:"step2-containers",xtype:"form"},items:[{layout:"auto",margin:"10 0 0",itemId:"step2-address-container",hidden:true,items:[{xtype:"fieldset",title:reference.lang.kkt.reregistration.addressTitle,items:[{xtype:"addressFiasBlock",itemId:"addressFIAS"},{itemId:"kktAddressBlock",hidden:true,layout:"hbox",margin:"10 0 0 ",items:[{html:'<div class="page-action-link help-tooltip" data-help="'+reference.lang.kkt.help.address+'" style="display:inline-block;">'+reference.lang.kkt.registration.address+"</div>:"+LkIp.Utils.requiredLabel(),width:320},{xtype:"container",width:"60%",items:[{xtype:"component",html:"",itemId:"address"}]}]},{xtype:"textareafield",margin:"10 0 0 0",grow:true,rows:3,labelWidth:318,anchor:"100%",name:"place_name",itemId:"place_name",fieldLabel:'<span class="page-action-link help-tooltip" data-help="'+reference.lang.kkt.help.address_place+'">'+reference.lang.kkt.registration.placeName+"</span>",maxLength:254,allowBlank:false,afterLabelTextTpl:LkIp.Utils.requiredLabel(),enforceMaxLength:true}]}]},{itemId:"step2-ofd-container",hidden:true,items:[{xtype:"fieldset",margin:"10 0 0",title:reference.lang.kkt.reregistration.ofdTitle,items:[{xtype:"filterSelect",fieldLabel:'<span class="page-action-link help-tooltip" data-help="'+reference.lang.kkt.help.ofd+'">'+reference.lang.kkt.registration.ofdFilter.label+"</span>",emptyText:reference.lang.kkt.registration.ofdFilter.empty,name:"ofd_code",itemId:"ofd_code",labelWidth:320,anchor:"100%",displayField:"value",allowBlank:false,afterLabelTextTpl:LkIp.Utils.requiredLabel(),store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Kkt.OfdFilter",autoDestroy:true,storeId:"ofdForReRegisterStore"},formScope:this,anyMatch:true,maskRe:undefined,forceSelection:false,margin:"0 0"},{xtype:"displayfield",itemId:"ofd_inn",hidden:true,fieldLabel:reference.lang.kkt.registration.ofdInn}]}]},{itemId:"step2-fn-container",hidden:true,items:[{xtype:"container",defaults:{xtype:"container",layout:"hbox",margin:"10 0 0"},items:[{items:[{componentCls:"kkt__checkbox",xtype:"checkbox",name:"flag_broken",itemId:"flagBroken",width:30,inputValue:"1"},{xtype:"component",width:"100%",html:reference.lang.kkt.registration.noCloseStatementFlag}]}]},{xtype:"container",itemId:"fiscClose",items:[{xtype:"fieldset",margin:"10 0 0",title:reference.lang.kkt.deregistrationBlock.fiscalizationTitle,items:[{xtype:"container",margin:"10 0 10 0",layout:"hbox",items:[{xtype:"filterDate",fieldLabel:'<span class="page-action-link help-tooltip" data-help="'+reference.lang.kkt.help.date_fp_close+'">'+reference.lang.kkt.fiscalization.date+"</span>",hidden:false,allowBlank:false,afterLabelTextTpl:LkIp.Utils.requiredLabel(),name:"date_fp",value:new Date(),maxValue:undefined,width:480},{xtype:"timefield",fieldLabel:"",name:"time_fp",labelWidth:0,width:70,margin:"0 0 0 5",format:"H:i",hideTrigger:true,allowBlank:false,invalidText:reference.lang.kkt.fiscalization.timeError,value:new Date()}]},{xtype:"textfield",maskRe:/[0-9]+/,minLength:1,enforceMaxLength:true,allowBlank:false,afterLabelTextTpl:LkIp.Utils.requiredLabel(),name:"kpk_number",vtype:"kpkNumber",width:600,margin:"0 0 10 0",fieldLabel:'<span class="page-action-link help-tooltip" data-help="'+reference.lang.kkt.help.kpk_number_close+'">'+reference.lang.kkt.fiscalization.kpkNumber+"</span>"},{xtype:"component",cls:"gray",hidden:true,itemId:"zerosMsg",margin:"0 0 5 0",style:{fontSize:"11px"},html:reference.lang.kkt.kpkNumberZeros},{xtype:"textfield",maskRe:/[0-9]+/,minLength:1,maxLength:10,enforceMaxLength:true,allowBlank:false,afterLabelTextTpl:LkIp.Utils.requiredLabel(),name:"kpk_value",width:600,margin:"0 0 10 0",fieldLabel:'<span class="page-action-link help-tooltip" data-help="'+reference.lang.kkt.help.kpk_value_close+'">'+reference.lang.kkt.fiscalization.kpkValue+"</span>"}]}]},{xtype:"note",itemId:"noCloseStatement",hidden:true,text:reference.lang.kkt.registration.noCloseStatement},{xtype:"fieldset",margin:"10 0 0",title:reference.lang.kkt.reregistration.newFnTitle,items:[{xtype:"container",margin:"10 0 0",defaults:{componentCls:"fl-l",xtype:"component"},items:[{html:'<span class="page-action-link help-tooltip" data-help="'+reference.lang.kkt.help.model_fn+'">'+reference.lang.kkt.registration.fnFilter.label+"</span>"+LkIp.Utils.requiredLabel(),itemId:"modelFnLabel",width:320},{xtype:"container",layout:"auto",width:500,items:[{xtype:"component",html:"",itemId:"modelFnString"},{xtype:"button",margin:"0",itemId:"editFnInRe",scale:"small",html:reference.lang.buttons.enterFn}]}]}]}]},{itemId:"step2-calculation-container",hidden:true,items:[{xtype:"checkbox",width:600,name:"in_calculation_device",itemId:"in_calculation_device",inputValue:"1",boxLabel:reference.lang.kkt.registration.in_calculation_device},{xtype:"textfield",fieldLabel:reference.lang.kkt.registration.calculation_device_number,name:"calculation_device_number",itemId:"calculation_device_number",allowBlank:false,afterLabelTextTpl:LkIp.Utils.requiredLabel()}]},{itemId:"step2-other-container",hidden:true,items:[{xtype:"container",defaults:{xtype:"container",layout:"hbox",margin:"10 0 0"},items:[{items:[{componentCls:"kkt__checkbox",xtype:"checkbox",name:"lottery",itemId:"lottery",width:30,inputValue:"1"},{xtype:"component",width:"100%",html:reference.lang.kkt.registration.lottery}]},{items:[{width:30,componentCls:"kkt__checkbox",xtype:"checkbox",name:"rates",itemId:"rates",inputValue:"1"},{xtype:"component",width:"100%",html:reference.lang.kkt.registration.rates}]},{items:[{width:30,componentCls:"kkt__checkbox",xtype:"checkbox",name:"bank",itemId:"bank",inputValue:"1"},{xtype:"component",width:"100%",html:reference.lang.kkt.registration.bank}]},{items:[{width:30,componentCls:"kkt__checkbox",xtype:"checkbox",name:"internet",itemId:"internet",inputValue:"1"},{xtype:"component",margin:"0 15 0 0",width:"100%",html:reference.lang.kkt.registration.internet}]},{margin:"0 0 0 5",layout:"auto",items:[{xtype:"component",html:'<span class="page-action-link help-tooltip" data-help="'+reference.lang.kkt.registration.web_address_help+'">'+reference.lang.kkt.registration.web_address+"</span>"+LkIp.Utils.requiredLabel(),itemId:"webAddressLabel",hidden:true},{margin:"10 0",xtype:"textareafield",grow:true,rows:3,maxLength:256,enforceMaxLength:true,name:"web_address",itemId:"web_address",vtype:"multiwebsite",msgTarget:"under",allowBlank:false,width:"100%",afterLabelTextTpl:LkIp.Utils.requiredLabel(),hidden:true,disabled:true,listeners:{show:function(a){a.up("container").down("#webAddressLabel").show()},hide:function(a){a.up("container").down("#webAddressLabel").hide()}}}]},{items:[{width:30,componentCls:"kkt__checkbox",xtype:"checkbox",name:"peddling",itemId:"peddling",inputValue:"1"},{xtype:"component",width:"100%",html:reference.lang.kkt.registration.peddling}]},{items:[{width:30,componentCls:"kkt__checkbox",xtype:"checkbox",name:"blank",itemId:"blank",inputValue:"1"},{xtype:"component",width:"100%",html:reference.lang.kkt.registration.blank}]},{items:[{width:30,componentCls:"kkt__checkbox",xtype:"checkbox",name:"akciz",itemId:"akciz",inputValue:"1"},{xtype:"component",width:"100%",html:reference.lang.kkt.registration.akciz}]},{items:[{width:30,componentCls:"kkt__checkbox",xtype:"checkbox",name:"payment_agent",itemId:"payment_agent",inputValue:"1"},{xtype:"component",width:"100%",html:reference.lang.kkt.registration.platAgent}]}]}]}]}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"3",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.kkt.reregistration.step3},{xtype:"component",html:"<p>"+reference.lang.kkt.reregistration.step3Description+"</p>"},{xtype:"note",hidden:LkIp.User.canSendKkt(),text:reference.lang.kkt.headError},{xtype:"note",hidden:!LkIp.User.isClosedUser(),text:reference.lang.errors.closedUser},{xtype:"button",text:reference.lang.buttons.pdf,rel:"submit",formBind:true,margin:"0 15 0 0",name:"kktReRegisterPdfSubmit",disabled:true,listeners:{enable:function(a){if(!LkIp.User.canSendKkt()||!LkIp.User.isActiveUser()){a.disable()}}}},{xtype:"button",text:reference.lang.buttons.signSend,rel:"submit",formBind:true,name:"kktReRegisterSubmit",disabled:true,listeners:{enable:function(a){if(!LkIp.User.canSendKkt()||!LkIp.User.isActiveUser()){a.disable()}}}}]}]}]}]});this.callParent(arguments)}},0,["kktReRegistration"],["component","container","box","kktReRegistration"],{component:true,container:true,box:true,kktReRegistration:true},["widget.kktReRegistration"],0,[LkIp.view.Kkt.ReRegistration,"Index"],0));Ext.apply(Ext.form.field.VTypes,{factoryCode:function(b,a){return/^(?=.*\d)[0-9\-]+$/.test(b)},factoryCodeText:reference.lang.kkt.registration.factoryCodeValidation,kpkNumber:function(b,a){b=parseInt(b);return b<=16777215},kpkNumberText:reference.lang.kkt.registration.kpkNumber});(Ext.cmd.derive("LkIp.view.Kkt.DeRegistration.Index",Ext.Container,{cls:"kktDeRegistration",initComponent:function(){Ext.apply(this,{items:[{xtype:"note",text:reference.lang.kkt.newNoticeNoteApp,itemId:"newNoticeNote",hidden:true},{xtype:"component",html:LkIp.Utils.header(reference.lang.kkt.deregistrationBlock.model_title,4)},{xtype:"component",margin:"0 0 15 0",cls:"kkt_model_info",tpl:'<table class="model_info"><tr><td style="width: 20%;" class="bold">'+reference.lang.kkt.deregistrationBlock.model_name+'</td><td style="width: 17%;">{model_kkt}</td><td class="separator"></td><td class="bold" style="width: 20%;">'+reference.lang.kkt.deregistrationBlock.model_fn+'</td><td>{model_fn}</td></tr><tr><td class="bold">'+reference.lang.kkt.deregistrationBlock.model_factory_code+'</td><td>{model_factory_code}</td><td class="separator"></td><td class="bold">'+reference.lang.kkt.deregistrationBlock.model_fn_code+'</td><td>{model_fn_code}</td></tr><tr><td style="width: 20%;" class="bold">'+reference.lang.kkt.deregistrationBlock.rnm+'</td><td>{rnm}</td><td class="separator"></td><td class="bold"></td><td></td></tr><tr><tr><td colspan="5"><hr/></td> </tr><td class="bold">'+reference.lang.kkt.deregistrationBlock.address+'</td><td colspan="4">{address}</td></tr><tr><td class="bold">'+reference.lang.kkt.deregistrationBlock.ofd+'</td><td colspan="4">{ofd}</td></tr></table>',itemId:"modelInfo",data:{model_kkt:"",model_fn:"",model_factory_code:"",model_fn_code:"",address:"",ofd:"",rnm:""}},{xtype:"form",itemId:"kktDeRegistrationForm",layout:{type:"auto"},rel:"form",border:false,fieldDefaults:{labelAlign:"left",labelWidth:350,width:885},items:[{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"1",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.kkt.deregistrationBlock.step1}]},{xtype:"checkboxgroup",columns:1,vertical:true,labelWidth:0,alwaysEnabled:true,defaults:{name:"reason_deregistration",width:"100%"},itemId:"reason_deregistration",items:[{boxLabel:"\u0417\u0430\u044f\u0432\u043b\u0435\u043d\u0438\u0435 \u043e \u0441\u043d\u044f\u0442\u0438\u0438 \u0441 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u043e\u043d\u043d\u043e\u0433\u043e \u0443\u0447\u0435\u0442\u0430 \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0432 \u0441\u0432\u044f\u0437\u0438 \u0441 \u0445\u0438\u0449\u0435\u043d\u0438\u0435\u043c \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044c\u043d\u043e-\u043a\u0430\u0441\u0441\u043e\u0432\u043e\u0439 \u0442\u0435\u0445\u043d\u0438\u043a\u0438",inputValue:"1"},{boxLabel:"\u0417\u0430\u044f\u0432\u043b\u0435\u043d\u0438\u0435 \u043e \u0441\u043d\u044f\u0442\u0438\u0438 \u0441 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u043e\u043d\u043d\u043e\u0433\u043e \u0443\u0447\u0435\u0442\u0430 \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0432 \u0441\u0432\u044f\u0437\u0438 \u0441 \u043f\u043e\u0442\u0435\u0440\u0435\u0439 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044c\u043d\u043e-\u043a\u0430\u0441\u0441\u043e\u0432\u043e\u0439 \u0442\u0435\u0445\u043d\u0438\u043a\u0438",inputValue:"2"}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",itemId:"step2",items:[{xtype:"component",html:"2",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.kkt.deregistrationBlock.fiscalizationTitle}]},{xtype:"container",margin:"0 0 10 0",layout:"hbox",items:[{xtype:"filterDate",fieldLabel:'<span class="page-action-link help-tooltip" data-help="'+reference.lang.kkt.help.date_fp_close+'">'+reference.lang.kkt.fiscalization.date+"</span>",hidden:false,allowBlank:false,afterLabelTextTpl:LkIp.Utils.requiredLabel(),name:"date_fp",value:new Date(),maxValue:undefined,width:480},{xtype:"timefield",fieldLabel:"",name:"time_fp",labelWidth:0,width:70,margin:"0 0 0 5",format:"H:i",hideTrigger:true,allowBlank:false,invalidText:reference.lang.kkt.fiscalization.timeError,value:new Date()}]},{xtype:"textfield",maskRe:/[0-9]+/,minLength:1,enforceMaxLength:true,allowBlank:false,afterLabelTextTpl:LkIp.Utils.requiredLabel(),name:"kpk_number",vtype:"kpkNumber",width:600,labelWidth:350,margin:"0 0 10 0",fieldLabel:'<span class="page-action-link help-tooltip" data-help="'+reference.lang.kkt.help.kpk_number_close+'">'+reference.lang.kkt.fiscalization.kpkNumber+"</span>"},{xtype:"component",cls:"gray",hidden:true,itemId:"zerosMsg",margin:"0 0 5 0",style:{fontSize:"11px"},html:reference.lang.kkt.kpkNumberZeros},{xtype:"textfield",maskRe:/[0-9]+/,minLength:1,maxLength:10,enforceMaxLength:true,allowBlank:false,afterLabelTextTpl:LkIp.Utils.requiredLabel(),name:"kpk_value",width:600,labelWidth:350,margin:"0 0 10 0",fieldLabel:'<span class="page-action-link help-tooltip" data-help="'+reference.lang.kkt.help.kpk_value+'">'+reference.lang.kkt.fiscalization.kpkValue+"</span>"}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"3",cls:"step-number",itemId:"step3Number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.kkt.deregistrationBlock.step2},{xtype:"component",html:"<p>"+reference.lang.kkt.deregistrationBlock.step2Description+"</p>"},{xtype:"note",hidden:LkIp.User.canSendKkt(),text:reference.lang.kkt.headError},{xtype:"note",hidden:!LkIp.User.isClosedUser(),text:reference.lang.errors.closedUser},{xtype:"button",text:reference.lang.buttons.pdf,rel:"submit",formBind:true,margin:"0 15 0 0",name:"kktDeRegisterPdfSubmit",listeners:{enable:function(a){if(!LkIp.User.canSendKkt()||!LkIp.User.isActiveUser()){a.disable()}}}},{xtype:"button",text:reference.lang.buttons.signSend,rel:"submit",formBind:true,name:"kktDeRegisterSubmit",listeners:{enable:function(a){if(!LkIp.User.canSendKkt()||!LkIp.User.isActiveUser()){a.disable()}}}}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"4",cls:"step-number",itemId:"step4Number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.kkt.deregistrationBlock.step3},{xtype:"component",html:"<p>"+reference.lang.kkt.deregistrationBlock.step3Description+"</p>"}]}]}]}]});this.callParent(arguments)}},0,["kktDeRegistration"],["kktDeRegistration","component","container","box"],{kktDeRegistration:true,component:true,container:true,box:true},["widget.kktDeRegistration"],0,[LkIp.view.Kkt.DeRegistration,"Index"],0));Ext.apply(Ext.form.field.VTypes,{kpkNumber:function(b,a){b=parseInt(b);return b<=16777215},kpkNumberText:reference.lang.kkt.registration.kpkNumber});(Ext.cmd.derive("LkIp.view.Kkt.FiscalReport.Index",Ext.Container,{cls:"kktRegistration fiscalReport",initComponent:function(){Ext.apply(this,{items:[{xtype:"form",itemId:"kktFiscalReportForm",layout:{type:"anchor"},disabled:!LkIp.User.canSendKkt()||!LkIp.User.isActiveUser(),rel:"form",border:false,fieldDefaults:{labelWidth:300,anchor:"100%",margin:5,msgTarget:"under"},items:[{xtype:"container",layout:{type:"anchor"},width:"100%",anchor:"100%",cls:"instruction",items:[{xtype:"component",html:"1",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.kkt.registration.step1}]},{xtype:"container",layout:"auto",width:"100%",itemId:"registrationBody",margin:"15 0 0",items:[{xtype:"fieldset",title:reference.lang.kkt.fiscalReport.fnInfo,items:[{xtype:"filterSelect",fieldLabel:reference.lang.kkt.fiscalReport.reason.label+LkIp.Utils.requiredLabel(),emptyText:reference.lang.kkt.fiscalReport.reason.emptyText,name:"reason",store:{extend:"Ext.data.ArrayStore",autoDestroy:true,fields:["code","value"],data:[{code:1,value:reference.lang.kkt.fiscalReport.reason.value1},{code:2,value:reference.lang.kkt.fiscalReport.reason.value2},{code:3,value:reference.lang.kkt.fiscalReport.reason.value3}]},allowBlank:false,displayField:"value",tpl:'<tpl for="."><li class="x-boundlist-item" role="option">{value}</li></tpl>',width:800,editable:false,typeAhead:false},{xtype:"container",defaults:{margin:"10 0 10 0",layout:"auto",xtype:"container",defaults:{componentCls:"fl-l",margin:"0 0 0 5",xtype:"component"}},items:[{itemId:"fnBlock",items:[{html:'<span class="page-action-link help-tooltip" data-help="'+reference.lang.kkt.help.model_fn+'">'+reference.lang.kkt.registration.fnFilter.label+"</span>"+LkIp.Utils.requiredLabel(),itemId:"modelFnLabel",width:300},{xtype:"container",width:"60%",items:[{xtype:"component",html:"",itemId:"modelFnString"},{xtype:"button",margin:"0",itemId:"editFn",scale:"small",html:reference.lang.buttons.enterFn}]}]}]}]},{xtype:"fieldset",title:reference.lang.kkt.fiscalReport.downloadDocs,items:[{xtype:"form",rel:"fileUpload",itemId:"fileUpload",layout:{type:"anchor"},items:[{anchor:"100%",xtype:"filefield",name:"file",itemId:"file",allowBlank:false,clearOnSubmit:false,buttonText:reference.lang.form.file.buttonDefault,fieldLabel:reference.lang.kkt.fiscalReport.fileLabel+LkIp.Utils.requiredLabel(),regex:/(.)+((\.fnc)(\w)?)$/i,regexText:reference.lang.kkt.fiscalReport.fileExtError,emptyText:reference.lang.form.file.emptyText,componentCls:"fl-l"},{xtype:"component",cls:"gray",margin:"0 0 0 5",html:reference.lang.kkt.fiscalReport.formatInfo}]}]}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"2",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.kkt.registration.step2},{xtype:"component",html:"<p>"+reference.lang.kkt.registration.step2Description+"</p>"},{xtype:"button",text:reference.lang.buttons.signSend,rel:"submit",name:"kktReportSubmit",disabled:true,listeners:{enable:function(a){if(!LkIp.User.canSendKkt()||!LkIp.User.isActiveUser()){a.disable()}}}}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"3",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.kkt.registration.step3},{xtype:"component",html:"<p>"+reference.lang.kkt.fiscalReport.step3Description+"</p>"}]}]}]}]});this.callParent(arguments)}},0,["kktFiscalReport"],["component","container","kktFiscalReport","box"],{component:true,container:true,kktFiscalReport:true,box:true},["widget.kktFiscalReport"],0,[LkIp.view.Kkt.FiscalReport,"Index"],0));(Ext.cmd.derive("LkIp.view.Kkt.Manufacturer.KktInstancesGrid",LkIp.view.Default.Grid,{itemId:"kktInstancesGrid",store:"Kkt.Manufacturer.KktInstancesStore",getFileAction:false,initComponent:function(){var a=this;Ext.apply(a,{columns:[{text:reference.lang.kkt.manufacturer.models.modelName,dataIndex:"model_name",flex:1},{text:reference.lang.kkt.manufacturer.models.factoryCode,dataIndex:"factory_code",width:200},{text:reference.lang.kkt.manufacturer.models.producedDate,dataIndex:"produced_date",width:200,renderer:function(b){return !Ext.isEmpty(b)?LkIp.Utils.getDate(b):""}}]});a.callParent(arguments)}},0,["kktInstancesGrid"],["panel","gridtable","component","tablepanel","container","grid","kktInstancesGrid","box","gridpanel"],{panel:true,gridtable:true,component:true,tablepanel:true,container:true,grid:true,kktInstancesGrid:true,box:true,gridpanel:true},["widget.kktInstancesGrid"],0,[LkIp.view.Kkt.Manufacturer,"KktInstancesGrid"],0));(Ext.cmd.derive("LkIp.view.Kkt.Manufacturer.FnInstancesGrid",LkIp.view.Default.Grid,{itemId:"fnInstancesGrid",store:"Kkt.Manufacturer.FnInstancesStore",getFileAction:false,initComponent:function(){var a=this;Ext.apply(a,{columns:[{text:reference.lang.kkt.manufacturer.fn.regNumber,dataIndex:"reg_number",width:150},{text:reference.lang.kkt.manufacturer.fn.modelName,dataIndex:"fn_name",flex:1,sortable:false},{text:reference.lang.kkt.manufacturer.fn.factoryCode,dataIndex:"factory_code",width:200},{text:reference.lang.kkt.manufacturer.fn.producedDate,dataIndex:"produced_date",width:200,renderer:function(b){return !Ext.isEmpty(b)?LkIp.Utils.getDate(b):""}}]});a.callParent(arguments)}},0,["fnInstancesGrid"],["panel","gridtable","component","tablepanel","container","grid","box","fnInstancesGrid","gridpanel"],{panel:true,gridtable:true,component:true,tablepanel:true,container:true,grid:true,box:true,fnInstancesGrid:true,gridpanel:true},["widget.fnInstancesGrid"],0,[LkIp.view.Kkt.Manufacturer,"FnInstancesGrid"],0));(Ext.cmd.derive("LkIp.view.Kkt.Manufacturer.Index",Ext.Container,{cls:"kktManufacturer",initComponent:function(){Ext.apply(this,{items:[{xtype:"container",items:[{xtype:"component",html:'<h2 class="header-uppercase">'+reference.lang.pages.kkt.manufacturer.title+"</h2>",cls:"fl-l",width:"73%"},{xtype:"container",cls:"fl-r",width:"27%",defaults:{xtype:"component",cls:"individual-help-link"},items:[LkIp.User.isKktManufacturer()?{html:'<a href="#!/kkt" class="link">'+reference.lang.kkt.kktLink+"</a>"}:{cls:"display-none"}]},{cls:"clear"}]},{xtype:"gridStatusBar",componentCls:"in-line-with-no-borders",page:"KktManufacturer",data:[{title:reference.lang.kkt.manufacturer.modelInstances,itemId:"tab-models-instances"},{title:reference.lang.kkt.manufacturer.fnInstances,itemId:"tab-fn-instances"}]},{xtype:"container",margin:"15 0 0",items:[{xtype:"container",itemId:"models-instances-block",hidden:true,items:[{xtype:"container",items:[{xtype:"container",cls:"fl-r",style:{width:"30%"},items:[{xtype:"button",componentCls:"fl-r",name:"registerKktInstances",text:reference.lang.kkt.addKktInstances,margin:"0 0 10 0",handler:function(){LkIp.Utils.goTo("#!/kkt/models/instances/registration")}}]}]},{cls:"clear"},{xtype:"defaultFilterPanel",itemId:"kktInstancesFilters",data:[{xtype:"filterSelect",lang:reference.lang.kkt.manufacturer.filters.model,name:"model_code",displayField:"value",labelWidth:250,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"kktModelsStore"},anyMatch:true,forceSelection:false,maskRe:undefined},{xtype:"defaultDateFilter",dateFieldName:"certificate_registration_date",iWidth:420,labelWidth:250,shortWidth:420,lang:reference.lang.kkt.manufacturer.filters.certificateDate,dateInnerFieldsMargin:"2 0 0 5"},{xtype:"defaultDateFilter",dateFieldName:"registration_date",iWidth:420,labelWidth:250,shortWidth:420,lang:reference.lang.kkt.manufacturer.filters.registrationDate,dateInnerFieldsMargin:"2 0 0 5"}]},{xtype:"kktInstancesGrid"}]},{xtype:"container",itemId:"fn-instances-block",hidden:true,items:[{xtype:"container",items:[{xtype:"container",cls:"fl-r",style:{width:"30%"},items:[{xtype:"button",componentCls:"fl-r",name:"registerKktInstances",text:reference.lang.kkt.addFnInstances,margin:"0 0 10 0",handler:function(){LkIp.Utils.goTo("#!/kkt/fn/instances/registration")}}]}]},{cls:"clear"},{xtype:"defaultFilterPanel",itemId:"fnInstancesFilters",data:[{xtype:"filterSelect",lang:reference.lang.kkt.manufacturer.filters.modelFn,name:"fn_code",displayField:"value",labelWidth:250,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"fnModelsStore"},anyMatch:true,forceSelection:false,maskRe:undefined},{xtype:"defaultDateFilter",dateFieldName:"produced_date",iWidth:420,labelWidth:250,shortWidth:420,lang:reference.lang.kkt.manufacturer.filters.registrationFnDate,dateInnerFieldsMargin:"2 0 0 5"}]},{xtype:"fnInstancesGrid"}]}]}]});this.callParent(arguments)}},0,["kktManufacturer"],["component","container","box","kktManufacturer"],{component:true,container:true,box:true,kktManufacturer:true},["widget.kktManufacturer"],0,[LkIp.view.Kkt.Manufacturer,"Index"],0));(Ext.cmd.derive("LkIp.view.Kkt.Manufacturer.Models.Instances.Registration.Index",Ext.Container,{cls:"kktModelInstanceRegistration iScroll",initComponent:function(){Ext.apply(this,{items:[{xtype:"form",itemId:"kktModelInstanceRegistrationForm",layout:{type:"auto"},rel:"form",border:false,fieldDefaults:{labelAlign:"left",labelWidth:600,width:880,margin:5},items:[{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"1",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.kkt.manufacturer.step1}]},{xtype:"hiddenfield",name:"no",value:"9965"},{xtype:"filterSelect",lang:reference.lang.kkt.model.registration.model.name,name:"model_code",itemId:"model_code",width:880,afterLabelTextTpl:LkIp.Utils.requiredLabel(),allowBlank:false,displayField:"value",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"kktModelInstanceModelNameStore"},formScope:this,anyMatch:true,maskRe:undefined,forceSelection:false},{xtype:"container",items:[{xtype:"simpleSelect",queryMode:"local",editable:false,itemId:"loadType",width:880,fieldLabel:reference.lang.kkt.produced.registration.item.loadType,store:[["1",reference.lang.kkt.produced.registration.item.file],["2",reference.lang.kkt.produced.registration.item.hand]],value:"1",disableTooltip:true},{xtype:"container",itemId:"loadWithFile",rel:"file-container",items:[{xtype:"form",itemId:"producedItemsUpload",layout:{type:"anchor"},border:false,items:[{xtype:"container",anchor:"100%",layout:{type:"anchor"},items:[{anchor:"100%",xtype:"filefield",name:"file",itemId:"producedFile",clearOnSubmit:false,fieldLabel:"",regex:/(.)+((\.csv)(\w)?)$/i,regexText:reference.lang.form.file.error.csv,buttonText:reference.lang.form.file.buttonDefault,msgTarget:"side",componentCls:"fl-l"},{xtype:"button",scale:"small",componentCls:"fl-l",anchor:"10%",disabled:true,hidden:true,text:reference.lang.buttons.reset,name:"resetFile",height:Ext.isIE8?24:26,margin:"6 0 0"}]}]},{xtype:"hiddenfield",allowBlank:false,name:"produced_items_file",itemId:"hiddenFile"}]},{xtype:"container",itemId:"loadByHand",hidden:true,items:[{xtype:"container",itemId:"producedItems",items:[]},{xtype:"button",text:reference.lang.kkt.produced.registration.addItem,name:"addItem"}]}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"2",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.kkt.manufacturer.step2},{xtype:"component",html:"<p>"+reference.lang.kkt.manufacturer.step2Description+"</p>"},{xtype:"button",text:reference.lang.buttons.signSend,rel:"submit",formBind:true,name:"kktModelInstanceRegister",disabled:true}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"3",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.kkt.manufacturer.step3},{xtype:"component",html:"<p>"+reference.lang.kkt.manufacturer.step3Description+"</p>"}]}]}]}]});this.callParent()}},0,["kktModelInstanceRegistration"],["component","container","box","kktModelInstanceRegistration"],{component:true,container:true,box:true,kktModelInstanceRegistration:true},["widget.kktModelInstanceRegistration"],0,[LkIp.view.Kkt.Manufacturer.Models.Instances.Registration,"Index"],0));(Ext.cmd.derive("LkIp.view.Kkt.Manufacturer.Fn.Instances.Registration.Index",Ext.Container,{cls:"kktFnInstancesRegistration iScroll",initComponent:function(){Ext.apply(this,{items:[{xtype:"form",itemId:"kktFnInstancesRegistrationForm",layout:{type:"auto"},rel:"form",border:false,fieldDefaults:{labelAlign:"left",labelWidth:500,width:800,margin:5},items:[{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"1",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.kkt.manufacturer.step1}]},{xtype:"hiddenfield",name:"no",value:"9965"},{xtype:"filterSelect",lang:reference.lang.kkt.fn.registration.fnName,name:"fn_code",itemId:"fn_code",width:800,afterLabelTextTpl:LkIp.Utils.requiredLabel(),allowBlank:false,displayField:"value",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.SelectFilters",autoDestroy:true,storeId:"fnStore"},formScope:this,anyMatch:true,maskRe:undefined,forceSelection:false},{xtype:"simpleSelect",queryMode:"local",editable:false,itemId:"loadType",width:800,fieldLabel:reference.lang.kkt.fn.produced.registration.loadType,store:[["1",reference.lang.kkt.produced.registration.item.file],["2",reference.lang.kkt.produced.registration.item.hand]],value:"1",disableTooltip:true},{xtype:"container",itemId:"loadWithFile",rel:"file-container",items:[{xtype:"form",itemId:"producedItemsUpload",layout:{type:"anchor"},border:false,items:[{xtype:"container",anchor:"100%",layout:{type:"anchor"},items:[{anchor:"100%",xtype:"filefield",name:"file",itemId:"producedFile",clearOnSubmit:false,fieldLabel:"",regex:/(.)+((\.csv)(\w)?)$/i,regexText:reference.lang.form.file.error.csv,buttonText:reference.lang.form.file.buttonDefault,msgTarget:"side",componentCls:"fl-l"},{xtype:"button",scale:"small",componentCls:"fl-l",anchor:"10%",disabled:true,hidden:true,text:reference.lang.buttons.reset,name:"resetFile",height:Ext.isIE8?24:26,margin:"6 0 0"}]}]},{xtype:"hiddenfield",allowBlank:false,name:"produced_items_file",itemId:"hiddenFile"}]},{xtype:"container",itemId:"loadByHand",hidden:true,items:[{xtype:"container",itemId:"producedItems",items:[]},{xtype:"button",text:reference.lang.kkt.fn.produced.registration.addItem,name:"addItem"}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"2",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.kkt.manufacturer.step2},{xtype:"component",html:"<p>"+reference.lang.kkt.manufacturer.step2Description+"</p>"},{xtype:"button",text:reference.lang.buttons.signSend,rel:"submit",formBind:true,name:"kktFnInstancesSubmit",disabled:true}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"3",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.kkt.manufacturer.step3},{xtype:"component",html:"<p>"+reference.lang.kkt.manufacturer.step3Description+"</p>"}]}]}]}]});this.callParent()}},0,["kktFnInstancesRegistration"],["component","container","box","kktFnInstancesRegistration"],{component:true,container:true,box:true,kktFnInstancesRegistration:true},["widget.kktFnInstancesRegistration"],0,[LkIp.view.Kkt.Manufacturer.Fn.Instances.Registration,"Index"],0));(Ext.cmd.derive("LkIp.view.SignDocumentWindow",Ext.window.Window,{autoHeight:true,layout:"auto",modal:true,ui:"nalogThemeWindow",maxWidth:550,minHeight:300,signDocumentCallback:undefined,closeCallback:undefined,buttonText:undefined,initComponent:function(){var a=this;Ext.apply(a,{defaults:{margin:15},items:[{xtype:"note",itemId:"requirements",hidden:true,text:""},{xtype:"note",itemId:"extraRequirements",hidden:true,text:""},{xtype:"container",layout:"hbox",itemId:"certificateBlock",items:[{xtype:"container",defaults:{xtype:"component"},width:"65%",margin:"0 10 0 0",items:[{itemId:"emptyCertificateBlock",html:'<div class="certificate__empty"><div><span class="exclamation-16-icon certificate__empty-icon"><span class="certificate__empty-header">\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0432\u044b\u0431\u0440\u0430\u0442\u044c \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442</span> </span></div><div><span class="certificate__empty-help">\u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445 \u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0435</span></div></div>'},{itemId:"selectedCertificate",hidden:true,tpl:'<div class="certificateList"><div class="certificateList__valid"><div class="certificateList__items"><div class="certificateList__row"><div class="certificateList__item certificateList__item-active certificateList__item-fullWidth"><div class="certificateList__item-inner"><div class="certificateList__item-header"><span class="certificateList__item-icon certificateList__item-header-label">'+reference.lang.certificateWindow.certificate+'</span> </div><div class="certificateList__item-label">{validity_string}</div><div class="certificateList__item-content"><div class="certificateList__item-formGroup"><span class="certificateList__item-label">'+reference.lang.certificateWindow.owner+'</span> <span class="certificateList__item-value">{owner}</span></div><div class="certificateList__item-formGroup"><span class="certificateList__item-label">'+reference.lang.certificateWindow.subjectName+'</span> <span class="certificateList__item-value">{name}</span></div><div class="certificateList__item-formGroup"><span class="certificateList__item-label">'+reference.lang.certificateWindow.inn+'</span> <span class="certificateList__item-value">{inn}</span></div><div class="certificateList__item-formGroup"><span class="certificateList__item-label">'+reference.lang.certificateWindow.ogrnIp+'</span> <span class="certificateList__item-value">{ogrnip}</span></div><div class="certificateList__item-formGroup"><span class="certificateList__item-label">'+reference.lang.certificateWindow.issuerName+'</span> <span class="certificateList__item-value">{issuer}</span></div></div><div class="certificateList__item-help">{thumbprint}</div></div></div></div></div></div></div>'}]},{xtype:"button",componentCls:"fl-r",text:reference.lang.buttons.chooseCertificate,itemId:"chooseCertificate",handler:function(b){a.fireEvent("chooseCertificate",b)}}]}],bbar:[{text:Ext.isEmpty(a.buttonText)?reference.lang.buttons.signSend:a.buttonText,itemId:"signBtn",disabled:true,handler:function(b){a.fireEvent("signSend",b)}},{text:reference.lang.buttons.close,itemId:"closeBtn",handler:function(b){a.close()}}]});a.callParent(arguments)}},0,["signDocumentWindow"],["panel","window","component","container","signDocumentWindow","box"],{panel:true,window:true,component:true,container:true,signDocumentWindow:true,box:true},["widget.signDocumentWindow"],0,[LkIp.view,"SignDocumentWindow"],0));(Ext.cmd.derive("LkIp.view.CertificateListWindow",Ext.window.Window,{autoHeight:true,layout:"auto",modal:true,ui:"nalogThemeWindow",autoScroll:true,width:Ext.isIE8?800:"60%",height:Ext.isIE8?500:"70%",signDocumentWindow:undefined,selectedCertificateId:undefined,componentCls:"certificateList realCertificateList",title:reference.lang.certificateWindow.selectCertificateTitle,getSignDocumentWindow:function(){return this.signDocumentWindow},initComponent:function(){var a=this;Ext.apply(a,{defaults:{margin:15},items:[{xtype:"note",itemId:"certificate",hidden:true,text:reference.lang.certificateWindow.noCertificates},{xtype:"container",itemId:"certificates",layout:"auto",items:[{xtype:"container",itemId:"validCertificates",defaults:{xtype:"component"},cls:"certificateList__valid",items:[{cls:"certificateList__header",html:reference.lang.certificateWindow.availableCertificates},{itemId:"validCertificatesList",tpl:'<div class="certificateList__items"><div class="certificateList__row"><tpl for="."><div class="certificateList__item <tpl if="active">certificateList__item-active</tpl> certificate-afc" data-certificateIdentifier="{certificateIdentifier}"><div class="certificateList__item-inner"><div class="certificateList__item-header"><span class="certificateList__item-icon certificateList__item-header-label">'+reference.lang.certificateWindow.certificate+'</span> </div><div class="certificateList__item-label">{validity_string}</div><div class="certificateList__item-content"><div class="certificateList__item-formGroup"><span class="certificateList__item-label">'+reference.lang.certificateWindow.owner+'</span> <span class="certificateList__item-value">{owner}</span> </div><div class="certificateList__item-formGroup"><span class="certificateList__item-label">'+reference.lang.certificateWindow.subjectName+'</span> <span class="certificateList__item-value">{name}</span> </div><div class="certificateList__item-formGroup"><span class="certificateList__item-label">'+reference.lang.certificateWindow.inn+'</span> <span class="certificateList__item-value">{inn}</span> </div><div class="certificateList__item-formGroup"><span class="certificateList__item-label">'+reference.lang.certificateWindow.snils+'</span> <span class="certificateList__item-value">{snils}</span> </div><div class="certificateList__item-formGroup"><span class="certificateList__item-label">'+reference.lang.certificateWindow.ogrnIp+'</span> <span class="certificateList__item-value">{ogrnip}</span> </div><div class="certificateList__item-formGroup"><span class="certificateList__item-label">'+reference.lang.certificateWindow.issuerName+'</span> <span class="certificateList__item-value">{issuer}</span> </div></div><div class="certificateList__item-help">{thumbprint}</div></div></div></tpl></div></div>'}]},{xtype:"container",hidden:true,itemId:"invalidCertificates",defaults:{xtype:"component"},cls:"certificateList__invalid",items:[{html:"<hr/>",margin:"0 0 15 0"},{cls:"certificateList__header",html:reference.lang.certificateWindow.notAvailableCertificates},{itemId:"invalidCertificatesList",tpl:'<div class="certificateList__items"><div class="certificateList__row"><tpl for="."><div class="certificateList__item"><div class="certificateList__item-inner"><div class="certificateList__item-header"><span class="certificateList__item-icon certificateList__item-header-label">'+reference.lang.certificateWindow.certificate+'</span><div class="certificateList__item-error">{invalid_reason}</div></div><div class="certificateList__item-label <tpl if="dateFault">certificateList__item-error</tpl> ">{validity_string}</div><div class="certificateList__item-content"><div class="certificateList__item-formGroup"><span class="certificateList__item-label">'+reference.lang.certificateWindow.owner+'</span> <span class="certificateList__item-value <tpl if="ulFault">certificateList__item-error</tpl> ">{owner}</span> </div><div class="certificateList__item-formGroup"><span class="certificateList__item-label">'+reference.lang.certificateWindow.subjectName+'</span> <span class="certificateList__item-value <tpl if="nameFault">certificateList__item-error</tpl> ">{name}</span> </div><div class="certificateList__item-formGroup"><span class="certificateList__item-label">'+reference.lang.certificateWindow.inn+'</span> <span class="certificateList__item-value <tpl if="innFault">certificateList__item-error</tpl> ">{inn}</span> </div><div class="certificateList__item-formGroup"><span class="certificateList__item-label">'+reference.lang.certificateWindow.snils+'</span> <span class="certificateList__item-value">{snils}</span> </div><div class="certificateList__item-formGroup"><span class="certificateList__item-label">'+reference.lang.certificateWindow.ogrnIp+'</span> <span class="certificateList__item-value <tpl if="ogrnIpFault">certificateList__item-error</tpl> ">{ogrnip}</span> </div><div class="certificateList__item-formGroup"><span class="certificateList__item-label">'+reference.lang.certificateWindow.issuerName+'</span> <span class="certificateList__item-value">{issuer}</span> </div></div></div></div></tpl></div></div>'}]}]}],bbar:[{text:reference.lang.buttons.choose,itemId:"chooseCertificate",disabled:true,handler:function(b){a.fireEvent("chooseCertificate",b)}},{text:reference.lang.buttons.close,itemId:"closeBtn",handler:function(b){a.close()}}]});a.callParent(arguments)}},0,["certificateListWindow"],["panel","window","component","container","certificateListWindow","box"],{panel:true,window:true,component:true,container:true,certificateListWindow:true,box:true},["widget.certificateListWindow"],0,[LkIp.view,"CertificateListWindow"],0));(Ext.cmd.derive("LkIp.view.SignCheck.Index",Ext.form.Panel,{rel:"form",layout:"auto",cls:"signcheck iScroll",defaults:{margin:5},initComponent:function(){Ext.apply(this,{items:[{xtype:"container",items:[{xtype:"note",text:reference.lang.signcheck.reinstallPlugin},{xtype:"note",text:reference.lang.signcheck.note},{xtype:"container",width:"80%",cls:"fl-l",margin:"0 15 0 0",items:[{xtype:"container",cls:"info__block",itemId:"infoBlock",layout:"hbox",items:[{xtype:"component",cls:"icon-note-icon",margin:"0 10 0 0"},{xtype:"component",cls:"info__block-text",html:reference.lang.signcheck.requirements.info}]},{xtype:"component",itemId:"errorBlock",cls:"error__block",hidden:true,tpl:'<div class="info__block-text">{msg}</div><div>{description}</div>'},{xtype:"component",itemId:"successBlock",cls:"success__block",hidden:true,tpl:'<div class="info__block-text">'+reference.lang.signcheck.success+"</div><div>"+reference.lang.signcheck.successD+"</div><div>"+reference.lang.signcheck.version+" {pVersion}</div><div>"+reference.lang.signcheck.csp+" {csp} ({cspV})</div>"}]},{xtype:"container",layout:"auto",cls:"fl-l",width:"15%",items:[{xtype:"button",itemId:"startCheck",text:reference.lang.signcheck.requirements.startCheck},{xtype:"button",itemId:"continueCheck",hidden:true,text:reference.lang.signcheck.requirements.continueCheck},{xtype:"button",itemId:"reCheck",hidden:true,text:reference.lang.signcheck.requirements.reCheck}]}]},{xtype:"container",layout:{type:"auto"},margin:"15 0",items:[{xtype:"component",html:LkIp.Utils.header(reference.lang.signcheck.programs,3),cls:"fl-l"}]},{xtype:"container",margin:0,itemId:"step-plugin",cls:"check__step check__question",layout:"auto",items:[{xtype:"component",width:"10%",cls:"check__step-item check__step-item-icon",html:'<div class="check__step-icon"></div>'},{xtype:"container",cls:"check__step-item check__step-item-content",items:[{xtype:"component",cls:"check__step-header",html:reference.lang.signcheck.requirements.plugin},{xtype:"component",itemId:"textInfo",cls:"check__step-text",html:"<div>"+reference.lang.signcheck.requirements.pluginInfo+"</div><div>"+reference.lang.signcheck.requirements.pluginInfoDownloadLink+"</div><div>"+reference.lang.signcheck.requirements.pluginInfoDownloadLink2+"</div>"+(Ext.isChrome?"<div>"+reference.lang.signcheck.requirements.pluginInfoDownloadLinkChrome+"</div>":"")+(Ext.isOpera?"<div>"+reference.lang.signcheck.requirements.pluginInfoDownloadLinkOpera+"</div>":"")+"<div>&nbsp;</div>"},{xtype:"component",itemId:"textError",cls:"check__step-text",hidden:true}]}]},{xtype:"container",margin:0,itemId:"step-csp",cls:"check__step check__question",layout:"auto",items:[{xtype:"component",cls:"check__step-item check__step-item-icon",html:'<div class="check__step-icon"></div>'},{xtype:"container",cls:"check__step-item check__step-item-content",items:[{xtype:"component",cls:"check__step-header",html:reference.lang.signcheck.requirements.csp},{xtype:"component",cls:"check__step-text",itemId:"textInfo",html:"<div>&nbsp;</div>"},{xtype:"component",itemId:"textError",cls:"check__step-text",hidden:true}]}]},{xtype:"container",margin:0,itemId:"step-certificate",cls:"check__step check__question",layout:"auto",items:[{xtype:"component",cls:"check__step-item check__step-item-icon",html:'<div class="check__step-icon"></div>'},{xtype:"container",layout:"auto",cls:"check__step-item check__step-item-content",items:[{xtype:"component",cls:"check__step-header",html:reference.lang.signcheck.requirements.cert},{xtype:"component",cls:"check__step-text",itemId:"textInfo",html:"<div>"+reference.lang.signcheck.requirements.certInfo+"</div><div>&nbsp;</div>"},{xtype:"component",itemId:"textError",cls:"check__step-text",hidden:true}]}]},{xtype:"container",margin:0,itemId:"step-test-sign",cls:"check__step check__question",layout:"auto",items:[{xtype:"component",cls:"check__step-item check__step-item-icon",html:'<div class="check__step-icon"></div>'},{xtype:"container",cls:"check__step-item check__step-item-content",items:[{xtype:"component",cls:"check__step-header",html:reference.lang.signcheck.requirements.testSign},{xtype:"component",cls:"check__step-text",itemId:"textInfo",html:"<div>&nbsp;</div>"},{xtype:"component",itemId:"textError",cls:"check__step-text",hidden:true}]}]}]});this.callParent()}},0,["signcheck"],["panel","form","component","container","signcheck","box"],{panel:true,form:true,component:true,container:true,signcheck:true,box:true},["widget.signcheck"],[[LkIp.view.Scrolling.prototype.mixinId||LkIp.view.Scrolling.$className,LkIp.view.Scrolling]],[LkIp.view.SignCheck,"Index"],0));(Ext.cmd.derive("LkIp.view.CertificatePinWindow",Ext.window.Window,{autoHeight:true,layout:"auto",modal:true,ui:"nalogThemeWindow",width:300,minHeight:150,bindCertificate:undefined,closable:false,initComponent:function(){var a=this;Ext.apply(a,{defaults:{margin:15},items:[{margin:"15",xtype:"textfield",name:"pin",itemId:"pin",fieldLabel:"",inputType:"password",allowBlank:false,minLength:3,labelWidth:0,width:200}],bbar:[{text:reference.lang.buttons.enter,itemId:"enterPin",disabled:true,handler:function(b){a.fireEvent("enterPin",b)}}]});a.callParent(arguments)}},0,["certificatePinWindow"],["panel","window","component","container","box","certificatePinWindow"],{panel:true,window:true,component:true,container:true,box:true,certificatePinWindow:true},["widget.certificatePinWindow"],0,[LkIp.view,"CertificatePinWindow"],0));(Ext.cmd.derive("LkIp.view.AddressFIASPanel",Ext.panel.Panel,{layout:"auto",ui:"nalogThemeWindow",width:870,required:'<span class="form-required-field" data-qtip="'+reference.lang.form.required+'">*</span>',autoMode:undefined,indexEl:undefined,noAutonom:undefined,componentCls:"address-panel-fias",rootEl:undefined,initComponent:function(){var a=this;Ext.apply(a,{items:[{xtype:"container",layout:"anchor",itemId:"mainAddressBlock",defaults:{margin:"5 0 0 0"},items:[{xtype:"component",margin:"0 10 10 0",html:'<span><a href="/docs/\u0421\u043f\u0440\u0430\u0432\u043a\u0430 \u043f\u043e \u0432\u0432\u043e\u0434\u0443 \u0430\u0434\u0440\u0435\u0441\u0430.pdf" download="'+reference.lang.address.manual.filename+'" target="_blank">'+reference.lang.address.manual.linkname+"</a></span>",style:"text-align: right"},{xtype:"container",layout:"hbox",items:[{xtype:"textfield",width:a.width-7,margin:"0 0 0 0",labelWidth:320,disabled:false,readOnly:false,name:"addressString",itemId:"addressString",ttip:reference.lang.kkt.help.address,fieldLabel:'<span class="page-action-link help-tooltip" data-help="'+reference.lang.kkt.help.address+'">'+reference.lang.kkt.registration.address+"</span>",afterLabelTextTpl:'<span class="red">*</span>',allowBlank:false,anchor:"90%"},{xtype:"component",hidden:true,html:'<div class="edit-icon delete-icon cancelEditAddress"></div>',itemId:"cancelEditAddress",margin:0,anchor:"10%"}]},{xtype:"component",itemId:"wrongAddress",html:'<span class="red">'+reference.lang.address.wrongAddress+"</span>",hidden:true},{xtype:"component",itemId:"notFullAddress",html:'<span class="red">'+reference.lang.address.notFullAddress+"</span>",hidden:true},{xtype:"component",itemId:"emptyNo",html:'<span class="red">'+reference.lang.address.emptyNo+"</span>",hidden:true},{xtype:"component",itemId:"fiasNot",html:'<span class="red">'+reference.lang.address.fiasNotAvailable+"</span>",hidden:true},{itemId:"addressBlock",hidden:true,width:"95%",margin:"5 0 0 50",defaults:{margin:"0 0 0 0",labelWidth:270},items:[{xtype:"displayfield",submitValue:true,name:"region",itemId:"region",fieldLabel:reference.lang.address.regionCode},{xtype:"displayfield",submitValue:true,name:"region_name",itemId:"region_name",fieldLabel:reference.lang.address.region},{xtype:"displayfield",submitValue:true,hidden:true,name:"no",itemId:"noFromAddress"},{xtype:"displayfield",submitValue:true,name:"district",itemId:"district",fieldLabel:reference.lang.address.district},{xtype:"displayfield",submitValue:true,name:"city",itemId:"city",fieldLabel:reference.lang.address.city},{xtype:"displayfield",submitValue:true,name:"locality",itemId:"locality",fieldLabel:reference.lang.address.locality2},{xtype:"displayfield",submitValue:true,name:"street",itemId:"street",fieldLabel:reference.lang.address.street2},{xtype:"displayfield",submitValue:true,name:"house",itemId:"house",fieldLabel:reference.lang.address.house},{xtype:"displayfield",submitValue:true,name:"housing",itemId:"housing",fieldLabel:reference.lang.address.housing},{xtype:"component",itemId:"responsibility",html:'<span class="red">'+reference.lang.address.responsibility+"</span>",hidden:true},{xtype:"container",items:[{cls:"fl-l",style:{width:"33%!important"},items:[{xtype:"label",html:reference.lang.address.apartment+":"}]},{cls:"fl-l",style:{width:"30%!important"},items:[{xtype:"simpleSelect",queryMode:"local",disableTooltip:true,itemId:"apartmentType",name:"apartmentType",width:220,labelWidth:40,fieldLabel:reference.lang.address.type,store:[[0,"-\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0442\u0438\u043f \u043f\u043e\u043c\u0435\u0449\u0435\u043d\u0438\u044f-"],["\u043f\u043e\u043c\u0435\u0449.","\u041f\u043e\u043c\u0435\u0449\u0435\u043d\u0438\u0435"],["\u043a\u0432.","\u041a\u0432\u0430\u0440\u0442\u0438\u0440\u0430"],["\u043e\u0444\u0438\u0441 ","\u041e\u0444\u0438\u0441"],["\u043a\u043e\u043c. ","\u041a\u043e\u043c\u043d\u0430\u0442\u0430"],["\u0433-\u0436 ","\u0413\u0430\u0440\u0430\u0436"],["\u043f-\u0431 ","\u041f\u043e\u0433\u0440\u0435\u0431"],["\u043f\u043e\u0434\u0432.","\u041f\u043e\u0434\u0432\u0430\u043b"],["\u0440\u0430\u0431.\u0443\u0447.","\u0420\u0430\u0431\u043e\u0447\u0438\u0439 \u0443\u0447\u0430\u0441\u0442\u043e\u043a"],["\u0442\u043e\u0440\u0433. \u0437\u0430\u043b ","\u0422\u043e\u0440\u0433\u043e\u0432\u044b\u0439 \u0437\u0430\u043b"],["\u0441\u043a\u043b.","\u0421\u043a\u043b\u0430\u0434"],["\u0446\u0435\u0445 ","\u0426\u0435\u0445"],["\u043f\u0430\u0432","\u041f\u0430\u0432\u0438\u043b\u044c\u043e\u043d"]]}]},{cls:"fl-l",style:{width:"25%!important"},items:[{xtype:"textfield",submitValue:true,name:"apartment",itemId:"apartment",maxLength:50,enforceMaxLength:true,fieldLabel:reference.lang.address.number,labelWidth:60,width:200}]}]},{xtype:"component",itemId:"apartmentHelpMessage",width:"65%",html:'<span class="gray">'+reference.lang.address.apartmentHelpMessage+"</span>",margin:"5 0 5 275",hidden:true},{xtype:"displayfield",submitValue:true,name:"postcode",itemId:"postcode",fieldLabel:reference.lang.address.postcode}]}]}],listeners:{afterrender:function(){$("input[name='addressString']").suggestions({serviceURL:"https://suggestions.dadata.ru/suggestions/api/4_1/rs",token:"0773ded29e41732c7894587dbb9602b418b91b1c",type:"ADDRESS",deferRequestBy:100,minChars:3,count:5,onSelect:function(b){a.fireEvent("selectAddressFIAS",b,1,a)},onSelectNothing:function(b){a.down("#addressString").blur()}})}}});a.callParent(arguments)}},0,["addressFiasBlock"],["panel","component","container","addressFiasBlock","box"],{panel:true,component:true,container:true,addressFiasBlock:true,box:true},["widget.addressFiasBlock"],0,[LkIp.view,"AddressFIASPanel"],0));(Ext.cmd.derive("LkIp.view.Employees.Identification.Index",Ext.Container,{cls:"employeesIdentification",initComponent:function(){var a=this;Ext.apply(a,{items:[{xtype:"form",itemId:"statementForm",layout:{type:"anchor"},border:false,items:[{xtype:"container",layout:{type:"auto"},margin:"20 0 0 0",items:[{xtype:"component",html:LkIp.Utils.header(reference.lang.pages.instruction,3),cls:"fl-l"}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"1",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.employeesIdentification.step1},{xtype:"note",itemId:"blockPageInfo",hidden:true,text:reference.lang.employeesIdentification.blockText},{xtype:"simpleSelect",componentCls:"form-element-right w-300",queryMode:"local",editable:false,itemId:"loadType",anchor:"100%",width:"100%",labelWidth:"30%",fieldLabel:reference.lang.employeesIdentification.loadType,store:[["1",reference.lang.kkt.produced.registration.item.file],["2",reference.lang.kkt.produced.registration.item.hand]],value:"1",disableTooltip:true},{xtype:"container",itemId:"fileContainer",items:[{xtype:"note",text:reference.lang.employeesIdentification.step1FileDescription},{xtype:"container",defaults:{margin:"0 0 10 0"},cls:"form-file-field",items:[{xtype:"form",rel:"fileUpload",itemId:"fileUpload",layout:{type:"anchor"},border:false,items:[{xtype:"container",anchor:"100%",layout:{type:"anchor"},items:[{anchor:"100%",xtype:"filefield",name:"file",itemId:"file",clearOnSubmit:false,buttonText:reference.lang.form.file.buttonDefault,fieldLabel:"",regex:/(.)+((\.xml)(\w)?)$/i,regexText:reference.lang.form.file.error.xml,emptyText:reference.lang.form.file.emptyText,msgTarget:"side",allowBlank:false,componentCls:"fl-l"},{xtype:"button",scale:"small",componentCls:"fl-l",anchor:"10%",disabled:true,hidden:true,text:reference.lang.buttons.reset,itemId:"resetFile",height:Ext.isIE8?24:26}]},{xtype:"component",cls:"gray",html:reference.lang.employeesIdentification.fileRestrictions}]}]}]},{xtype:"container",itemId:"manualContainer",hidden:true,items:[{xtype:"component",html:LkIp.Utils.header(reference.lang.employeesIdentification.employeesHeader,3)},{xtype:"component",html:"<hr/>"},{xtype:"note",text:reference.lang.employeesIdentification.employeesHelp},{xtype:"container",itemId:"manualContainerItems",items:[]},{xtype:"button",formBind:true,disabled:true,itemId:"addManualItem",text:reference.lang.buttons.add}]}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"2",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.pages.steps.step2},{xtype:"component",html:"<p>"+reference.lang.pages.steps.step2Description+"</p>"}]},{xtype:"button",rel:"submit",itemId:"signBtn",name:"signButton",disabled:true,formBind:true,text:reference.lang.buttons.signSend}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"3",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.pages.steps.step3},{xtype:"component",html:"<p>"+reference.lang.pages.steps.step3Description+"</p>"}]}]}]}]});this.callParent(arguments)}},0,["employeesIdentification"],["component","container","employeesIdentification","box"],{component:true,container:true,employeesIdentification:true,box:true},["widget.employeesIdentification"],0,[LkIp.view.Employees.Identification,"Index"],0));(Ext.cmd.derive("LkIp.view.Consent.Index",Ext.Container,{cls:"employeesIdentification",initComponent:function(){var a=this;Ext.apply(a,{items:[{xtype:"form",rel:"form",itemId:"consentForm",layout:{type:"anchor"},border:false,items:[{xtype:"container",layout:{type:"auto"},margin:"20 0 0 0",items:[{xtype:"component",html:LkIp.Utils.header(reference.lang.pages.instruction,3),cls:"fl-l"}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"1",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.consent.step1},{xtype:"note",itemId:"blockPageInfo",hidden:true,text:reference.lang.employeesIdentification.blockText},{xtype:"simpleSelect",queryMode:"local",editable:false,itemId:"loadType",anchor:"100%",width:890,labelWidth:350,fieldLabel:reference.lang.consent.loadType,store:[["1",reference.lang.consent.writeType],["2",reference.lang.consent.fileType]],value:"1",disableTooltip:true},{xtype:"container",itemId:"manualContainer",defaults:{width:890,labelWidth:350},items:[{xtype:"displayfield",fieldLabel:reference.lang.consent.createDocDate,name:"create_date",submitValue:true,value:LkIp.Utils.getNowDate()},{xtype:"displayfield",fieldLabel:reference.lang.consent.codeNo,name:"codeNo",value:LkIp.User.get("head")["SvedUchet"]["@KodNalOrg"]+" - "+LkIp.User.get("head")["SvedUchet"]["@ImyaNalOrg"]},{xtype:"container",width:"100%",items:[{xtype:"radiogroup",rel:"fullPart",fieldLabel:reference.lang.consent.agreeText+":",width:"100%",labelWidth:"40%",labelSeparator:"",allowBlank:false,columns:1,items:[{boxLabel:reference.lang.consent.allData,name:"fullPart",inputValue:"1",checked:true},{boxLabel:reference.lang.consent.partData,name:"fullPart",inputValue:"2"}]}]},{xtype:"container",hidden:true,marginTop:"10",itemId:"partDocContainer",defaults:{xtype:"container",layout:"hbox",margin:"5 0 0 0"},items:[{xtype:"component",width:"100%",html:reference.lang.consent.selectData+LkIp.Utils.requiredLabel()+":",margin:"15 0 0 0"},{xtype:"note",hidden:true,layout:{type:"auto"},margin:"10 0",itemId:"chooseOneHelp",text:reference.lang.consent.chooseOne},{items:[{xtype:"component",margin:"0 15 0 0",width:700,html:'<span class="page-action-link help-tooltip" data-help="'+reference.lang.consent.data01Desc+'">'+reference.lang.consent.data01+"</span>"},{margin:0,width:50,componentCls:"kkt__checkbox",xtype:"checkbox",name:"data01",itemId:"data01",rel:"cbx",inputValue:"1"}]},{items:[{xtype:"component",margin:"0 15 0 0",width:700,html:'<span class="page-action-link help-tooltip" data-help="'+reference.lang.consent.data02Desc+'">'+reference.lang.consent.data02+"</span>"},{margin:0,width:50,componentCls:"kkt__checkbox",xtype:"checkbox",name:"data02",itemId:"data02",rel:"cbx",inputValue:"1"}]},{items:[{xtype:"component",margin:"0 15 0 0",width:700,html:'<span class="page-action-link help-tooltip" data-help="'+reference.lang.consent.data03Desc+'">'+reference.lang.consent.data03+"</span>"},{margin:0,width:50,componentCls:"kkt__checkbox",xtype:"checkbox",name:"data03",itemId:"data03",rel:"cbx",inputValue:"1"}]},{items:[{xtype:"component",margin:"0 15 0 0",width:700,html:'<span class="page-action-link help-tooltip" data-help="'+reference.lang.consent.data04Desc+'">'+reference.lang.consent.data04+"</span>"},{margin:0,width:50,componentCls:"kkt__checkbox",xtype:"checkbox",name:"data04",itemId:"data04",rel:"cbx",inputValue:"1"}]},{items:[{xtype:"component",margin:"0 15 0 0",width:700,html:'<span class="page-action-link help-tooltip" data-help="'+reference.lang.consent.data05Desc+'">'+reference.lang.consent.data05+"</span>"},{margin:0,width:50,componentCls:"kkt__checkbox",xtype:"checkbox",name:"data05",itemId:"data05",rel:"cbx",inputValue:"1"}]},{items:[{xtype:"component",margin:"0 15 0 0",width:700,html:'<span class="page-action-link help-tooltip" data-help="'+reference.lang.consent.data06Desc+'">'+reference.lang.consent.data06+"</span>"},{margin:0,width:50,componentCls:"kkt__checkbox",xtype:"checkbox",name:"data06",itemId:"data06",rel:"cbx",inputValue:"1"}]},{items:[{xtype:"component",margin:"0 15 0 0",width:700,html:'<span class="page-action-link help-tooltip" data-help="'+reference.lang.consent.data07Desc+'">'+reference.lang.consent.data07+"</span>"},{margin:0,width:50,componentCls:"kkt__checkbox",xtype:"checkbox",name:"data07",itemId:"data07",rel:"cbx",inputValue:"1"}]},{items:[{xtype:"component",margin:"0 15 0 0",width:700,html:'<span class="page-action-link help-tooltip" data-help="'+reference.lang.consent.data08Desc+'">'+reference.lang.consent.data08+"</span>"},{margin:0,width:50,componentCls:"kkt__checkbox",xtype:"checkbox",name:"data08",itemId:"data08",rel:"cbx",inputValue:"1"}]},{items:[{xtype:"component",margin:"0 15 0 0",width:700,html:'<span class="page-action-link help-tooltip" data-help="'+reference.lang.consent.data09Desc+'">'+reference.lang.consent.data09+"</span>"},{margin:0,width:50,componentCls:"kkt__checkbox",xtype:"checkbox",name:"data09",itemId:"data09",rel:"cbx",inputValue:"1"}]},{items:[{xtype:"component",margin:"0 15 0 0",width:700,html:'<span class="page-action-link help-tooltip" data-help="'+reference.lang.consent.data10Desc+'">'+reference.lang.consent.data10+"</span>"},{margin:0,width:50,componentCls:"kkt__checkbox",xtype:"checkbox",name:"data10",itemId:"data10",rel:"cbx",inputValue:"1"}]},{items:[{xtype:"component",margin:"0 15 0 0",width:700,html:'<span class="page-action-link help-tooltip" data-help="'+reference.lang.consent.data11Desc+'">'+reference.lang.consent.data11+"</span>"},{margin:0,width:50,componentCls:"kkt__checkbox",xtype:"checkbox",name:"data11",itemId:"data11",rel:"cbx",inputValue:"1"}]},{items:[{xtype:"component",margin:"0 15 0 0",width:700,html:'<span class="page-action-link help-tooltip" data-help="'+reference.lang.consent.data12Desc+'">'+reference.lang.consent.data12+"</span>"},{margin:0,width:50,componentCls:"kkt__checkbox",xtype:"checkbox",name:"data12",itemId:"data12",rel:"cbx",inputValue:"1"}]},{items:[{xtype:"component",margin:"0 15 0 0",width:700,html:'<span class="page-action-link help-tooltip" data-help="'+reference.lang.consent.data13Desc+'">'+reference.lang.consent.data13+"</span>"},{margin:0,width:50,componentCls:"kkt__checkbox",xtype:"checkbox",name:"data13",itemId:"data13",rel:"cbx",inputValue:"1"}]},{items:[{xtype:"component",margin:"0 15 0 0",width:700,html:'<span class="page-action-link help-tooltip" data-help="'+reference.lang.consent.data14Desc+'">'+reference.lang.consent.data14+"</span>"},{margin:0,width:50,componentCls:"kkt__checkbox",xtype:"checkbox",name:"data14",itemId:"data14",rel:"cbx",inputValue:"1"}]},{xtype:"textfield",name:"otherText",itemId:"otherText",hidden:true,disabled:true,width:890,labelWidth:350,fieldLabel:reference.lang.consent.otherText,enforceMaxLength:true,allowBlank:false,afterLabelTextTpl:LkIp.Utils.requiredLabel()}]},{xtype:"container",layout:"hbox",margin:"10 10 0 0",items:[{xtype:"component",width:"40%",html:reference.lang.consent.period+":",margin:"0 10 0 0"},{xtype:"filterDate",name:"date_from",itemId:"date_from",hidden:false,fieldLabel:"\u0441"+LkIp.Utils.requiredLabel(),labelWidth:20,width:150,hideEmptyLabel:false,allowBlank:false,margin:"1 0 0 5",maxValue:new Date(),minValue:"01.01.2014"},{xtype:"filterDate",name:"date_to",hidden:false,fieldLabel:"\u043f\u043e",labelWidth:25,width:150,hideEmptyLabel:false,margin:"1 0 0 5",maxValue:undefined,minValue:"01.01.2014"}]}]},{xtype:"container",hidden:true,itemId:"fileContainer",items:[{xtype:"note",text:reference.lang.consent.step1FileDescription},{xtype:"container",defaults:{margin:"0 0 10 0"},cls:"form-file-field",items:[{xtype:"form",rel:"fileUpload",itemId:"fileUpload",layout:{type:"anchor"},border:false,items:[{xtype:"component",cls:"gray",html:reference.lang.consent.fileRestrictions},{xtype:"container",anchor:"100%",layout:{type:"anchor"},items:[{anchor:"100%",xtype:"filefield",name:"file",itemId:"file",clearOnSubmit:false,allowBlank:false,disabled:true,buttonText:reference.lang.form.file.buttonDefault,fieldLabel:"",regex:/(.)+((\.xml)(\w)?)$/i,regexText:reference.lang.form.file.error.xml,emptyText:reference.lang.form.file.emptyText,msgTarget:"side",componentCls:"fl-l"},{xtype:"button",scale:"small",componentCls:"fl-l",anchor:"10%",disabled:true,hidden:true,text:reference.lang.buttons.reset,itemId:"resetFile",height:Ext.isIE8?24:26}]}]}]}]}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"2",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.pages.steps.step2},{xtype:"component",html:"<p>"+reference.lang.pages.steps.step2Description+"</p>"}]},{xtype:"button",rel:"submit",itemId:"signBtn",name:"signButton",formBind:true,text:reference.lang.buttons.signSend}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"3",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.pages.steps.step3},{xtype:"component",html:"<p>"+reference.lang.pages.steps.step3Description+"</p>"}]}]}]}]});this.callParent(arguments)}},0,["consent"],["consent","component","container","box"],{consent:true,component:true,container:true,box:true},["widget.consent"],0,[LkIp.view.Consent,"Index"],0));(Ext.cmd.derive("LkIp.view.Foreign.Index",Ext.Container,{cls:"employeesIdentification",initComponent:function(){var a=this;Ext.apply(a,{items:[{xtype:"form",rel:"form",itemId:"foreignForm",layout:{type:"anchor"},border:false,items:[{xtype:"container",layout:{type:"auto"},margin:"20 0 0 0",items:[{xtype:"component",html:LkIp.Utils.header(reference.lang.pages.instruction,3),cls:"fl-l"}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"1",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.foreign.step1},{xtype:"note",itemId:"blockPageInfo",hidden:true,text:reference.lang.employeesIdentification.blockText},{xtype:"container",hidden:true,itemId:"manualContainer",defaults:{width:890,labelWidth:350},items:[]},{xtype:"container",itemId:"fileContainer",items:[{xtype:"note",text:reference.lang.foreign.step1FileDescription},{xtype:"container",defaults:{margin:"0 0 10 0"},cls:"form-file-field",items:[{xtype:"form",rel:"fileUpload",itemId:"fileUpload",layout:{type:"anchor"},border:false,items:[{xtype:"component",cls:"gray",html:reference.lang.foreign.fileRestrictions},{xtype:"container",anchor:"100%",layout:{type:"anchor"},items:[{anchor:"100%",xtype:"filefield",name:"file",itemId:"file",clearOnSubmit:false,allowBlank:false,buttonText:reference.lang.form.file.buttonDefault,fieldLabel:"",regex:/(.)+((\.xml)(\w)?)$/i,regexText:reference.lang.form.file.error.xml,emptyText:reference.lang.form.file.emptyText,msgTarget:"side",componentCls:"fl-l"},{xtype:"button",scale:"small",componentCls:"fl-l",anchor:"10%",disabled:true,hidden:true,text:reference.lang.buttons.reset,itemId:"resetFile",height:Ext.isIE8?24:26}]}]}]}]}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"2",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.foreign.step2},{xtype:"component",html:"<p>"+reference.lang.foreign.step2Description+"</p>"}]},{xtype:"button",rel:"submit",itemId:"signBtn",name:"signButton",formBind:true,text:reference.lang.buttons.signSend}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"3",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.pages.steps.step3},{xtype:"component",html:"<p>"+reference.lang.pages.steps.step3Description+"</p>"}]}]}]}]});this.callParent(arguments)}},0,["foreign"],["component","container","box","foreign"],{component:true,container:true,box:true,foreign:true},["widget.foreign"],0,[LkIp.view.Foreign,"Index"],0));(Ext.cmd.derive("LkIp.view.ServiceUnavailable.Index",Ext.Container,{initComponent:function(){var a=this;Ext.apply(a,{items:[{xtype:"note",margin:"20 0 0",html:"\u0423\u0432\u0430\u0436\u0430\u0435\u043c\u044b\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c! \u0414\u0430\u043d\u043d\u044b\u0439 \u0441\u0435\u0440\u0432\u0438\u0441 \u0432 \u043d\u0430\u0441\u0442\u043e\u044f\u0449\u0435\u0435 \u0432\u0440\u0435\u043c\u044f \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d. \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u043f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u044c \u043f\u043e\u043f\u044b\u0442\u043a\u0443 \u043f\u043e\u0437\u0434\u043d\u0435\u0435.<br/>\u041f\u0440\u0438\u043d\u043e\u0441\u0438\u043c \u0438\u0437\u0432\u0438\u043d\u0435\u043d\u0438\u044f \u0437\u0430 \u0434\u043e\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u043d\u044b\u0435 \u043d\u0435\u0443\u0434\u043e\u0431\u0441\u0442\u0432\u0430."}]});this.callParent(arguments)}},0,["serviceUnavailable"],["serviceUnavailable","component","container","box"],{serviceUnavailable:true,component:true,container:true,box:true},["widget.serviceUnavailable"],0,[LkIp.view.ServiceUnavailable,"Index"],0));(Ext.cmd.derive("LkIp.view.Viewport",Ext.Container,{id:"viewport",layout:"auto",defaultLastPageString:'<div class="last-page-item"><a href="{0}">{1}</a></div>',initComponent:function(){var a=this,c=LkIp.User.isInspector(),d=LkIp.User.isClosedUser(),b=LkIp.User.get("inn");Ext.apply(this,{items:[{xtype:"container",cls:"links-fixed-block",items:[{xtype:"container",layout:{type:"auto"},cls:"toolbar links-bar",items:[{xtype:"component",cls:"fl-l",html:(!c&&!d?'<a class="feedback-link" href="#!/feedback">'+reference.lang.viewport.feedback+"</a>":"")+(!c?'<a class="faq-link" href="/faq">'+reference.lang.viewport.faq+"</a>":"")},{xtype:"component",cls:"fl-r",html:(!c?'<a id="lk2check" class="lk2check flk offset">'+reference.lang.viewport.lkFl+"</a>":"")+'<a class="exit-link logout">'+reference.lang.viewport.exit+"</a>"}]}]},{xtype:"container",cls:"wrapper",items:[{cls:"top-block",itemId:"header-element",xtype:"container",items:[{xtype:"container",layout:{type:"auto"},cls:"clear header",defaults:{xtype:"component"},items:[{cls:"fl-l wrap-logo",html:'<a href="https://nalog.ru"><div class="fl-l logo"></div></a>'},{xtype:"container",cls:"fl-l left",defaults:{xtype:"component"},layout:{type:"auto"},items:[{cls:"title",html:reference.lang.viewport.fnsTitle},{cls:"service-title",html:reference.lang.viewport.lkTitle}]},{xtype:"container",cls:"fl-l right",layout:{type:"auto"},items:[{xtype:"container",cls:"user-info",itemId:"user-info",items:[{xtype:"component",itemId:"inspectorFio",html:'<div class="fio">'+(c?("\u0418\u043d\u0441\u043f\u0435\u043a\u0442\u043e\u0440: {inspectorName}"):("&nbsp;"))+"</div>"},{cls:"clear"},{xtype:"component",itemId:"fio",tpl:'<div class="fio">{name}</div>'},{cls:"clear"},{xtype:"component",itemId:"inn-ogrn-block",tpl:'<table class="inn-ogrn-block"><tr><td id="user-info-ogrn" class="user-info-element">'+reference.lang.user.ogrn+':</td><td>{ogrn}</td></tr><tr><td id="user-info-inn" class="user-info-element">'+reference.lang.user.inn+":</td><td>{inn}</td></tr></table>"}]}]}]}]},{cls:"clear"},{xtype:"container",cls:"main",id:"main-content",itemId:"main-content",layout:"auto",items:[{xtype:"toolbar",itemId:"breadcrumbs",cls:"breadcrumbs",hidden:true},{xtype:"component",itemId:"pageTitle",tpl:'<tpl for="."><tpl if="title != \'\'"><h2 class="header-uppercase">{title}</h2></tpl></tpl>'},{xtype:"note",hidden:true,itemId:"mainPageInformation"},{xtype:"container",id:"content-container",itemId:"content-container",cls:"content-container",layout:{type:"card",deferredRender:true},defaults:{listeners:{activate:function(e){},deactivate:function(e){var f=Ext.query(".x-mask");if(!Ext.isEmpty(f)){Ext.Array.each(f,function(g){Ext.get(g).setStyle("display","none")})}LkIp.app.getController("Content").hideNoTooltips()},scope:this}},items:[{xtype:"index",id:"index"},{xtype:"serviceUnavailable",id:"serviceUnavailable"}]},{cls:"clear"}]}]},!c&&!d?{xtype:"component",html:'<a class="questionary-link" href="http://www.nalog.ru/rn52/service/anket/" target="_blank"></a>'}:{cls:"display-none"},{xtype:"container",cls:"footer",items:{xtype:"container",cls:"footer-frame",items:{xtype:"container",cls:"footer-holder",items:[!c&&!d?{xtype:"container",cls:"support",items:[{xtype:"component",html:'<span class="support-text"><a target="_blank" href="https://www.nalog.ru/rn77/service/service_feedback/?service=50&INN='+b+'">'+reference.lang.viewport.techSupport+"</a></span> "}]}:{cls:"display-none"},!c&&!d?{xtype:"container",cls:"support",items:[{xtype:"component",html:'<span class="support-text"><a href="#!/feedback">'+reference.lang.viewport.feedback+"</a></span> "}]}:{cls:"display-none"},!c?{xtype:"container",cls:"support",items:[{xtype:"component",html:'<span class="support-text"><a href="/faq">'+reference.lang.viewport.faq+"</a></span> "}]}:{cls:"display-none"},{xtype:"container",cls:"copy-div",items:[{xtype:"component",cls:"copy",html:"&copy; 2013-"+Ext.Date.format(new Date(),"Y")+" \u0424\u041d\u0421 \u0420\u043e\u0441\u0441\u0438\u0438"},{xtype:"component",cls:"date-renew",html:"\u0414\u0430\u0442\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b "+LkIp.app.lastmodified}]},{xtype:"container",cls:"help-link",items:[{xtype:"component",html:'<p><a class="link showMainVideoAgain">\u0412\u0438\u0434\u0435\u043e\u043c\u0430\u0442\u0435\u0440\u0438\u0430\u043b: \u0420\u0430\u0431\u043e\u0442\u0430 \u0432 \u043b\u0438\u0447\u043d\u043e\u043c \u043a\u0430\u0431\u0438\u043d\u0435\u0442\u0435 \u0438\u043d\u0434\u0438\u0432\u0438\u0434\u0443\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043f\u0440\u0435\u0434\u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u0435\u043b\u044f</a></p>'},{xtype:"component",html:'<p><a class="link" href="/docs/lkip_manual.doc">'+reference.lang.viewport.helpWork+"</a></p>"}]}]}}}]});this.callParent(arguments)},listeners:{afterrender:function(a){if(LkIp.User.isInspector()){a.down("#inspectorFio").update({inspectorName:LkIp.User.get("inspectorName")})}a.down("#fio").update({name:LkIp.User.get("organizationName")});a.down("#inn-ogrn-block").update({inn:LkIp.User.get("inn"),ogrn:LkIp.User.get("ogrn")});if(LkIp.User.isJacartaUser()){jaCarta.onTokenRemoved(function(){if(!jaCarta.hasAnyToken()){LkIp.app.getController("Viewport").jacartaTokenError()}});jaCarta.onTokenAdded(function(){if(!jaCarta.initialized()){jaCarta.initialize()}})}}},setHtmlPageTitle:function(a){a=Ext.util.Format.stripTags(a);if(!this.origTitle){this.origTitle=document.title}document.title=a?(a+" - "+this.origTitle):this.origTitle}},0,["LkIpViewport"],["LkIpViewport","component","container","box"],{LkIpViewport:true,component:true,container:true,box:true},["widget.LkIpViewport"],0,[LkIp.view,"Viewport"],0));Ext.apply(Ext.form.field.VTypes,{website:function(c,b){var a=/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})).?)(?::\d{2,})?(?:[/?#]\S*)?$/i;return a.test(c)},websiteText:reference.lang.kkt.registration.webSiteValidation,multiwebsite:function(e,c){var d=e.split(/;/g),a=true,b=/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})).?)(?::\d{2,})?(?:[/?#]\S*)?$/i;Ext.Array.each(d,function(f){f=Ext.String.trim(f);if(f.length==0){return true}if(!b.test(Ext.String.trim(f))){a=false;return false}});return a},multiwebsiteText:reference.lang.kkt.registration.webSiteValidationM});(Ext.cmd.derive("LkIp.model.Filters.DocumentTypes",Ext.data.Model,{fields:["code","value","type","regexpr",{name:"qtip",type:"string",convert:function(b,a){return a.get("value")}},{name:"fullName",type:"string",convert:function(c,a){var b=a.get("code");return(0!==b?b+"-":"")+a.get("value")}},{name:"shortName",type:"string",convert:function(b,a){var c=a.get("value");return a.get("code")+"-"+Ext.String.ellipsis(c,40,true)}},{name:"filterValue",type:"string",convert:function(d,a){var b="",c=a.get("code");if("0"!=c){b=c+"-"}return b+a.get("value")}}],idProperty:"code"},0,0,0,0,0,0,[LkIp.model.Filters,"DocumentTypes"],0));(Ext.cmd.derive("LkIp.controller.RegistrationViewport",Ext.app.Controller,{refs:[{ref:"index",selector:"#LkIpRegistrationViewport"},{ref:"innCheckWindow",selector:"registrationInnCheck"},{ref:"userDataWindow",selector:"registrationUserData"},{ref:"setPasswordWindow",selector:"registrationSetPasswordCert"}],signedAgreement:undefined,models:["Filters.DocumentTypes"],init:function(){var a=Ext.getBody();a.addListener("click",this.generatePicture,this,{preventDefault:true,delegate:"#newCaptcha"});this.control({LkIpRegistrationViewport:{render:function(){var b=this;Ext.get("agreement-text").on("load",function(){b.generatePicture()})},afterrender:function(){var b=this,c=LkIp.User.get("inn");if(Ext.isEmpty(c)||"000000000000"==c){b.registerParams=Ext.Object.merge(b.getIndex().down("#registration-form").getValues(),{signedAgreement:"",checkInn:true});b.sendRegisterRequest()}}},'LkIpRegistrationViewport [name="registrationSignAgreement"]':{click:this.signAgreementAction},'LkIpRegistrationViewport [name="registrationNextStep"]':{click:this.registerAction},'registrationUserData [name="registrationUserDataNextStep"]':{click:this.enterUserDataAction},'registrationUserData [name="documentType"]':{change:this.changeDocumentTypeAction},'registrationSetPasswordCert [name="password"]':{change:this.changePasswordAction},'registrationSetPasswordCert [name="registrationSetPasswordNextStep"]':{click:this.enterPasswordAction}})},registerParams:{},onLaunch:function(){},loading:function(a){this.getIndex().down("#registration").setLoading(a)},signAgreementAction:function(){var b=this,c=b.getIndex().down('[name="inn"]').getValue(),a=b.getIndex().down('[name="ogrnIp"]').getValue();if(Ext.isEmpty(c)||Ext.isEmpty(a)){LkIp.Msg.error("\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0437\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043f\u043e\u043b\u044f: \u0418\u041d\u041d \u0438 \u041e\u0413\u0420\u041d\u0418\u041f.");return false}LkIp.Request.request({url:"/api/user/register/getHashAgreement",scope:b,method:"POST",params:{agreement:LkIp.Signature.getCryptoApi().base64.encode(b.getAgreementText()),inn:c,ogrnip:a}},function(d){LkIp.app.getController("Viewport").signAction(d,{loader:b.getIndex(),withoutSigning:true,successCallback:function(e){b.loading(false);if(!Ext.isEmpty(e)&&Ext.isObject(e)){b.signedAgreement=e.signHash;b.hashId=e.id}else{b.signedAgreement=1}b.getIndex().down('[name="registrationSignAgreement"]').hide();b.getIndex().down("#signedAgreementSuccess").show()},errorCallback:function(e){b.loading(false);LkIp.Msg.error((Ext.isEmpty(e)||Ext.isObject(e))?"\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u0442\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u0434\u043f\u0438\u0441\u0430\u043d\u0438\u0438 \u0441\u043e\u0433\u043b\u0430\u0448\u0435\u043d\u0438\u044f":e)}})})},getAgreementText:function(){var a=Ext.get("agreement-text").dom.contentDocument.body.innerText;if(Ext.isEmpty(a)){a=Ext.get("agreement-text").dom.contentDocument.body.textContent}return a},registerAction:function(){var a=this;if(Ext.isEmpty(a.signedAgreement)||"false"===a.signedAgreement||false===a.signedAgreement){LkIp.Msg.error('\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u043f\u0440\u043e\u0447\u0438\u0442\u0430\u0442\u044c \u0438 \u043f\u043e\u0434\u043f\u0438\u0441\u0430\u0442\u044c \u0441\u043e\u0433\u043b\u0430\u0448\u0435\u043d\u0438\u0435 \u043e\u0431 \u043e\u0442\u043a\u0440\u044b\u0442\u0438\u0438 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u0441\u0435\u0440\u0432\u0438\u0441\u0443 "\u041b\u0438\u0447\u043d\u044b\u0439 \u043a\u0430\u0431\u0438\u043d\u0435\u0442 \u043d\u0430\u043b\u043e\u0433\u043e\u043f\u043b\u0430\u0442\u0435\u043b\u044c\u0449\u0438\u043a\u0430 \u0438\u043d\u0434\u0438\u0432\u0438\u0434\u0443\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043f\u0440\u0435\u0434\u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0442\u0435\u043b\u044f".');return false}a.registerParams=Ext.Object.merge(a.getIndex().down("#registration-form").getValues(),{signedAgreement:a.signedAgreement,hashId:a.hashId,registrationType:"cert"});a.sendRegisterRequest()},sendRegisterRequest:function(){var a=this;a.loading(true);LkIp.Request.setMaxAttempts(20).request({url:"/api/user/register/cert",method:"POST",params:a.registerParams,scope:this},function(b){a.loading(false);if(false!==b){if(1==b.status){window.location.reload()}else{switch(b.response.code){case"PARAMS_ERROR":LkIp.Msg.error("\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0432\u0432\u0435\u0434\u0435\u043d\u043d\u044b\u0445 \u0432 \u0444\u043e\u0440\u043c\u0443 \u0434\u0430\u043d\u043d\u044b\u0445.");break;case"CAPTCHA_ERROR":LkIp.Msg.error("\u0426\u0438\u0444\u0440\u044b \u0441 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0438 \u0432\u0432\u0435\u0434\u0435\u043d\u044b \u043d\u0435\u0432\u0435\u0440\u043d\u043e.");a.getIndex().down('[name="captcha"]').reset();a.generatePicture();break;case"INN_CHECK":a.setInn(b.response.data.inn);break;case"DELAYED_REGISTRATION":case"FID_PROBLEMS":if(Ext.isEmpty(a.registerParams.documentType)){a.runUserDataEnter()}else{a.delayedRegistration()}break;case"ACTIVITY_CANCELED":LkIp.Error.eLoginEgrip();break;case"ABSENT_USER":LkIp.Error.e403();break;case"INN_OGRN_EGRIP_MISMATCH_ERROR":LkIp.Error.invalidData();break;case"ACCESS_DENIED":LkIp.Error.cancelled();break;case"NO_OGRNIP":LkIp.Error.auth();break;case"INVALID_FIO_BY_FID_COMPARE":LkIp.Error.fio();break;case"INN_INCORRECT":LkIp.Error.incorrectInn();break;case"USER_WITHOUT_LKFL_PASSWORD_ERROR":LkIp.Error.noLkFlPassword();break;case"INCORRECT_FIO_SNILS_ERROR":LkIp.Error.invalidFioOrSnils();break;case"INCORRECT_SNILS_ERROR":LkIp.Error.invalidFioOrSnils("snils");break;case"INCORRECT_FIO_ERROR":LkIp.Error.invalidFioOrSnils("fio");break;default:if(!Ext.isEmpty(b.response.msg)){LkIp.Msg.error(b.response.msg)}else{LkIp.Error.technicalProblems()}break}}}else{if(Ext.isEmpty(a.registerParams.documentType)){a.runUserDataEnter()}else{LkIp.Error.technicalProblems();return false}}})},delayedRegistration:function(){var a=this;a.loading(true);LkIp.Request.request({url:"/api/user/delayedRegister",params:a.registerParams,method:"POST",scope:this},function(b){a.loading(false);LkIp.Msg.success(reference.lang.registrationPassword.delayedMsgWithEmail,{rewriteDefaultButtons:true,buttons:[{text:reference.lang.buttons.ok,handler:function(){LkIp.Auth.logout(function(){LkIp.Settings.cleanStore()},"/");a.loading(true);LkIp.Msg.fireEvent("closemessagebox",LkIp.Msg);LkIp.Msg.close()}}]})})},setInn:function(b){var a=this;a.getIndex().down('[name="inn"]').setValue(b)},generatePicture:function(){Ext.get("captchaImage").set({src:"/generateCaptcha?"+new Date().getTime()})},enterUserDataAction:function(){var b=this,a=b.getUserDataWindow().down("#registration-user-data").getValues();a.seriesNumber=Ext.String.trim(a.seriesNumber);b.registerParams=Ext.Object.merge(b.registerParams,a);b.getUserDataWindow().close();b.sendRegisterRequest()},runUserDataEnter:function(){var a=this;Ext.create("LkIp.view.Registration.UserData").show();a.documentTypesStore=Ext.getStore("registrationDocumentType");a.getUserDataWindow().setLoading(true);LkIp.Request.request({url:"/api/filters/getDocumentTypes",method:"GET"},function(b){a.getUserDataWindow().setLoading(false);if(LkIp.Utils.isJsonSuccess(b)){a.documentTypesStore.loadData(b.response);a.getUserDataWindow().down('[name="documentType"]').setValue("21")}else{LkIp.Msg.error("\u0412\u043e\u0437\u043d\u0438\u043a\u043b\u0438 \u0442\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0442\u0440\u0443\u0434\u043d\u043e\u0441\u0442\u0438. \u041f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438 \u043f\u043e\u0437\u0436\u0435.")}})},changeDocumentTypeAction:function(b,e){var d=this,a=d.getUserDataWindow().down("#documentInfo");a.removeAll();if(0!=e){var f=b.valueModels[0].getData(),c=d.getMaskedInputPlugin(e,f.regexpr);a.add(Ext.apply({xtype:"textfield",name:"seriesNumber",itemId:"seriesNumber",fieldLabel:reference.lang.registration.userInfo.seriesNumber,anchor:"100%",allowBlank:false,afterLabelTextTpl:d.getUserDataWindow().required,labelWidth:150,plugins:c},"01"===e?{validator:function(g){if(/(?=[CLXVI])((C{0,3})?((X[LC])|(L?XX{0,2})|L)?((I[VX])|(V?(II{0,2}))|V)?)-[-]{2}\s[0-9]{6}/.test(g)){return true}else{return reference.lang.registration.errors.sssrPasport}}}:{}))}},getMaskedInputPlugin:function(b,a){if("01"===b){return[]}else{if("04"===b||"07"===b){a="\u0411\u0411 9999990"}}return[new LkIp.plugins.MaskedInput(a,{placeholder:" ",exclude:["-"]})]}},0,0,0,0,0,0,[LkIp.controller,"RegistrationViewport"],0));(Ext.cmd.derive("LkIp.controller.ActivationViewport",Ext.app.Controller,{refs:[{ref:"index",selector:"#LkIpActivationViewport"}],init:function(){this.control({'LkIpActivationViewport [name="activationChangeEmail"]':{click:this.activateAction}})},activateAction:function(){var b=this,a=b.getIndex(),c=a.down("form").getValues();if(1==LkIp.User.get("changeEmail")){c.updateProfile=true}a.setLoading(true);LkIp.Request.request({url:"/api/user/register/updateEmail",method:"POST",params:c,scope:b},function(d){a.setLoading(false);if(false!==d&&!Ext.isEmpty(d.response)&&1==d.status){LkIp.Msg.success(reference.lang.registration.activation.success)}else{LkIp.Msg.error(reference.lang.registration.activation.failure)}})}},0,0,0,0,0,0,[LkIp.controller,"ActivationViewport"],0));(Ext.cmd.derive("LkIp.controller.DelayedRegistrationViewport",Ext.app.Controller,{refs:[{ref:"index",selector:"#LkIpDelayedRegistrationViewport"}],init:function(){this.control({'LkIpDelayedRegistrationViewport [name="delayedChangeEmail"]':{click:this.changeEmailAction},'LkIpDelayedRegistrationViewport [name="logout"]':{click:this.logout}})},changeEmailAction:function(){var b=this,a=b.getIndex(),c=a.down("form").getValues(),d=a.down("#delayedInfo");a.setLoading(true);LkIp.Request.request({url:"/api/user/register/updateDelayedEmail",method:"POST",params:c,scope:b},function(e){a.setLoading(false);if(1==e.status){if(!Ext.isEmpty(d)){d.update({email:c.email})}LkIp.Msg.success(reference.lang.registration.delayed.success)}else{LkIp.Msg.error(Ext.isString(e.response)?e.response:reference.lang.errors.serverError)}})},logout:function(){this.getIndex().setLoading(true);LkIp.Auth.logout(function(){LkIp.Settings.cleanStore()},"/")}},0,0,0,0,0,0,[LkIp.controller,"DelayedRegistrationViewport"],0));(Ext.cmd.derive("LkIp.controller.RegistrationPasswordViewport",Ext.app.Controller,{refs:[{ref:"index",selector:"#LkIpRegistrationPasswordViewport"},{ref:"errorBlock",selector:"#error-block"}],failureAttempts:0,init:function(){var a=Ext.getBody();a.addListener("click",this.generatePicture,this,{preventDefault:true,delegate:"#newCaptcha"});this.control({"#LkIpRegistrationPasswordViewport #ogrnipForm #ogrnipStepBtn":{click:this.sendOgrnip},"#LkIpRegistrationPasswordViewport #passwordForm #passwordStepBtn":{click:this.repeatRegistration},"#LkIpRegistrationPasswordViewport #finishForm #finishStepBtn":{click:this.completeRegistration},'#LkIpRegistrationPasswordViewport #finishForm [name="password"]':{change:this.resetRules}})},onLaunch:function(){},loadIndex:function(){var c=this,b=c.getIndex();if(!Ext.isEmpty(c.registerData)&&1==c.registerData.status&&c.registerData.response.errorCode!=="captcha"){b.down("#passwordForm").hide().getForm().reset();b.down("#ogrnipForm").hide().getForm().reset();b.down("#finishForm").hide().getForm().reset();b.down("#captchaContainer").hide();b.down('[name="captcha"]').reset();b.down('[name="captcha"]').disable();c.getErrorBlock().hide()}if(!Ext.isEmpty(c.registerData)){if(1==c.registerData.status&&Ext.isEmpty(c.registerData.response.errorCode)){b.down("#ogrnipForm").show();b.down('[name="fid"]').setValue(c.registerData.response.fid);c.failureAttempts=0}else{if(0==c.registerData.status||Ext.isEmpty(c.registerData.response)){LkIp.Error.technicalProblems();b.down('[name="captcha"]').reset();return}if(!Ext.isEmpty(c.registerData.response.errorCode)){if(c.registerData.response.errorCode=="captcha"){if(c.failureAttempts>0){LkIp.Msg.error(reference.lang.registrationPassword.errors.captchaError);return}else{b.down("#errorNote").setText(reference.lang.registrationPassword.errors.error99);c.getErrorBlock().show()}}if(c.registerData.response.errorCode!=="10"){var a=!Ext.isEmpty(reference.lang.registrationPassword.errors["error"+c.registerData.response.errorCode])?reference.lang.registrationPassword.errors["error"+c.registerData.response.errorCode]:reference.lang.errors.serverError;b.down("#errorNote").setText(a);c.getErrorBlock().show()}else{c.failureAttempts=parseInt(c.registerData.response.failureAttempts);b.down("#passwordForm").show();if(c.failureAttempts>3){c.generatePicture();b.down("#captchaContainer").show();b.down('[name="captcha"]').enable()}}}}}else{LkIp.Error.technicalProblems()}},sendOgrnip:function(){var b=this,a=b.getIndex();LkIp.Request.request({url:"/api/user/register/check-ip",method:"POST",params:b.getIndex().down("#ogrnipForm").getValues()},function(c){if(LkIp.Utils.isJsonSuccess(c)){b.getIndex().down("#ogrnipForm").hide();if(!Ext.isEmpty(c.response.ogrnip)){b.getIndex().down('#finishForm [name="inn"]').setValue(b.registerData.response.inn);b.getIndex().down('#finishForm [name="ogrnip"]').setValue(b.getIndex().down('#ogrnipForm [name="ogrnip"]').getValue());b.getIndex().down("#finishForm").show()}else{if(!Ext.isEmpty(c.response.endDate)){a.down("#errorNote").setText(Ext.String.format(reference.lang.registrationPassword.ogrnipNotFound,b.registerData.response.inn,b.getIndex().down('#ogrnipForm [name="ogrnip"]').getValue()));b.getErrorBlock().show()}else{a.down("#errorNote").setText(c.response.errorCode=="01"?reference.lang.registrationPassword.errors.egripError:reference.lang.registrationPassword.errors.error99);b.getErrorBlock().show()}}}else{LkIp.Error.technicalProblems()}})},repeatRegistration:function(){var b=this,a=b.getIndex(),c=a.down("#passwordForm").getValues();c.inn=b.registerData.response.inn;c.repeat=1;a.setLoading(true);LkIp.Request.setMaxAttempts(20).request({url:"/api/user/register/password",method:"POST",params:c,scope:b},function(d){a.setLoading(false);b.registerData=d;b.loadIndex()})},completeRegistration:function(){var b=this,a=b.getIndex();b.registerParams=a.down("#finishForm").getValues();a.setLoading(true);LkIp.Request.setMaxAttempts(20).request({url:"/api/user/register/password/complete",method:"POST",params:a.down("#finishForm").getValues(),scope:b},function(c){a.setLoading(false);if(1==c.status){LkIp.Msg.success(reference.lang.registrationPassword.success,{rewriteDefaultButtons:true,buttons:[{text:reference.lang.buttons.ok,handler:function(){window.location="/";LkIp.Msg.fireEvent("closemessagebox",LkIp.Msg);LkIp.Msg.close()}}]})}else{switch(c.response.code){case"CAPTCHA_ERROR":LkIp.Msg.error(reference.lang.registrationPassword.errors.captchaError);break;case"ACTIVITY_CANCELED":LkIp.Error.eLoginEgrip();break;case"DELAYED_REGISTRATION":b.delayedRegistration();break;case"INN_OGRN_EGRIP_MISMATCH_ERROR":LkIp.Error.invalidData();break;case"ACCESS_DENIED":LkIp.Error.cancelled();break;case"NO_OGRNIP":LkIp.Error.auth();break;default:if(!Ext.isEmpty(c.response.msg)){LkIp.Msg.error(c.response.msg)}else{LkIp.Error.technicalProblems()}return false}}b.getIndex().down('[name="captcha"]').reset();b.generatePicture()})},delayedRegistration:function(){var a=this;if(Ext.isEmpty(a.registerParams.email)){return}if(typeof a.registerData.response.no!="undefined"){a.registerParams.emailNo=a.registerData.response.no.email}a.getIndex().setLoading(true);LkIp.Request.request({url:"/api/user/delayedRegister",params:a.registerParams,method:"POST",scope:this},function(c){a.getRegistrationForm().setLoading(false);var b=(!Ext.isEmpty(a.registerParams.email)?reference.lang.registrationPassword.delayedMsgWithEmail:reference.lang.registrationPassword.delayedMsg);LkIp.Msg.success(b,{rewriteDefaultButtons:true,buttons:[{text:reference.lang.buttons.ok,handler:function(){LkIp.Auth.logout(function(){LkIp.Settings.cleanStore()},"/");a.getIndex().setLoading(true);LkIp.Msg.fireEvent("closemessagebox",LkIp.Msg);LkIp.Msg.close()}}]})})},setRegisterData:function(a){this.registerData=a},generatePicture:function(){Ext.get("captchaImage").set({src:"/generateCaptcha?"+new Date().getTime()})},resetRules:function(d,c){var b=this,a=b.getIndex();if(c===""){Ext.form.field.VTypes.passwordLetters(c,d)}a.down("#passwordConfirmed").allowBlank=Ext.isEmpty(c);a.down("#passwordConfirmed").isValid()}},0,0,0,0,0,0,[LkIp.controller,"RegistrationPasswordViewport"],0));(Ext.cmd.derive("LkIp.controller.GuestViewport",Ext.app.Controller,{refs:[{ref:"viewport",selector:"#guestViewport",autoCreate:true}],init:function(){var a=this;a.control({"#guestViewport":{afterrender:function(){LkIp.app.getController("Calculator").loadIndex()}}})}},0,0,0,0,0,0,[LkIp.controller,"GuestViewport"],0));(Ext.cmd.derive("LkIp.controller.InnEnterViewport",Ext.app.Controller,{refs:[{ref:"index",selector:"#LkIpInnEnterViewport"}],init:function(){this.control({"LkIpInnEnterViewport #enterInnNextStep":{click:this.enterInnAction}})},enterInnAction:function(){var a=this;a.getIndex().setLoading(true);LkIp.Request.request({url:"/api/auth/updateInn",method:"POST",params:{inn:a.getIndex().down("#inn").getValue()},scope:a},function(b){a.getIndex().setLoading(false);window.location.reload()})}},0,0,0,0,0,0,[LkIp.controller,"InnEnterViewport"],0));(Ext.cmd.derive("LkIp.controller.Content",Ext.app.Controller,{MIDDLE:1,refs:[{ref:"tabPanel",selector:"tab-panel"},{ref:"contentContainer",selector:"#content-container"},{ref:"viewport",selector:"#viewport"},{ref:"serviceUnavailable",selector:"serviceUnavailable"}],title:"",currentPage:{},extraData:{},requestParams:[],firstLayoutLoad:false,certificateTooltip:undefined,obligationTemporaryDisabledTooltip:undefined,helpTooltip:undefined,codeNoList:{},taxTtip:undefined,init:function(){if(typeof this.cache!=="undefined"){LkIp.app.addListener({clearCache:{fn:this.clearControllerCache,scope:this}})}},clearControllerCache:function(a){a=Ext.isObject(a)?false:a;if(false!==a){if(this.id===a){this.cache=false}}else{this.cache=false}},loadIndex:function(){var d=this,a=Ext.getBody(),b=d.getController("Content"),c,e=LkIp.FlashData.get("disablePageScrollToTop");d.checkForUfnsExperiment();if(Ext.isEmpty(e)){LkIp.Utils.scrollTo(0,{duration:0})}d.currentPage=LkIp.PageRegistry.getInfo(d.getCurrentPageUrl());if(false===d.initView()){return false}d.requestParams=d.findRequestParams();d.checkForRequiredParams();c=d.resolveParamsAndHistoryUrl();if(typeof d.currentPage.history=="undefined"||true===d.currentPage.history){LkIp.History.push(c)}d.setTitles();d.getController("Viewport").showBreadcrumbs(LkIp.PageRegistry.getBreadcrumbs(d.currentPage.href),d.currentPage.href);if(!Ext.isEmpty(d.currentPage.needServiceCheck)&&d.currentPage.needServiceCheck){d.getViewport().setLoading(true);LkIp.Request.request({url:"/api/v1/service/check/"+d.currentPage.key,method:"GET"},function(f){d.getViewport().setLoading(false);if(Ext.isEmpty(f.available)||f.available==0){b.getContentContainer().layout.setActiveItem(b.getServiceUnavailable());return false}else{d.displayContent()}})}else{d.displayContent()}},displayContent:function(){var c=this,b=c.getController("Content");b.getContentContainer().layout.setActiveItem(c.getIndex());if(typeof c.currentPage.signature!="undefined"&&c.currentPage.signature){var a=LkIp.app.getController("SignCheck").check();if(LkIp.User.isActiveUser()&&!LkIp.User.isCertUser()&&!a){LkIp.Msg.info('<div class="header-text">\u0423\u0432\u0430\u0436\u0430\u0435\u043c\u044b\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c!</div><div>\u041d\u0430 \u0434\u0430\u043d\u043d\u043e\u0439 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435 \u0432\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u043f\u043e\u0434\u043f\u0438\u0441\u0430\u0442\u044c \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442, \u043e\u0434\u043d\u0430\u043a\u043e \u043f\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u043e, \u043f\u0435\u0440\u0435\u0434 \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435\u043c \u0444\u043e\u0440\u043c\u044b, \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u043d\u0430\u0441\u0442\u0440\u043e\u0438\u0442\u044c \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u044b \u0438 \u043f\u0440\u043e\u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u043f\u043e\u0434\u043f\u0438\u0441\u0430\u043d\u0438\u044f \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u043e\u0432 \u043d\u0430 <a href="#!/sign-check">\u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435 \u043f\u0440\u043e\u0432\u0435\u0440\u043e\u043a</a>.</div>')}}if(!Ext.isMobile.any){c.addMouseOverListener(".show-full-name-tooltip",function(e,d){var f=Ext.get(d).dom.getAttribute("fullName");if(!Ext.isEmpty(f)){if(typeof c.taxTtip!=="undefined"){c.taxTtip.destroy()}c.taxTtip=LkIp.Utils.tooltip(d,f,{dismissDelay:10000});c.taxTtip.show()}});c.addMouseOverListener(".certificate-tooltip",function(e,d){if(typeof c.certificateTooltip!=="undefined"){c.certificateTooltip.destroy()}var f=LkIp.User.isClosedUser()?reference.lang.closedUserTooltip:reference.lang.certificateTooltip;c.certificateTooltip=LkIp.Utils.tooltip(Ext.get(d),f,{dismissDelay:10000});c.certificateTooltip.show()});c.addMouseOverListener(".obligation-temporary-disabled",function(e,d){if(typeof c.obligationTemporaryDisabledTooltip!=="undefined"){c.obligationTemporaryDisabledTooltip.destroy()}c.obligationTemporaryDisabledTooltip=LkIp.Utils.tooltip(Ext.get(d),reference.lang.informationService.obligation.tmpDisabled,{dismissDelay:10000});c.obligationTemporaryDisabledTooltip.show()});c.addMouseOverListener(".help-tooltip",function(e,d){var f=Ext.get(d).dom.getAttribute("data-help");if(typeof c.helpTooltip!=="undefined"){c.helpTooltip.destroy()}if(!Ext.isEmpty(f)){c.helpTooltip=LkIp.Utils.tooltip(Ext.get(d),f,{dismissDelay:10000,width:350});c.helpTooltip.show()}})}c.initNoTooltips();c.hideBoundLists();c.getViewport().setLoading(false)},hideBoundLists:function(){var a=Ext.query(".x-boundlist");Ext.suspendLayouts();if(!Ext.isEmpty(a)){Ext.Array.each(a,function(b){Ext.getCmp(b.id).hide()})}Ext.resumeLayouts(true)},initView:function(){var b=this,a=b.getController("Content");if(Ext.Object.isEmpty(b.currentPage)){LkIp.Utils.goTo("#!/index");return false}if("#!/index"!=b.currentPage.href){if(Ext.isEmpty(a.getContentContainer().down("#"+b.currentPage.key))){Ext.suspendLayouts();a.getContentContainer().add({xtype:b.currentPage.key,id:b.currentPage.key});Ext.resumeLayouts(true)}}return true},addMouseOverListener:function(a,b){Ext.getBody().addListener("mouseover",b,this,{preventDefault:true,stopEvent:true,delegate:a})},setTitles:function(){var a=this;a.getViewport().setHtmlPageTitle(a.currentPage.title);if("#!/index"===a.currentPage.href){a.setPageTitle("")}else{a.setPageTitle(a.currentPage.title)}},resolveParamsAndHistoryUrl:function(){var b=this,a;if(typeof b.currentPage.requireParam!="undefined"){if(!b.getParams(b.currentPage.requireParam,b.requestParams.length)){!Ext.isEmpty(b.currentPage.error)&&LkIp.Msg.error(b.currentPage.error);LkIp.Utils.goTo(b.currentPage.href.substring(0,b.currentPage.href.lastIndexOf("/")));return false}a=b.currentPage.href+"?"+b.requestParams.join("&")}else{if(typeof b.currentPage.optionalParams!="undefined"){if(b.getParams(b.currentPage.optionalParams,b.requestParams.length)){a=b.currentPage.href+"?"+b.requestParams.join("&")}else{a=b.currentPage.href}}else{a=b.currentPage.href}}return a},getParams:function(c,a){var b=this;if(a>0&&a==c.length){Ext.Array.each(c,function(e,d){b[e]=b.requestParams[d]});return true}else{Ext.Array.each(c,function(e,d){b[e]=undefined})}return false},checkForRequiredParams:function(){var a=this;if(typeof a.currentPage.requireParent!="undefined"){if(Ext.isEmpty(LkIp.FlashData.get(a.currentPage.requireParent))){LkIp.Utils.goTo(a.currentPage.href.substring(0,a.currentPage.href.lastIndexOf("/")));return false}}},opensNewWindow:function(a){return a.button===this.MIDDLE||a.shiftKey||a.ctrlKey},getBaseUrl:function(){return document.location.href.replace(/\/?(index.html|template.html)?(\?[^#]*)?#.*/,"")},getCurrentPageUrl:function(){var c=document.location.href.indexOf("#!"),b=document.location.href.indexOf("?"),a=b>-1?b:document.location.href.length;if(c===-1){return"#!/index"}else{return document.location.href.substring(c,a)}},findRequestParams:function(){var a=document.location.href.indexOf("?");if(a>-1){return document.location.href.substring(a+1).split("&")}return[]},getRequestParams:function(){return this.requestParams},getCurrentPage:function(){return this.currentPage},setPageTitle:function(a){this.getViewport().down("#pageTitle").update({title:a})},initNoTooltips:function(){var a=this;Ext.getBody().addListener("click",function(c,b){var d=Ext.get(b).dom.getAttribute("code");if(typeof(a.codeNoList[d])!="undefined"){a.getTooltip(b,a.codeNoList[d]).show()}else{LkIp.Request.request({url:"/api/filters/getNo/"+d,method:"GET"},function(e){a.codeNoList[d]=e.response[0];a.getTooltip(b,a.codeNoList[d]).show()})}},this,{preventDefault:true,stopEvent:true,delegate:".ifns-tooltip"})},getTooltip:function(a,b){var c='<div class="no-tooltip-content"><div class="no-tooltip-header">{value}</div><div class="no-tooltip-body"><div class="no-body-item"><span class="label">'+reference.lang.ifnsTooltip.address+'</span><span class="value">{address}</span></div><div class="no-body-item"><span class="label">'+reference.lang.ifnsTooltip.phone+'</span><span class="value">{phone}</span></div></div><div class="no-tooltip-footer"><a href="#!/feedback?{code}">'+reference.lang.ifnsTooltip.callInspection+"{value}</a></div></div>";return LkIp.Utils.tooltip(a,new Ext.XTemplate(c).apply(b),{dismissDelay:0,autoHide:false,listeners:{hide:function(d){d.destroy()}}})},hideNoTooltips:function(){Ext.suspendLayouts();var a=Ext.query(".x-tip");if(!Ext.isEmpty(a)){Ext.Array.each(a,function(b){Ext.get(b).hide()})}Ext.resumeLayouts(true)},checkForUfnsExperiment:function(){var a=this;if(LkIp.User.isInUfnsExperiment()&&document.location.hash=="#!/index"){a.getViewport().down("#mainPageInformation").show().setText(reference.lang.ufnsExperiment)}else{a.getViewport().down("#mainPageInformation").hide().setText("")}}},0,0,0,0,0,0,[LkIp.controller,"Content"],0));(Ext.cmd.derive("LkIp.controller.Egrip.Request",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"#egriprequest"}],init:function(){this.control({'egriprequest [rel="submit"]':{submitForm:this.submitFormAction}});this.callParent()},submitFormAction:function(){var a=this;a.getIndex().setLoading(true);LkIp.Request.request({url:"/api/egrip/generateXml",scope:this,params:a.getIndex().getValues(),method:"POST"},function(b){a.getIndex().setLoading(false);if(false!==b&&!(Ext.isEmpty(b.response))){if(0!==b.status){LkIp.app.fireEvent("clearCache");LkIp.Msg.success(reference.lang.signature.successDefault)}else{LkIp.Msg.error(reference.lang.signature.errorDefault)}}else{LkIp.Msg.error(reference.lang.errors.serverError)}})}},0,0,0,0,0,0,[LkIp.controller.Egrip,"Request"],0));(Ext.cmd.derive("LkIp.mixins.Filters",Ext.Base,{filtersLoaded:false,filtersParams:{},applySelectedFilters:function(b){b=Ext.isArray(b)?b:[];var d=this,c=d.getFiltersParams(),a=d.getFilterPanel();Ext.suspendLayouts();Ext.Object.each(c,function(e,f){if(!Ext.Array.contains(b,e)){if(!LkIp.Utils.isFilterEmpty(f)){a.down('[name="'+e+'"]').setValue(f)}else{a.down('[name="'+e+'"]').reset()}}});Ext.resumeLayouts(true)},applyFiltersAction:function(){var b=this,a=b.getFilterPanel();Ext.suspendLayouts();b.filtersParams=a=="undefined"?{}:a.getForm().getValues();Ext.resumeLayouts(true);b.loadFirstPage()},resetFiltersAction:function(){var b=this,a=b.getFilterPanel();b.filtersParams={};Ext.suspendLayouts();typeof a!="undefined"&&a.getForm().reset();Ext.resumeLayouts(true);b.loadFirstPage()},expandFilterPanel:function(){var a=this;if(!a.filtersLoaded){a.loadFilters()}},getFiltersParams:function(b){var c=this,a={};b=b||false;if(b){Ext.Object.each(c.filtersParams,function(d,e){if(!LkIp.Utils.isFilterEmpty(e)){a[d]=e}});return a}return c.filtersParams}},0,0,0,0,0,0,[LkIp.mixins,"Filters"],0));(Ext.cmd.derive("LkIp.model.Rsb.Budget",Ext.data.Model,{fields:["name","@Vsego","@Nalog","@Peni","@SHtrafyi","@Protsentyi","@ProtsentyiZaPolzByudjSr","defaultNodeKey"]},0,0,0,0,0,0,[LkIp.model.Rsb,"Budget"],0));(Ext.cmd.derive("LkIp.controller.Rsb.Budget",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"rsbBudget"},{ref:"filterPanel",selector:"#rsbBudgetFilterPanel"}],models:["Rsb.Budget","Filters.SelectFilters"],filtersLoaded:true,originalData:[],cache:false,init:function(){Ext.getBody().addListener("click",this.getFileAction,this,{preventDefault:true,delegate:".saveBudgetFile"});this.control({rsbBudget:{activate:function(){if(false===this.cache){this.getIndex().setLoading(true)}}},'rsbBudget [rel="apply"]':{applyFilters:this.applyFiltersAction},'rsbBudget [rel="reset"]':{resetFilters:this.resetFiltersAction}});this.callParent()},loadIndex:function(){var a=this;a.callParent();if(true!==a.cache){a.noStore=Ext.getStore("budgetNoStore");a.gridStore=Ext.getStore("budgetGridStore");LkIp.Request.request({url:"/api/rsb/budget/get",scope:this},function(b){a.getIndex().setLoading(false);if(false!==b&&!Ext.isEmpty(b.response)){a.originalData=b.response;a.cache=true;a.loadFiltersData();a.loadFirstPage()}})}},loadFiltersData:function(){var a=this;a.noStore.loadData(a.originalData.no)},loadFirstPage:function(){var c=this,e=c.getFilterPanel().down('[name="codeNO"]').getValue(),b=LkIp.Utils.isFilterEmpty(e)?"total":e,a=c.getIndex(),d=Ext.clone(c.originalData.grid[b].children);c.gridStore.getRootNode().removeAll();if("total"!==b){a.down('[name="codeNODateContainer"]').show();a.down('[name="codeNODate"]').getEl().setHTML(LkIp.Utils.getDate(c.originalData.grid[b].date))}else{a.down('[name="codeNODate"]').getEl().setHTML("");a.down('[name="codeNODateContainer"]').hide()}c.gridStore.getRootNode().appendChild(d)},getFileAction:function(){LkIp.Utils.downloadDocument("rsbBudget","/api/rsb/budget/getFile",{})}},0,0,0,0,0,[["filters",LkIp.mixins.Filters]],[LkIp.controller.Rsb,"Budget"],0));(Ext.cmd.derive("LkIp.store.DefaultStore",Ext.data.Store,{attempt:1,maxAttempts:10,firstDelay:500,pageSize:5,remoteSort:true,defaultProxy:{type:"ajax",url:"",noCache:false,reader:{type:"json",root:"response.root",totalProperty:"response.count"}},extraParams:{},rest:true,restPrefix:"api",getPageSize:function(){return this.pageSize},setPageSize:function(a){this.pageSize=a},resetAttempts:function(){this.attempt=1;this.firstDelay=500},onProxyLoad:function(c){var d=this,e=new Ext.util.DelayedTask(function(){d.load()}),a=parseFloat(undefined!==c.response?c.response.status:c.error.status);if(d.attempt<d.maxAttempts){switch(parseFloat(a)){case 401:if(LkIp.User.isCertUser()){window.location.reload()}else{window.location="/"}break;case 403:LkIp.Error.e403();break;case 404:LkIp.Error.e404();break;case 500:case 405:d.callParent([c]);break;case 406:LkIp.Error.e406();break;case 200:default:if(typeof c.response.responseText!="undefined"){var b=Ext.JSON.decode(c.response.responseText);if(2===b.status){e.delay(d.firstDelay+(d.attempt*1000)/2);d.attempt++}else{if(0===b.status){LkIp.Msg.error(reference.lang.dataLoadError)}d.callParent([c])}}else{d.callParent([c])}break}}else{d.callParent([c])}},updateProxy:function(){var a=this;if(a.rest&&-1===a.url.indexOf(a.restPrefix)){a.url="/"+a.restPrefix+a.url}if(LkIp.User.isInspectorWithCodeNO()){a.extraParams.codeNO=LkIp.User.get("codeNO")}a.setProxy({type:"ajax",url:a.url.indexOf("{")>-1?a.updateUrlTemplate():a.url,extraParams:a.extraParams,reader:{type:"json",root:"response.root",totalProperty:"response.count"},noCache:false,headers:{"Web-Client-Version":LkIp.app.version}})},updateUrlTemplate:function(){var c=this,a=new Ext.Template(c.url),b=a.apply(c.extraParams),d=c.url.split("{").join("").split("}").join("").split("/");Ext.Array.each(d,function(e){if(typeof c.extraParams[e]!="undefined"){delete c.extraParams[e]}});return b},loadFirstPage:function(a){this.loadPage(1,{params:Ext.isObject(a)?a:{}})}},0,0,0,0,0,0,[LkIp.store,"DefaultStore"],0));(Ext.cmd.derive("LkIp.model.Docflow.Documents.Grid",Ext.data.Model,{fields:["@StatusZayavl","@KolDokumOtv","@DataPriemaZayavl","@Tip","@KodNO","@FIdZayavl","@NaimNO","@NaimZayavl","@ExtZayavl","@UdovlUsl","@DataOtsenki","@Kommentariy","@RegNomer","@RegData","document_send_type","answers"]},0,0,0,0,0,0,[LkIp.model.Docflow.Documents,"Grid"],0));(Ext.cmd.derive("LkIp.store.Docflow.Documents.GridStore",LkIp.store.DefaultStore,{model:"LkIp.model.Docflow.Documents.Grid",url:"/documents/getInfo",sorters:[{property:"@DataPriemaZayavl",direction:"DESC"}]},0,0,0,0,0,0,[LkIp.store.Docflow.Documents,"GridStore"],0));(Ext.cmd.derive("LkIp.model.Docflow.Documents.Answers",Ext.data.Model,{fields:["@ExtDokOtvNO","@NaimDokOtvNO","@DataPolucheniyaOtv","@TipOtv","@FIdDokumOtv","@FIdZayavl","need_signature","id_receipt"]},0,0,0,0,0,0,[LkIp.model.Docflow.Documents,"Answers"],0));(Ext.cmd.derive("LkIp.controller.Docflow.Documents",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"#docflowList"},{ref:"filterPanel",selector:"#docflowFilterPanel"},{ref:"grid",selector:"#documentsGrid"},{ref:"feedbackWindow",selector:"feedbackWindow"},{ref:"answersGrid",selector:"#answersGrid"}],models:["Docflow.Documents.Grid","Docflow.Documents.Answers"],filtersParams:{1:{},2:{}},statementInfo:[],openedTooltip:null,firstLoad:true,cache:false,type:1,kktTooltip:undefined,answersWindows:undefined,excludedInSatisfy:["142","143","144","145","146","150","151"],answer:{},getDocflowGridStore:function(){return this.getStore("Docflow.Documents.GridStore")},init:function(){var b=this,a=Ext.getBody();a.addListener("mouseover",function(d,c){if(!Ext.isEmpty(b.kktTooltip)){b.kktTooltip.destroy()}b.kktTooltip=LkIp.Utils.tooltip(Ext.get(c),reference.lang.kkt.documentTooltip,{dismissDelay:0,width:300,hideDelay:4000,listeners:{hide:function(e){e.destroy();b.kktTooltip=undefined}}});b.kktTooltip.show()},this,{preventDefault:true,stopEvent:true,delegate:".kkt-maybe-need-fiscalization"});a.addListener("click",b.showAnswers,this,{preventDefault:true,stopEvent:true,delegate:".document-answers"});a.addListener("click",b.getAnswer,this,{preventDefault:true,stopEvent:true,delegate:".get-answer-link"});a.addListener("click",b.signReceipt,this,{preventDefault:true,stopEvent:true,delegate:".sign-receipt"});b.getDocflowGridStore().on({beforeload:{fn:b.beforeloadDocflowList,scope:b},load:{fn:b.loadDocflowList,scope:b}});b.control({"#docflowList":{deactivate:function(){if(!Ext.isEmpty(b.openedTooltip)){b.openedTooltip.destroy()}}},'#statusBarTabsDocflowDocuments [type="status-bar-tab"]':{activate:b.activateTab},'docflowList [rel="apply"]':{applyFilters:b.applyFiltersAction},'docflowList [rel="reset"]':{resetFilters:b.resetFiltersAction},"#docflowFilterPanel":{expand:b.expandFilterPanel},"#documentsGrid":{downloadStatement:b.downloadStatementHandler},"#answersGrid":{downloadAnswer:b.downloadAnswerHandler},"feedbackWindow #feedback-yes":{click:b.feedbackYesAction},"feedbackWindow #feedback-no":{click:b.feedbackNoAction},"feedbackWindow #feedback-send":{click:b.feedbackSendAction},"feedbackWindow #feedback-evaluate-later":{click:b.feedbackCloseWindow}});b.callParent()},showAnswers:function(f,c){var d=this,h=Ext.get(c).getAttribute("data-index"),b=d.getDocflowGridStore().findBy(function(e,i){return i==h},d),a=d.getDocflowGridStore().getAt(b),g=a.get("answers");d.answersWindow=Ext.create("LkIp.view.Docflow.Documents.Answers",{title:new Ext.XTemplate(reference.lang.docflow.grid.answersTitle).apply({name:a.get("@NaimZayavl")}),answers:g,itemId:"answersWindow",onClose:function(){d.getDocflowGridStore().reload()}});d.answersWindow.show()},getAnswer:function(g,d){var f=this,b=Ext.get(d).getAttribute("data-internalId"),c=Ext.get(d).getAttribute("data-returnIn"),a=f.getAnswersGrid().getStore().data.getByKey(b);c=Ext.isEmpty(c)?"":c;f.downloadDocument(a,"@FIdDokumOtv","@TipOtv","answer",c)},signReceipt:function(f,c){var d=this,b=Ext.get(c).getAttribute("data-internalId"),a=d.getAnswersGrid().getStore().data.getByKey(b),g=a.get("@FIdDokumOtv"),h=a.get("id_receipt");d.answer.record=a;if(h==0){LkIp.Msg.error(reference.lang.docflow.grid.getReceiptError);return false}d.answersWindow.setLoading(true);LkIp.Request.request({url:"/api/document/receipt/"+h,scope:this,async:false},function(e){if(false!==e&&0!==e.status&&!Ext.isEmpty(e.response)){d.answer.doc=e.response;LkIp.app.getController("Viewport").signAction({response:{"@hash":e.response,"@id":a.get("@FIdDokumOtv"),"@type":a.get("@TipOtv")},status:1},{loader:d.answersWindow,returnHash:true,signXml:true,successCallback:function(i){if(Ext.isEmpty(i)){return false}LkIp.Request.request({url:"/api/document/receipt/sign",scope:this,params:{signResult:i.signHash,documentId:d.answer.record.get("@FIdDokumOtv"),answer:d.answer.doc},method:"POST"},function(j){d.answersWindow.setLoading(false);if(false!==j&&!(Ext.isEmpty(j.response))){if(0!==j.status){if(!Ext.isEmpty(j.response.errors)){LkIp.Msg.error(j.response.errors.join("<br/>"));return}else{if(Ext.isEmpty(j.response.fid)){LkIp.Msg.error(reference.lang.docflow.grid.signReceiptError);return}else{d.answer.record.set("need_signature",false);d.answer.record.set("id_receipt",0);d.answer.record.commit();d.downloadDocument(d.answer.record,"@FIdDokumOtv","@TipOtv","answer")}}}else{LkIp.Msg.error(Ext.isEmpty(j.response)?reference.lang.docflow.grid.signReceiptError:j.response)}}else{LkIp.Msg.error(reference.lang.docflow.grid.signReceiptError)}})}})}else{d.answersWindow.setLoading(false);LkIp.Msg.error(reference.lang.docflow.grid.getReceiptError)}})},loadIndex:function(){var a=this;a.callParent();if(!LkIp.Msg.isHidden()){LkIp.Msg.close()}if(!a.cache){if(!LkIp.User.isInspectorWithCodeNO()){a.noStore=Ext.getStore("docflowNoStore")}a.statementTypeStore=Ext.getStore("docflowStatementTypeStore");a.statementStatusStore=Ext.getStore("docflowStatementStatusStore");a.docflowAnswerStatusStore=Ext.getStore("docflowAnswerStatusStore");a.loadFirstPage();a.firstLoad=false;a.cache=true}},activateTab:function(a){var b=this;switch(a.itemId){case"tab-all-documents":b.type=2;break;case"tab-new-documents":default:b.type=1;break}if(b.filtersLoaded){b.changeFiltersData()}if(!b.firstLoad){b.loadFirstPage()}},loadFirstPage:function(a){this.getDocflowGridStore().loadPage(1,{params:Ext.isObject(a)?a:{}})},beforeloadDocflowList:function(){var a=this;a.applySelectedFilters(["type"]);a.getDocflowGridStore().extraParams=this.getFiltersParams(true)},loadDocflowList:function(){var a=this;Ext.get(Ext.query(".documentTooltip")).on("click",function(b,c){a.makeStatementInfoTooltip(c.attributes.fid.value,c.attributes.docType.value,Ext.get(c))});Ext.get(Ext.query(".feedback-window")).on("click",function(b,c){a.showFeedbackWindow(c.attributes.idDoc.value)});a.initEgripTooltips()},makeStatementInfoTooltip:function(d,a,b){var c=this;if(!Ext.isEmpty(c.openedTooltip)){c.openedTooltip.destroy()}if(typeof c.statementInfo[d]=="undefined"){b.up(".x-grid-cell").addCls("loading");LkIp.Request.request({url:"/api/documents/getDocumentInfo/"+d+"/"+a,scope:this,async:false},function(e){b.up(".x-grid-cell").removeCls("loading");if(false!==e&&0!==e.status&&!Ext.isEmpty(e.response)){c.statementInfo[d]=c.getGrid().getStatementTpl(e.response,a);c.openedTooltip=LkIp.Utils.closableTooltip(b,c.statementInfo[d],reference.lang.docflow.tooltip.title);c.openedTooltip.show()}else{c.openedTooltip=LkIp.Utils.closableTooltip(b,reference.lang.docflow.tooltip.error,reference.lang.docflow.tooltip.title);c.openedTooltip.show()}})}else{c.openedTooltip=LkIp.Utils.closableTooltip(b,c.statementInfo[d],reference.lang.docflow.tooltip.title);c.openedTooltip.show()}},applyFiltersAction:function(){this.filtersParams[this.type]=this.getFilterPanel().getForm().getValues();this.loadFirstPage()},resetFiltersAction:function(){this.filtersParams[this.type]={};Ext.suspendLayouts();this.getFilterPanel().getForm().reset();Ext.resumeLayouts(true);this.loadFirstPage()},loadFilters:function(){var a=this;a.getFilterPanel().setLoading(true);LkIp.Request.request({url:"/api/documents/getFilters",scope:this},function(b){a.getFilterPanel().setLoading(false);a.defaultFiltersResult=b.response;a.docflowAnswerStatusStore.loadData(a.defaultFiltersResult.statusAnswer);a.changeFiltersData();a.filtersLoaded=true})},changeFiltersData:function(){var d=this;if(d.type==1){var c=[],b=[],a=[];if(!LkIp.User.isInspectorWithCodeNO()){Ext.Array.each(d.defaultFiltersResult.no,function(e){if(e.type==1||e.type==0){c.push(e)}});d.noStore.loadData(c)}Ext.Array.each(d.defaultFiltersResult.typeStatement,function(e){if(e.type==1||e.type==0){b.push(e)}});Ext.Array.each(d.defaultFiltersResult.statusStatement,function(e){if(e.type==1||e.type==0){a.push(e)}});d.statementTypeStore.loadData(b);d.statementStatusStore.loadData(a)}else{d.noStore.loadData(d.defaultFiltersResult.no);d.statementTypeStore.loadData(d.defaultFiltersResult.typeStatement);d.statementStatusStore.loadData(d.defaultFiltersResult.statusStatement)}},getFiltersParams:function(b){b=b||false;var c=Ext.Object.merge(this.filtersParams[this.type],{type:this.type});if(b){var a={};Ext.Object.each(c,function(d,e){if(!LkIp.Utils.isFilterEmpty(e)){a[d]=e}});return a}return c},downloadStatementHandler:function(a){this.downloadDocument(a,"@FIdZayavl","@Tip","request")},downloadAnswerHandler:function(a){this.downloadDocument(a,"@FIdDokumOtv","@TipOtv","answer")},downloadDocument:function(b,h,g,a,f){f=f||"";var e=this,c=b.get(h),d=b.get(g);if(0!=c){LkIp.Utils.downloadDocument("docflowDocument","/api/documents/getDocument/"+c+"/"+d+(!Ext.isEmpty(f)?"?returnIn="+f:""),{},function(){if("answer"===a){LkIp.Msg.close();if(Ext.isEmpty(b.get("@UdovlUsl"))&&Ext.isEmpty(b.get("@DataOtsenki"))&&!Ext.Array.contains(e.excludedInSatisfy,d)){e.showFeedbackWindow(b.get("@FIdZayavl"))}}})}},showFeedbackWindow:function(a){Ext.create("LkIp.view.Docflow.Documents.UserFeedback",{idDoc:a}).show()},sendSatisfaction:function(a,b,d){var c=this;d=Ext.isString(d)?d:"";c.getFeedbackWindow().close();if(typeof a=="undefined"){LkIp.Msg.error(reference.lang.docflow.satisfaction.error)}else{c.getIndex().setLoading(true);LkIp.Request.request({url:"/api/documents/sendSatisfaction",method:"POST",params:{idDoc:a,isSatisfy:b,comment:d}},function(e){c.getIndex().setLoading(false);if(false!==e&&0!==e.status){LkIp.Msg.success(reference.lang.docflow.satisfaction.success);c.getGrid().getStore().reload()}else{LkIp.Msg.error(reference.lang.docflow.satisfaction.error)}})}},feedbackYesAction:function(){var a=this;a.sendSatisfaction(a.getFeedbackWindow().idDoc,true)},feedbackNoAction:function(){var a=this;Ext.suspendLayouts();a.getFeedbackWindow().down("#feedback-first-buttons").hide();a.getFeedbackWindow().down("#feedback-comment-block").show();Ext.resumeLayouts(true)},feedbackSendAction:function(){var a=this;a.sendSatisfaction(a.getFeedbackWindow().idDoc,false,a.getFeedbackWindow().down('[name="comment"]').getValue())},feedbackCloseWindow:function(){this.getFeedbackWindow().close()},egripTooltip:undefined,initEgripTooltips:function(){var b=this,a=Ext.getBody();a.addListener("mouseover",function(d,c){if(!Ext.isEmpty(b.openedTooltip)){b.egripTooltip.destroy()}b.egripTooltip=LkIp.Utils.tooltip(Ext.get(c),reference.lang.docflow.tooltip.egrip.body,{componentCls:"js-egrip-tooltip-to-close",hideDelay:5000,dismissDelay:5000});b.egripTooltip.show()},this,{preventDefault:true,stopEvent:true,delegate:".egrip-ttip"})}},0,0,0,0,0,[["filters",LkIp.mixins.Filters]],[LkIp.controller.Docflow,"Documents"],0));(Ext.cmd.derive("LkIp.model.Docflow.Notice.Grid",Ext.data.Model,{fields:["fid","docTypeCode","docType","lkDate","docExt","docStatusCode","docStatus","noCode","noName","receiptId","needSign"]},0,0,0,0,0,0,[LkIp.model.Docflow.Notice,"Grid"],0));(Ext.cmd.derive("LkIp.store.Docflow.Notice.GridStore",LkIp.store.DefaultStore,{model:"LkIp.model.Docflow.Notice.Grid",url:"/notice/getList",sorters:[{property:"lkDate",direction:"DESC"}]},0,0,0,0,0,0,[LkIp.store.Docflow.Notice,"GridStore"],0));(Ext.cmd.derive("LkIp.controller.Docflow.Notice",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"#docflowNotice"},{ref:"filterPanel",selector:"#noticeFilterPanel"},{ref:"grid",selector:"#noticeGrid"}],filtersParams:{1:{},2:{}},firstLoad:true,cache:false,type:1,signReceiptWindow:undefined,answer:{},getDocflowGridStore:function(){return this.getStore("Docflow.Notice.GridStore")},init:function(){var b=this,a=Ext.getBody();a.addListener("click",b.signReceipt,this,{preventDefault:true,stopEvent:true,delegate:".sign-answer-receipt"});b.getDocflowGridStore().on({beforeload:{fn:b.beforeloadDocflowList,scope:b},load:{fn:b.loadDocflowList,scope:b}});b.control({'#statusBarTabsDocflowNotice [type="status-bar-tab"]':{activate:b.activateTab},'docflowNotice [rel="apply"]':{applyFilters:b.applyFiltersAction},'docflowNotice [rel="reset"]':{resetFilters:b.resetFiltersAction},"#noticeFilterPanel":{expand:b.expandFilterPanel},"#noticeGrid":{docClick:b.onDocClick}});b.callParent()},signReceipt:function(c,a){var b=this;b.signReceiptWindow.setLoading(true);LkIp.Request.request({url:"/api/document/receipt/"+b.answer.record.get("receiptId"),scope:this,async:false},function(d){if(false!==d&&0!==d.status&&!Ext.isEmpty(d.response)){b.answer.doc=d.response;LkIp.app.getController("Viewport").signAction({response:{"@hash":d.response,"@id":b.answer.record.get("fid"),"@typeId":b.answer.record.get("docTypeCode")},status:1},{loader:b.signReceiptWindow,returnHash:true,signXml:true,successCallback:function(e){if(Ext.isEmpty(e)){return false}LkIp.Request.request({url:"/api/document/receipt/sign",scope:this,params:{signResult:e.signHash,documentId:b.answer.record.get("fid"),answer:b.answer.doc},method:"POST"},function(f){b.signReceiptWindow.setLoading(false);if(false!==f&&!(Ext.isEmpty(f.response))){if(0!==f.status){if(!Ext.isEmpty(f.response.errors)){LkIp.Msg.error(f.response.errors.join("<br/>"));return}else{if(Ext.isEmpty(f.response.fid)){LkIp.Msg.error(reference.lang.docflow.grid.signReceiptError);return}else{b.loadFirstPage();b.downloadDocument(b.answer.record,"fid","docTypeCode","answer")}}}else{LkIp.Msg.error(Ext.isEmpty(f.response)?reference.lang.docflow.grid.signReceiptError:f.response)}}else{LkIp.Msg.error(reference.lang.docflow.grid.signReceiptError)}})}})}else{b.signReceiptWindow.setLoading(false);LkIp.Msg.error(reference.lang.docflow.grid.getReceiptError)}})},loadIndex:function(){var a=this;a.callParent();if(!a.cache){if(!LkIp.User.isInspectorWithCodeNO()){a.noStore=Ext.getStore("docflowNoStore")}a.docTypeStore=Ext.getStore("docflowStatementTypeStore");a.docStatusStore=Ext.getStore("docflowStatementStatusStore");a.loadFirstPage();a.firstLoad=false;a.cache=true}},activateTab:function(a){var b=this;switch(a.itemId){case"tab-all-documents":b.type=2;break;case"tab-new-documents":default:b.type=1;break}if(b.filtersLoaded){b.changeFiltersData()}if(!b.firstLoad){b.loadFirstPage()}b.getIndex().down('[name="docStatus"]').setVisible(b.type==2);b.getIndex().down('[name="docStatus"]').setDisabled(b.type==1)},loadFirstPage:function(a){this.getDocflowGridStore().loadPage(1,{params:Ext.isObject(a)?a:{}})},beforeloadDocflowList:function(){var a=this;a.applySelectedFilters(["type"]);a.getDocflowGridStore().extraParams=a.firstLoad?{docStatus:11}:a.getFiltersParams(true)},loadDocflowList:function(){var a=this},applyFiltersAction:function(){this.filtersParams[this.type]=this.getFilterPanel().getForm().getValues();this.loadFirstPage()},resetFiltersAction:function(){this.filtersParams[this.type]={};Ext.suspendLayouts();this.getFilterPanel().getForm().reset();Ext.resumeLayouts(true);this.loadFirstPage()},loadFilters:function(){var a=this;a.getFilterPanel().setLoading(true);LkIp.Request.request({url:"/api/notice/getFilters",scope:this},function(b){a.getFilterPanel().setLoading(false);a.defaultFiltersResult=b.response;a.getFilterPanel().getForm().reset();a.getFilterPanel().getForm().setValues(a.filtersParams[a.type]);a.noStore.loadData(a.defaultFiltersResult.no);a.docTypeStore.loadData(a.defaultFiltersResult.docType);a.docStatusStore.loadData(a.defaultFiltersResult.docStatus);a.filtersLoaded=true})},getFiltersParams:function(b){b=b||false;var c=Ext.Object.merge(this.filtersParams[this.type],{type:this.type});if(b){var a={};Ext.Object.each(c,function(d,e){if(!LkIp.Utils.isFilterEmpty(e)){a[d]=e}});return a}return c},onDocClick:function(a){var b=this;if(a.get("needSign")=="0"){b.downloadDocument(a,"fid","docTypeCode","answer")}else{b.answer.record=a;if(b.receiptId==0){LkIp.Msg.error(reference.lang.docflow.grid.getReceiptError);return}b.signReceiptWindow=Ext.create("LkIp.view.Docflow.Notice.SignReceiptWindow",{onClose:function(){b.getDocflowGridStore().reload()}});b.signReceiptWindow.show()}},downloadDocument:function(b,h,g,a,f){f=f||"";var e=this,c=b.get(h),d=b.get(g);if(0!=c){LkIp.Utils.downloadDocument("docflowDocument","/api/documents/getDocument/"+c+"/"+d+(!Ext.isEmpty(f)?"?returnIn="+f:""),{},function(){})}}},0,0,0,0,0,[["filters",LkIp.mixins.Filters]],[LkIp.controller.Docflow,"Notice"],0));(Ext.cmd.derive("LkIp.controller.Index",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"index"},{ref:"widgetPanel",selector:"widgetPanel"},{ref:"rsbWidget",selector:"rsbWidget"},{ref:"taxCalendarWidget",selector:"widgettaxcalendar"},{ref:"profileWidget",selector:"widgetprofile"},{ref:"taxModeWidget",selector:"taxModeWidget"},{ref:"mailWidget",selector:"widgetmail"},{ref:"overpaymentInfoBlock",selector:"overpaymentInfoBlock"},{ref:"anketaInfoBlock",selector:"anketaInfoBlock"}],selectAll:false,data:[],taxCalendarEventsStore:undefined,payEvents:[],rsbExpandItems:["debt","overpayment"],createdTooltips:[],loaded:false,updateAnswersTask:undefined,ttipTpl:"<div class='datepicker-tooltip'><div class='datepicker-tooltip-header'><span>{header}</span></div><div class='datepicker-tooltip-body'>{body}</div></div>",tooltips:[],onStart:true,hasOverpayment:false,eventsHelpTooltip:undefined,overpaymentCookie:"overpayment-info-msg",anketaCookie:"anketa-info",init:function(){var b=this,a=Ext.getBody();a.addListener("click",this.rsbExpand,this,{preventDefault:true,delegate:".rsb-arrow"});a.addListener("click",this.rsbExpand,this,{preventDefault:true,delegate:".rsb-clickable-field"});a.addListener("click",function(e,d){if(!Ext.isEmpty(b.eventsHelpTooltip)){b.eventsHelpTooltip.destroy()}var c='<div class="events-help__block"><div class="events-help__block-item events-help__block-item-first"><div class="events-help__block-item-cell events-help__block-item-cell-first"><div class="events-help__block-item-cell-orange"></div></div><div class="events-help__block-item-cell">'+reference.lang.calendar.orange+'</div></div><div class="events-help__block-item"><div class="events-help__block-item-cell events-help__block-item-cell-first"><div class="events-help__block-item-cell-blue"></div></div><div class="events-help__block-item-cell">'+reference.lang.calendar.blue+"</div></div></div>";b.eventsHelpTooltip=LkIp.Utils.tooltip(Ext.get(d),c,{dismissDelay:0,width:450,hideDelay:60000,anchor:"bottom",listeners:{hide:function(f){f.destroy()}}});b.eventsHelpTooltip.show()},this,{preventDefault:true,stopEvent:true,delegate:".events-help"});a.addListener("click",function(){if(b.getIndex().down("#close-write-off-forever-checkbox").getValue()){Ext.util.Cookies.set("hideWriteOffMessage",1,Ext.Date.add(new Date(),Ext.Date.MONTH,3))}b.getIndex().remove("debt-write-off")},b,{preventDefault:b,delegate:".close-debt-write-off"});this.control({"#taxpayerCalendar":{changeMonth:this.changeMonthAction},'taxModeWidget [type="tab"]':{activate:function(c){b.renderTaxModeTooltip(c)}},widgetPanel:{drop:this.dropWindow},widgetWindow:{resize:this.resizeWindow},educationVideo:{close:this.closeVideo},updateInformationBlock:{close:this.closeDataUpdatingBlock},overpaymentInfoBlock:{close:this.closeOverpaymentBlock},'overpaymentInfoBlock [name="overpayment-btn"]':{closeOverpaymentBlock:this.closeOverpaymentVideo}});this.callParent()},loadIndex:function(){var a=this,b={};if(false!==a.callParent()&&!a.loaded){a.getIndex().setLoading(true);if(LkIp.User.isInspectorWithCodeNO()){b.codeNO=LkIp.User.get("codeNO")}if(!Ext.isEmpty(LkIp.User.get("head"))){b.headReady=true;a.headReady=true}LkIp.Auth.authorizationRequestPool(b,0,function(){var c=LkIp.Settings.get("overpaymentStatus");a.hasOverpayment=Ext.isEmpty(c)?false:Boolean(c);a.drawPage()})}},closeOverpaymentBlock:function(){},closeOverpaymentVideo:function(b){var a=this;LkIp.Request.request("/api/rsb/overpayment/status/set",function(){});a.getOverpaymentInfoBlock().close();if(b){LkIp.Utils.goTo("#!/rsb/overpayment")}},drawPage:function(){var e=this,d=LkIp.Settings.get("cards"),h=!Ext.isEmpty(d)?d.cards:[],g=LkIp.Settings.get("mc"),c=LkIp.Settings.get("otherTaxMode"),f=LkIp.Settings.get("envd"),b=LkIp.User.get("temporaryPassword"),a={};e.taxCalendarEventsStore=Ext.getStore("taxCalendarEventsStore");if(!LkIp.User.isEcrInspector()){if(!Ext.isEmpty(c)||!Ext.isEmpty(f)){if(Ext.isEmpty(c)||typeof c.usn=="undefined"){a.orn={}}if(!Ext.isEmpty(f)){a.envd=f}if(!Ext.isEmpty(c)){a=Ext.Object.merge(a,c)}}else{if(Ext.isEmpty(h)&&Ext.isEmpty(g)){if(LkIp.User.get("isDataUpdating")){a.wait=true}}else{a.orn={}}}}LkIp.Settings.set("index_calendar_taxes_types",Ext.Object.getKeys(a));if(!Ext.isEmpty(g)&&g.writeOff==1&&Ext.isEmpty(Ext.util.Cookies.get("hideWriteOffMessage"))){e.getIndex().down("#debt-write-off").show()}LkIp.Request.request({url:"/api/taxmode/getEvents",params:{"type[]":Ext.Object.getKeys(a)}},function(i){e.getIndex().setLoading(false);if(!LkIp.User.isEcrInspector()){e.drawCardsWidget(h,g);e.drawTaxCalendarWidget(i);e.drawMcWidget(g);e.drawTaxWidget(a);if(LkIp.User.hasKktAccess()){e.drawKkt()}}e.loaded=true;Ext.suspendLayouts();if(!LkIp.User.isEcrInspector()){Ext.get("widget-iwant").removeCls("hidden-panel-body");Ext.get("widget-tax-calendar").removeCls("hidden-panel-body");Ext.get("widget-tax-system").removeCls("hidden-panel-body");Ext.get("widget-rsb").removeCls("hidden-panel-body");if(LkIp.User.hasKktAccess()){Ext.get("widget-kkt").removeCls("hidden-panel-body")}}if(LkIp.User.isCertUser()){Ext.get("widget-markirovka").removeCls("hidden-panel-body")}Ext.get("widget-mail").removeCls("hidden-panel-body");Ext.resumeLayouts(true);e.getViewport().doLayout();if(!LkIp.User.isInspector()&&!LkIp.User.isClosedUser()){e.updateNewAnswers()}if(!LkIp.User.isEcrInspector()){e.addListenersToView()}if(LkIp.User.isActiveUser()){if(0!=b){LkIp.Msg.info(reference.lang.changePassword,{rewriteDefaultButtons:true,buttons:[{text:reference.lang.buttons.changePassword,handler:function(j){LkIp.FlashData.set("goTo","accounting");LkIp.Utils.goTo("#!/profile");LkIp.Msg.onClose()}},{text:reference.lang.buttons.continueWork,handler:function(j){LkIp.Msg.onClose();e.showVideo()}}]})}else{e.showVideo()}}})},drawKkt:function(){var b=this,a=b.getIndex(),d=LkIp.Settings.get("kktList"),c;Ext.suspendLayouts();if(!Ext.isEmpty(d)&&d.count!=0){c=d.root[0];c.table=LkIp.app.getController("Kkt.Index").drawIndicator(c.status);if(!Ext.isEmpty(c.cls)){c.cls+=" kkt-state-padding"}a.down("#emptyKktList").hide();a.down("#kktInstance").show().update(c)}else{a.down("#emptyKktList").show();a.down("#kktInstance").hide()}Ext.resumeLayouts(true)},updateEvents:function(){var a=this,b;if(a.loaded){b=a.getTaxCalendarWidget();b.setLoading(true);LkIp.Request.request({url:"/api/taxmode/getEvents",params:{"type[]":LkIp.Settings.get("index_calendar_taxes_types")}},function(c){b.setLoading(false);a.drawTaxCalendarWidget(c)})}},showVideo:function(){if(Ext.isEmpty(Ext.util.Cookies.get("hideVideo"))){LkIp.app.getController("Viewport").showVideoWindow()}else{this.showDataUpdatingBlock()}},closeVideo:function(){var a=this;if(a.onStart){a.showDataUpdatingBlock();a.onStart=false}},showDataUpdatingBlock:function(){if(LkIp.User.get("isDataUpdating")&&Ext.isEmpty(Ext.util.Cookies.get("hideDataUpdatingBlock"))){Ext.create("LkIp.view.UpdateInformationBlock",{}).show()}else{this.showOverpaymentBlock()}},closeDataUpdatingBlock:function(){this.showOverpaymentBlock()},showOverpaymentBlock:function(){var a=this;if(LkIp.User.isActiveUser()&&a.hasOverpayment&&!LkIp.User.get("hideOverpayment")&&Ext.isEmpty(Ext.util.Cookies.get(a.overpaymentCookie))){Ext.create("LkIp.view.OverpaymentInformationBlock").show()}},addListenersToView:function(){var b=this,a=Ext.getBody();a.addListener("click",b.toggleTaxModeInfo,b,{preventDefault:true,stopEvent:false,delegate:".toggle-more-link"});a.addListener("click",b.goToCardInfo,b,{preventDefault:true,stopEvent:false,delegate:".rsb-card-details-link"});a.addListener("click",b.goToCardInfo,b,{preventDefault:true,stopEvent:false,delegate:".rsb-cards-item"});a.addListener("click",function(){LkIp.FlashData.set("gotToTaxSystems",1);LkIp.FlashData.set("disablePageScrollToTop",1);LkIp.Utils.goTo("#!/statement/list");return true},b,{preventDefault:true,stopEvent:false,delegate:"#taxSystemStatement"})},drawCardsWidget:function(c,b){var a=this;if(!Ext.isEmpty(c)){LkIp.app.getController("Viewport").drawCards(c,a.getIndex().down("#rsb-widget-cards"),2)}else{if(Ext.isEmpty(b)&&LkIp.User.get("isDataUpdating")){a.getRsbWidget().down("#rsb-wait-info-text").show();a.getRsbWidget().down("#rsb-widget-cards").remove()}}},drawTaxCalendarWidget:function(d){var i=this,g=i.getTaxCalendarWidget(),e=g.down("#taxpayerCalendar"),f=g.down("#noFutureEvents"),a=g.down("#tax-calendar-events-grid"),b=new Date(),c=d.status==1?d.response.calendar:[],j=d.status==1?d.response.events:[],h=j;LkIp.Settings.set("payEvents",j);if(!Ext.isEmpty(c)){e.setMinDate(new Date(c.min)).setMaxDate(new Date(c.max));if(c.disabledDates.length>0){e.setDisabledDates(Ext.Array.map(c.disabledDates,function(k){return new Date(k)}))}j=i.getActualEvents(j);if(j.length==0){f.show();a.hide()}else{i.taxCalendarEventsStore.loadRawData(Ext.Array.slice(j,0,3))}i.generateTooltipsForCalendar(h)}else{e.setMinDate(b);e.setMaxDate(b);e.setDisabledDates([new Date()]);f.show();a.hide()}},getActualEvents:function(c){var b,a=new Date();a.setHours(0,0,0,0);return Ext.Array.filter(c,function(d){b=LkIp.Utils.getDateObject(d.date);return a<=b})},drawMcWidget:function(c){var a=this,b=a.getRsbWidget();if(!Ext.isEmpty(c)){b.down("#debt").update({debt:LkIp.Utils.numberConvert(c.debt)});b.down("#overpayment").update({overpayment:LkIp.Utils.numberConvert(c.overpayment)});b.down("#unexpay").update({unexpay:LkIp.Utils.numberConvert(c.unexpay)})}},rsbExpand:function(f,b){var c=this,a=b.id.split("-")[0],d=c.getRsbWidget(),h=d.down("#"+a+"-cards"),g=d.down("#"+a);Ext.suspendLayouts();if(h.isHidden()){h.show();g.removeCls("collapsed");g.addCls("expanded")}else{h.hide();g.removeCls("expanded");g.addCls("collapsed")}Ext.Array.each(c.rsbExpandItems,function(e){if(a!==e){d.down("#"+e+"-cards").hide();d.down("#"+e).removeCls("expanded").addCls("collapsed")}});Ext.resumeLayouts(true)},drawTaxWidget:function(a){var c=this,b=c.getTaxModeWidget();if(!Ext.Object.isEmpty(a)){if(Ext.isEmpty(a.wait)){b.addTabs(a);b.down("#tabs-block").setActiveTab(0);c.renderTaxModeTooltip(b.down("#tabs-block").getActiveTab())}else{b.down("#tabs-block").hide();b.down("#no-tax-mode").hide();b.down("#tax-info-text").show().update(reference.lang.dataWaiting)}}else{b.down("#tabs-block").hide();b.down("#no-tax-mode").hide();b.down("#tax-info-text").removeCls("rsb-wait-info-text").addCls("rsb-none-info-text").show().update("-")}},renderTaxModeTooltip:function(e){var f=this,d=f.getTaxModeWidget(),b=e.down("#tooltip"),c=e.itemId.split("-")[0],a=LkIp.Settings.get("otherTaxMode");if(!Ext.isEmpty(b)&&!Ext.Array.contains(f.createdTooltips,e.itemId)){LkIp.Utils.tooltip(b,"usn"===c?d.tooltips[c][a.usn["@ObNalCheck"]]:d.tooltips[c],{componentCls:"taxmode-tooltip",anchor:"bottom"});f.createdTooltips.push(e.itemId)}},toggleTaxModeInfo:function(){var d=this.getTaxModeWidget().down("#tabs-block"),a=d.getActiveTab(),b=a.down("#mode-description"),c=a.down("#mode-description-short");Ext.suspendLayouts();if(b.isHidden()){b.show();c.hide()}else{b.hide();c.show()}Ext.resumeLayouts(true)},goToCardInfo:function(b,a){this.getViewport().setLoading(true);Ext.util.Cookies.set("currentCardIndex",Ext.get(a).dom.getAttribute("fid"));LkIp.Utils.goTo("#!/rsb/cards/details");return true},dropWindow:function(d){var b=d.portal.items.items,a=[],c;Ext.Array.each(b,function(e){c={};Ext.Array.each(e.items.items,function(f){c[f.id]={height:f.height}});a.push(c)});Ext.util.Cookies.set("widget-order",Ext.JSON.encode(a),Ext.Date.add(new Date(),Ext.Date.YEAR,1))},resizeWindow:function(){var a=this.getWidgetPanel();a.fireEvent("drop",{portal:a})},changeMonthAction:function(b,a){this.generateTooltipsForCalendar(LkIp.Settings.get("payEvents"))},generateTooltipsForCalendar:function(b){var c=this,d=c.getTaxCalendarWidget().down("#taxpayerCalendar"),a=d.getActiveCells();if(!Ext.isEmpty(c.tooltips)){c.destroyCalendarTooltips()}if(!Ext.isEmpty(a)){Ext.Array.each(a,function(h){var f=h.firstChild.dateValue,i=Ext.Array.filter(b,function(j){return LkIp.Utils.getDateObject(j.date).getTime()==f}),e;if(!Ext.isEmpty(i)){e="<div>";var g=i.length;Ext.Array.each(i,function(l,k){e+='<div class="'+(i.length>1&&(i.length-1)!=k?"default-bottom-separator":"")+'">';if(Ext.isEmpty(l.common)){e+=new Ext.XTemplate(c.ttipTpl).apply({header:l.type===1?"\u041f\u0440\u0435\u0434\u0441\u0442\u043e\u044f\u0449\u0438\u0439 \u043f\u043b\u0430\u0442\u0435\u0436":"\u041f\u0440\u0435\u0434\u0441\u0442\u043e\u044f\u0449\u0438\u0439 \u043f\u043b\u0430\u0442\u0435\u0436 (\u0430\u0432\u0430\u043d\u0441)",body:"\u043f\u043e "+l.name+(l.status!==""?" ("+l.status+")":"")+" \u0434\u043e "+Ext.Date.format(LkIp.Utils.getDateObject(l.date),"d.m.Y")})}else{if(l.common=="booking"){e+=new Ext.XTemplate(c.ttipTpl).apply({header:l.name+":",body:l.no+" <br/>\u043d\u0430 "+l.time})}else{var j="\u043f\u043e "+l.shortKBK+" \u0434\u043e "+Ext.Date.format(LkIp.Utils.getDateObject(l.date),"d.m.Y");if(l.common==11){j+="<div>"+l.help+"</div>";if(g==1){Ext.get(h).addCls("active-blue")}}e+=new Ext.XTemplate(c.ttipTpl).apply({header:l.name,body:j})}}e+="</div>"});e+="</div>";c.tooltips.push(LkIp.Utils.tooltip(h,e,{componentCls:"taxcalendar-widget-tooltip",dismissDelay:10000}))}})}},destroyCalendarTooltips:function(){Ext.Array.each(this.tooltips,function(a){a.destroy()})},updateNewAnswers:function(){var a=LkIp.app.getController("Index").getMailWidget().down("#countNewAnswers");if(LkIp.User.isActiveUser()){LkIp.Request.setMaxAttempts(4).request({url:"/api/documents/getStatistics",method:"GET"},function(e){var d=0,c=0,b=["193","194","195"];if(LkIp.Utils.isJsonSuccess(e)){if(!Ext.isEmpty(e.response.StatistPoTipuDokum)){Ext.Array.each(e.response.StatistPoTipuDokum,function(f){if(b.indexOf(f["@Tip"])!=-1){d+=parseInt(f["@KolDokNov"]);c+=parseInt(f["@KolDokVsego"])}})}}a.update({count:LkIp.Utils.isJsonSuccess(e)&&e.response.StatistDokum["@KolOtvetNov"]!=0?e.response.StatistDokum["@KolOtvetNov"]:"",noticeCount:c,noticeNewCount:d})})}}},0,0,0,0,0,0,[LkIp.controller,"Index"],0));(Ext.cmd.derive("LkIp.controller.Viewport",Ext.app.Controller,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"updateUserInfoBlock",selector:"updateInformationBlock"},{ref:"videoWindow",selector:"educationVideo"}],userInfoTooltip:null,cacheDocuments:false,signDocumentWindow:undefined,init:function(){var b=this,a=Ext.getBody();a.addListener("click",this.logoutAction,this,{preventDefault:true,stopEvent:true,delegate:".logout"});a.addListener("click",function(){},this,{preventDefault:true,stopEvent:true,delegate:".none-click"});a.addListener("click",this.reconciliationSection,this,{preventDefault:false,stopEvent:false,delegate:"#reconciliationSection"});a.addListener("click",this.goToLk2,this,{preventDefault:false,stopEvent:false,delegate:".lk2check"});a.addListener("click",this.showVideoWindow,this,{preventDefault:false,stopEvent:false,delegate:".showMainVideoAgain"});a.addListener("click",this.goToFeedback,this,{preventDefault:false,stopEvent:false,delegate:"#goToFeedback-link"});a.addListener("click",this.goToMarkirovka,this,{preventDefault:false,stopEvent:false,delegate:".markirovkaLink"});a.addListener("click",this.goToSmp,this,{preventDefault:false,stopEvent:false,delegate:".smpLink"});a.addListener("click",function(d,c){if(c.hash.indexOf("#!/")===0&&d.button==0&&Ext.isEmpty(d.target.target)&&c.hash!=b.getCurrentPageUrl()){if(!Ext.isEmpty(LkIp.Msg.header)){LkIp.Msg.close()}}},this,{preventDefault:false,stopEvent:false,delegate:"a"});a.addListener("click",function(d,c){b.openAnketa()},this,{preventDefault:false,stopEvent:false,delegate:".go-to-anketa"});this.control({'updateInformationBlock [name="close-forever"]':{change:this.changeShowUpdateInfoBlockState},'educationVideo [name="close-video-forever"]':{change:this.changeVideoCheckboxFieldState},selectCertificate:{close:function(){this.signDocumentWindow=undefined}}})},loading:function(a){this.getViewport().down("#content-container").getLayout().getActiveItem().setLoading(a)},getCurrentPageUrl:function(){var c=document.location.href.indexOf("#!"),b=document.location.href.indexOf("?"),a=b>-1?b:document.location.href.length;if(c===-1){return"#!/index"}else{return document.location.href.substring(c,a)}},showInformationPopUpBlocks:function(){if("#!/index"==LkIp.app.getController("Content").getCurrentPageUrl()||!LkIp.User.isActiveUser()){if(LkIp.User.get("isDataUpdating")){if(Ext.isEmpty(Ext.util.Cookies.get("hideDataUpdatingBlock"))){this.showDataUpdatingBlockWindow()}}else{this.closeUpdateInformationBlock()}}},closeUpdateInformationBlock:function(){if(Ext.isEmpty(Ext.util.Cookies.get("hideVideo"))){this.showVideoWindow()}},goToFeedback:function(){var a=this;a.getUpdateUserInfoBlock().close();LkIp.Utils.goTo("#!/feedback")},setCookieDependencyForWindowBlocks:function(b,a){if(b){Ext.util.Cookies.set(a,1,Ext.Date.add(new Date(),Ext.Date.YEAR,1))}else{Ext.util.Cookies.clear(a)}},changeShowUpdateInfoBlockState:function(a,b){this.setCookieDependencyForWindowBlocks(b,"hideDataUpdatingBlock")},changeVideoCheckboxFieldState:function(a,b){this.setCookieDependencyForWindowBlocks(b,"hideVideo")},reconciliationSection:function(){LkIp.FlashData.set("reconciliationSection",1)},logoutAction:function(){this.getViewport().setLoading(reference.lang.viewport.exit);LkIp.Auth.logout(function(){LkIp.Settings.cleanStore()})},showBreadcrumbs:function(c,b){var f=this.getViewport().down("#breadcrumbs"),a=[],e=0,d=c.length;f.removeAll();if(!Ext.isEmpty(c)){for(;e<d;e++){if(b!==c[e].href){a.push(this.decorateBreadcrumb(c[e]))}a.push('<span class="separator">/</span>')}a.pop();f.show().add(a)}else{f.hide()}},decorateBreadcrumb:function(a){return Ext.String.format('<a href="{0}" name="{1}">{2}</a>',a.href,a.key,a.menuTitle)},signAction:function(d,a){var c=this,b=a.loader;if(false!==d&&!(Ext.isEmpty(d.response))){if(0!==d.status){if("UFNS_EXPERIMENT_ERROR"===d.response){LkIp.Msg.error(reference.lang.ufnsExperimentError);b.setLoading(false);return false}if(!LkIp.Signature.checkPlugin()){b.setLoading(false);return}if(!LkIp.User.isActiveUser()){b.setLoading(false);c.tellUserThatHeCannotSendDocumentsBecauseHeIsClosed();return}if(LkIp.Signature.isEnabled()){LkIp.Signature.reset();if(!Ext.isEmpty(d.response["@hash"])){LkIp.Signature.reset();a.signXml=!Ext.isEmpty(a.signXml)&&a.signXml;if(Ext.isEmpty(a.gp3)){a.gp3=false}if(LkIp.User.authorizedByAnyCertificate()){c.startGettingHash(d,LkIp.User.getCertificateIdentifier(),a)}else{c.drawSignDocumentWindow(function(e){c.startGettingHash(d,e,a)},a)}}else{b.setLoading(false);LkIp.Msg.error("\u041e\u0442\u043a\u043b\u044e\u0447\u0435\u043d\u043e \u043f\u043e\u0434\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u043e\u0432.")}}else{b.setLoading(false);LkIp.app.fireEvent("clearCache");if(typeof a.successCallback!=="undefined"){a.successCallback()}else{LkIp.Msg.success(reference.lang.signature.successDefault)}}}else{b.setLoading(false);if(typeof a.errorCallback!=="undefined"){a.errorCallback(d.response)}else{LkIp.Msg.error(d.response)}}}else{b.setLoading(false);LkIp.Msg.error(reference.lang.errors.serverError)}},jacartaTokenError:function(){LkIp.Msg.error(reference.lang.jacarta.removeTokenError)},drawSignDocumentWindow:function(e,b){var c=this;if(!LkIp.Signature.isPluginLoaded()){var a=new Ext.util.DelayedTask(function(){c.drawSignDocumentWindow(e,b)});a.delay(200);return}if(LkIp.Signature.isPluginEnabled()){LkIp.Signature.loadCertificates();if(!LkIp.Signature.isCertificateListLoaded()){var d=new Ext.util.DelayedTask(function(){c.drawSignDocumentWindow(e,b)});d.delay(500);return}}b.loader.setLoading(false);c.signDocumentWindow=Ext.create("LkIp.view.SignDocumentWindow",{title:reference.lang.certificateWindow.title,signDocumentCallback:e});c.signDocumentWindow.show()},startGettingHash:function(d,b,a){var c=this;a.loader.setLoading(true);LkIp.Signature.sign(d.response["@hash"],b,a);c.tryToGetSignature(d,b,a)},tryToGetSignature:function(d,c,i){var f=this;if(LkIp.Signature.isSigning()){var b=new Ext.util.DelayedTask(function(){f.tryToGetSignature(d,c,i)});b.delay(500);return}if(LkIp.Signature.hasSigningError()){i.loader.setLoading(false);var g=LkIp.Signature.getSigningError();if(typeof i.errorCallback!=="undefined"){i.errorCallback(g)}else{i.loader.setLoading(false);LkIp.Msg.error(g)}return}var a=LkIp.Signature.getSigningResults(),e={id:d.response["@id"],type:d.response["@typeId"]};if(Ext.isArray(a)){var h=[];Ext.Array.each(a,function(j,k){h["signHash["+k+"][name]"]=j.id;h["signHash["+k+"][signHash]"]=j.hash});e=Ext.Object.merge(e,h)}else{e.signHash=a.hash}if(!LkIp.User.authorizedByAnyCertificate()){e.b64=LkIp.Signature.getCertificateContent(c)}e.gp3=i.gp3;if(!Ext.isEmpty(i.withoutSigning)&&i.withoutSigning&&typeof i.successCallback!=="undefined"){i.loader.setLoading(false);i.successCallback(e);return}LkIp.Request.request({url:"/api/document/sign",scope:this,params:e,method:"POST"},function(j){i.loader.setLoading(false);if(false!==j){if(0!==j.status){LkIp.app.fireEvent("clearCache");if(typeof i.successCallback!=="undefined"){i.successCallback()}else{LkIp.Msg.success(reference.lang.signature.successDefault)}}else{if(typeof i.errorCallback!=="undefined"){i.errorCallback(j.response)}else{LkIp.Msg.error(j.response)}}}else{LkIp.Msg.error(reference.lang.errors.serverError)}})},goToLk2:function(){var a=this;a.loading(true);LkIp.Request.request({url:"/api/user/getLk2Token",method:"GET"},function(b){a.loading(false);if(false==b||Ext.isEmpty(b.response)){LkIp.Msg.info(reference.lang.lk2Unavailable)}else{if(0==b.status){LkIp.Msg.info(b.response)}else{window.location=b.response}}})},goToMarkirovka:function(){var a=this;a.loading(true);LkIp.Request.request({url:"/api/user/markirovka",method:"GET"},function(b){a.loading(false);if(false==b||Ext.isEmpty(b.response)){LkIp.Msg.info(reference.lang.markirovkaError)}else{if(0==b.status){LkIp.Msg.info(b.response)}else{LkIp.Utils.openExternalLink(b.response.link)}}})},goToSmp:function(){var a=this;a.loading(true);LkIp.Request.request({url:"/api/user/smp",method:"GET"},function(b){a.loading(false);if(false==b||Ext.isEmpty(b.response)){LkIp.Msg.info(reference.lang.markirovkaError)}else{if(0==b.status){LkIp.Msg.info(b.response)}else{LkIp.Utils.openExternalLink(b.response.link)}}})},showVideoWindow:function(){Ext.create("LkIp.view.EducationVideo",{}).show();if(!Ext.isEmpty(Ext.util.Cookies.get("hideVideo"))){this.getVideoWindow().down('[name="close-video-forever"]').setValue(true)}},showDataUpdatingBlockWindow:function(){Ext.create("LkIp.view.UpdateInformationBlock",{}).show()},drawCards:function(c,e,d){var b=this,a="";d=d||"-1";Ext.suspendLayouts();Ext.Array.each(c,function(f,h){if(d!="-1"){if(h>=d){return false}}if(0===h||0===h%4){f.firstBlock=1}else{f.firstBlock=0}f.index=h;var g=new Ext.XTemplate(f.countCards>1?b.manyCardsTpl:b.oneCardTpl);if(1==f.countCards){f.withDebt=f.debt.total>0;f.debtSumm=LkIp.Utils.generateNumberString(f.debt.total);f.overpaymentSumm=LkIp.Utils.generateNumberString(f.overpayment.total)}else{Ext.Array.each(f.children,function(i){if("undefined"!==typeof i.children){return 0!=Ext.Array.each(i.children,function(j){if(j.debt.total>0){f.withDebt=1;return false}})}else{if(i.debt.total>0){f.withDebt=1;return false}}});f.debtSumm=LkIp.Utils.generateNumberString(f.debt.total);f.overpaymentSumm=LkIp.Utils.generateNumberString(f.overpayment.total)}a+=g.apply(f)});e.add({xtype:"component",html:a});Ext.resumeLayouts(true)},anketa:undefined,openAnketa:function(){var a=this;if(!Ext.isEmpty(a.anketa)){a.anketa.destroy()}a.anketa=Ext.create("LkIp.view.AnketaWindow");a.anketa.show()},tellUserAboutHeadProblems:function(){LkIp.Msg.error(reference.lang.kkt.headError)},tellUserThatHeCannotSendDocumentsBecauseHeIsClosed:function(){LkIp.Msg.error(reference.lang.errors.closedUser)},oneCardTpl:'<tpl if="firstBlock == 0"><div fid="{fid}" class="rsb-cards-item"><tpl else><div fid="{fid}" class="rsb-cards-item first-card"></tpl><div class="wrap-item"><div class="header-block"><div class="header"><span class="show-full-name-tooltip" fullName="{nameKBK}">{cardHeader}</span></div><div class="sub-header">{subHeader}</div></div><div class="summ-block"><div class="summ debt"><span class="orange-minus-icon">{debtSumm}</span></div><div class="summ overpayment"><span class="blue-plus-icon">{overpaymentSumm}</span></div></div></div></div>',manyCardsTpl:'<tpl if="firstBlock == 0"><div class="rsb-cards-item" fid="{fid}"><tpl else><div class="rsb-cards-item first-card" fid="{fid}"></tpl><div class="wrap-item many-cards-block"><div class="header-block"><div class="header fl-l"><span class="show-full-name-tooltip" fullName="{nameKBK}">{cardHeader}</span> <span class="countCards">{countCards}</span></div><div class="clear"></div></div><div class="summ-block"><div class="summ debt"><span class="orange-minus-icon">{debtSumm}</span></div><div class="summ overpayment"><span class="blue-plus-icon">{overpaymentSumm}</span></div></div></div></div>'},0,0,0,0,0,0,[LkIp.controller,"Viewport"],0));(Ext.cmd.derive("LkIp.model.Egrn.Account.Grid",Ext.data.Model,{fields:["@ImyaPrichinyi","@DataPostanovki","@DataSnyatiya","@KodNalOrg","@ImyaNalOrg","@AdresNalOrg"]},0,0,0,0,0,0,[LkIp.model.Egrn.Account,"Grid"],0));(Ext.cmd.derive("LkIp.store.Egrn.Account.GridStore",LkIp.store.DefaultStore,{model:"LkIp.model.Egrn.Account.Grid",url:"/egrn/getInfo",pageSize:100},0,0,0,0,0,0,[LkIp.store.Egrn.Account,"GridStore"],0));(Ext.cmd.derive("LkIp.controller.Egrn.Account",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"egrnAccount"},{ref:"grid",selector:"#egrnAccountGrid"},{ref:"filterPanel",selector:"#egrnFilterPanel"}],models:["Egrn.Account.Grid"],cache:false,account_type:1,dateRemoveColumn:undefined,firstLoad:true,filtersLoaded:false,filtersParams:{1:{},2:{}},defaultFiltersResult:[],getEgrnAccountStore:function(){return this.getStore("Egrn.Account.GridStore")},init:function(){this.getEgrnAccountStore().on({beforeload:{fn:this.beforeloadGrid,scope:this},load:{fn:this.loadGrid,scope:this}});this.control({'#statusBarTabsEgrnAccount [type="status-bar-tab"]':{activate:this.activateStatusTab},egrnAccount:{activate:function(){if(false===this.cache){this.getIndex().setLoading(true)}}},'egrnAccount [rel="apply"]':{applyFilters:this.applyFiltersAction},'egrnAccount [rel="reset"]':{resetFilters:this.resetFiltersAction},"#egrnFilterPanel":{expand:this.expandFilterPanel},'#egrnFilterPanel [name="codeRegion"]':{change:this.changeRegion},'#egrnFilterPanel [name="codeNO"]':{change:this.changeNo},"#egrnAccountGrid":{getFile:this.getFileAction}});this.callParent()},loadIndex:function(){var b=this,a=LkIp.User.get("head");b.callParent();b.dateRemoveColumn=Ext.getCmp("dateRemoveColumn");if(false===b.cache){if(!LkIp.User.isInspectorWithCodeNO()){b.regionStore=Ext.getStore("egrnRegionStore");b.noStore=Ext.getStore("egrnNoStore")}b.reasonStore=Ext.getStore("egrnReasonStore");if(!Ext.isEmpty(a)){b.updateHeadInfo(a)}b.loadFirstPage();b.firstLoad=false;b.cache=true}else{b.loadFirstPage()}b.getIndex().setLoading(false)},updateHeadInfo:function(a){this.updateFlInfo(!Ext.isEmpty(a.SvedFL)?a.SvedFL:{FIO:[],UdLichn:[]});this.updateIpInfo(!Ext.isEmpty(a.SvedUchet)?a.SvedUchet:{SvedUchetIP:[]});this.updateCertificateInfo(!Ext.isEmpty(a.SvedUchet["SvedUchetIP"]["SvedSvid"])?a.SvedUchet["SvedUchetIP"]["SvedSvid"]:{})},updateFlInfo:function(a){return this.getIndex().down("#tabFL").update({certUser:LkIp.User.isActiveUser()?1:0,name:!Ext.isEmpty(a.FIO["@Imya"])?a.FIO["@Imya"]:"-",surname:!Ext.isEmpty(a.FIO["@Familiya"])?a.FIO["@Familiya"]:"-",patronymic:!Ext.isEmpty(a.FIO["@Otchestvo"])?a.FIO["@Otchestvo"]:"-",document:!Ext.isEmpty(a.UdLichn["@Naimenovanie"])?a.UdLichn["@Naimenovanie"]:"-",birthDate:!Ext.isEmpty(a["@DataRojd"])?LkIp.Utils.getDate(a["@DataRojd"]):"-",series:!Ext.isEmpty(a.UdLichn["@SerNomDok"])?a.UdLichn["@SerNomDok"]:"-",whenGet:!Ext.isEmpty(a.UdLichn["@DataDok"])?LkIp.Utils.getDate(a.UdLichn["@DataDok"]):"-",address:!Ext.isEmpty(a.Address)?a.Address:"-",whoGive:!Ext.isEmpty(a.UdLichn["@NaimOrgVyidDok"])?a.UdLichn["@NaimOrgVyidDok"]:"-"})},updateIpInfo:function(c){var d=!Ext.isEmpty(c["@KodNalOrg"])?LkIp.Utils.noRenderer(c["@KodNalOrg"]):"-",b=!Ext.isEmpty(c["@ImyaNalOrg"])?"-"+c["@ImyaNalOrg"]:"-",a=!Ext.isEmpty(c["@AdresNalOrg"])?","+c["@AdresNalOrg"]:"-";if(Ext.isEmpty(c.SvedUchetIP)){c.SvedUchetIP={}}return this.getIndex().down("#tabIP").update({no:d+b+a,datePMJ:!Ext.isEmpty(c["@DataPostMJ"])?LkIp.Utils.getDate(c["@DataPostMJ"]):"-",reasonName:!Ext.isEmpty(c.SvedUchetIP["@NaimPrichPostIP"])?c.SvedUchetIP["@NaimPrichPostIP"]:"",reasonDate:!Ext.isEmpty(c.SvedUchetIP["@DataPostIP"])?LkIp.Utils.getDate(c.SvedUchetIP["@DataPostIP"]):""})},updateCertificateInfo:function(a){return this.getIndex().down("#tabCertificate").update({series:!Ext.isEmpty(a["@Seriya"])?a["@Seriya"]:"-",number:!Ext.isEmpty(a["@Nomer"])?a["@Nomer"]:"-",dateGet:!Ext.isEmpty(a["@DataVyid"])?LkIp.Utils.getDate(a["@DataVyid"]):"-"})},loadFirstPage:function(a){this.getEgrnAccountStore().loadPage(1,{params:Ext.isObject(a)?a:{}})},getFiltersParams:function(b){b=b||false;var c=Ext.Object.merge(this.filtersParams[this.account_type],{account_type:this.account_type});if(b){var a={};Ext.Object.each(c,function(d,e){if(!LkIp.Utils.isFilterEmpty(e)){a[d]=e}});return a}return c},beforeloadGrid:function(){var a=this;a.applySelectedFilters();a.getEgrnAccountStore().extraParams=this.getFiltersParams(true)},applySelectedFilters:function(){var b=this,a=b.getFiltersParams();Ext.suspendLayouts();if(Ext.Object.getSize(a)>1){Ext.Object.each(a,function(c,d){if(c==="account_type"){return}if(!LkIp.Utils.isFilterEmpty(d)){b.getFilterPanel().down('[name="'+c+'"]').setValue(d)}else{b.getFilterPanel().down('[name="'+c+'"]').reset()}})}else{if(typeof b.getFilterPanel()!="undefined"){b.getFilterPanel().getForm().reset()}}Ext.resumeLayouts(true)},loadGrid:function(){},activateStatusTab:function(a){Ext.suspendLayouts();switch(a.id){case"tab-all-reasons":this.account_type=2;break;case"tab-active-reasons":default:this.account_type=1;break}this.toggleReasonElements();Ext.resumeLayouts(true);if(this.filtersLoaded){if(!LkIp.User.isInspectorWithCodeNO()){this.loadRegion();this.loadNo();this.loadReason()}else{this.loadReason(false,LkIp.User.get("inspectorCodeNO"))}}if(!this.firstLoad){this.getEgrnAccountStore().removeAll();this.loadFirstPage()}},toggleReasonElements:function(){var b=this,a=this.getFilterPanel().down('[name="date_remove"]');if(Ext.isEmpty(b.dateRemoveColumn)){b.dateRemoveColumn=Ext.getCmp("dateRemoveColumn")}if(1===b.account_type){b.dateRemoveColumn.hide();a.hide()}else{b.dateRemoveColumn.show();a.show()}},applyFiltersAction:function(){this.filtersParams[this.account_type]=this.getFilterPanel().getForm().getValues();this.loadFirstPage()},resetFiltersAction:function(){this.filtersParams[this.account_type]={};Ext.suspendLayouts();this.getFilterPanel().getForm().reset();Ext.resumeLayouts(true);this.loadFirstPage()},expandFilterPanel:function(){if(!this.filtersLoaded){this.loadFilters()}},loadFilters:function(){var a=this;a.getFilterPanel().setLoading(true);LkIp.Request.request({url:"/api/egrn/getFilters",scope:this},function(b){a.getFilterPanel().setLoading(false);if(LkIp.Utils.isJsonSuccess(b)){a.defaultFiltersResult=b.response;if(!LkIp.User.isInspectorWithCodeNO()){a.loadRegion();a.loadNo();a.loadReason()}else{a.loadReason(false,LkIp.User.get("inspectorCodeNO"))}a.filtersLoaded=true}})},loadRegion:function(){this.regionStore.loadData(this.defaultFiltersResult[this.account_type]["region"]);LkIp.Utils.checkFilterStore(this.getFilterPanel().down('[name="codeRegion"]'))},loadNo:function(b){b=b||false;var a;if(false===b){a=this.defaultFiltersResult[this.account_type]["no"]}else{a=this.getDataBy("region",this.defaultFiltersResult[this.account_type]["no"],b)}this.noStore.loadData(2===this.account_type?LkIp.Utils.unique(a,"code"):a);LkIp.Utils.checkFilterStore(this.getFilterPanel().down('[name="codeNO"]'))},getDataBy:function(c,a,d){var b=[];Ext.Array.each(a,function(e){if(e[c]==d||"0"==e.code){b.push(e)}});return b},loadReason:function(d,e){var c=this,b=c.defaultFiltersResult[this.account_type]["reasons"],a=c.getFilterPanel().down('[name="codeReason"]');a.reset();d=d||false;e=e||false;if(false!==e){b=this.getDataBy("no",b,e)}else{if(false!==d){b=this.getDataBy("region",b,d)}}c.reasonStore.loadData(LkIp.Utils.unique(b,"code"))},changeRegion:function(b){var c=this,d=b.getValue(),a=b.getStore();if(0!==a.getCount()){d=0==d?false:d;c.loadNo(d);if(0==c.getFilterPanel().down('[name="codeNO"]').getValue()){c.loadReason(d)}}},changeNo:function(b){var c=this,d=b.getValue(),a=b.getStore();if(0!==a.getCount()){if(0!=d){c.getFilterPanel().down('[name="codeRegion"]').setValue(d.substring(0,2))}c.loadReason(false,0==d?false:d)}},getFileAction:function(){var a=this;LkIp.Utils.downloadDocument("egrnAccount","/api/egrn/getFile",a.getFiltersParams(true))}},0,0,0,0,0,0,[LkIp.controller.Egrn,"Account"],0));(Ext.cmd.derive("LkIp.controller.Rsb.Cards",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"rsbCards"}],init:function(){this.control({rsbCards:{activate:function(){this.cards=[];this.getIndex().down("#rsb-cards-items").removeAll()}}});this.callParent()},loadIndex:function(){var a=this;a.callParent();a.getIndex().setLoading(true);a.getRsbCards()},getRsbCards:function(){var a=this;if(Ext.isEmpty(LkIp.Settings.get("cards"))){LkIp.Request.request({url:"/api/rsb/cards/getDetails",scope:this,params:LkIp.User.isInspectorWithCodeNO()?{codeNO:LkIp.User.get("codeNO")}:{}},function(c){var b=LkIp.Utils.isJsonSuccess(c)?c.response:[];LkIp.Settings.set("cards",b);a.cards=b.cards;a.showCards();if(0==c.status){LkIp.Msg.error(reference.lang.dataLoadError)}},true)}else{a.cards=LkIp.Settings.get("cards").cards;a.showCards()}},showCards:function(){var b=this,a=b.getIndex();Ext.suspendLayouts();if(!Ext.isEmpty(b.cards)){LkIp.app.getController("Viewport").drawCards(b.cards,a.down("#rsb-cards-items"))}Ext.getBody().addListener("click",this.goToCardInfo,this,{preventDefault:true,stopEvent:false,delegate:".rsb-cards-item"});Ext.resumeLayouts(true);a.setLoading(false)},goToCardInfo:function(b,a){Ext.util.Cookies.set("currentCardIndex",Ext.get(a).dom.getAttribute("fid"));LkIp.Utils.goTo("#!/rsb/cards/details");return true}},0,0,0,0,0,0,[LkIp.controller.Rsb,"Cards"],0));(Ext.cmd.derive("LkIp.model.Rsb.Cards.Nds.Grid",Ext.data.Model,{fields:["@DataPodachi","@Nomer","@NalPeriod","@SrokUpl","@SummaDekl"]},0,0,0,0,0,0,[LkIp.model.Rsb.Cards.Nds,"Grid"],0));(Ext.cmd.derive("LkIp.store.Rsb.Cards.Nds.GridStore",LkIp.store.DefaultStore,{model:"LkIp.model.Rsb.Cards.Nds.Grid",url:"/rsb/cards/nds/getInfo/{fidCard}"},0,0,0,0,0,0,[LkIp.store.Rsb.Cards.Nds,"GridStore"],0));(Ext.cmd.derive("LkIp.mixins.Rsb.CardInfo",Ext.Base,{cardData:{},getCardData:function(b,e){var d=this,c=b.getIndex(),a=c.down('[name="rsbCardsTitle"]');LkIp.Request.request({url:"/api/rsb/cards/getCardInfo/"+b.fidCard,scope:this},function(f){if(f==false||Ext.isEmpty(f.response)||Ext.isEmpty(f.response.KRSB)){LkIp.Msg.error(reference.lang.rsb.cards.errors.canNotGetCardData);LkIp.History.back();return false}if(a!==null){a.update({imyaKbk:Ext.isEmpty(f.response.KRSB["@ImyaKBK"])?"-":f.response.KRSB["@ImyaKBK"]})}d.cardData=f.response.KRSB;c.down('[name="rsbCardTpl"]').update({kbkOkato:(Ext.isEmpty(f.response.KRSB["@KodKBK"])?"-":f.response.KRSB["@KodKBK"])+"/"+(Ext.isEmpty(f.response.KRSB["@OKATO_OKTMO"])?"-":f.response.KRSB["@OKATO_OKTMO"]),status:Ext.isEmpty(f.response.KRSB["@ImyaStatus"])?"-":(f.response.KRSB["@KodStatus"]+"-"+f.response.KRSB["@ImyaStatus"]),no:Ext.isEmpty(f.response.KRSB["@ImyaNO"])?"-":(LkIp.Utils.noRenderer(f.response.KRSB["@KodNO"])+"-"+f.response.KRSB["@ImyaNO"]),dateSost:Ext.isEmpty(f.response.KRSB["@DataSostRasch"])?"-":LkIp.Utils.getDate(f.response.KRSB["@DataSostRasch"])});if(typeof e!=="undefined"){e()}})},removeCardData:function(b,d){var c=b.getIndex(),a=c.down('[name="rsbCardsTitle"]');if(a!==null){a.update({imyaKbk:""})}c.down('[name="rsbCardTpl"]').update({kbkOkato:"-",status:"-",no:"-",dateSost:"-"});if(typeof d!=="undefined"){d()}}},0,0,0,0,0,0,[LkIp.mixins.Rsb,"CardInfo"],0));(Ext.cmd.derive("LkIp.controller.Rsb.Cards.Nds",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"rsbCardsNds"},{ref:"grid",selector:"#rsbCardsNdsGrid"}],models:["Rsb.Cards.Nds.Grid"],cache:false,getNdsStore:function(){return this.getStore("Rsb.Cards.Nds.GridStore")},init:function(){this.getNdsStore().on({beforeload:{fn:this.beforeloadGrid,scope:this},load:{fn:this.loadGrid,scope:this}});this.control({rsbCardsNds:{activate:function(){if(false===this.cache){this.getIndex().setLoading(true)}},deactivate:function(){this.removeCardData(this);this.getNdsStore().removeAll()}},"#rsbCardsNdsGrid":{getFile:this.getFileAction}});this.callParent()},loadIndex:function(){var b=this,a=b.callParent();if(false!==a){b.getCardData(b,function(){b.getIndex().setLoading(false);b.loadFirstPage()})}},loadFirstPage:function(a){this.getNdsStore().loadPage(1,{params:Ext.isObject(a)?a:{}})},beforeloadGrid:function(){this.getNdsStore().extraParams={fidCard:this.fidCard}},loadGrid:function(){this.getIndex().setLoading(false)},getFileAction:function(){var a=this;LkIp.Utils.downloadDocument("rsbCardsNds","/api/rsb/cards/nds/getFile/"+a.fidCard,{})}},0,0,0,0,0,[["cardInfo",LkIp.mixins.Rsb.CardInfo]],[LkIp.controller.Rsb.Cards,"Nds"],0));(Ext.cmd.derive("LkIp.model.Rsb.Cards.Hung.Grid",Ext.data.Model,{fields:["@DokOsnNom","@DokOsnData","@DokOsnNaimen","@SummOpUpl","@NaimBanka","@NomerScheta","@TipPl","@SrokUpl","@SummUplBank","@DokOsnPriznIspNom","@DokOsnPriznIspData","@OrgPrinyavResh"]},0,0,0,0,0,0,[LkIp.model.Rsb.Cards.Hung,"Grid"],0));(Ext.cmd.derive("LkIp.store.Rsb.Cards.Hung.GridStore",LkIp.store.DefaultStore,{model:"LkIp.model.Rsb.Cards.Hung.Grid",url:"/api/rsb/cards/operations/other/getInfo/{fidCard}"},0,0,0,0,0,0,[LkIp.store.Rsb.Cards.Hung,"GridStore"],0));(Ext.cmd.derive("LkIp.controller.Rsb.Cards.Hung",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"rsbCardsHung"},{ref:"grid",selector:"#rsbCardsHungGrid"}],models:["Rsb.Cards.Hung.Grid"],cache:false,getHungStore:function(){return this.getStore("Rsb.Cards.Hung.GridStore")},init:function(){this.getHungStore().on({beforeload:{fn:this.beforeloadGrid,scope:this},load:{fn:this.loadGrid,scope:this}});this.control({rsbCardsHung:{activate:function(){if(false===this.cache){this.getIndex().setLoading(true)}},deactivate:function(){this.removeCardData(this);this.getHungStore().removeAll()}},"#rsbCardsHungGrid":{getFile:this.getFileAction}});this.callParent()},loadIndex:function(){var b=this,a=b.callParent();if(false!==a){b.getCardData(b,function(){b.getIndex().setLoading(false);b.loadFirstPage()})}},loadFirstPage:function(a){this.getHungStore().loadPage(1,{params:Ext.isObject(a)?a:{}})},beforeloadGrid:function(){this.getHungStore().extraParams={fidCard:this.fidCard}},loadGrid:function(){this.getIndex().setLoading(false)},getFileAction:function(){var a=this;LkIp.Utils.downloadDocument("rsbCardsHung","/api/rsb/cards/operations/other/getFile/"+a.fidCard,{})}},0,0,0,0,0,[["cardInfo",LkIp.mixins.Rsb.CardInfo]],[LkIp.controller.Rsb.Cards,"Hung"],0));(Ext.cmd.derive("LkIp.model.Rsb.Cards.Operations.Grid",Ext.data.Model,{fields:["@SrokUpl","@ImyaOp","@ImyaTipPl","@SummOpNach","@SummOpUpl","@SummRaschOp","DokOsnNumberDokOsnDataDocOsnNaimen","DokOsnNumber","DokOsnData","DocOsnNaimen","@DataRaschOp","@DataNachPeni","DokOsnPeriod","@NaprPlat","NaprZachKBK","NaprZachOKATO_OKTMO","NaprZachImyaTipPl"]},0,0,0,0,0,0,[LkIp.model.Rsb.Cards.Operations,"Grid"],0));(Ext.cmd.derive("LkIp.store.Rsb.Cards.Operations.GridStore",LkIp.store.DefaultStore,{model:"LkIp.model.Rsb.Cards.Operations.Grid",url:"/rsb/cards/operations/getInfo/{fidCard}/{year}"},0,0,0,0,0,0,[LkIp.store.Rsb.Cards.Operations,"GridStore"],0));(Ext.cmd.derive("LkIp.controller.Rsb.Cards.Operations",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"rsbCardsOperations"},{ref:"grid",selector:"#rsbCardsOperationsGrid"},{ref:"filterPanel",selector:"#rsbCardsOperationsFilterPanel"}],models:["Rsb.Cards.Operations.Grid"],cache:false,getOperationsStore:function(){return this.getStore("Rsb.Cards.Operations.GridStore")},init:function(){this.getOperationsStore().on({beforeload:{fn:this.beforeloadGrid,scope:this},load:{fn:this.loadGrid,scope:this}});this.control({rsbCardsOperations:{activate:function(){if(false===this.cache){this.getIndex().setLoading(true)}},deactivate:function(){this.removeCardData(this);this.getOperationsStore().removeAll();this.filtersLoaded=false;this.getIndex().down("#rsbCardsOperationsFilterPanel").collapse()}},'rsbCardsOperations [rel="apply"]':{applyFilters:this.applyFiltersAction},'rsbCardsOperations [rel="reset"]':{resetFilters:this.resetFiltersAction},"#rsbCardsOperationsFilterPanel":{expand:this.expandFilterPanel},'#rsbCardsOperationsFilterPanel [name="year"]':{change:this.changeYearAction},"#rsbCardsOperationsGrid":{getFile:this.getFileAction,toggleAccountingPeriodFilter:this.toggleAccountingPeriodFilterAction}});this.callParent()},loadIndex:function(){var b=this,a=b.callParent();if(false!==a){b.rsbCardsPaymentTypeStore=Ext.getStore("rsbCardsPaymentTypeStore");b.rsbCardsAccountingPeriodStore=Ext.getStore("rsbCardsAccountingPeriodStore");b.rsbCardsYearStore=Ext.getStore("rsbCardsYearStore");b.getCardData(b,function(){b.getIndex().setLoading(false);b.filtersParams={year:Ext.Date.format(new Date(),"Y")};b.loadFirstPage()})}},loadFirstPage:function(a){this.getOperationsStore().loadPage(1,{params:Ext.isObject(a)?a:{}})},beforeloadGrid:function(){var b=this,a=b.getFiltersParams(true);b.applySelectedFilters(["year"]);a.fidCard=b.fidCard;b.getOperationsStore().extraParams=a;this.getIndex().down('[name="saldo-block"]').update({tax:"-",peni:"-",penalty:"-",procent:"-",procentNo:"-"})},resetFiltersAction:function(){Ext.suspendLayouts();typeof this.getFilterPanel()!="undefined"&&this.getFilterPanel().getForm().reset();Ext.resumeLayouts(true);this.filtersParams={year:this.getFilterPanel().down('[name="year"]').getValue()}},loadGrid:function(b){if(!Ext.isEmpty(b)&&!Ext.isEmpty(b.getProxy().getReader().rawData)&&!Ext.isEmpty(b.getProxy().getReader().rawData.response)){var a=typeof b.getProxy().getReader().rawData.response.saldo!="undefined"?b.getProxy().getReader().rawData.response.saldo:{"@Nalog":"","@Peni":"","@ProtsentNO":"","@Protsentyi":"","@SHtrafyi":""};this.getIndex().down('[name="saldo-block"]').update({tax:Ext.isEmpty(a["@Nalog"])?"-":LkIp.Utils.numberConvert(a["@Nalog"]),peni:Ext.isEmpty(a["@Peni"])?"-":LkIp.Utils.numberConvert(a["@Peni"]),penalty:Ext.isEmpty(a["@SHtrafyi"])?"-":LkIp.Utils.numberConvert(a["@SHtrafyi"]),procent:Ext.isEmpty(a["@Protsentyi"])?"-":LkIp.Utils.numberConvert(a["@Protsentyi"]),procentNo:Ext.isEmpty(a["@ProtsentNO"])?"-":LkIp.Utils.numberConvert(a["@ProtsentNO"])})}},getFileAction:function(){var b=this.getFiltersParams(true),a=b.year;delete b.year;LkIp.Utils.downloadDocument("rsbCardsOperations","/api/rsb/cards/operations/getFile/"+this.fidCard+"/"+a,b)},expandFilterPanel:function(){if(!this.filtersLoaded){this.rsbCardsYearStore.loadData(this.getDataForYearStore());this.getFilterPanel().down('[name="year"]').setValue(Ext.Date.format(new Date(),"Y"));this.loadFilters()}},loadFilters:function(a){var b=this,c=b.getFilterPanel().down('[name="year"]');a=a||false;b.getFilterPanel().setLoading(true);LkIp.Request.request({url:"/api/rsb/cards/operations/getFilters/"+b.fidCard+"/"+c.getValue(),scope:this},function(d){b.getFilterPanel().setLoading(false);b.rsbCardsPaymentTypeStore.loadData(d.response.paymentType);b.rsbCardsAccountingPeriodStore.loadData(d.response.accountingPeriod);b.filtersLoaded=true;if(a){b.loadFirstPage()}})},getDataForYearStore:function(){var c=Ext.Date.format(new Date(),"Y"),a=Ext.Date.format(Ext.Date.parse(this.cardData["@DataOtkrKart"],"Y-m-d"),"Y"),b=(c-2)>=a?(c-2):(c-1)==a?(c-1):c,e=c,d=[];for(;e>=b;e--){d.push({code:e,value:e})}return d},toggleAccountingPeriodFilterAction:function(a){if(a){this.getFilterPanel().down('[name="accountingPeriod"]').show()}else{this.getFilterPanel().down('[name="accountingPeriod"]').hide()}},changeYearAction:function(b,d){var c=this,a=c.getFilterPanel();c.filtersLoaded=false;if(d!=0){a.setLoading(true);a.down('[name="typePayment"]').reset();a.down('[name="accountingPeriod"]').reset();a.down('[name="paymentDate"]').reset();this.filtersParams={year:d};c.loadFilters(true)}}},0,0,0,0,0,[["cardInfo",LkIp.mixins.Rsb.CardInfo],["filters",LkIp.mixins.Filters]],[LkIp.controller.Rsb.Cards,"Operations"],0));(Ext.cmd.derive("LkIp.model.Rsb.Cards.Debt.Grid",Ext.data.Model,{fields:["@FIdUregZadolj","@NaimSpUreg","@OsnUreg","@UpolnOrg","@NomerResh","@DataResh","@NomerZayavl","@DataZayavl","@SummaResh","@OstSummaResh"]},0,0,0,0,0,0,[LkIp.model.Rsb.Cards.Debt,"Grid"],0));(Ext.cmd.derive("LkIp.store.Rsb.Cards.Debt.GridStore",LkIp.store.DefaultStore,{model:"LkIp.model.Rsb.Cards.Debt.Grid",url:"/api/rsb/cards/debt/getInfo/{fidCard}"},0,0,0,0,0,0,[LkIp.store.Rsb.Cards.Debt,"GridStore"],0));(Ext.cmd.derive("LkIp.controller.Rsb.Cards.Debt",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"rsbCardsDebt"},{ref:"grid",selector:"#rsbCardsDebtGrid"},{ref:"filterPanel",selector:"#rsbCardsDebtFilterPanel"}],models:["Rsb.Cards.Debt.Grid"],cache:false,filtersLoaded:false,filtersParams:{},getDebtStore:function(){return this.getStore("Rsb.Cards.Debt.GridStore")},init:function(){this.getDebtStore().on({beforeload:{fn:this.beforeloadGrid,scope:this},load:{fn:this.loadGrid,scope:this}});this.control({rsbCardsDebt:{activate:function(){if(false===this.cache){this.getIndex().setLoading(true)}},deactivate:function(){this.removeCardData(this);this.getDebtStore().removeAll()}},'rsbCardsDebt [rel="apply"]':{applyFilters:this.applyFiltersAction},'rsbCardsDebt [rel="reset"]':{resetFilters:this.resetFiltersAction},'rsbCardsDebt [rel="showDecisionContent"]':{click:this.pushButtonAction},"#rsbCardsDebtFilterPanel":{expand:this.expandFilterPanel},"#rsbCardsDebtGrid":{getFile:this.getFileAction,selectionchange:this.selectionChangeAction}});this.callParent()},loadIndex:function(){var b=this,a=b.callParent();if(false!==a){if(false===b.cache){b.settlementModeStore=Ext.getStore("rsbCardsSettlementModeStore");b.settlementReasonStore=Ext.getStore("rsbCardsSettlementReasonStore")}b.getCardData(b,function(){b.getIndex().setLoading(false);b.loadFirstPage()})}},loadFirstPage:function(a){this.getDebtStore().loadPage(1,{params:Ext.isObject(a)?a:{}})},getFiltersParams:function(b){b=b||false;if(b){var a={};Ext.Object.each(this.filtersParams,function(c,d){if(!LkIp.Utils.isFilterEmpty(d)){a[c]=d}});return a}return this.filtersParams},beforeloadGrid:function(){var a=this;a.applySelectedFilters();a.getDebtStore().extraParams=Ext.apply(a.getFiltersParams(true),{fidCard:this.fidCard})},loadGrid:function(){this.getIndex().setLoading(false)},applySelectedFilters:function(){var b=this,a=b.getFiltersParams();Ext.suspendLayouts();if(Ext.Object.getSize(a)>1){Ext.Object.each(a,function(c,d){if(!LkIp.Utils.isFilterEmpty(d)){b.getFilterPanel().down('[name="'+c+'"]').setValue(d)}else{b.getFilterPanel().down('[name="'+c+'"]').reset()}})}else{if(typeof b.getFilterPanel()!="undefined"){b.getFilterPanel().getForm().reset()}}Ext.resumeLayouts(true)},applyFiltersAction:function(){this.filtersParams=this.getFilterPanel().getForm().getValues();this.loadFirstPage()},resetFiltersAction:function(){this.filtersParams={};Ext.suspendLayouts();this.getFilterPanel().getForm().reset();Ext.resumeLayouts(true);this.loadFirstPage()},expandFilterPanel:function(){if(!this.filtersLoaded){this.loadFilters()}},loadFilters:function(){var a=this;a.getFilterPanel().setLoading(true);LkIp.Request.request({url:"/api/rsb/cards/debt/getFilters/"+a.fidCard,scope:this},function(b){a.getFilterPanel().setLoading(false);a.settlementModeStore.loadData(b.response.settlementMode);a.settlementReasonStore.loadData(b.response.settlementReason);a.filtersLoaded=true})},pushButtonAction:function(){var a=this.getGrid().getSelected();if(!Ext.isEmpty(a)){LkIp.Utils.goTo(this.getCurrentPageUrl()+"/object?"+this.fidCard+"&"+a.data["@FIdUregZadolj"])}else{LkIp.Msg.error(reference.lang.rsb.cards.debt.errors.cardNotSelected)}},getFileAction:function(){var a=this;LkIp.Utils.downloadDocument("rsbCardsDebt","/api/rsb/cards/debt/getFile/"+a.fidCard,a.getFiltersParams(true))},selectionChangeAction:function(c,a){var b=this;if(a.length){b.getIndex().down('[rel="showDecisionContent"]').enable()}}},0,0,0,0,0,[["cardInfo",LkIp.mixins.Rsb.CardInfo]],[LkIp.controller.Rsb.Cards,"Debt"],0));(Ext.cmd.derive("LkIp.model.Rsb.Cards.Debt.Object.GraphDebtPercent.Grid",Ext.data.Model,{fields:["@FIdZapisi","@SrokUpl","@SummaPlat","@SummaUplPlat","@OstKUplate"]},0,0,0,0,0,0,[LkIp.model.Rsb.Cards.Debt.Object.GraphDebtPercent,"Grid"],0));(Ext.cmd.derive("LkIp.store.Rsb.Cards.Debt.Object.GraphDebtPercent.GridStore",LkIp.store.DefaultStore,{model:"LkIp.model.Rsb.Cards.Debt.Object.GraphDebtPercent.Grid",url:"/api/rsb/cards/debt/schedule/getInfo/{fidDebt}",sorters:[{property:"@SrokUpl",direction:"ASC"}],pageSize:10},0,0,0,0,0,0,[LkIp.store.Rsb.Cards.Debt.Object.GraphDebtPercent,"GridStore"],0));(Ext.cmd.derive("LkIp.model.Rsb.Cards.Debt.Object.GraphWriteOff.Grid",Ext.data.Model,{fields:["@SummaZadolj","@NomerDok","@DataDok","@OsnSpisZadolj"]},0,0,0,0,0,0,[LkIp.model.Rsb.Cards.Debt.Object.GraphWriteOff,"Grid"],0));(Ext.cmd.derive("LkIp.store.Rsb.Cards.Debt.Object.GraphWriteOff.GridStore",LkIp.store.DefaultStore,{model:"LkIp.model.Rsb.Cards.Debt.Object.GraphWriteOff.Grid",url:"/api/rsb/cards/debt/schedule/cancelled/getInfo/{fidDebt}"},0,0,0,0,0,0,[LkIp.store.Rsb.Cards.Debt.Object.GraphWriteOff,"GridStore"],0));(Ext.cmd.derive("LkIp.model.Rsb.Cards.Debt.Object.GraphInfo.Grid",Ext.data.Model,{fields:["@SummaPlat","@NomerDok","@DataDok","@NaimDok"]},0,0,0,0,0,0,[LkIp.model.Rsb.Cards.Debt.Object.GraphInfo,"Grid"],0));(Ext.cmd.derive("LkIp.store.Rsb.Cards.Debt.Object.GraphInfo.GridStore",LkIp.store.DefaultStore,{model:"LkIp.model.Rsb.Cards.Debt.Object.GraphInfo.Grid",url:"/api/rsb/cards/debt/schedule/payments/getInfo/{fidDebt}/{fidNote}"},0,0,0,0,0,0,[LkIp.store.Rsb.Cards.Debt.Object.GraphInfo,"GridStore"],0));(Ext.cmd.derive("LkIp.mixins.Rsb.Debt.DecisionInfo",Ext.Base,{objectsData:[],getDecisionData:function(a,d){var c=this,b=a.getIndex();LkIp.Request.request({url:"/api/rsb/cards/debt/getObjects/"+a.fidCard+"/"+a.fidDebtCard,scope:this},function(e){if(e==false||Ext.isEmpty(e.response)||Ext.isEmpty(e.response.info)){LkIp.Msg.error(reference.lang.rsb.cards.debt.errors.canNotGetDecisionInfo);LkIp.Utils.goTo(a.currentPage.href.substring(0,a.currentPage.href.lastIndexOf("/")));return false}c.objectsData=e.response.objects;b.down('[name="rsbDebtObjTpl"]').update({spUreg:Ext.isEmpty(e.response.info["@NaimSpUreg"])?"-":e.response.info["@NaimSpUreg"],osnUreg:Ext.isEmpty(e.response.info["@OsnUreg"])?"-":e.response.info["@OsnUreg"],infoDoc:(Ext.isEmpty(e.response.info["@NomerResh"])?"-":e.response.info["@NomerResh"])+" / "+(Ext.isEmpty(e.response.info["@DataResh"])?"-":LkIp.Utils.getDate(e.response.info["@DataResh"])),protsKred:Ext.isEmpty(e.response.info["@ProtsKred"])?"-":e.response.info["@ProtsKred"],upOrgResh:Ext.isEmpty(e.response.info["@UpolnOrg"])?"-":e.response.info["@UpolnOrg"],infoZayavl:(Ext.isEmpty(e.response.info["@NomerZayavl"])?"-":e.response.info["@NomerZayavl"])+" / "+(Ext.isEmpty(e.response.info["@DataZayavl"])?"-":LkIp.Utils.getDate(e.response.info["@DataZayavl"])),urBuydj:Ext.isEmpty(e.response.info["@UrByudj"])?"-":e.response.info["@UrByudj"]});if(typeof d!=="undefined"){d()}})},removeDecisionData:function(a,b){a.getIndex().down('[name="rsbDebtObjTpl"]').update({spUreg:"-",osnUreg:"-",infoDoc:"-",protsKred:"-",upOrgResh:"-",infoZayavl:"-",urBuydj:"-"});if(typeof b!=="undefined"){b()}}},0,0,0,0,0,0,[LkIp.mixins.Rsb.Debt,"DecisionInfo"],0));(Ext.cmd.derive("LkIp.controller.Rsb.Cards.DebtObject",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"rsbCardsDebtObj"},{ref:"tabpanel",selector:"#debtObjectTabPanel"},{ref:"filterPanel",selector:"#debtObjectFilterPanel"},{ref:"graphDebtPercentGrid",selector:"#graphDebtPercentGrid"},{ref:"graphWriteOffGrid",selector:"#graphWriteOffGrid"},{ref:"graphInfoGrid",selector:"#graphInfoGrid"}],models:["Rsb.Cards.Debt.Object.GraphDebtPercent.Grid","Rsb.Cards.Debt.Object.GraphWriteOff.Grid","Rsb.Cards.Debt.Object.GraphInfo.Grid"],cache:false,filtersParams:{1:{},2:{}},graphType:1,getGraphDebtPercentStore:function(){return this.getStore("Rsb.Cards.Debt.Object.GraphDebtPercent.GridStore")},getGraphWriteOffStore:function(){return this.getStore("Rsb.Cards.Debt.Object.GraphWriteOff.GridStore")},getGraphInfoStore:function(){return this.getStore("Rsb.Cards.Debt.Object.GraphInfo.GridStore")},init:function(){var a=Ext.getBody();a.addListener("click",this.returnToDebt,this,{preventDefault:true,delegate:"#backToDebt"});a.addListener("click",this.returnToDebt,this,{preventDefault:true,delegate:"a[name='rsbCardsDebt']"});this.getGraphDebtPercentStore().on({beforeload:{fn:this.beforeloadGraphDebtPercentGrid,scope:this}});this.getGraphWriteOffStore().on({beforeload:{fn:this.beforeloadGraphWriteOffGrid,scope:this}});this.getGraphInfoStore().on({beforeload:{fn:this.beforeloadGraphInfoGrid,scope:this}});this.control({"#debtObjectTabPanel":{tabchange:this.activateTab},"#statusBarTabsDebtObject":{tabchange:this.activateStatusTab},rsbCardsDebtObj:{activate:function(){if(false===this.cache){this.getIndex().setLoading(true)}this.getTabpanel().activeTab=null},deactivate:function(){var b=this;Ext.suspendLayouts();b.removeCardData(b);b.removeDecisionData(b);b.getIndex().down("#subGridBlock").hide();b.getIndex().down("#mainGridBlock").hide();Ext.Array.each(this.getTabpanel().getTabBar().items.items,function(c){c.setDisabled(true)});b.getTabpanel().hide();Ext.resumeLayouts(true)}},'#debtObjectFilterPanel [rel="apply"]':{applyFilters:this.applyFiltersAction},'#debtObjectFilterPanel [rel="reset"]':{resetFilters:this.resetFiltersAction},"#graphDebtPercentGrid":{selectionchange:this.selectGraphRow}});this.callParent()},loadIndex:function(){var c=this,b=c.callParent(),a={vidPl:5};if(false!==b){c.getCardData(c,function(){c.getDecisionData(c,function(){if(!Ext.isEmpty(c.objectsData)){Ext.suspendLayouts();Ext.Object.each(c.objectsData,function(e,d){var f=c.getTabpanel().child("[vidPl="+e+"]");f.fidObject=d["@FIdObyektUreg"];f.setDisabled(false);a=e<a.vidPl?f:a;f.down('[name="summInfo"]').update({summa:LkIp.Utils.numberConvert(d["@Summa"]),unpaidSumma:LkIp.Utils.numberConvert(d["@OstSumma"]),period:LkIp.Utils.getDate(d["@DataNach"])+" - "+LkIp.Utils.getDate(d["@DataKon"])})});c.getIndex().down("#mainGridBlock").show();c.getTabpanel().setActiveTab(a);c.getTabpanel().show();Ext.resumeLayouts(true)}c.getIndex().setLoading(false)})})}},currentFidObject:undefined,firstLoad:true,activateTab:function(b,c){var d=this,a=d.getIndex().down("#statusBarTabsDebtObject");d.currentFidObject=c.fidObject;d.clearData();a.activeTab=null;a.setActiveTab(0)},clearData:function(){var a=this;a.getGraphDebtPercentStore().removeAll();a.getGraphWriteOffStore().removeAll();a.getGraphInfoStore().removeAll();a.filtersParams={1:{},2:{}};a.getFilterPanel().getForm().reset()},activateStatusTab:function(a,b){var c=this;Ext.suspendLayouts();switch(b.itemId){case"tab-info-write-off":c.graphType=3;break;case"tab-graph-percent":c.graphType=2;break;case"tab-graph-debt":default:c.graphType=1;break}if(c.graphType==1||c.graphType==2){c.getGraphDebtPercentGrid().show();c.getFilterPanel().show();c.getGraphWriteOffGrid().hide();c.getIndex().down("#subGridBlock").hide();c.getGraphDebtPercentStore().removeAll()}else{c.getGraphWriteOffGrid().show();c.getGraphDebtPercentGrid().hide();c.getFilterPanel().hide();c.getIndex().down("#subGridBlock").hide();c.getGraphWriteOffStore().removeAll()}Ext.resumeLayouts(true);if(c.graphType==1||c.graphType==2){c.loadFirstPage("shedule")}else{c.loadFirstPage("cancelled")}},loadFirstPage:function(c,d){var b=this,a="";switch(c){case"payments":a=b.getGraphInfoStore();break;case"cancelled":a=b.getGraphWriteOffStore();break;case"shedule":default:a=b.getGraphDebtPercentStore()}if(!Ext.isEmpty(a)){a.loadPage(1,{params:Ext.isObject(d)?d:{}});b.firstLoad=false}},beforeloadGraphDebtPercentGrid:function(){var b=this,a=b.getFiltersParams(true);b.applySelectedFilters(["graphType"]);a.fidDebt=b.currentFidObject;b.getGraphDebtPercentStore().extraParams=a},beforeloadGraphWriteOffGrid:function(){this.getGraphWriteOffStore().extraParams={fidDebt:this.currentFidObject}},beforeloadGraphInfoGrid:function(){this.getGraphInfoStore().extraParams={graphType:this.graphType,fidDebt:this.currentFidObject,fidNote:this.fidNote}},selectGraphRow:function(a,b){var c=this,d=c.getIndex().down("#subGridBlock");if(!Ext.isEmpty(b)){c.fidNote=b[0].data["@FIdZapisi"];d.show();LkIp.Utils.scrollTo(d);c.loadFirstPage("payments")}},applyFiltersAction:function(){this.filtersParams[this.graphType]=this.getFilterPanel().getForm().getValues();this.loadFirstPage("shedule")},resetFiltersAction:function(){this.filtersParams[this.graphType]={};Ext.suspendLayouts();this.getFilterPanel().getForm().reset();Ext.resumeLayouts(true);this.loadFirstPage()},getFiltersParams:function(b){b=b||false;var c=Ext.Object.merge(this.filtersParams[this.graphType],{graphType:this.graphType});if(b){var a={};Ext.Object.each(c,function(d,e){if(!LkIp.Utils.isFilterEmpty(e)){a[d]=e}});return a}return c},returnToDebt:function(){LkIp.Utils.goTo("#!/rsb/cards/debt?"+this.fidCard)}},0,0,0,0,0,[["cardInfo",LkIp.mixins.Rsb.CardInfo],["decisionInfo",LkIp.mixins.Rsb.Debt.DecisionInfo],["filters",LkIp.mixins.Filters]],[LkIp.controller.Rsb.Cards,"DebtObject"],0));(Ext.cmd.derive("LkIp.controller.Rsb.Cards.Budget",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"rsbCardsBudget"},{ref:"grid",selector:"#rsbCardsBudgetGrid"}],models:["Rsb.Budget"],init:function(){this.control({rsbCardsBudget:{activate:function(){this.getIndex().setLoading(true)},deactivate:function(){this.removeCardData(this);this.getGrid().getStore().getRootNode().removeAll()}}});this.callParent()},loadIndex:function(){var b=this,a=b.callParent();if(false!==a){b.budgetGridStore=Ext.getStore("cardsBudgetGridStore");b.getCardData(b,function(){b.getIndex().setLoading(false);b.getIndex().down('[name="goToOperationsButton"]').update({fidCard:b.fidCard});b.loadGridData()})}},loadGridData:function(){var a=this;a.getGrid().setLoading(true);LkIp.Request.request({url:"/api/rsb/cards/budget/getInfo/"+a.fidCard,scope:this},function(b){a.getGrid().setLoading(false);if(false!==b&&!Ext.isEmpty(b.response)){a.budgetGridStore.getRootNode().appendChild(b.response.children)}})}},0,0,0,0,0,[["cardInfo",LkIp.mixins.Rsb.CardInfo]],[LkIp.controller.Rsb.Cards,"Budget"],0));(Ext.cmd.derive("LkIp.model.Rsb.Overpayment.Grid",Ext.data.Model,{fields:["@FIdKart","@KodNO","@ImyaNO","@ImyaKBK","@KodKBK","@OKATO_OKTMO","@PriznakOKATO_OKTMO","@TipPl","@TipPlNaim","@Summa","@SummaPeresch","@VidN","@VidNNaim","@VidNNZ","@Status","@KodStatus"]},0,0,0,0,0,0,[LkIp.model.Rsb.Overpayment,"Grid"],0));(Ext.cmd.derive("LkIp.store.Rsb.Overpayment.GridStore",LkIp.store.DefaultStore,{model:"LkIp.model.Rsb.Overpayment.Grid",url:"/rsb/overpayment/getInfo"},0,0,0,0,0,0,[LkIp.store.Rsb.Overpayment,"GridStore"],0));(Ext.cmd.derive("LkIp.controller.Rsb.Overpayment",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"rsbOverpayment"},{ref:"grid",selector:"#rsbOverpaymentGrid"},{ref:"filterPanel",selector:"#rsbOverpaymentFilterPanel"}],models:["Rsb.Overpayment.Grid"],cache:false,getOverpaymentStore:function(){return this.getStore("Rsb.Overpayment.GridStore")},init:function(){this.getOverpaymentStore().on({beforeload:{fn:this.beforeloadGrid,scope:this},load:{fn:this.loadGrid,scope:this}});this.control({rsbOverpayment:{activate:function(){},deactivate:function(){if(LkIp.User.isInspector()){this.getIndex().down('[name="rsbOverpaymentStatementButton"]').disable()}this.getGrid().getStore().removeAll()}},'rsbOverpayment [rel="apply"]':{applyFilters:this.applyFiltersAction},'rsbOverpayment [rel="reset"]':{resetFilters:this.resetFiltersAction},"#rsbOverpaymentFilterPanel":{expand:this.expandFilterPanel},"#rsbOverpaymentGrid":{getFile:this.getFileAction,selectionchange:this.selectionChangeAction},'rsbOverpayment [name="rsbOverpaymentStatementButton"]':{click:this.pushGridButtonAction}});this.callParent()},loadIndex:function(){var a=this;a.callParent();if(false===a.cache){a.noStore=Ext.getStore("rsbOverpaymentNoStore");a.kbkStore=Ext.getStore("rsbOverpaymentKbkStore");a.typeTaxStore=Ext.getStore("rsbOverpaymentTypeTaxStore");a.statusIPStore=Ext.getStore("rsbOverpaymentStatusIPStore");a.typePaymentStore=Ext.getStore("rsbOverpaymentTypePaymentStore");a.cache=true}a.loadFirstPage()},loadFirstPage:function(a){this.getOverpaymentStore().loadPage(1,{params:Ext.isObject(a)?a:{}})},beforeloadGrid:function(){var a=this;a.applySelectedFilters();a.getOverpaymentStore().extraParams=this.getFiltersParams(true)},loadGrid:function(){this.getIndex().setLoading(false)},loadFilters:function(){var a=this;a.getFilterPanel().setLoading(true);LkIp.Request.request({url:"/api/rsb/overpayment/getFilters",params:LkIp.Utils.checkForInspectorNo(),scope:this},function(b){a.getFilterPanel().setLoading(false);if(!LkIp.User.isInspectorWithCodeNO()){a.noStore.loadData(b.response.no)}a.kbkStore.loadData(b.response.kbk);a.statusIPStore.loadData(b.response.statusIP);a.typePaymentStore.loadData(b.response.typePayment);a.filtersLoaded=true})},getFileAction:function(){var a=this;LkIp.Utils.downloadDocument("rsbOverpayment","/api/rsb/overpayment/getFile",a.getFiltersParams(true))},selectionChangeAction:function(d,a){if(a.length&&(LkIp.User.isActiveUser())){var b=this.getIndex().down('[name="rsbOverpaymentStatementButton"]'),c=a[0].get("@SummaPeresch");if(!Ext.isEmpty(c)&&c!=0){b.enable()}else{this.getGrid().getView().deselect(a);b.disable()}}},pushGridButtonAction:function(a){var c=this,b=c.getGrid().getSelectionModel().getSelection();if(b.length){var d=b[0].get("@SummaPeresch");if(!Ext.isEmpty(d)&&d!=0){c.getIndex().setLoading(true);LkIp.Request.request({url:"/api/rsb/overpayment/checkPage",params:{typeInfo:2,typeTax:b[0].get("@VidN"),typeTaxLaw:b[0].get("@VidNNZ")}},function(e){c.getIndex().setLoading(false);if(false!==e&&0!==e.status){LkIp.FlashData.set("rsbOverpayment",1);if(e.response["@ObschSum"]!=0){LkIp.Utils.goTo("#!/rsb/overpayment/statement?offset&"+b[0].get("@FIdKart")+"&"+b[0].get("@TipPl"))}else{LkIp.Utils.goTo("#!/rsb/overpayment/statement?return&"+b[0].get("@FIdKart")+"&"+b[0].get("@TipPl"))}}else{LkIp.Msg.error(reference.lang.rsb.overpayment.errors.noCardData)}})}else{c.getGrid().getView().deselect(b);LkIp.Msg.error(reference.lang.rsb.overpayment.errors.cardNotSelected)}}}},0,0,0,0,0,[["filters",LkIp.mixins.Filters]],[LkIp.controller.Rsb,"Overpayment"],0));(Ext.cmd.derive("LkIp.view.Envd.ActivityInfo",Ext.Container,{layout:{type:"auto"},cls:"envd-activity-info",required:'<span class="form-required-field" data-qtip="'+reference.lang.form.required+'">*</span>',number:0,defaultAddressString:undefined,initComponent:function(){var a=this;Ext.apply(this,{items:[{xtype:"container",width:"100%",cls:"field-container",defaults:{width:650,labelWidth:400,padding:"10 0 0"},items:[{xtype:"component",cls:"fieldset-title",html:reference.lang.envd.form.activityTitle},{xtype:"filterSelect",name:this.number+"[codeActivity]",allowBlank:false,itemId:"activity",displayField:"fullName",tpl:'<tpl for="."><tpl if="code != 0"><li data-qtip="{qtip}" class="x-boundlist-item" role="option">{fullName}</li></tpl><tpl if="code == 0"><li class="x-boundlist-item" role="option">{value}</li></tpl></tpl>',fieldLabel:reference.lang.envd.form.activity,afterLabelTextTpl:this.required,store:"Envd.ActivityStore"},{xtype:"container",width:"100%",itemId:"addressDescription"+this.number,margin:"10 0 0",index:this.index,items:[{xtype:"container",layout:"auto",defaults:{style:{marginTop:"5px",marginRight:"10px"},componentCls:"fl-l",xtype:"component"},items:[{html:reference.lang.taxSystem.psn.patent.addressLabel,itemId:"addressLabel"+this.index},{html:a.defaultAddressString,itemId:"addressString"+this.index},{xtype:"button",idBlock:"addressDescription"+this.index,margin:"0",itemId:"editAddress",scale:"small",index:this.index,html:reference.lang.buttons.editAddress}]}]},{xtype:"container",width:"100%",margin:"0 0 5",items:[{xtype:"button",itemId:"removeActivity",idBlock:this.itemId,componentCls:"fl-l",html:reference.lang.buttons.remove}]},{xtype:"component",width:"100%",html:"<hr>"}]}]});this.callParent()}},0,["envdActivityInfo"],["component","envdActivityInfo","container","box"],{component:true,envdActivityInfo:true,container:true,box:true},["widget.envdActivityInfo"],0,[LkIp.view.Envd,"ActivityInfo"],0));(Ext.cmd.derive("LkIp.store.Envd.ActivityStore",LkIp.store.DefaultStore,{model:"LkIp.model.Filters.SelectFilters"},0,0,0,0,0,0,[LkIp.store.Envd,"ActivityStore"],0));(Ext.cmd.derive("LkIp.store.Envd.RegionStore",LkIp.store.DefaultStore,{model:"LkIp.model.Filters.SelectFilters"},0,0,0,0,0,0,[LkIp.store.Envd,"RegionStore"],0));(Ext.cmd.derive("LkIp.controller.Envd",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"}],models:["Filters.SelectFilters"],defaultAddressObject:{region:"",regionName:"",postcode:"",oktmo:"",district:"",city:"",locality:"",street:"",house:"",housing:"",apartment:"",noFromAddress:""},addressData:[],getActivityStore:function(){return this.getStore("Envd.ActivityStore")},init:function(){this.control({"#envd-form-registration":{validitychange:this.validitychange},"#envd-form-deregistration":{validitychange:this.validitychange},envdRegistration:{activate:this.activatePage},envdDeregistration:{activate:this.activatePage},'[name="reasonDeregistration"]':{change:this.changeReasonDeregistration},'[name="subFile"]':{change:this.changeSubFile},'[name="envdSignButton"]':{click:this.submitFormAction},'[name="envdShowButton"]':{click:this.getPdf},"#addActivity":{click:this.addActivity},"#removeActivity":{click:this.removeActivity},"envdRegistration #editAddress":{click:this.editAddress},"envdDeregistration #editAddress":{click:this.editAddress},"#registration_address":{addEnvdAddress:this.addAddress,close:this.closeAddress},"#deregistration_address":{addEnvdAddress:this.addAddress,close:this.closeAddress}});this.callParent()},loadIndex:function(){var a=this,b=a.getEnvdPage();a.callParent();a.noStore=Ext.getStore("envdNoStore-"+b);LkIp.Request.request({url:"/api/envd/getReferenceData"},function(d){var c=LkIp.User.get("head");if(typeof d.response.region!="undefined"){a.defaultAddressObject.region=d.response.region;a.defaultAddressObject.regionName=d.response.regionName;a.defaultAddressObject.addressString=d.response.regionName}a.referenceData=d.response;a.noStore.loadData(a.referenceData.no);a.getActivityStore().loadData(a.referenceData.activity);if("deregistration"==b){a.reasonsStore=Ext.getStore("envdReasonDeregistrationStore");a.reasonsStore.loadData(a.referenceData.reason);a.getFormPanel().down("#reasonDeregistration").enable().show();a.getFormPanel().down("#reasonDeregistration").setValue(1)}else{a.getFormPanel().down("#reasonDeregistration").disable().hide();a.addActivity();a.getFormPanel().down("#activityBlock0").down('[idBlock="activityBlock0"]').hide()}if(!Ext.isEmpty(c)){a.getFormPanel().down("#no").setValue(c.SvedUchet["@KodNalOrg"])}a.getIndex().setLoading(false)})},checkAddresses:function(){var a=true;Ext.Array.each(this.addressData,function(b,c){if(Ext.isEmpty(b.addressString)){a=false;return false}});return a},validitychange:function(c,e){var d=this,b=d.getIndex().down('[name="envdSignButton"]'),a=d.getIndex().down('[name="envdShowButton"]');if(e){if(!d.checkAddresses()){b.disable();a.disable()}else{b.enable();a.enable()}}else{b.disable();a.disable()}},checkValidity:function(){var c=this,b=c.getIndex().down('[name="envdSignButton"]'),a=c.getIndex().down('[name="envdShowButton"]');c.validateForm()},activatePage:function(){var b=this;b.getIndex().setLoading(true);Ext.suspendLayouts();if(b.countActivity>0){for(var a=b.countActivity;a>0;a--){b.getFormPanel().down("#activityContainer").remove("activityBlock"+(parseInt(a)-1))}}Ext.resumeLayouts(true);b.countActivity=0;b.indexActivity=0;b.addressData=[]},getEnvdPage:function(){return document.location.href.indexOf("deregistration")>-1?"deregistration":"registration"},getIndex:function(){return Ext.getCmp("envd"+LkIp.Utils.ucfirst(this.getEnvdPage()))},getFormPanel:function(){return this.getIndex().down("#envd-form-"+this.getEnvdPage())},countActivity:0,indexActivity:0,autoAddEl:null,changeReasonDeregistration:function(a,c){var b=this;3==c?b.getFormPanel().down('[name="dateTax"]').disable().hide():b.getFormPanel().down('[name="dateTax"]').enable().show();if(4==c){if(0==b.countActivity){b.autoAddEl=b.addActivity();b.autoAddEl.down("#removeActivity").hide()}}else{if(null!==b.autoAddEl){b.autoAddEl.down("#removeActivity").show()}}b.checkValidity()},validateForm:function(){this.getFormPanel().getForm().checkValidity()},addActivity:function(){var b=this,a=b.getFormPanel();++b.countActivity;b.addressData[b.indexActivity]=b.defaultAddressObject;a.down("#activityContainer").add({xtype:"envdActivityInfo",defaultAddressString:b.defaultAddressObject.addressString,index:b.indexActivity,number:"activity["+b.indexActivity+"]",itemId:"activityBlock"+b.indexActivity});b.indexActivity++;b.checkValidity()},removeActivity:function(a){this.getFormPanel().down("#activityContainer").remove(a.idBlock);--this.countActivity;this.checkValidity()},submitFormAction:function(){var a=this,b=Ext.apply(a.getFormPanel().getValues(),{type:a.getEnvdPage()});Ext.Array.each(a.addressData,function(c,d){Ext.Object.each(c,function(f,e){b["activity["+d+"]["+f+"]"]=e})});a.getIndex().setLoading(true);LkIp.Request.request({url:"/api/envd/request",scope:this,params:b,method:"POST"},function(c){LkIp.app.getController("Viewport").signAction(c,{loader:a.getIndex()})})},getPdf:function(){var b=this,a=Ext.apply(b.getFormPanel().getValues(),{type:b.getEnvdPage()});Ext.Array.each(b.addressData,function(c,d){Ext.Object.each(c,function(f,e){a["activity["+d+"]["+f+"]"]=e})});LkIp.Utils.downloadDocument("envd"+b.getEnvdPage(),"/api/envd/pdf",a)},changeSubFile:function(b,c){var a=this.getFormPanel().down("#email");c?a.enable().show():a.disable().hide();a.reset();this.checkValidity()},editAddress:function(a){var b=this,c=b.addressData[a.index];Ext.create("LkIp.view.AddressBlock",{data:c,oktmoRequired:false,event:"addEnvdAddress",checkExistEvent:undefined,hasCustomAddressField:false,selectRegion:true,hideOktmo:true,checkNo:false,buttonCheck:false,addAddressText:reference.lang.kkt.registration.chooseAddress,componentCls:"center-block",itemId:b.getEnvdPage()+"_address",closeAddressText:false,insertId:a.index}).show();b.checkValidity()},addAddress:function(a,b){var c=this;c.addressData[b]=a;c.getIndex().down("#addressString"+b).update(a.addressString);c.checkValidity()},closeAddress:function(){this.checkValidity()}},0,0,0,0,0,0,[LkIp.controller,"Envd"],0));(Ext.cmd.derive("LkIp.controller.Rsb.Clarify",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"clarify"}],init:function(){this.callParent()},loadIndex:function(){this.callParent()}},0,0,0,0,0,0,[LkIp.controller.Rsb,"Clarify"],0));(Ext.cmd.derive("LkIp.model.Rsb.Clarify.Unexpay.Grid",Ext.data.Model,{fields:["@PlatDokNomer","@PlatDokSumma","@PlatDokData","@PlatDokName","@PlatDokINNPlat","@PlatDokNaimenPlat","@PlatDokINNPol","@PlatDokKPPPol","@PlatDokNaimenPol","@PlatDokKBK","@PlatDokOKATO_OKTMO","@PlatDokOsnPlat","@PlatDokNalPeriod","@PlatDokOsn","@PlatDokNomerDokNaprav","@PlatDokDataDokNaprav","@PlatDokTipPlat","@PlatDokNapravPlat","@FIdDok","@EstUvedoml","@EstZayavl","@PrichNePlat","@NaimNO","@KodNO","@INNNO","@KPPNO","@AddressNO","@PlatDokStatusPlat","@PlatDokNaimenStatusPlat","@UvedomlDokNomer","@UvedomlDokData","@UvedomlDokFid","@PlatDokNaimenKBK"]},0,0,0,0,0,0,[LkIp.model.Rsb.Clarify.Unexpay,"Grid"],0));(Ext.cmd.derive("LkIp.store.Rsb.Clarify.Unexpay.GridStore",LkIp.store.DefaultStore,{model:"LkIp.model.Rsb.Clarify.Unexpay.Grid",url:"/rsb/unexpay/getInfo"},0,0,0,0,0,0,[LkIp.store.Rsb.Clarify.Unexpay,"GridStore"],0));(Ext.cmd.derive("LkIp.controller.Rsb.Clarify.Unexpay",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"rsbUnexpay"},{ref:"grid",selector:"#rsbUnexpayGrid"},{ref:"filterPanel",selector:"#rsbUnexpayFilterPanel"}],models:["Rsb.Clarify.Unexpay.Grid"],cache:false,getUnexpayStore:function(){return this.getStore("Rsb.Clarify.Unexpay.GridStore")},init:function(){this.getUnexpayStore().on({beforeload:{fn:this.beforeloadGrid,scope:this},load:{fn:this.loadGrid,scope:this}});this.control({rsbUnexpay:{activate:function(){},deactivate:function(){var a=this;Ext.suspendLayouts();if(LkIp.User.isActiveUser()){a.getIndex().down('[name="rsbUnexpayStatementButton"]').disable();a.getIndex().down('[name="rsbUnexpayNotifyButton"]').hide()}a.removeTpl();a.getGrid().getStore().removeAll();Ext.resumeLayouts(true)}},'rsbUnexpay [rel="apply"]':{applyFilters:this.applyFiltersAction},'rsbUnexpay [rel="reset"]':{resetFilters:this.resetFiltersAction},"#rsbUnexpayFilterPanel":{expand:this.expandFilterPanel},"#rsbUnexpayGrid":{getFile:this.getFileAction,selectionchange:this.selectionChangeAction},'rsbUnexpay [name="rsbUnexpayStatementButton"]':{click:this.pushGridButtonAction},'rsbUnexpay [name="rsbUnexpayNotifyButton"]':{click:this.pushGridButtonAction}});this.callParent()},loadIndex:function(){var a=this;a.callParent();if(false===a.cache){a.noStore=Ext.getStore("rsbUnexpayNoStore");a.cache=true}a.loadFirstPage()},loadFirstPage:function(a){this.getUnexpayStore().loadPage(1,{params:Ext.isObject(a)?a:{}})},beforeloadGrid:function(){var a=this;a.applySelectedFilters();a.getUnexpayStore().extraParams=this.getFiltersParams(true)},loadGrid:function(){this.getIndex().setLoading(false)},loadFilters:function(){var a=this;a.getFilterPanel().setLoading(true);LkIp.Request.request({url:"/api/rsb/unexpay/getFilters",params:LkIp.Utils.checkForInspectorNo(),scope:this},function(b){a.getFilterPanel().setLoading(false);a.noStore.loadData(b.response.no);a.filtersLoaded=true})},getFileAction:function(){var a=this;LkIp.Utils.downloadDocument("rsbUnexpay","/api/rsb/unexpay/getFile",a.getFiltersParams(true))},selectionChangeAction:function(h,a){if(a.length){Ext.suspendLayouts();var e=this,b=e.getIndex().down('[name="rsbUnexpayNoTpl"]'),d=e.getIndex().down('[name="rsbUnexpayUvedomlTpl"]'),g=a[0].get("@EstUvedoml");if(LkIp.User.isActiveUser()){var c=e.getIndex().down('[name="rsbUnexpayStatementButton"]'),f=e.getIndex().down('[name="rsbUnexpayNotifyButton"]');if(a[0].get("@EstZayavl")==0){c.enable()}else{c.disable()}if(!Ext.isEmpty(g)){if(g==0){f.show()}else{f.hide()}}else{f.hide()}}if(!Ext.isEmpty(g)){d.update({number:a[0].get("@UvedomlDokNomer"),date:LkIp.Utils.getDate(a[0].get("@UvedomlDokData"))});d.show()}else{d.hide()}b.update({code:a[0].get("@KodNO"),inn_kpp:a[0].get("@INNNO")+"/"+a[0].get("@KPPNO"),name:a[0].get("@NaimNO"),address:a[0].get("@AddressNO")});b.show();LkIp.app.getController("Content").initNoTooltips();Ext.resumeLayouts(true)}},removeTpl:function(){var a=this,b=a.getIndex().down('[name="rsbUnexpayNoTpl"]'),c=a.getIndex().down('[name="rsbUnexpayUvedomlTpl"]');b.update({code:"",inn_kpp:"",name:"",address:""});b.hide();c.update({number:"",date:""});c.hide()},pushGridButtonAction:function(b){var d=this,c=d.getGrid().getSelected(),a=b.name;if(!Ext.isEmpty(c)){LkIp.FlashData.set("rsbUnexpay",1);if("rsbUnexpayNotifyButton"==a){LkIp.Utils.goTo(this.getCurrentPageUrl()+"/notify?"+c.data["@FIdDok"])}else{if("rsbUnexpayStatementButton"==a){LkIp.Utils.goTo(this.getCurrentPageUrl()+"/statement?"+c.data["@FIdDok"])}}}else{LkIp.Msg.error(reference.lang.rsb.clarify.unexpay.errors.cardNotSelected)}}},0,0,0,0,0,[["filters",LkIp.mixins.Filters]],[LkIp.controller.Rsb.Clarify,"Unexpay"],0));(Ext.cmd.derive("LkIp.store.Rsb.Overpayment.Statement.OffsetDebt.GridStore",LkIp.store.Rsb.Overpayment.GridStore,{},0,0,0,0,0,0,[LkIp.store.Rsb.Overpayment.Statement.OffsetDebt,"GridStore"],0));(Ext.cmd.derive("LkIp.model.Rsb.Cards.Grid",Ext.data.Model,{fields:["@FIdKRSB","@KodNO","@ImyaNO","@IdKBK","@OKATO_OKTMO","@PriznakOKATO_OKTMO","@VidN","@IdStatus","@KPPKart","@DataSostRasch","@DataOtkrKart","@SummZavisshPl","@SummaUregZadolj","@SummaNDSZayavVozm","@ImyaVidN","@KodKBK","@ImyaKBK","@KodStatus","@ImyaStatus","selected"]},0,0,0,0,0,0,[LkIp.model.Rsb.Cards,"Grid"],0));(Ext.cmd.derive("LkIp.store.Rsb.Cards.GridStore",LkIp.store.DefaultStore,{model:"LkIp.model.Rsb.Cards.Grid",url:"/rsb/cards/getInfo"},0,0,0,0,0,0,[LkIp.store.Rsb.Cards,"GridStore"],0));(Ext.cmd.derive("LkIp.store.Rsb.Overpayment.Statement.OffsetFuture.GridStore",LkIp.store.Rsb.Cards.GridStore,{},0,0,0,0,0,0,[LkIp.store.Rsb.Overpayment.Statement.OffsetFuture,"GridStore"],0));(Ext.cmd.derive("LkIp.model.Rsb.Overpayment.PersonalAccounts",Ext.data.Model,{fields:["@NaimFinOrg","@INNFinOrg","@KPPFinOrg","@NomSchFK","@DataSchFK","@NaimKredOrg","@INNKredOrg","@KPPKredOrg","@BIKKredOrg","@NomSchKredOrg","@DataOtkrKredOrg","@AdresKredOrg",{name:"qtip",type:"string",convert:function(b,a){return a.get("@NaimFinOrg").split('"').join("'")}},{name:"shortName",type:"string",convert:function(b,a){return Ext.String.ellipsis(a.get("@NaimFinOrg"),40,true)}},{name:"code",type:"string",convert:function(b,a){return a.get("@NomSchFK")}}]},0,0,0,0,0,0,[LkIp.model.Rsb.Overpayment,"PersonalAccounts"],0));(Ext.cmd.derive("LkIp.model.Rsb.Overpayment.PaymentAccounts",Ext.data.Model,{fields:["@NaimBanka","@NomSchBank","@INNBanka","@KPPBanka","@BIKBanka","@DataOtkryitiya","@AdresBanka","@KorSchyot",{name:"qtip",type:"string",convert:function(b,a){return a.get("@NaimBanka").split('"').join("'")}},{name:"shortName",type:"string",convert:function(b,a){return Ext.String.ellipsis(a.get("@NaimBanka"),40,true)}},{name:"code",type:"string",convert:function(b,a){return a.get("@NomSchBank")}}]},0,0,0,0,0,0,[LkIp.model.Rsb.Overpayment,"PaymentAccounts"],0));(Ext.cmd.derive("LkIp.controller.Rsb.Overpayment.Statement",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"rsbOverpaymentStatement"},{ref:"tabpanel",selector:"#overpaymentStatementTabPanel"},{ref:"offsetDebtTab",selector:"rsbOverpaymentOffsetDebt"},{ref:"offsetFutureTab",selector:"rsbOverpaymentOffsetFuture"},{ref:"returnTab",selector:"rsbOverpaymentReturn"},{ref:"filterPanelDebt",selector:"#rsbOverpaymentOffsetDebtFilterPanel"},{ref:"filterPanelFuture",selector:"#rsbOverpaymentOffsetFutureFilterPanel"},{ref:"overpaymentGrid",selector:"#rsbOverpaymentStatementDebtGrid"},{ref:"rsbCardsGrid",selector:"#rsbOverpaymentStatementFutureGrid"},{ref:"signBtn",selector:'rsbOverpaymentStatement [rel="sign"]'}],models:["LkIp.model.Rsb.Overpayment.Grid","LkIp.model.Rsb.Cards.Grid","LkIp.model.Rsb.Overpayment.PersonalAccounts","LkIp.model.Rsb.Overpayment.PaymentAccounts"],cache:false,filtersParamsDebt:{},filtersParamsFuture:{statusIP:"09"},filtersLoadedDebt:false,filtersLoadedFuture:false,firstLoadReturn:true,editableFields:[],tab:"offsetFuture",selectedCardData:{},selectedSumm:undefined,selectedBankAccount:{},getOverpaymentStore:function(){return this.getStore("Rsb.Overpayment.Statement.OffsetDebt.GridStore")},getRsbCardsStore:function(){return this.getStore("Rsb.Overpayment.Statement.OffsetFuture.GridStore")},init:function(){this.getOverpaymentStore().on({beforeload:{fn:this.beforeloadOverpaymentGrid,scope:this}});this.getRsbCardsStore().on({beforeload:{fn:this.beforeloadRsbCardsGrid,scope:this}});this.control({rsbOverpaymentStatement:{activate:function(){if(false===this.cache){this.getIndex().setLoading(true)}this.getTabpanel().activeTab=null},deactivate:function(){this.removeCardData(this);this.getRsbCardsStore().removeAll();this.getOverpaymentStore().removeAll();this.clearStatementInfo();this.clearPaymentTab();this.clearPersonalTab();this.editableFields=[];this.getTabpanel().hide()}},'rsbOverpaymentStatement [rel="back"]':{click:this.returnBack},"#rsbOverpaymentStatementFutureGrid":{getFile:this.getFileAction,selectionchange:this.toggleChooseBtn},"#rsbOverpaymentStatementDebtGrid":{getFile:this.getFileAction,selectionchange:this.toggleChooseBtn},"rsbOverpaymentStatement editField":{notEnterValue:this.editAction,enteredValue:this.enterValueAction},'rsbOverpaymentOffsetDebt [rel="choose"]':{click:this.updateStatementInfo},'rsbOverpaymentOffsetFuture [rel="choose"]':{click:this.updateStatementInfo},'rsbOverpaymentOffsetDebt [rel="exclude"]':{click:function(){this.clearStatementInfo(true)}},'rsbOverpaymentOffsetFuture [rel="exclude"]':{click:function(){this.clearStatementInfo(true)}},"rsbOverpaymentReturn #fkName #saveValue":{click:function(){this.changeName(true)}},"rsbOverpaymentReturn #bankName #saveValue":{click:function(){this.changeName()}},"rsbOverpaymentReturn #accountNumber":{enteredValue:function(){this.changeAccountNumber(false)}},"rsbOverpaymentReturn #fkNumber":{enteredValue:function(){this.changeAccountNumber(true)}},'#statementSumma [name="enterValue"]':{change:this.changeSumma},"#statementSumma #saveValue":{click:this.changeSumma},'#overpaymentStatementReturnTabPanel [type="tab"]':{activate:this.activateReturnTabs},"#overpaymentStatementTabPanel":{tabchange:this.activateTab},'#rsbOverpaymentOffsetDebtFilterPanel [rel="apply"]':{applyFilters:this.applyFiltersAction},'#rsbOverpaymentOffsetDebtFilterPanel [rel="reset"]':{resetFilters:this.resetFiltersAction},"#rsbOverpaymentOffsetDebtFilterPanel":{expand:this.expandFilterPanel},'#rsbOverpaymentOffsetFutureFilterPanel [rel="apply"]':{applyFilters:this.applyFiltersAction},'#rsbOverpaymentOffsetFutureFilterPanel [rel="reset"]':{resetFilters:this.resetFiltersAction},"#rsbOverpaymentOffsetFutureFilterPanel":{expand:this.expandFilterPanel},'rsbOverpaymentStatement [rel="showPdf"]':{click:this.showPdfAction},'rsbOverpaymentStatement [rel="sign"]':{click:this.signStatement}});this.callParent()},loadIndex:function(){var b=this,a=b.callParent();if(false!==a){LkIp.Request.request({url:"/api/rsb/overpayment/getCardInfo/"+b.fidCard+"/"+b.paymentType,scope:this},function(c){if(c==false||Ext.isEmpty(c.response)){LkIp.Msg.error(reference.lang.rsb.overpayment.errors.noCardData);LkIp.Utils.goTo("#!/rsb/overpayment");return false}b.cardData=c.response;b.setCardData(b.cardData);b.noFutureStore=Ext.getStore("rsbOffsetFutureNoStore");b.statusIPFutureStore=Ext.getStore("rsbOffsetFutureStatusIPStore");b.kbkFutureStore=Ext.getStore("rsbOffsetFutureKbkStore");if(b.typeStatement=="offset"){b.noDebtStore=Ext.getStore("rsbOffsetDebtNoStore");b.statusIPDebtStore=Ext.getStore("rsbOffsetDebtStatusIPStore");b.kbkDebtStore=Ext.getStore("rsbOffsetDebtKbkStore");b.typePaymentDebtStore=Ext.getStore("rsbOffsetDebtTypePaymentStore");b.getTabpanel().child("#tab-return").tab.hide();b.getTabpanel().child("#tab-offset-debt").tab.show();b.getTabpanel().show();b.getTabpanel().setActiveTab(1)}else{b.bankNameStore=Ext.getStore("returnPaymentBankName");b.accountNumberStore=Ext.getStore("returnPaymentAccountNumber");b.fkNameStore=Ext.getStore("returnPersonalNameFk");b.fkNumberStore=Ext.getStore("returnPersonalFkNumber");b.getTabpanel().child("#tab-offset-debt").tab.hide();b.getTabpanel().child("#tab-return").tab.show();b.getReturnTab().down("#returnNote").update({vidN:b.cardData["@ImyaVidN"]});b.getReturnTab().down("#statementSumma").setValue(LkIp.Utils.numberConvert(b.cardData["@SummaPeresch"]));b.getTabpanel().setActiveTab(0);b.getTabpanel().show()}b.getIndex().setLoading(false)})}},loadBankAccounts:function(){var a=this;a.getReturnTab().setLoading(true);LkIp.Request.request({url:"/api/rsb/overpayment/getBankAccounts"},function(d){a.getReturnTab().setLoading(false);if(false!==d&&0!==d.status){if(!Ext.isEmpty(d.response.payment)){var c=[];Ext.Array.each(d.response.payment,function(e){if(e.inBankNames){c.push(e)}});a.bankNameStore.loadData(c);a.accountNumberStore.loadData(d.response.payment);a.defaultPaymentValues=d.response.payment}if(!Ext.isEmpty(d.response.personal)){var b=[];Ext.Array.each(d.response.personal,function(e){if(e.inBankNames){b.push(e)}});a.fkNameStore.loadData(b);a.fkNumberStore.loadData(d.response.personal);a.defaultPersonalValues=d.response.personal}a.firstLoadReturn=false}})},setCardData:function(){this.getIndex().down('[name="rsbOverpaymentCardTpl"]').update({taxName:Ext.isEmpty(this.cardData["@ImyaKBK"])?"-":this.cardData["@ImyaKBK"],paymentType:Ext.isEmpty(this.cardData["@ImyaTipPl"])?"-":this.cardData["@ImyaTipPl"],kbkOkato:(Ext.isEmpty(this.cardData["@KodKBK"])?"-":this.cardData["@KodKBK"])+"/"+(Ext.isEmpty(this.cardData["@OKATO_OKTMO"])?"-":this.cardData["@OKATO_OKTMO"]),status:Ext.isEmpty(this.cardData["@ImyaStatus"])?"-":(this.cardData["@KodStatus"]+"-"+this.cardData["@ImyaStatus"]),no:Ext.isEmpty(this.cardData["@ImyaNO"])?"-":(LkIp.Utils.noRenderer(this.cardData["@KodNO"])+"-"+this.cardData["@ImyaNO"]),summa:Ext.isEmpty(this.cardData["@SummaPeresch"])?"-":LkIp.Utils.numberConvert(this.cardData["@SummaPeresch"])})},removeCardData:function(){this.getIndex().down('[name="rsbOverpaymentCardTpl"]').update({taxName:"-",paymentType:"-",kbkOkato:"-",no:"-",status:"-",summa:"-"})},loadFirstPage:function(c){var b=this,a="";switch(b.tab){case"offsetDebt":a=b.getOverpaymentStore();break;case"offsetFuture":a=b.getRsbCardsStore();break;case"return":if(b.firstLoadReturn){b.loadBankAccounts()}break}if(!Ext.isEmpty(a)){a.loadPage(1,{params:Ext.isObject(c)?c:{}})}},activateTab:function(a,b){Ext.suspendLayouts();switch(b.itemId){case"tab-offset-debt":this.clearStatementInfo();this.getOverpaymentStore().removeAll();this.tab="offsetDebt";break;case"tab-offset-future":this.clearStatementInfo();this.getRsbCardsStore().removeAll();this.tab="offsetFuture";break;case"tab-return":this.clearPaymentTab();this.clearPersonalTab();this.tab="return";this.selectedSumm=this.cardData["@SummaPeresch"];break;default:return false}Ext.resumeLayouts(true);this.loadFirstPage()},activateReturnTabs:function(a){a=a||false;switch(a.itemId){case"tab-payment-account":this.clearPersonalTab();this.returnTab="payment";break;case"tab-personal-account":this.clearPaymentTab();this.returnTab="personal";break;default:break}},clearPaymentTab:function(){var a=this.getReturnTab();a.down("#bankName").resetValue();a.down("#accountNumber").resetValue();a.down("#statementInfo").updatePaymentAccount()},clearPersonalTab:function(){var a=this.getReturnTab();a.down("#fkName").resetValue();a.down("#fkNumber").resetValue();a.down("#statementInfo").updatePersonalAccount()},beforeloadOverpaymentGrid:function(){var a=this;a.applySelectedFilters();a.getOverpaymentStore().extraParams=Ext.apply(a.getFiltersParams(true),{typeTax:a.cardData["@VidN"],typeTaxLaw:a.cardData["@VidNNZ"],typeInfo:2})},beforeloadRsbCardsGrid:function(){var a=this;a.applySelectedFilters();a.getRsbCardsStore().extraParams=Ext.apply({typeTax:a.cardData["@VidN"],typeTaxLaw:a.cardData["@VidNNZ"],statusIPCondition:1,fromOverpayment:true},a.getFiltersParams(true))},expandFilterPanel:function(){switch(this.tab){case"offsetDebt":!this.filtersLoadedDebt&&this.loadDebtFilters();break;case"offsetFuture":!this.filtersLoadedFuture&&this.loadFutureFilters();break;default:break}},loadDebtFilters:function(){var a=this,b=LkIp.Utils.checkForInspectorNo();b.typeTax=a.cardData["@VidN"];b.typeFilters=2;b.typeTaxLaw=a.cardData["@VidNNZ"];a.getFilterPanelDebt().setLoading(true);LkIp.Request.request({url:"/api/rsb/overpayment/getFilters",params:b,scope:this},function(c){a.getFilterPanelDebt().setLoading(false);if(!LkIp.User.isInspectorWithCodeNO()){a.noDebtStore.loadData(c.response.no)}a.kbkDebtStore.loadData(c.response.kbk);a.statusIPDebtStore.loadData(c.response.statusIP);a.typePaymentDebtStore.loadData(c.response.typePayment);a.applySelectedFilters();a.filtersLoadedDebt=true})},loadFutureFilters:function(){var a=this,b={fromOverpayment:true,typeTax:a.cardData["@VidN"],typeTaxLaw:a.cardData["@VidNNZ"]};a.getFilterPanelFuture().setLoading(true);LkIp.Request.request({url:"/api/rsb/cards/getFilters",params:b,scope:this},function(c){a.getFilterPanelFuture().setLoading(false);if(!LkIp.User.isInspectorWithCodeNO()){a.noFutureStore.loadData(c.response.no)}a.kbkFutureStore.loadData(c.response.kbk);a.statusIPFutureStore.loadData(c.response.statusIP);a.applySelectedFilters();a.filtersLoadedFuture=true})},applyFiltersAction:function(){Ext.suspendLayouts();switch(this.tab){case"offsetDebt":this.filtersParamsDebt=this.getFilterPanelDebt().getForm().getValues();break;case"offsetFuture":this.filtersParamsFuture=this.getFilterPanelFuture().getForm().getValues();break}Ext.resumeLayouts(true);this.loadFirstPage()},resetFiltersAction:function(){Ext.suspendLayouts();switch(this.tab){case"offsetDebt":this.filtersParamsDebt={};this.getFilterPanelDebt().getForm().reset();break;case"offsetFuture":this.filtersParamsFuture={};this.getFilterPanelFuture().getForm().reset();break}Ext.resumeLayouts(true);this.loadFirstPage()},getFiltersParams:function(c){var a=this.tab=="offsetDebt"?this.filtersParamsDebt:this.filtersParamsFuture;c=c||false;if(c){var b={};Ext.Object.each(a,function(d,e){if(!LkIp.Utils.isFilterEmpty(e)){b[d]=e}});return b}return a},applySelectedFilters:function(){var c=this,b=c.getFiltersParams(),a=c.tab=="offsetDebt"?c.getFilterPanelDebt():c.getFilterPanelFuture();Ext.suspendLayouts();if(Ext.Object.getSize(b)>0){Ext.Object.each(b,function(d,e){if(!LkIp.Utils.isFilterEmpty(e)){a.down('[name="'+d+'"]').setValue(e)}else{a.down('[name="'+d+'"]').reset()}})}else{if(typeof a!="undefined"){a.getForm().reset()}}Ext.resumeLayouts(true)},toggleChooseBtn:function(b,c){var a=this.tab=="offsetDebt"?this.getOffsetDebtTab().down('[rel="choose"]'):this.getOffsetFutureTab().down('[rel="choose"]');if(!c.length||(this.tab=="offsetDebt"&&c[0].get("@SummaPeresch")==0)){a.disable()}else{a.enable()}},updateStatementInfo:function(){Ext.suspendLayouts();var d=this,a=d.tab=="offsetDebt"?d.getOverpaymentGrid():d.getRsbCardsGrid(),c=d.tab=="offsetDebt"?d.getOffsetDebtTab():d.getOffsetFutureTab(),b=a.getSelected();if(!Ext.isEmpty(b.data)){d.summaOffset=d.tab=="offsetDebt"?(parseFloat(d.cardData["@SummaPeresch"])<parseFloat(b.data["@SummaPeresch"])?d.cardData["@SummaPeresch"]:b.data["@SummaPeresch"]):d.cardData["@SummaPeresch"];c.down("#statementInfo").setData({taxName:b.data["@ImyaKBK"],paymentType:d.tab=="offsetDebt"?b.data["@TipPlNaim"]:reference.lang.rsb.overpayment.statement.onOffsetFuture.paymentType,kbkOkato:b.data["@KodKBK"]+"/"+b.data["@OKATO_OKTMO"],no:b.data["@KodNO"]+" - "+b.data["@ImyaNO"],summa:LkIp.Utils.numberConvert(d.summaOffset)});d.selectedCardData=b.data;d.selectedSumm=d.summaOffset;c.down('[rel="exclude"]').enable();LkIp.Utils.scrollTo(c.down("#statementInfo"))}else{LkIp.Msg.error(reference.lang.rsb.overpayment.statement.errors.notSelected)}Ext.resumeLayouts(true)},clearStatementInfo:function(a){a=a||false;var c=this.tab=="offsetDebt"?this.getOffsetDebtTab():this.getOffsetFutureTab(),b=this.tab=="offsetDebt"?this.getOverpaymentGrid():this.getRsbCardsGrid();a&&LkIp.Utils.scrollTo(b);b.getSelectionModel().deselectAll();c.down("#statementInfo").removeData();c.down('[rel="exclude"]').disable();c.down('[rel="showPdf"]').disable();this.getSignBtn().disable()},changeSumma:function(){var d=this,e,a,b;switch(d.tab){case"offsetDebt":e=d.getOffsetDebtTab().down("#statementSumma").down('[name="enterValue"]');b=d.getOffsetDebtTab().down("#statementSumma").down("#saveValue");a=d.summaOffset.replace(" ","");break;case"offsetFuture":e=d.getOffsetFutureTab().down("#statementSumma").down('[name="enterValue"]');b=d.getOffsetFutureTab().down("#statementSumma").down("#saveValue");a=d.summaOffset.replace(" ","");break;case"return":e=d.getReturnTab().down("#statementSumma").down('[name="enterValue"]');b=d.getReturnTab().down("#statementSumma").down("#saveValue");a=d.cardData["@SummaPeresch"];break}var c=parseFloat(e.getValue().replace(" ",""));if(isNaN(c)||c>parseFloat(a)){e.bigSum=true}else{e.bigSum=false;d.selectedSumm=e.getValue().replace(" ","");return true}},getStatementNumberValue:function(){var b=this,a;switch(b.tab){case"offsetDebt":a=b.getOffsetDebtTab().down("#statementNumber").down('[name="enterValue"]');break;case"offsetFuture":a=b.getOffsetFutureTab().down("#statementNumber").down('[name="enterValue"]');break;case"return":a=b.getReturnTab().down("#statementNumber").down('[name="enterValue"]');break}return Ext.isEmpty(a.getValue())?"":a.getValue()},editAction:function(b){var a=this;if(false!==b){Ext.Array.include(a.editableFields,b)}a.getPdfButton().disable();a.getSignBtn().disable()},enterValueAction:function(b){var a=this,c=Ext.Array.indexOf(a.editableFields,b);if(c!=-1){Ext.Array.erase(a.editableFields,c,1)}Ext.suspendLayouts();if(Ext.isEmpty(a.editableFields)){a.getPdfButton().enable();a.getSignBtn().enable()}Ext.resumeLayouts(true)},getPdfButton:function(){var a=this;switch(a.tab){case"offsetDebt":return a.getOffsetDebtTab().down('[rel="showPdf"]');case"offsetFuture":return a.getOffsetFutureTab().down('[rel="showPdf"]');case"return":return a.getReturnTab().down('[rel="showPdf"]')}},signStatement:function(){var a=this,b=a.getTabParams();a.getIndex().setLoading(true);LkIp.Request.request({url:"/api/rsb/overpayment/generateXml",method:"POST",params:b},function(c){a.getController("Viewport").signAction(c,{loader:a.getIndex(),successCallback:function(){switch(a.tab){case"offsetDebt":case"offsetFuture":break}a.updateSumma();if("return"==a.tab){a.updateReturnTab()}else{a.clearStatementInfo()}a.loadFirstPage();if(a.cardData["@SummaPeresch"]==0){LkIp.Msg.success(reference.lang.rsb.overpayment.statement.sendAll,{rewriteDefaultButtons:true,buttons:[{text:reference.lang.buttons.ok,handler:function(){a.returnBack();LkIp.Msg.fireEvent("closemessagebox",LkIp.Msg);LkIp.Msg.close()}}]})}else{LkIp.Msg.success(reference.lang.signature.successDefault,{rewriteDefaultButtons:true,buttons:[{text:reference.lang.buttons.close,handler:function(){LkIp.Utils.scrollTo(a.getIndex());LkIp.Msg.fireEvent("closemessagebox",LkIp.Msg);LkIp.Msg.close()}}]})}},errorCallback:function(d){if("NUM_ISNOT_UNIQUE"==d){LkIp.Msg.error(new Ext.XTemplate(reference.lang.rsb.overpayment.errors.statementIsNotUnique).apply({number:a.getStatementNumberValue()}))}else{LkIp.Msg.error(d)}}})})},showPdfAction:function(){var a=this.getTabParams();a.method="POST";LkIp.Utils.downloadDocument("overpaymentStatement","/api/rsb/overpayment/generatePdf",a)},getTabParams:function(){var a=this,b={parentCard:Ext.JSON.encode(a.cardData),statementNumber:a.getStatementNumberValue(),type:a.getPageType(),summ:a.selectedSumm};switch(a.tab){case"offsetDebt":case"offsetFuture":b.card=Ext.JSON.encode(a.selectedCardData);break;case"return":b.bankAccount=Ext.JSON.encode(a.selectedBankAccount);break}return b},getPageType:function(){switch(this.tab){case"offsetDebt":return 1;case"offsetFuture":return 2;case"return":return 3}},updateReturnTab:function(){var a=this;a.getReturnTab().down("#statementSumma").setValue(LkIp.Utils.numberConvert(a.cardData["@SummaPeresch"]));a.clearPaymentTab();a.clearPersonalTab()},updateSumma:function(){var b=this,a;switch(b.tab){case"offsetDebt":a=b.getOffsetDebtTab();break;case"offsetFuture":a=b.getOffsetFutureTab();break;case"return":a=b.getReturnTab();break}b.cardData["@SummaPeresch"]=parseFloat(b.cardData["@SummaPeresch"])-parseFloat(a.down("#statementInfo").down("#statementSumma").getValue().replace(" ",""));b.setCardData()},changeName:function(d){d=d||false;var b=this,c,a=[];if(d){c=b.getReturnTab().down("#fkName").getValue();if(Ext.isEmpty(c)){a=b.defaultPersonalValues}else{Ext.Array.each(b.defaultPersonalValues,function(e){if(e["@NaimFinOrg"]==c){a.push(e)}})}b.fkNumberStore.loadData(a);if(a.length==1){b.getReturnTab().down("#fkNumber").setValue(a[0]["@NomSchFK"])}else{b.getReturnTab().down("#fkNumber").resetValue();b.getReturnTab().down("#statementInfo").updatePersonalAccount()}}else{c=b.getReturnTab().down("#bankName").getValue();if(Ext.isEmpty(c)){a=b.defaultPaymentValues}else{Ext.Array.each(b.defaultPaymentValues,function(e){if(e["@NaimBanka"]==c){a.push(e)}})}b.accountNumberStore.loadData(a);if(a.length==1){b.getReturnTab().down("#accountNumber").setValue(a[0]["@NomSchBank"])}else{b.getReturnTab().down("#accountNumber").resetValue();b.getReturnTab().down("#statementInfo").updatePaymentAccount()}}},changeAccountNumber:function(c){var a=this,b="";if(c){b=a.getReturnTab().down("#fkNumber").getValue();Ext.Array.each(a.defaultPersonalValues,function(d){if(d["@NomSchFK"]==b){b=d;return false}});a.getReturnTab().down("#statementInfo").updatePersonalAccount({fkName:b["@NaimFinOrg"],innKppFk:(Ext.isEmpty(b["@INNFinOrg"])?"-":b["@INNFinOrg"])+"/"+(Ext.isEmpty(b["@KPPFinOrg"])?"-":b["@KPPFinOrg"]),bankName:b["@NaimKredOrg"],innKpp:(Ext.isEmpty(b["@INNKredOrg"])?"-":b["@INNKredOrg"])+"/"+(Ext.isEmpty(b["@KPPKredOrg"])?"-":b["@KPPKredOrg"]),bik:b["@BIKKredOrg"]})}else{b=a.getReturnTab().down("#accountNumber").getValue();Ext.Array.each(a.defaultPaymentValues,function(d){if(d["@NomSchBank"]==b){b=d;return false}});a.getReturnTab().down("#statementInfo").updatePaymentAccount({bankName:b["@NaimBanka"],innKpp:(Ext.isEmpty(b["@INNBanka"])?"-":b["@INNBanka"])+"/"+(Ext.isEmpty(b["@KPPBanka"])?"-":b["@KPPBanka"]),bik:b["@BIKBanka"]})}a.selectedBankAccount={type:false===c?1:2,data:b}},getFileAction:function(){var a=this;switch(a.tab){case"offsetDebt":LkIp.Utils.downloadDocument("rsbOverpayment","/api/rsb/overpayment/getFile",Ext.apply(a.getFiltersParams(true),{typeTax:a.cardData["@VidN"],typeInfo:2}));break;case"offsetFuture":LkIp.Utils.downloadDocument("rsbCards","/api/rsb/cards/getFile",Ext.apply({typeTax:a.cardData["@VidN"],statusIPCondition:1},a.getFiltersParams(true)));break}},returnBack:function(){LkIp.Utils.goTo("#!/rsb/overpayment")}},0,0,0,0,0,0,[LkIp.controller.Rsb.Overpayment,"Statement"],0));(Ext.cmd.derive("LkIp.model.Rsb.Overpayment.StatusGrid",Ext.data.Model,{fields:["@Imya","@SummPereplat","@DataOznakomleniya"]},0,0,0,0,0,0,[LkIp.model.Rsb.Overpayment,"StatusGrid"],0));(Ext.cmd.derive("LkIp.store.Rsb.Overpayment.StatusStore",LkIp.store.DefaultStore,{model:"LkIp.model.Rsb.Overpayment.StatusGrid",url:"/rsb/overpayment/getStatusesInfo"},0,0,0,0,0,0,[LkIp.store.Rsb.Overpayment,"StatusStore"],0));(Ext.cmd.derive("LkIp.controller.Rsb.Overpayment.Status",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"overpaymentStatus"},{ref:"filterPanel",selector:"#rsbOverpaymentStatusFilters"}],models:[],cache:false,getStatusStore:function(){return this.getStore("Rsb.Overpayment.StatusStore")},init:function(){this.getStatusStore().on({beforeload:{fn:this.beforeloadStore,scope:this}});this.control({overpaymentStatus:{activate:function(){},deactivate:function(){this.getStatusStore().removeAll();this.cache=false}},'#rsbOverpaymentStatusFilters [rel="apply"]':{applyFilters:this.applyFiltersAction},'#rsbOverpaymentStatusFilters [rel="reset"]':{resetFilters:this.resetFiltersAction}});this.callParent()},loadIndex:function(){var b=this,a=b.callParent();if(false!==a){b.loadFirstPage()}},beforeloadStore:function(){var a=this;a.applySelectedFilters();a.getStatusStore().extraParams=a.getFiltersParams(true)},loadFirstPage:function(a){this.getStatusStore().loadPage(1,{params:Ext.isObject(a)?a:{}})}},0,0,0,0,0,[["filters",LkIp.mixins.Filters]],[LkIp.controller.Rsb.Overpayment,"Status"],0));(Ext.cmd.derive("LkIp.controller.Rsb.Clarify.Unexpay.Notify",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"rsbUnexpayNotify"}],models:[],cache:false,cardData:{},init:function(){this.control({rsbUnexpayNotify:{activate:function(){this.getIndex().setLoading(true)},deactivate:function(){this.getIndex().down('[name="rsbNotifyNoTpl"]').update([]);this.getIndex().down('[name="rsbNotifyUvedomlTpl"]').update([]);this.getIndex().down('[name="rsbNotifyDocumentTpl"]').update([])}},'rsbUnexpayNotify [name="rsbNotifySignButton"]':{click:this.pushSignButton},'rsbUnexpayNotify [name="rsbNotifySignShow"]':{click:this.pushShowButton}});this.callParent()},loadIndex:function(){var b=this,a=b.callParent();if(false!==a){LkIp.Request.request({url:"/api/rsb/unexpay/getCardInfo/"+b.fidCard,scope:this},function(d){if(d==false||Ext.isEmpty(d.response)||Ext.isEmpty(d.response.root)){LkIp.Msg.error(reference.lang.rsb.cards.errors.canNotGetCardData);LkIp.Utils.goTo("#!/rsb/unexpay");return false}var c=b.cardData=d.response.root;b.getIndex().down('[name="rsbNotifyNoTpl"]').update({code:c["@KodNO"],inn_kpp:c["@INNNO"]+"/"+c["@KPPNO"],name:c["@NaimNO"],address:c["@AddressNO"]});b.getIndex().down('[name="rsbNotifyUvedomlTpl"]').update({number:c["@UvedomlDokNomer"],date:LkIp.Utils.getDate(c["@UvedomlDokData"])});b.getIndex().down('[name="rsbNotifyDocumentTpl"]').update({number:c["@PlatDokNomer"],date:LkIp.Utils.getDate(c["@PlatDokData"]),summ:LkIp.Utils.numberConvert(c["@PlatDokSumma"])});b.getIndex().setLoading(false)})}},pushSignButton:function(){var a=this,b={parentCard:Ext.JSON.encode(a.cardData)};a.getIndex().setLoading(true);LkIp.Request.request({url:"/api/rsb/unexpay/notify/generateXml",method:"POST",params:b},function(c){a.getController("Viewport").signAction(c,{loader:a.getIndex(),successCallback:function(){LkIp.Msg.success(reference.lang.signature.successDefault,{rewriteDefaultButtons:true,buttons:[{text:reference.lang.buttons.close,handler:function(){LkIp.Utils.goTo("#!/rsb/unexpay");LkIp.Msg.fireEvent("closemessagebox",LkIp.Msg);LkIp.Msg.close()}}]})}})})},pushShowButton:function(){LkIp.Utils.downloadDocument("unexpayNotify","/api/rsb/unexpay/notify/generatePdf",{parentCard:Ext.JSON.encode(this.cardData)})}},0,0,0,0,0,0,[LkIp.controller.Rsb.Clarify.Unexpay,"Notify"],0));(Ext.cmd.derive("LkIp.model.Rsb.UnexpayDecisions.Grid",Ext.data.Model,{fields:["@KodNO","@NaimenDokOsnov","@NomerResh","@DataResh","@NomerDokOsnov","@DataDokOsnov","@Summa","@NomerDok","@DataDok","KPPPlat","INNKPPPol","StatusPlat","KBK","OKATO_OKTMO","OsnPlat","NalPeriod","NomerDokNaprav","DataDokNaprav","TipPl"]},0,0,0,0,0,0,[LkIp.model.Rsb.UnexpayDecisions,"Grid"],0));(Ext.cmd.derive("LkIp.store.Rsb.UnexpayDecisions.GridStore",LkIp.store.DefaultStore,{model:"LkIp.model.Rsb.UnexpayDecisions.Grid",url:"/rsb/unexpay/decisions/getInfo"},0,0,0,0,0,0,[LkIp.store.Rsb.UnexpayDecisions,"GridStore"],0));(Ext.cmd.derive("LkIp.controller.Rsb.UnexpayDecisions",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"rsbUnexpayDecisions"},{ref:"grid",selector:"#rsbUnexpayDecisionsGrid"},{ref:"filterPanel",selector:"#rsbUnexpayDecisionsFilterPanel"}],models:["Rsb.UnexpayDecisions.Grid"],cache:false,getUnexpayDecisionsStore:function(){return this.getStore("Rsb.UnexpayDecisions.GridStore")},init:function(){this.getUnexpayDecisionsStore().on({beforeload:{fn:this.beforeloadGrid,scope:this},load:{fn:this.loadGrid,scope:this}});this.control({rsbUnexpayDecisions:{activate:function(){},deactivate:function(){this.getGrid().getStore().removeAll()}},'rsbUnexpayDecisions [rel="apply"]':{applyFilters:this.applyFiltersAction},'rsbUnexpayDecisions [rel="reset"]':{resetFilters:this.resetFiltersAction},"#rsbUnexpayDecisionsFilterPanel":{expand:this.expandFilterPanel},"#rsbUnexpayDecisionsGrid":{getFile:this.getFileAction}});this.callParent()},loadIndex:function(){var a=this;a.callParent();if(false===a.cache){a.noStore=Ext.getStore("rsbUnexpayDecisionsNoStore");a.cache=true}a.loadFirstPage()},loadFirstPage:function(a){this.getUnexpayDecisionsStore().loadPage(1,{params:Ext.isObject(a)?a:{}})},beforeloadGrid:function(){var a=this;a.applySelectedFilters();a.getUnexpayDecisionsStore().extraParams=this.getFiltersParams(true)},loadGrid:function(){this.getIndex().setLoading(false)},loadFilters:function(){if(!LkIp.User.isInspectorWithCodeNO()){var a=this;a.getFilterPanel().setLoading(true);LkIp.Request.request({url:"/api/rsb/unexpay/decisions/getFilters",scope:this},function(b){a.getFilterPanel().setLoading(false);a.noStore.loadData(b.response.no);a.filtersLoaded=true})}else{a.filtersLoaded=true}},getFileAction:function(){var a=this;LkIp.Utils.downloadDocument("rsbUnexpayDecisions","/api/rsb/unexpay/decisions/getFile",a.getFiltersParams(true))}},0,0,0,0,0,[["filters",LkIp.mixins.Filters]],[LkIp.controller.Rsb,"UnexpayDecisions"],0));(Ext.cmd.derive("LkIp.controller.Rsb.Clarify.Unexpay.Statement",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"rsbUnexpayStatement"},{ref:"contentContainer",selector:"#content-container"}],models:[],cache:false,requiredFields:[],editableFields:[],editedFields:[],cardData:{},init:function(){this.control({rsbUnexpayStatement:{activate:function(a){this.getIndex().setLoading(true)},deactivate:function(a){var b=this;b.osnovaniePlStore.removeAll();b.getIndex().removeData();b.getIndex().down("#statement_number").resetValue();b.getIndex().down('[name="rsbUStatementNoTpl"]').update({code:"-",inn_kpp:"-",name:"-",address:"-"});b.getIndex().down('[name="rsbUStatementUvedomlTpl"]').update({number:"-",date:"-"});b.requiredFields=[];b.editableFields=[];b.editedFields=[];b.cardData={}}},'rsbUnexpayStatement [name="rsbUnexpayStatementSignButton"]':{click:this.pushSignButton},'rsbUnexpayStatement [name="rsbUnexpayStatementShowButton"]':{click:this.pushShowButton},"rsbUnexpayStatement editField":{notEnterValue:this.editAction,enteredValue:this.enterValueAction},"rsbUnexpayStatement editPeriod":{notEnterValue:this.editAction,enteredValue:this.enterValueAction}});this.callParent()},loadIndex:function(){var b=this,a=b.callParent();if(false!==a){b.osnovaniePlStore=Ext.getStore("u_statement_osn_plat_store");b.statusPlStore=Ext.getStore("u_statement_status_plat_store");LkIp.Request.request({url:"/api/rsb/unexpay/getCardInfo/"+b.fidCard,scope:this},function(c){if(c===false||Ext.isEmpty(c.response)||Ext.isEmpty(c.response.root)){LkIp.Msg.error(reference.lang.rsb.clarify.unexpay.errors.canNotGetCardData);LkIp.Utils.goTo("#!/rsb/unexpay");return false}LkIp.Request.request({url:"/api/rsb/cards/getKbkOktmoList",scope:this},function(d){if(d===false||Ext.isEmpty(c.response)){LkIp.Msg.error(reference.lang.rsb.clarify.unexpay.errors.kbkOkato);LkIp.Utils.goTo("#!/rsb/unexpay");return false}var e=b.cardData=c.response.root;b.getIndex().down('[name="rsbUStatementNoTpl"]').update({code:e["@KodNO"],inn_kpp:e["@INNNO"]+"/"+e["@KPPNO"],name:e["@NaimNO"],address:e["@AddressNO"]});b.getIndex().down('[name="rsbUStatementUvedomlTpl"]').update({number:e["@PlatDokNomer"],date:LkIp.Utils.getDate(e["@PlatDokData"])});if(typeof e["@PrichNePlat"]=="undefined"){LkIp.Msg.error(reference.lang.rsb.clarify.unexpay.errors.canNotGetCardData);return false}b.setRequiredFields(e["@PrichNePlat"]);b.editAction(false,false);b.getIndex().setData(e,b.requiredFields);LkIp.Request.request({url:"/api/filters/getBasePayment",scope:this},function(f){if(false!==f&&!Ext.isEmpty(f.response)){b.osnovaniePlStore.loadData(f.response)}});LkIp.Request.request({url:"/api/filters/getIPStatus",scope:this},function(f){if(false!==f&&!Ext.isEmpty(f.response)){b.statusPlStore.loadData(f.response)}});b.getIndex().setLoading(false)})})}},setRequiredFields:function(b){var a=this;if(Ext.Array.contains(b,"08")||Ext.Array.contains(b,"10")){a.requiredFields.push("inn_pol")}if(Ext.Array.contains(b,"09")||Ext.Array.contains(b,"10")){a.requiredFields.push("kpp_pol")}if(Ext.Array.contains(b,"01")||Ext.Array.contains(b,"02")||Ext.Array.contains(b,"13")||Ext.Array.contains(b,"14")){a.requiredFields.push("kbk_pol")}if(Ext.Array.contains(b,"03")){a.requiredFields.push("oktmo_pol")}if(Ext.Array.contains(b,"12")){a.requiredFields.push("osn_plat")}if(Ext.Array.contains(b,"16")){a.requiredFields.push("nal_period")}if(Ext.Array.contains(b,"15")){a.requiredFields.push("status_plat")}},editAction:function(f,d){var e=this,c=e.getIndex(),a=c.down('[name="rsbUnexpayStatementSignButton"]'),b=c.down('[name="rsbUnexpayStatementShowButton"]');if(false!==f){Ext.Array.include(e.editableFields,f);c.down("#u_statement_edit_help").show();a.disable();b.disable()}else{if(d!==false){e.removeFromEdited(d.itemId)}}if(!e.checkRequiredFields()){c.down("#u_statement_require_help").show();a.disable();b.disable()}else{if(Ext.isEmpty(e.requiredFields)&&Ext.isEmpty(e.editedFields)){c.down("#u_statement_require_one_enter-help").show();a.disable();b.disable()}}},removeFromEdited:function(b){var a=this,c=Ext.Array.indexOf(a.editedFields,b);if(c!=-1){Ext.Array.erase(a.editedFields,c,1)}},enterValueAction:function(f,d){var e=this,g=Ext.Array.indexOf(e.editableFields,f),c=e.getIndex(),a=c.down('[name="rsbUnexpayStatementSignButton"]'),b=c.down('[name="rsbUnexpayStatementShowButton"]');if(g!=-1){Ext.Array.erase(e.editableFields,g,1)}if(!Ext.isEmpty(d.getValue())){Ext.Array.include(e.editedFields,f)}else{e.removeFromEdited(d.itemId)}Ext.suspendLayouts();if(Ext.isEmpty(e.editableFields)){c.down("#u_statement_edit_help").hide();if(e.checkRequiredFields()){c.down("#u_statement_require_help").hide();if(Ext.isEmpty(e.requiredFields)&&Ext.isEmpty(e.editedFields)){c.down("#u_statement_require_one_enter-help").show();a.disable();b.disable()}else{c.down("#u_statement_require_one_enter-help").hide();a.enable();b.enable()}}else{if(Ext.isEmpty(e.requiredFields)&&Ext.isEmpty(e.editedFields)){c.down("#u_statement_require_one_enter-help").show()}else{c.down("#u_statement_require_one_enter-help").hide()}c.down("#u_statement_require_help").show();a.disable();b.disable()}}Ext.resumeLayouts(true)},checkRequiredFields:function(){var b=this,a=true;Ext.Array.each(b.requiredFields,function(c){a=!Ext.isEmpty(b.getIndex().down("#"+c+"_value").getValue());return a});return a},pushSignButton:function(){var a=this,b=a.getFormValues();if(!Ext.isEmpty(a.editableFields)||!a.checkRequiredFields()){LkIp.Msg.error(reference.lang.rsb.clarify.unexpay.statement.errors.editMode);return false}a.getIndex().setLoading(true);b.parentCard=Ext.JSON.encode(a.cardData);LkIp.Request.request({url:"/api/rsb/unexpay/generateXml",method:"POST",params:b},function(c){a.getController("Viewport").signAction(c,{loader:a.getIndex(),successCallback:function(){LkIp.Msg.success(reference.lang.signature.successDefault,{rewriteDefaultButtons:true,buttons:[{text:reference.lang.buttons.close,handler:function(){LkIp.Utils.goTo("#!/rsb/unexpay");LkIp.Msg.fireEvent("closemessagebox",LkIp.Msg);LkIp.Msg.close()}}]})},errorCallback:function(e){var d=a.getIndex().down("#rsbUnexpayStatementForm").getForm().getValues();if("NUM_ISNOT_UNIQUE"==e){LkIp.Msg.error(new Ext.XTemplate(reference.lang.signature.errors.numberError).apply({number:d.statement_number}))}else{LkIp.Msg.error(e,{rewriteDefaultButtons:true,buttons:[{text:reference.lang.buttons.close,handler:function(){LkIp.Utils.scrollTo(a.getIndex().down("#rsbUnexpayStatementForm"));LkIp.Msg.fireEvent("closemessagebox",LkIp.Msg);LkIp.Msg.close()}}]})}}})})},getFormValues:function(){var b=this,a=["data_doc_naprav","inn_pol","kpp_pol","kbk_pol","no_period","nomer_doc_naprav","oktmo_pol","osn_plat","statement_number","status_plat"],c=b.getIndex().down("#rsbUnexpayStatementForm").getForm().getValues();Ext.Object.each(c,function(d,e){if(!Ext.Array.contains(a,d)){delete c[d]}});return c},pushShowButton:function(){var a=this,b=a.getFormValues();if(!Ext.isEmpty(a.editableFields)||!a.checkRequiredFields()){LkIp.Msg.error(reference.lang.rsb.clarify.unexpay.statement.errors.editMode);return false}b.parentCard=Ext.JSON.encode(a.cardData);LkIp.Utils.downloadDocument("unexpayStatement","/api/rsb/unexpay/generatePdf",b)},errorCallback:function(c,b){var a=c.getIndex().down("#rsbUnexpayStatementForm").getForm().getValues();if("NUM_ISNOT_UNIQUE"==b){LkIp.Msg.error(new Ext.XTemplate(reference.lang.signature.errors.numberError).apply({number:a.statement_number}))}else{LkIp.Msg.error(b,{rewriteDefaultButtons:true,buttons:[{text:reference.lang.buttons.close,handler:function(){LkIp.Utils.scrollTo(c.getIndex().down("#rsbUnexpayStatementForm"));LkIp.Msg.fireEvent("closemessagebox",LkIp.Msg);LkIp.Msg.close()}}]})}}},0,0,0,0,0,0,[LkIp.controller.Rsb.Clarify.Unexpay,"Statement"],0));(Ext.cmd.derive("LkIp.model.Rsb.OverpaymentDecisions.Grid",Ext.data.Model,{fields:["@KodNO","@SummaResh","@NomerResh","@DataResh","@NomerDokOsnov","@DataDokOsnov","@NaimenKBKPerepl","@KBKPerepl","@OKATO_OKTMOPerepl","@KPPKartPerepl","@TipPlPerepl","@KBKZachet","@OKATO_OKTMOZachet","@TipPlZachet","@NomSchet","@NaimBank","@BIKBank","@INKPP"]},0,0,0,0,0,0,[LkIp.model.Rsb.OverpaymentDecisions,"Grid"],0));(Ext.cmd.derive("LkIp.store.Rsb.OverpaymentDecisions.GridStore",LkIp.store.DefaultStore,{model:"LkIp.model.Rsb.OverpaymentDecisions.Grid",url:"/rsb/overpayment/decisions/getInfo"},0,0,0,0,0,0,[LkIp.store.Rsb.OverpaymentDecisions,"GridStore"],0));(Ext.cmd.derive("LkIp.controller.Rsb.OverpaymentDecisions",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"rsbOverpaymentDecisions"},{ref:"gridOffset",selector:"#rsbOverpaymentDecisionsOffsetGrid"},{ref:"gridReturn",selector:"#rsbOverpaymentDecisionsReturnGrid"},{ref:"filterPanel",selector:"#rsbOverpaymentDecisionsFilterPanel"}],models:["Rsb.OverpaymentDecisions.Grid"],cache:false,type:1,filtersParams:{1:{},2:{}},getOverpaymentDecisionsStore:function(){return this.getStore("Rsb.OverpaymentDecisions.GridStore")},init:function(){this.getOverpaymentDecisionsStore().on({beforeload:{fn:this.beforeloadGrid,scope:this},load:{fn:this.loadGrid,scope:this}});this.control({rsbOverpaymentDecisions:{activate:function(){},deactivate:function(){this.getOverpaymentDecisionsStore().removeAll()}},'#statusBarTabsOverpaymentDecisions [type="status-bar-tab"]':{activate:this.activateTab},'rsbOverpaymentDecisions [rel="apply"]':{applyFilters:this.applyFiltersAction},'rsbOverpaymentDecisions [rel="reset"]':{resetFilters:this.resetFiltersAction},"#rsbOverpaymentDecisionsFilterPanel":{expand:this.expandFilterPanel},"#rsbOverpaymentDecisionsGrid":{getFile:this.getFileAction}});this.callParent()},loadIndex:function(){var a=this;a.callParent();if(false===a.cache){a.noStore=Ext.getStore("rsbOverpaymentDecisionsNoStore");a.cache=true}else{a.loadFirstPage()}},activateTab:function(a){var b=this;switch(a.itemId){case"tab-offset":b.getGridReturn().hide();b.getGridOffset().show();break;case"tab-return":b.getGridReturn().show();b.getGridOffset().hide();break}this.type=parseInt(a.typeDecisions);this.loadNoStore();this.loadFirstPage()},loadFirstPage:function(a){this.getOverpaymentDecisionsStore().loadPage(1,{params:Ext.isObject(a)?a:{}})},beforeloadGrid:function(){var a=this;a.applySelectedFilters(["type"]);a.getOverpaymentDecisionsStore().extraParams=this.getFiltersParams(true)},loadGrid:function(){this.getIndex().setLoading(false)},loadFilters:function(){var a=this;if(!LkIp.User.isInspectorWithCodeNO()){a.getFilterPanel().setLoading(true);LkIp.Request.request({url:"/api/rsb/overpayment/decisions/getFilters",scope:this},function(b){a.getFilterPanel().setLoading(false);a.defaulNoStoreValues=b.response.no;a.filtersLoaded=true;a.loadNoStore()})}else{a.filtersLoaded=true}},loadNoStore:function(){var b=this,a=[];if(b.filtersLoaded){Ext.Array.each(b.defaulNoStoreValues,function(c){if(c.type==b.type){a.push(c)}if(c.type==0||c.type==3){a.push(c)}});b.noStore.loadData(a)}},getFiltersParams:function(b){b=b||false;var c=Ext.Object.merge(this.filtersParams[this.type],{type:this.type});if(b){var a={};Ext.Object.each(c,function(d,e){if(!LkIp.Utils.isFilterEmpty(e)){a[d]=e}});return a}return c},applyFiltersAction:function(){this.filtersParams[this.type]=this.getFilterPanel().getForm().getValues();this.loadFirstPage()},getFileAction:function(){var a=this;LkIp.Utils.downloadDocument("rsbOverpaymentDecisions","/api/rsb/overpayment/decisions/getFile",a.getFiltersParams(true))}},0,0,0,0,0,[["filters",LkIp.mixins.Filters]],[LkIp.controller.Rsb,"OverpaymentDecisions"],0));(Ext.cmd.derive("LkIp.model.Rsb.PvzDecisions.Grid",Ext.data.Model,{fields:["@FIdNRVzyiskZadolj","@KodNO","@NomerResh","@DataResh","@SummaZadolj","@SummNevzZadolj","@OsnResh"]},0,0,0,0,0,0,[LkIp.model.Rsb.PvzDecisions,"Grid"],0));(Ext.cmd.derive("LkIp.store.Rsb.PvzDecisions.GridStore",LkIp.store.DefaultStore,{model:"LkIp.model.Rsb.PvzDecisions.Grid",url:"/rsb/pvz/decisions/getInfo"},0,0,0,0,0,0,[LkIp.store.Rsb.PvzDecisions,"GridStore"],0));(Ext.cmd.derive("LkIp.model.Rsb.SuspendedDecisions.Grid",Ext.data.Model,{fields:["@KodNO","@NomerResh","@DataResh","@NaimBanka","@NomerScheta","@OsnovanieVyistResh"]},0,0,0,0,0,0,[LkIp.model.Rsb.SuspendedDecisions,"Grid"],0));(Ext.cmd.derive("LkIp.store.Rsb.SuspendedDecisions.GridStore",LkIp.store.DefaultStore,{model:"LkIp.model.Rsb.SuspendedDecisions.Grid",url:"/rsb/suspended/decisions/getInfo"},0,0,0,0,0,0,[LkIp.store.Rsb.SuspendedDecisions,"GridStore"],0));(Ext.cmd.derive("LkIp.store.Rsb.PvzDecisions.Suspended.GridStore",LkIp.store.Rsb.SuspendedDecisions.GridStore,{model:"LkIp.model.Rsb.SuspendedDecisions.Grid",url:"/rsb/suspended/decisions/getInfo"},0,0,0,0,0,0,[LkIp.store.Rsb.PvzDecisions.Suspended,"GridStore"],0));(Ext.cmd.derive("LkIp.controller.Rsb.PvzDecisions",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"rsbPvzDecisions"},{ref:"grid",selector:"#rsbPvzDecisionsGrid"},{ref:"filterPanel",selector:"#rsbPvzDecisionsFilterPanel"}],models:["Rsb.PvzDecisions.Grid","Rsb.SuspendedDecisions.Grid"],cache:false,getPvzDecisionsStore:function(){return this.getStore("Rsb.PvzDecisions.GridStore")},getSuspendedStore:function(){return this.getStore("Rsb.PvzDecisions.Suspended.GridStore")},init:function(){this.getPvzDecisionsStore().on({beforeload:{fn:this.beforeloadGrid,scope:this},load:{fn:this.loadGrid,scope:this}});this.getSuspendedStore().on({beforeload:{fn:this.beforeloadSuspendedGrid,scope:this}});this.control({rsbPvzDecisions:{activate:function(){},deactivate:function(){}},'rsbPvzDecisions [rel="apply"]':{applyFilters:this.applyFiltersAction},'rsbPvzDecisions [rel="reset"]':{resetFilters:this.resetFiltersAction},"#rsbPvzDecisionsFilterPanel":{expand:this.expandFilterPanel},"#rsbPvzDecisionsGrid":{selectionchange:this.selectedAction,getFile:this.getFileAction}});this.callParent()},loadIndex:function(){var a=this,b=a.getCurrentPageUrl();a.callParent();a.getIndex().down("#suspendedBlock").hide();a.getSuspendedStore().removeAll();a.getPvzDecisionsStore().removeAll();a.type=b.slice(b.lastIndexOf("/")+1)=="money"?1:2;if(false===a.cache){a.noStore=Ext.getStore("rsbPvzDecisionsNoStore");a.cache=true}a.loadFirstPage()},loadFirstPage:function(a){this.getPvzDecisionsStore().loadPage(1,{params:Ext.isObject(a)?a:{}})},beforeloadGrid:function(){var a=this;a.applySelectedFilters();a.getPvzDecisionsStore().extraParams=Ext.apply(this.getFiltersParams(true),{type:a.type})},loadGrid:function(){this.getIndex().setLoading(false)},loadFilters:function(){var a=this;a.getFilterPanel().setLoading(true);LkIp.Request.request({url:"/api/rsb/pvz/decisions/getFilters/"+a.type,scope:this},function(b){a.getFilterPanel().setLoading(false);a.noStore.loadData(b.response.no);a.filtersLoaded=true})},selectedAction:function(d,b){var c=this,a=c.getIndex().down("#suspendedBlock");if(c.type==1&&!Ext.isEmpty(b)){a.show();LkIp.Utils.scrollTo(a);c.fidPvzDecision=b[0].data["@FIdNRVzyiskZadolj"];c.getSuspendedStore().loadPage(1,{})}},beforeloadSuspendedGrid:function(){this.getSuspendedStore().removeAll();this.getSuspendedStore().extraParams={fid:this.fidPvzDecision}},getFileAction:function(){var a=this;LkIp.Utils.downloadDocument("rsbPvzDecisions","/api/rsb/pvz/decisions/getFile",Ext.apply(this.getFiltersParams(true),{type:a.type}))}},0,0,0,0,0,[["filters",LkIp.mixins.Filters]],[LkIp.controller.Rsb,"PvzDecisions"],0));(Ext.cmd.derive("LkIp.controller.Rsb.SuspendedDecisions",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"rsbSuspendedDecisions"},{ref:"grid",selector:"#rsbSuspendedDecisionsGrid"},{ref:"filterPanel",selector:"#rsbSuspendedDecisionsFilterPanel"}],models:["Rsb.SuspendedDecisions.Grid"],cache:false,getSuspendedDecisionsStore:function(){return this.getStore("Rsb.SuspendedDecisions.GridStore")},init:function(){this.getSuspendedDecisionsStore().on({beforeload:{fn:this.beforeloadGrid,scope:this},load:{fn:this.loadGrid,scope:this}});this.control({rsbSuspendedDecisions:{activate:function(){},deactivate:function(){this.getSuspendedDecisionsStore().removeAll()}},'rsbSuspendedDecisions [rel="apply"]':{applyFilters:this.applyFiltersAction},'rsbSuspendedDecisions [rel="reset"]':{resetFilters:this.resetFiltersAction},"#rsbSuspendedDecisionsFilterPanel":{expand:this.expandFilterPanel},"#rsbSuspendedDecisionsGrid":{getFile:this.getFileAction}});this.callParent()},loadIndex:function(){var a=this;a.callParent();if(false===a.cache){a.noStore=Ext.getStore("rsbSuspendedDecisionsNoStore");a.cache=true}a.loadFirstPage()},loadFirstPage:function(a){this.getSuspendedDecisionsStore().loadPage(1,{params:Ext.isObject(a)?a:{}})},getFileAction:function(){var a=this;LkIp.Utils.downloadDocument("rsbSuspendedDecisions","/api/rsb/suspended/decisions/getFile")},beforeloadGrid:function(){var a=this;a.applySelectedFilters();a.getSuspendedDecisionsStore().extraParams=a.getFiltersParams(true)},loadGrid:function(){this.getIndex().setLoading(false)},loadFilters:function(){var a=this;a.getFilterPanel().setLoading(true);LkIp.Request.request({url:"/api/rsb/suspended/decisions/getFilters",scope:this},function(b){a.getFilterPanel().setLoading(false);a.noStore.loadData(b.response.no);a.filtersLoaded=true})}},0,0,0,0,0,[["filters",LkIp.mixins.Filters]],[LkIp.controller.Rsb,"SuspendedDecisions"],0));(Ext.cmd.derive("LkIp.model.Rsb.DebitDecisions.Grid",Ext.data.Model,{fields:["@KodNO","@NomerResh","@DataResh","@Osnovanie","@NaimenKBK","@KBK","@OKATO_OKTMO","@Summa","@Nalog","@Peni","@Shtraf","@Protsent"]},0,0,0,0,0,0,[LkIp.model.Rsb.DebitDecisions,"Grid"],0));(Ext.cmd.derive("LkIp.store.Rsb.DebitDecisions.GridStore",LkIp.store.DefaultStore,{model:"LkIp.model.Rsb.DebitDecisions.Grid",url:"/rsb/debit/decisions/getInfo"},0,0,0,0,0,0,[LkIp.store.Rsb.DebitDecisions,"GridStore"],0));(Ext.cmd.derive("LkIp.controller.Rsb.DebitDecisions",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"rsbDebitDecisions"},{ref:"grid",selector:"#rsbDebitDecisionsGrid"},{ref:"filterPanel",selector:"#rsbDebitDecisionsFilterPanel"}],models:["Rsb.DebitDecisions.Grid"],cache:false,getDebitDecisionsStore:function(){return this.getStore("Rsb.DebitDecisions.GridStore")},init:function(){this.getDebitDecisionsStore().on({beforeload:{fn:this.beforeloadGrid,scope:this},load:{fn:this.loadGrid,scope:this}});this.control({rsbDebitDecisions:{activate:function(){},deactivate:function(){this.getDebitDecisionsStore().removeAll()}},'rsbDebitDecisions [rel="apply"]':{applyFilters:this.applyFiltersAction},'rsbDebitDecisions [rel="reset"]':{resetFilters:this.resetFiltersAction},"#rsbDebitDecisionsFilterPanel":{expand:this.expandFilterPanel},"#rsbDebitDecisionsGrid":{getFile:this.getFileAction}});this.callParent()},loadIndex:function(){var a=this;a.callParent();if(false===a.cache){a.noStore=Ext.getStore("rsbDebitDecisionsNoStore");a.kbkStore=Ext.getStore("rsbDebitDecisionsKbkStore");a.reasonStore=Ext.getStore("rsbDebitDecisionsReasonStore");a.cache=true}a.loadFirstPage()},loadFirstPage:function(a){this.getDebitDecisionsStore().loadPage(1,{params:Ext.isObject(a)?a:{}})},beforeloadGrid:function(){var a=this;a.applySelectedFilters();a.getDebitDecisionsStore().extraParams=this.getFiltersParams(true)},loadGrid:function(){this.getIndex().setLoading(false)},loadFilters:function(){var a=this;a.getFilterPanel().setLoading(true);LkIp.Request.request({url:"/api/rsb/debit/decisions/getFilters",params:LkIp.Utils.checkForInspectorNo(),scope:this},function(b){a.getFilterPanel().setLoading(false);if(!LkIp.User.isInspectorWithCodeNO()){a.noStore.loadData(b.response.no)}a.kbkStore.loadData(b.response.kbk);a.reasonStore.loadData(b.response.reason);a.filtersLoaded=true})},getFileAction:function(){var a=this;LkIp.Utils.downloadDocument("rsbDebitDecisions","/api/rsb/debit/decisions/getFile",a.getFiltersParams(true))}},0,0,0,0,0,[["filters",LkIp.mixins.Filters]],[LkIp.controller.Rsb,"DebitDecisions"],0));(Ext.cmd.derive("LkIp.controller.Rsb.Clarify.Other",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"rsbClarifyOther"}],models:[],cache:false,editableFields:[],editedFields:[],cardData:{},init:function(){this.control({rsbClarifyOther:{activate:function(){},deactivate:function(){var a=this;a.resetPage();if(!Ext.isEmpty(a.osnovaniePlStore)){a.osnovaniePlStore.removeAll()}a.cardData={};a.editableFields=[];a.editedFields=[]}},'rsbClarifyOther [name="rsbClarifyOtherFindButton"]':{click:this.pushFindButton},'rsbClarifyOther [name="rsbClarifyOtherChooseButton"]':{click:this.pushChooseButton},'rsbClarifyOther [name="rsbClarifyOtherSignButton"]':{click:this.pushSignButton},'rsbClarifyOther [name="rsbClarifyOtherShowButton"]':{click:this.pushShowButton},"rsbClarifyOther editField":{notEnterValue:this.editAction,enteredValue:this.enterValueAction},"rsbClarifyOther editPeriod":{notEnterValue:this.editAction,enteredValue:this.enterValueAction},"#rsbClarifyOtherFindForm":{validitychange:this.validitychangeAction},"#rsbClarifyOtherGrid":{selectionchange:this.selectionChangeAction}});this.callParent()},loadIndex:function(){var a=this;a.callParent();a.gridStore=Ext.getStore("rsbClarifyOtherGridStore")},validitychangeAction:function(b,e){if(e){var d=this,c=d.getIndex().down('[name="number"]').getValue(),f=d.getIndex().down('[name="summ"]').getValue(),a=d.getIndex().down('[name="rsbClarifyOtherFindButton"]');if(Ext.isEmpty(c)&&Ext.isEmpty(f)){a.disable()}else{a.enable()}}},pushFindButton:function(){var a=this,b=a.getIndex().down("#rsbClarifyOtherFindForm").getForm().getValues();if(LkIp.User.isActiveUser()){a.resetPage();a.getIndex().setLoading(true);LkIp.Request.request({url:"api/rsb/clarify/other/getCards",params:b},function(c){a.getIndex().setLoading(false);if(false===c||Ext.isEmpty(c.response)||Ext.isEmpty(c.response.data)){LkIp.Msg.info(a.createErrorMsg(b));return false}if(1==c.response.alreadySend){LkIp.Msg.info(reference.lang.rsb.clarify.other.errors.alreadySend);return false}a.osnovaniePlStore=Ext.getStore("u_clarify_other_osn_plat_store");a.statusPlStore=Ext.getStore("u_clarify_other_status_plat_store");LkIp.Request.request({url:"/api/filters/getBasePayment",scope:this},function(d){if(false!==d&&!Ext.isEmpty(d.response)){a.osnovaniePlStore.loadData(d.response)}});LkIp.Request.request({url:"/api/filters/getIPStatus",scope:this},function(d){if(false!==d&&!Ext.isEmpty(d.response)){a.statusPlStore.loadData(d.response)}});if(1==c.response.count){a.cardData=c.response.data[0];a.getIndex().setData(c.response.data[0],[]);a.getIndex().down("#rsbClarifyOtherPaymentEditContainer").show();LkIp.Utils.scrollTo(a.getIndex().down("#rsbClarifyOtherPaymentHeader"),{duration:1000})}else{if(1<c.response.count){a.gridStore.loadData(c.response.data);a.getIndex().down("#rsbClarifyOtherPaymentGridContainer").show();LkIp.Utils.scrollTo(a.getIndex().down("#rsbClarifyOtherGridHeader"),{duration:1000})}}return true})}},resetPage:function(){var a=this;a.getIndex().down("#rsbClarifyOtherFindForm").getForm().reset();a.getIndex().removeData();a.getIndex().down("#rsbClarifyOtherPaymentEditContainer").hide();a.gridStore.removeAll();a.getIndex().down("#rsbClarifyOtherPaymentGridContainer").hide()},createErrorMsg:function(b){var a;if(!Ext.isEmpty(b.summ)){b.summ=LkIp.Utils.numberConvert(b.summ);if(Ext.isEmpty(b.number)){a=new Ext.Template(reference.lang.rsb.clarify.other.errors.paymentWithSumm)}else{a=new Ext.Template(reference.lang.rsb.clarify.other.errors.paymentError)}}else{a=new Ext.Template(reference.lang.rsb.clarify.other.errors.paymentWithNumber)}return a.apply(b)},pushChooseButton:function(){var c=this,a=c.getIndex().down("#rsbClarifyOtherGrid"),b=a.getSelected(),d=c.getIndex().down("#rsbClarifyOtherPaymentEditContainer");if(!Ext.isEmpty(b.data)){c.cardData=b.data;c.getIndex().setData(b.data,[]);d.show();LkIp.Utils.scrollTo(d,{duration:1000})}},pushSignButton:function(){var a=this,b=a.getFormValues();if(!Ext.isEmpty(a.editableFields)||a.isEmptyEnteredValue()){LkIp.Msg.error(reference.lang.rsb.clarify.other.errors.send);return false}b.parentCard=Ext.JSON.encode(a.cardData);a.getIndex().setLoading(true);LkIp.Request.request({url:"/api/rsb/clarify/other/generateXml",method:"POST",params:b},function(c){a.getController("Viewport").signAction(c,{loader:a.getIndex(),successCallback:function(){LkIp.Msg.success(reference.lang.signature.successDefault,{rewriteDefaultButtons:true,buttons:[{text:reference.lang.buttons.close,handler:function(){LkIp.Utils.scrollTo(a.getViewport(),{duration:1000});a.resetPage();a.getIndex().down("#rsbClarifyOtherPaymentForm").getForm().reset();LkIp.Msg.fireEvent("closemessagebox",LkIp.Msg);LkIp.Msg.close()}}]})},errorCallback:function(d){LkIp.Msg.error(d,{rewriteDefaultButtons:true,buttons:[{text:reference.lang.buttons.close,handler:function(){LkIp.Utils.scrollTo(a.getIndex().down("#rsbClarifyOtherPaymentForm"),{duration:1000});LkIp.Msg.fireEvent("closemessagebox",LkIp.Msg);LkIp.Msg.close()}}]})}})})},isEmptyEnteredValue:function(){var d=this,c=d.getIndex().down("#rsbClarifyOtherPaymentForm").getForm().getValues(),a=["data_doc_naprav","inn_pol","kbk_pol","kpp_pol","no_period","nomer_doc_naprav","oktmo_pol","osn_plat","status_plat"],b=false;Ext.Array.each(a,function(e){b=Ext.isEmpty(c[e]);return b});return b},getFormValues:function(){var b=this,a=["data_doc_naprav","inn_pol","kpp_pol","kbk_pol","no_period","nomer_doc_naprav","oktmo_pol","osn_plat","status_plat"],c=b.getIndex().down("#rsbClarifyOtherPaymentForm").getForm().getValues();Ext.Object.each(c,function(d,e){if(!Ext.Array.contains(a,d)){delete c[d]}});return c},pushShowButton:function(){var a=this,b=a.getFormValues();if(!Ext.isEmpty(a.editableFields)||a.isEmptyEnteredValue()){LkIp.Msg.error(reference.lang.rsb.clarify.other.errors.send);return false}b.parentCard=Ext.JSON.encode(a.cardData);LkIp.Utils.downloadDocument("clarifyOtherStatement","/api/rsb/clarify/other/generatePdf",b)},editAction:function(e){var d=this,c=d.getIndex(),a=c.down('[name="rsbClarifyOtherSignButton"]'),b=c.down('[name="rsbClarifyOtherShowButton"]');if(false!==e){Ext.Array.include(d.editableFields,e);c.down("#u_clarify_other_edit_help").show();a.disable();b.disable()}else{if(el!==false){d.removeFromEdited(el.itemId);if(Ext.isEmpty(d.editedFields)){c.down("#u_clarify_other_enter_one_field_help").show();a.disable();b.disable()}}}},removeFromEdited:function(b){var a=this,c=Ext.Array.indexOf(a.editedFields,b);if(c!=-1){Ext.Array.erase(a.editedFields,c,1)}},enterValueAction:function(f,d){var e=this,g=Ext.Array.indexOf(e.editableFields,f),c=e.getIndex(),a=c.down('[name="rsbClarifyOtherSignButton"]'),b=c.down('[name="rsbClarifyOtherShowButton"]');if(g!=-1){Ext.Array.erase(e.editableFields,g,1)}if(!Ext.isEmpty(d.getValue())){Ext.Array.include(e.editedFields,f)}else{e.removeFromEdited(d.itemId)}Ext.suspendLayouts();if(Ext.isEmpty(e.editableFields)){c.down("#u_clarify_other_edit_help").hide();if(Ext.isEmpty(e.editedFields)){c.down("#u_clarify_other_enter_one_field_help").show();a.disable();b.disable()}else{c.down("#u_clarify_other_enter_one_field_help").hide();a.enable();b.enable()}}Ext.resumeLayouts(true)},selectionChangeAction:function(e,a){if(a.length){Ext.suspendLayouts();var d=this,c=a[0].get("@EstZayavl"),b=d.getIndex().down('[name="rsbClarifyOtherChooseButton"]');if(typeof c!="undefined"){b.setDisabled(c>0)}Ext.resumeLayouts(true)}}},0,0,0,0,0,0,[LkIp.controller.Rsb.Clarify,"Other"],0));(Ext.cmd.derive("LkIp.controller.Rsb.Cards.Details",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"rsbCardsDetails"}],selectAll:false,storeName:"rsbCardsGridViewStore",defaultSort:"DESC",currentSelectedFid:undefined,currentData:[],data:[],kbkTooltip:undefined,init:function(){var a=this;Ext.getBody().addListener("click",function(z,e){if(!Ext.isEmpty(a.kktProgressTooltip)){a.kbkTooltip.destroy()}var l=Ext.get(e).getAttribute("data-kbk"),j=l.substr(0,13),w="10",A="21",f="30",c="22",g=l.substr(15),b=true,d=true,n=false,u=false,D=false,v=false,s=false,p=false;if(l=="18210202101080011160"||l=="18210202103080011160"||l=="18210202103080013160"){A="20";b=false}if(l=="18210202101080013160"){A="20"}if(l=="18210910010060000160"||l=="18210910020060000160"){A="20";c="20";d=false}if(l=="18210202131060000160"||l=="18210202132060000160"){n=true;v=true;s=true;p=true;var F=l.substr(17),m=j+"1010"+F,x=j+"1020"+F,C=j+"2110"+F,t=j+"2100"+F,k=j+"3010"+F,B=j+"3000"+F,i=j+"2210"+F,y=j+"2200"+F}if(l=="18210202140060000160"){u=true;var m=j+"11"+g,x=j+"12"+g}if(l=="18210202140060010160"){D=true;var m=j+"1110"+l.substr(17),x=j+"1210"+l.substr(17)}var r=j+w+g,h=j+A+g,E=j+f+g,o=j+c+g,q='<table style="width: 100%;">'+(n?('<tr><td class="fl-l"> \u0412\u0437\u043d\u043e\u0441 (\u043f\u043e \u043d\u0435\u0437\u0430\u0432\u0438\u0441. \u0442\u0430\u0440\u0438\u0444\u0443):</td><td class="fl-r">'+m+'</td></tr><tr><td class="fl-l"> \u0412\u0437\u043d\u043e\u0441 (\u043f\u043e \u0437\u0430\u0432\u0438\u0441. \u0442\u0430\u0440\u0438\u0444\u0443):</td><td class="fl-r">'+x+"</td></tr>"):"")+(u?('<tr><td class="fl-l"> \u0412\u0437\u043d\u043e\u0441 (\u0434\u043e \u043f\u0440\u0435\u0434\u0435\u043b\u044c\u043d\u043e\u0433\u043e \u0434\u043e\u0445\u043e\u0434\u0430):</td><td class="fl-r">'+m+'</td></tr><tr><td class="fl-l"> \u0412\u0437\u043d\u043e\u0441 (\u0441\u0432\u0435\u0440\u0445 \u043f\u0440\u0435\u0434\u0435\u043b\u044c\u043d\u043e\u0433\u043e \u0434\u043e\u0445\u043e\u0434\u0430):</td><td class="fl-r">'+x+"</td></tr>"):"")+(D?('<tr><td class="fl-l"> \u0412\u0437\u043d\u043e\u0441:</td><td class="fl-r">'+m+'</td></tr><tr><td class="fl-l"> \u0412\u0437\u043d\u043e\u0441 (\u0441\u0432\u0435\u0440\u0445 \u0432\u0435\u043b\u0438\u0447\u0438\u043d\u044b \u0434\u043e\u0445\u043e\u0434\u0430 <br/> \u043f\u043e \u0441\u0442. 430 \u041d\u041a \u0420\u0424):</td><td class="fl-r">'+x+"</td></tr>"):"")+((n||u||D)?"":'<tr><td class="fl-l">\u041d\u0430\u043b\u043e\u0433, \u0432\u0437\u043d\u043e\u0441:</td><td class="fl-r">'+r+"</td></tr>")+(v?('<tr><td class="fl-l"> \u041f\u0435\u043d\u0438 (\u043f\u043e \u043d\u0435\u0437\u0430\u0432\u0438\u0441. \u0442\u0430\u0440\u0438\u0444\u0443):</td><td class="fl-r">'+C+'</td></tr><tr><td class="fl-l"> \u041f\u0435\u043d\u0438 (\u043f\u043e \u0437\u0430\u0432\u0438\u0441. \u0442\u0430\u0440\u0438\u0444\u0443):</td><td class="fl-r">'+t+"</td></tr>"):"")+(v?"":'<tr><td class="fl-l">\u041f\u0435\u043d\u0438:</td><td class="fl-r">'+h+"</td></tr>")+(s?('<tr><td class="fl-l"> \u0428\u0442\u0440\u0430\u0444 (\u043f\u043e \u043d\u0435\u0437\u0430\u0432\u0438\u0441. \u0442\u0430\u0440\u0438\u0444\u0443):</td><td class="fl-r">'+k+'</td></tr><tr><td class="fl-l"> \u0428\u0442\u0440\u0430\u0444 (\u043f\u043e \u0437\u0430\u0432\u0438\u0441. \u0442\u0430\u0440\u0438\u0444\u0443):</td><td class="fl-r">'+B+"</td></tr>"):"")+(!s&&d?'<tr><td class="fl-l">\u0428\u0442\u0440\u0430\u0444\u044b:</td><td class="fl-r">'+E+"</td></tr>":"")+(p?('<tr><td class="fl-l"> \u041f\u0440\u043e\u0446\u0435\u043d\u0442\u044b (\u043f\u043e \u043d\u0435\u0437\u0430\u0432\u0438\u0441. \u0442\u0430\u0440\u0438\u0444\u0443):</td><td class="fl-r">'+i+'</td></tr><tr><td class="fl-l"> \u041f\u0440\u043e\u0446\u0435\u043d\u0442\u044b (\u043f\u043e \u0437\u0430\u0432\u0438\u0441. \u0442\u0430\u0440\u0438\u0444\u0443):</td><td class="fl-r">'+y+"</td></tr>"):"")+(!p&&b?'<tr><td class="fl-l">\u041f\u0440\u043e\u0446\u0435\u043d\u0442\u044b:</td><td class="fl-r">'+o+"</td></tr>":"")+"</table>";a.kbkTooltip=LkIp.Utils.tooltip(Ext.get(e),q,{dismissDelay:0,width:D?400:undefined,hideDelay:6000,listeners:{hide:function(G){G.destroy();a.kktProgressTooltip=undefined}}});a.kbkTooltip.show()},this,{preventDefault:true,stopEvent:true,delegate:".kbk-pay"});this.control({rsbCardsDetails:{activate:function(){},deactivate:function(){var b=this;b.getIndex().down("#content-page").removeAll();if(!Ext.isEmpty(Ext.getStore(b.storeName))){Ext.getStore(b.storeName).removeAll()}b.defaultSort="DESC";b.data=[];b.currentData=[];b.currentSelectedFid=undefined}},'rsbCardsDetails [name="codeNoFilter"]':{change:{fn:this.onTextFieldChange,buffer:300}},'rsbCardsDetails [name="rsb-cards-sorting-button"]':{sortCardData:this.sortCardDataAction},'rsbCardsDetails [type="cardBtn"]':{click:this.clickButton},"rsbCardsDetails #rsb-cards-grid-view-grid":{selectionchange:this.selectionChangeAction}});this.callParent()},getRsbCards:function(){var a=this;if(Ext.isEmpty(LkIp.Settings.get("cards"))){LkIp.Request.request({url:"/api/rsb/cards/getDetails",scope:this,params:LkIp.User.isInspectorWithCodeNO()?{codeNO:LkIp.User.get("codeNO")}:{}},function(c){var b=LkIp.Utils.isJsonSuccess(c)?c.response:[];LkIp.Settings.set("cards",b);a.modifyData(b.cards)},true)}else{a.modifyData(LkIp.Settings.get("cards").cards)}},modifyData:function(c){var a=this,b=Ext.util.Cookies.get("currentCardIndex");if(Ext.isEmpty(c)){LkIp.Utils.goTo("#!/index");return false}else{a.data=Ext.Array.findBy(c,function(d){return d.fid.indexOf(b)>-1});a.currentSelectedFid=b}a.showCard()},loadIndex:function(){var a=this,b=Ext.util.Cookies.get("currentCardIndex");if(null===b){LkIp.Utils.goTo("#!/index");return false}a.callParent();a.getIndex().setLoading(true);a.getRsbCards()},showCard:function(){var d=this,a=[];if(!Ext.isEmpty(d.data)){var e=d.data.countCards>1;if(e){d.gridData=d.formData(d.data.children);a=d.data.children[0]}else{a=d.data}d.getIndex().drawPage(a,d.data.cardHeader,d.storeName,e);if(e){d.gridData=d.sortCardData(d.gridData);Ext.getStore(d.storeName).loadData(d.gridData);var c=d.getIndex().down("#rsb-cards-grid-view-grid").getSelectionModel();if(d.currentSelectedFid.indexOf("_")==-1){var b=Ext.getStore(d.storeName).findBy(function(f){return f.get("fid").indexOf(d.currentSelectedFid)>-1});d.currentSelectedFid=0;c.select(b)}else{c.select(0)}d.currentSelectedFid=c.getSelection()[0].get("fid")}d.getIndex().down("#kbkToPay-debt").update(a);d.getIndex().down("#kbkToPay-over").update(a)}d.getIndex().setLoading(false)},recalculateHeight:function(){Ext.suspendLayouts();var f=this,d=f.getIndex().down("#rsb-cards-grid-view-filters").getHeight(),e=f.getIndex().down("#rsb-cards-grid-view-grid").getHeight(),c=d+e,b=f.getIndex().down("#rsb-cards-card-view").getHeight(),g=f.getIndex().getHeight(),a=Ext.Array.max([c,b,g]);if(a-c!=0){f.getIndex().down("#rsb-cards-grid-view-after-grid").setHeight(a-c-38);f.getIndex().doLayout()}else{f.getIndex().down("#rsb-cards-grid-view-after-grid").setHeight(50-38);f.getIndex().doLayout()}Ext.resumeLayouts(true)},selectionChangeAction:function(h,a){var e=this;if(!Ext.isEmpty(a)){var b=a[0].get("fid");if(b!=e.currentSelectedFid){Ext.suspendLayouts();var d=e.getIndex().down("#rsb-cards-card-view"),g=e.getIndex().down("#cardFid-"+e.currentSelectedFid),c=e.getIndex().down("#cardFid-"+b);e.currentSelectedFid=b;if(!Ext.isEmpty(g)){g.hide()}var f=e.findCardByFid(b);f.hideOktmo=0;if(!Ext.isEmpty(c)){c.show()}else{d.add(Ext.create("LkIp.view.Rsb.Cards.Details.CardInfoLayout",{cardData:f}))}Ext.resumeLayouts(true);c=e.getIndex().down("#cardFid-"+b);c.down("#kbkToPay-debt").update(f);c.down("#kbkToPay-over").update(f);e.recalculateHeight()}}},findCardByFid:function(a){return Ext.Array.findBy(this.data.children,function(b){return b.fid===a})},formData:function(b){var a=[];Ext.Array.each(b,function(c){a.push({codeNo:Ext.isObject(c.codeNo)?"":c.codeNo,nameNo:c.nameNo,debtSumm:c.debt.total,overpaymentSumm:c.overpayment.total,fid:c.fid})});return a},sortCardDataAction:function(b){var c=this,a=Ext.getStore(c.storeName);if("DESC"===c.defaultSort){b.setIconCls("arrow-down-black-icon")}else{b.setIconCls("arrow-up-black-icon")}c.gridData=c.sortCardData(c.gridData);a.loadData(c.gridData);c.afterLoadEvent(a)},afterLoadEvent:function(b){var c=this;if(!Ext.isEmpty(c.currentSelectedFid)){var a=b.findRecord("fid",c.currentSelectedFid);if(!Ext.isEmpty(a)){c.getIndex().down("#rsb-cards-grid-view-grid").getSelectionModel().select([a],false,false)}}},onTextFieldChange:function(c,e){var d=this,b=[],a=Ext.getStore(d.storeName);if(0===e.length){a.loadData(d.gridData)}else{Ext.Array.each(d.gridData,function(f){if(f.codeNo===e||0===f.codeNo.indexOf(e)){b.push(f)}});a.loadData(b)}d.afterLoadEvent(a);c.focus()},sortCardData:function(b){var a=this;b=Ext.Array.sort(b,function(d,c){var f=d.debtSumm,e=c.debtSumm;if(f===e){return 0}if("ASC"===a.defaultSort){if(f>e){return 1}else{if(f<e){return -1}}}else{if(f>e){return -1}else{return 1}}});a.defaultSort=a.defaultSort==="DESC"?"ASC":"DESC";return b},clickButton:function(a){switch(a.itemId){case"overpaymentBtn":LkIp.Utils.goTo("#!/rsb/overpayment");break;default:break}}},0,0,0,0,0,0,[LkIp.controller.Rsb.Cards,"Details"],0));(Ext.cmd.derive("LkIp.controller.Partnership",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"#partnership"},{ref:"formPanel",selector:"#partnership-form"}],models:[],headData:undefined,init:function(){this.control({"#partnership":{activate:function(){this.getIndex().setLoading(true)}},'#partnership [name="partnershipSignButton"]':{click:this.submitFormAction},'#partnership [name="partnershipShowButton"]':{click:this.getPdf}});this.callParent()},loadIndex:function(){var a=this,b;a.callParent();a.noStore=Ext.getStore("partnershipNoStore");a.oksmStore=Ext.getStore("partnershipOksmStore");LkIp.Request.request({url:"/api/partnership/getFilters",scope:this},function(c){a.getIndex().setLoading(false);if(false!==c&&!Ext.isEmpty(c.response)){a.noStore.loadData(c.response.no);b=LkIp.User.get("head");if(!Ext.isEmpty(b)){a.getFormPanel().down('[name="no"]').setValue(b.SvedUchet["@KodNalOrg"])}}})},submitFormAction:function(){var b=this,a=b.getFormPanel();if(a.getForm().isValid()){b.getIndex().setLoading(true);LkIp.Request.request({url:"/api/partnership/request",params:a.getValues(),method:"POST",scope:b},function(c){b.getController("Viewport").signAction(c,{loader:b.getIndex()})})}},formSubmitFailure:function(a,b){this.getIndex().setLoading(false);LkIp.Msg.error(b.result.response)},getPdf:function(){var d=this,c=d.getIndex(),a=d.getFormPanel(),b=a.getValues();LkIp.Utils.downloadDocument("partnership","/api/partnership/pdf",b)}},0,0,0,0,0,0,[LkIp.controller,"Partnership"],0));(Ext.cmd.derive("LkIp.model.Rsb.Reconciliation.Grid",Ext.data.Model,{fields:["@FIdSovmSver","@KodNO","@NomerAktaSver","@FormaSver","@NomerZayavl","@DataZayavl","@DataNachSver","@DataKonSver","@PrichOkonSver","@DataNachSverPeriod","@DataKonSverPeriod"]},0,0,0,0,0,0,[LkIp.model.Rsb.Reconciliation,"Grid"],0));(Ext.cmd.derive("LkIp.store.Rsb.Reconciliation.GridStore",LkIp.store.DefaultStore,{model:"LkIp.model.Rsb.Reconciliation.Grid",url:"/rsb/reconciliation/getInfo"},0,0,0,0,0,0,[LkIp.store.Rsb.Reconciliation,"GridStore"],0));(Ext.cmd.derive("LkIp.model.Rsb.Reconciliation.StatementGrid",Ext.data.Model,{fields:["@KodNO","@NomerAkt","@DataAkt","@FormaSver","@NaimKBK","@KBK","@OKATO_OKTMO","@VidNal","@PrichOkonSver","@DataNachSverPeriod","@DataKonSverPeriod"]},0,0,0,0,0,0,[LkIp.model.Rsb.Reconciliation,"StatementGrid"],0));(Ext.cmd.derive("LkIp.store.Rsb.Reconciliation.StatementGridStore",LkIp.store.DefaultStore,{model:"LkIp.model.Rsb.Reconciliation.StatementGrid",url:"/rsb/reconciliation/getStatementInfo"},0,0,0,0,0,0,[LkIp.store.Rsb.Reconciliation,"StatementGridStore"],0));(Ext.cmd.derive("LkIp.controller.Rsb.Reconciliation",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"rsbReconciliation"},{ref:"grid",selector:"#rsbReconciliationGrid"},{ref:"statementGrid",selector:"#rsbReconciliationStatementGrid"},{ref:"filterPanel",selector:"#rsbReconciliationFilterPanel"},{ref:"statementFilterPanel",selector:"#rsbReconciliationStatementFilterPanel"}],models:["Rsb.Reconciliation.Grid","Rsb.Reconciliation.StatementGrid"],cache:false,tab:1,filtersParams:{1:{},2:{}},filtersLoaded:false,filtersLoadedStatement:false,getReconsiliationStore:function(){return this.getStore("Rsb.Reconciliation.GridStore")},getReconsiliationStatementStore:function(){return this.getStore("Rsb.Reconciliation.StatementGridStore")},init:function(){this.getReconsiliationStore().on({beforeload:{fn:this.beforeloadGrid,scope:this}});this.getReconsiliationStatementStore().on({beforeload:{fn:this.beforeloadStatementGrid,scope:this}});this.control({rsbReconciliation:{activate:function(){this.getIndex().down("#reconciliationTabPanel").activeTab=null},deactivate:function(){this.getReconsiliationStore().removeAll();this.getReconsiliationStatementStore().removeAll();this.getGrid().getSelectionModel().deselectAll()}},"#reconciliationTabPanel":{tabchange:this.activateTab},'#rsbReconciliationFilterPanel [rel="apply"]':{applyFilters:this.applyFiltersAction},'#rsbReconciliationFilterPanel [rel="reset"]':{resetFilters:this.resetFiltersAction},'#rsbReconciliationStatementFilterPanel [rel="apply"]':{applyFilters:this.applyFiltersAction},'#rsbReconciliationStatementFilterPanel [rel="reset"]':{resetFilters:this.resetFiltersAction},"#rsbReconciliationFilterPanel":{expand:this.expandFilterPanel},"#rsbReconciliationStatementFilterPanel":{expand:this.expandFilterPanel},"#rsbReconciliationGrid":{selectionchange:this.selectRow,getFile:this.getFileAction},"#rsbReconciliationStatementGrid":{getFile:this.getFileAction},'rsbReconciliation button[type="toolbarButtons"]':{click:this.pushButton}});this.callParent()},loadIndex:function(){var a=this;a.callParent();a.noStore=Ext.getStore("rsbReconciliationNoStore");a.reasonStore=Ext.getStore("rsbReconciliationReasonStore");a.statementNoStore=Ext.getStore("rsbReconciliationStatementNoStore");a.statementKbkStore=Ext.getStore("rsbReconciliationStatementKbkStore");a.statementReasonStore=Ext.getStore("rsbReconciliationStatementReasonStore");a.statementTypeTaxStore=Ext.getStore("rsbReconciliationStatementTypeTaxStore");a.statementStatusIPStore=Ext.getStore("rsbReconciliationStatementStatusIPStore");if(!Ext.isEmpty(LkIp.FlashData.get("reconciliationSection"))){a.getIndex().down("#reconciliationTabPanel").setActiveTab(1)}else{a.getIndex().down("#reconciliationTabPanel").setActiveTab(0)}},activateTab:function(a,b){var c=this;switch(b.itemId){case"tab-reconciliation-common":c.getGrid().getSelectionModel().deselectAll();c.tab=1;break;case"tab-reconciliation-section":c.tab=2;break}c.loadFirstPage()},loadFirstPage:function(c){var b=this,a=b.tab==1?b.getReconsiliationStore():b.getReconsiliationStatementStore();a.loadPage(1,{params:Ext.isObject(c)?c:{}})},beforeloadGrid:function(){var a=this;a.applySelectedFilters();a.getReconsiliationStore().extraParams=this.getFiltersParams(true)},beforeloadStatementGrid:function(){var a=this;a.applySelectedFilters();a.getReconsiliationStatementStore().extraParams=this.getFiltersParams(true)},expandFilterPanel:function(){switch(this.tab){case 1:!this.filtersLoaded&&this.loadFilters();break;case 2:!this.filtersLoadedStatement&&this.loadFiltersStatement();break;default:break}},loadFilters:function(){var a=this;a.getFilterPanel().setLoading(true);LkIp.Request.request({url:"/api/rsb/reconciliation/getFilters",params:LkIp.Utils.checkForInspectorNo(),scope:this},function(b){a.getFilterPanel().setLoading(false);if(!LkIp.User.isInspectorWithCodeNO()){a.noStore.loadData(b.response.no)}a.reasonStore.loadData(b.response.reason);a.filtersLoaded=true})},loadFiltersStatement:function(){var a=this;a.getStatementFilterPanel().setLoading(true);LkIp.Request.request({url:"/api/rsb/reconciliation/getStatementFilters",params:LkIp.Utils.checkForInspectorNo(),scope:this},function(b){a.getStatementFilterPanel().setLoading(false);if(!LkIp.User.isInspectorWithCodeNO()){a.statementNoStore.loadData(b.response.no)}a.statementKbkStore.loadData(b.response.kbk);a.statementStatusIPStore.loadData(b.response.statusIP);a.statementReasonStore.loadData(b.response.reason);a.filtersLoadedStatement=true})},applyFiltersAction:function(){var a=this.tab==1?this.getFilterPanel():this.getStatementFilterPanel();this.filtersParams[this.tab]=a.getForm().getValues();this.loadFirstPage()},resetFiltersAction:function(){var a=this.tab==1?this.getFilterPanel():this.getStatementFilterPanel();this.filtersParams[this.tab]={};Ext.suspendLayouts();a.getForm().reset();Ext.resumeLayouts(true);this.loadFirstPage()},getFiltersParams:function(b){b=b||false;var c=this.filtersParams[this.tab];if(b){var a={};Ext.Object.each(c,function(d,e){if(!LkIp.Utils.isFilterEmpty(e)){a[d]=e}});return a}return c},applySelectedFilters:function(){var c=this,b=c.getFiltersParams(),a=c.tab==1?c.getFilterPanel():c.getStatementFilterPanel();Ext.suspendLayouts();if(Ext.Object.getSize(b)>0){Ext.Object.each(b,function(d,e){if(!LkIp.Utils.isFilterEmpty(e)){a.down('[name="'+d+'"]').setValue(e)}else{a.down('[name="'+d+'"]').reset()}})}else{if(typeof a!="undefined"){a.getForm().reset()}}Ext.resumeLayouts(true)},getFileAction:function(){LkIp.Utils.downloadDocument("reconciliation",this.tab==1?"/api/rsb/reconciliation/getFile":"/api/rsb/reconciliation/getStatementFile",this.getFiltersParams(true))},selectRow:function(b,a){if(!Ext.isEmpty(a)){this.getIndex().down("#objectBtn").enable()}else{this.getIndex().down("#objectBtn").disable()}},pushButton:function(a){var b=this;switch(a.itemId){case"objectBtn":LkIp.Utils.goTo(this.getCurrentPageUrl()+"/object?"+b.getGrid().getSelected().data["@FIdSovmSver"]);break;case"statementBtn":LkIp.Utils.goTo(this.getCurrentPageUrl()+"/statement");break}}},0,0,0,0,0,0,[LkIp.controller.Rsb,"Reconciliation"],0));(Ext.cmd.derive("LkIp.store.Rsb.Reconciliation.Object.GridStore",LkIp.store.Rsb.Reconciliation.StatementGridStore,{},0,0,0,0,0,0,[LkIp.store.Rsb.Reconciliation.Object,"GridStore"],0));(Ext.cmd.derive("LkIp.controller.Rsb.Reconciliation.Object",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"rsbReconciliationObject"},{ref:"grid",selector:"#rsbReconciliationObjectGrid"},{ref:"filterPanel",selector:"#rsbReconciliationObjectFilterPanel"}],models:["Rsb.Reconciliation.StatementGrid"],cache:false,filtersLoaded:false,getReconsiliationObjectStore:function(){return this.getStore("Rsb.Reconciliation.Object.GridStore")},init:function(){this.getReconsiliationObjectStore().on({beforeload:{fn:this.beforeloadGrid,scope:this}});this.control({rsbReconciliationObject:{activate:function(){},deactivate:function(){this.getReconsiliationObjectStore().removeAll();this.getIndex().down("#objectInfo").update({nomerZayavl:"-",dataZayavl:"-",nomerAkt:"-",razdel:"-",prichOkonSver:"-",dataNach:"-",dataKon:"-",dataNachPeriod:"-",dataKonPeriod:"-"})}},'#rsbReconciliationObjectFilterPanel [rel="apply"]':{applyFilters:this.applyFiltersAction},'#rsbReconciliationObjectFilterPanel [rel="reset"]':{resetFilters:this.resetFiltersAction},"#rsbReconciliationObjectFilterPanel":{expand:this.expandFilterPanel},"#rsbReconciliationObjectGrid":{getFile:this.getFileAction}});this.callParent()},loadIndex:function(){var b=this,a=b.callParent();if(false!=a){b.getIndex().setLoading(true);LkIp.Request.request({url:"/api/rsb/reconciliation/getObjectInfo/"+b.fidReconciliation,scope:this},function(c){if(c==false||Ext.isEmpty(c.response)||Ext.isEmpty(c.response.Sved_SovmSver)){LkIp.Msg.error(reference.lang.rsb.reconciliation.errors.noObjectInfo);LkIp.Utils.goTo(b.currentPage.href.substring(0,b.currentPage.href.lastIndexOf("/")));return false}b.objectInfo=c.response.Sved_SovmSver;b.getIndex().down("#objectInfo").update({nomerZayavl:b.objectInfo["@NomerZayavl"],dataZayavl:LkIp.Utils.getDate(b.objectInfo["@DataZayavl"]),nomerAkt:b.objectInfo["@NomerAktaSver"],razdel:b.objectInfo["@FormaSver"]==2?reference.lang.rsb.reconciliation.sectionValue.two:(b.objectInfo["@FormaSver"]==1?reference.lang.rsb.reconciliation.sectionValue.one:reference.lang.rsb.reconciliation.sectionValue.oneAndTwo),prichOkonSver:b.objectInfo["@PrichOkonSver"],dataNach:LkIp.Utils.getDate(b.objectInfo["@DataNachSver"]),dataKon:!Ext.isEmpty(b.objectInfo["@DataKonSver"])?LkIp.Utils.getDate(b.objectInfo["@DataKonSver"]):"",dataNachPeriod:LkIp.Utils.getDate(b.objectInfo["@DataNachSverPeriod"]),dataKonPeriod:LkIp.Utils.getDate(b.objectInfo["@DataKonSverPeriod"])});b.kbkStore=Ext.getStore("rsbReconciliationObjectKbkStore");b.typeTaxStore=Ext.getStore("rsbReconciliationObjectTypeTaxStore");b.getIndex().setLoading(false);b.loadFirstPage()})}},loadFirstPage:function(a){this.getReconsiliationObjectStore().loadPage(1,{params:Ext.isObject(a)?a:{}})},beforeloadGrid:function(){var a=this;a.applySelectedFilters();a.getReconsiliationObjectStore().extraParams=Ext.apply({fidReconciliation:a.fidReconciliation},this.getFiltersParams(true))},loadFilters:function(){var a=this;a.getFilterPanel().setLoading(true);LkIp.Request.request({url:"/api/rsb/reconciliation/getStatementFilters",scope:this,params:{fidReconciliation:a.fidReconciliation}},function(b){a.getFilterPanel().setLoading(false);a.kbkStore.loadData(b.response.kbk);a.filtersLoaded=true})},getFileAction:function(){LkIp.Utils.downloadDocument("reconciliation","/api/rsb/reconciliation/getStatementFile",this.getFiltersParams(true))}},0,0,0,0,0,[["filters",LkIp.mixins.Filters]],[LkIp.controller.Rsb.Reconciliation,"Object"],0));(Ext.cmd.derive("LkIp.controller.PersonalData.Update",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"personalDataUpdate"},{ref:"form",selector:"#userinfoUpdateForm"}],models:[],headData:{},init:function(){this.control({"personalDataUpdate button":{click:this.pushButtonAction}});this.callParent()},loadIndex:function(){var b=this,a=b.callParent();if(false!=a){b.headData=LkIp.User.get("head");if(!Ext.Object.isEmpty(b.headData)){b.getIndex().updateTableData(b.headData)}else{LkIp.Msg.error(reference.lang.userinfo.update.errors.headData)}}},pushButtonAction:function(b){var d=this,c=d.getForm(),e=c.getForm().getValues(),a=false;if(Ext.Object.isEmpty(d.headData)){LkIp.Msg.error(reference.lang.userinfo.update.errors.headData);return false}Ext.Object.each(e,function(f,g){if(!Ext.isEmpty(g)&&f!="additionalInfo"&&f!="codeNo"){a=true;return false}});if(a&&c.getForm().isValid()){c.setLoading(true);LkIp.Request.request({url:"api/userinfo/update/changePersonalData",scope:this,params:e,method:"POST"},function(f){c.setLoading(false);if(false!==f&&!(Ext.isEmpty(f.response))){if(0!==f.status){c.getForm().reset();d.getIndex().updateTableData(d.headData);LkIp.app.fireEvent("clearCache");LkIp.Msg.success(new Ext.XTemplate(reference.lang.userinfo.update.success).apply({codeNo:e.codeNo}))}else{LkIp.Msg.error(f.response)}}else{LkIp.Msg.error(reference.lang.errors.serverError)}});c.setLoading(false)}else{LkIp.Msg.error(reference.lang.userinfo.update.errors.allEmpty)}}},0,0,0,0,0,0,[LkIp.controller.PersonalData,"Update"],0));(Ext.cmd.derive("LkIp.model.Rsb.CompliedReqs.GridInfo",Ext.data.Model,{fields:["@OKATO_OKTMO","@KPPObyektUch","@SrokUpl","@NaimKBK","@KodKBK","@NaimStatus","@KodStatus","@NalogSummTreb","@PeniSummTreb","@ShtrafSummTreb","@ProtsentSummTreb","@NalogNeoplOst","@PeniNeoplOst","@ShtrafNeoplOst","@ProtsentNeoplOst"]},0,0,0,0,0,0,[LkIp.model.Rsb.CompliedReqs,"GridInfo"],0));(Ext.cmd.derive("LkIp.store.Rsb.CompliedReqs.GridInfoStore",LkIp.store.DefaultStore,{model:"LkIp.model.Rsb.CompliedReqs.GridInfo",url:"/rsb/compliedreqs/getCardInfo/{fidCard}"},0,0,0,0,0,0,[LkIp.store.Rsb.CompliedReqs,"GridInfoStore"],0));(Ext.cmd.derive("LkIp.model.Rsb.CompliedReqs.Grid",Ext.data.Model,{fields:["FIdTreb","KodNO","DataSved","DataSost","SrokUpl","ObschSumma","SummaNal","Peni","SHtrafyi","Protsentyi","NaimNO","KodOsnovanie","NaimOsnovanie","NomerTreb","DataTreb"]},0,0,0,0,0,0,[LkIp.model.Rsb.CompliedReqs,"Grid"],0));(Ext.cmd.derive("LkIp.store.Rsb.CompliedReqs.GridStore",LkIp.store.DefaultStore,{model:"LkIp.model.Rsb.CompliedReqs.Grid",url:"/rsb/compliedreqs/getInfo"},0,0,0,0,0,0,[LkIp.store.Rsb.CompliedReqs,"GridStore"],0));(Ext.cmd.derive("LkIp.controller.Rsb.CompliedReqs",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"rsbCompliedReqs"},{ref:"gridReqs",selector:"rsbCompliedReqsGrid"},{ref:"filterPanel",selector:"#rsbCompliedReqsFilterPanel"}],models:["Rsb.CompliedReqs.Grid","Rsb.CompliedReqs.GridInfo"],cache:false,getReqsStore:function(){return this.getStore("Rsb.CompliedReqs.GridStore")},getReqInfoStore:function(){return this.getStore("Rsb.CompliedReqs.GridInfoStore")},init:function(){this.getReqsStore().on({beforeload:{fn:this.beforeloadReqsGrid,scope:this},load:{fn:this.loadReqsGrid,scope:this}});this.getReqInfoStore().on({beforeload:{fn:this.beforeloadReqInfoGrid,scope:this},load:{fn:this.loadReqInfoGrid,scope:this}});this.control({rsbCompliedReqs:{activate:function(){},deactivate:function(){}},'rsbCompliedReqs [rel="apply"]':{applyFilters:this.applyFiltersAction},'rsbCompliedReqs [rel="reset"]':{resetFilters:this.resetFiltersAction},"#rsbCompliedReqsFilterPanel":{expand:this.expandFilterPanel},rsbCompliedReqsGrid:{getFile:this.getFileAction,selectionchange:this.selectionChangeAction},'rsbCompliedReqs [name="rsbCompliedReqsChooseButton"]':{click:this.pushGridButtonAction}});this.callParent()},loadIndex:function(){var a=this;a.callParent();if(false===a.cache){a.noStore=Ext.getStore("rsbCompliedReqsNoStore");a.cache=true}a.loadFirstPage()},loadFirstPage:function(a){this.getReqsStore().loadPage(1,{params:Ext.isObject(a)?a:{}})},beforeloadReqsGrid:function(a){var b=this;b.applySelectedFilters();b.resetInfoGrid();if(a.sorters.getCount()>0&&a.sorters.first().property.indexOf("@")==-1){a.sorters.first().property="@"+a.sorters.first().property}b.getReqsStore().extraParams=b.getFiltersParams(true)},loadReqsGrid:function(){},loadFilters:function(){var a=this;a.getFilterPanel().setLoading(true);LkIp.Request.request({url:"/api/rsb/compliedreqs/getFilters",params:LkIp.Utils.checkForInspectorNo(),scope:this},function(b){a.getFilterPanel().setLoading(false);a.noStore.loadData(b.response.no);a.filtersLoaded=true})},getFileAction:function(){var a=this;LkIp.Utils.downloadDocument("rsbcompliedReqs","/api/rsb/compliedreqs/getFile",a.getFiltersParams(true))},selectionChangeAction:function(c,a){if(a.length){Ext.suspendLayouts();var b=this;b.resetInfoGrid();b.getIndex().down('[name="rsbCompliedReqsChooseButton"]').enable();b.fidCard=a[0].get("FIdTreb");Ext.resumeLayouts(true)}},resetInfoGrid:function(){var b=this,a=b.getIndex();a.down("#requirementContainer").hide();b.getReqInfoStore().removeAll();a.down('[name="rsbCompliedReqsChooseButton"]').disable();LkIp.Utils.hideDomMask()},pushGridButtonAction:function(b){Ext.suspendLayouts();var c=this,a=c.getIndex().down("#requirementContainer");a.show();LkIp.Utils.scrollTo(a);c.loadReqInfoFirstPage();Ext.resumeLayouts(true)},loadReqInfoFirstPage:function(a){this.getReqInfoStore().loadPage(1,{params:Ext.isObject(a)?a:{}})},beforeloadReqInfoGrid:function(a){var b=this;a.removeAll();b.getReqInfoStore().extraParams={fidCard:b.fidCard}},loadReqInfoGrid:function(){}},0,0,0,0,0,[["filters",LkIp.mixins.Filters]],[LkIp.controller.Rsb,"CompliedReqs"],0));(Ext.cmd.derive("LkIp.controller.StateRegistration",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"#stateRegistration"},{ref:"formPanel",selector:"#stateRegistration-form"}],models:[],init:function(){this.control({"#stateRegistration":{activate:function(){var a=this.getFormPanel();a.getForm().reset();a.down('[name="stateRegistrationMessage"]').setRawValue("");a.down('[name="signButton"]').disable()}},'#stateRegistration [name="signButton"]':{click:this.submitFormAction},'#stateRegistration [name="stateRegistrationMessage"]':{change:this.chooseFileToUpload}});this.callParent()},loadIndex:function(){this.callParent()},submitFormAction:function(){var b=this,a=b.getFormPanel(),c=a.getValues();c.support=1;c.unique=1;b.getIndex().setLoading(true);LkIp.Request.formSubmit(a,{url:"/web/file/upload",params:c,scope:b,success:b.formSubmitSuccess,failure:b.formSubmitFailure})},formSubmitSuccess:function(e,b){var d=this,a=d.getFormPanel(),c=b.result.response[0];c=-1!=c.indexOf("fakepath")?c.replace("C:\\fakepath\\",""):c;a.down('[name="filename"]').setValue(b.result.response[0]);LkIp.Request.request({url:"api/state/registration/send",scope:d,params:a.getValues(),method:"POST"},function(f){d.getIndex().setLoading(false);if(false!==f&&!(Ext.isEmpty(f.response))){if(0!==f.status){d.resetFileForm();LkIp.app.fireEvent("clearCache");LkIp.Msg.success(reference.lang.signature.successDefault)}else{LkIp.Msg.error(f.response)}}else{LkIp.Msg.error(reference.lang.errors.serverError)}})},resetFileForm:function(){var b=this,a=b.getFormPanel();a.getForm().reset();a.down('[name="stateRegistrationMessage"]').setRawValue();a.down('[name="signButton"]').disable()},formSubmitFailure:function(a,b){this.getIndex().setLoading(false);LkIp.Msg.error(b.result.response)},chooseFileToUpload:function(b,c){var a=this.getFormPanel(),d=c.replace("C:\\fakepath\\","");b.setRawValue(d);a.down('[name="signButton"]').setDisabled(!b.isValid())}},0,0,0,0,0,0,[LkIp.controller,"StateRegistration"],0));(Ext.cmd.derive("LkIp.controller.Information.Service",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"informationService"}],models:[],cache:false,init:function(){this.callParent()},loadIndex:function(){this.callParent()}},0,0,0,0,0,0,[LkIp.controller.Information,"Service"],0));(Ext.cmd.derive("LkIp.mixins.Information.Service",Ext.Base,{pageType:"",filtersData:{},headData:{},findPageInfoByUrl:function(){var a=this;switch(a.getCurrentPageUrl()){case"#!/information/service/paymentsStatus":a.pageType=43;break;case"#!/information/service/obligation":a.pageType=55;break;case"#!/information/service/accounting":a.pageType=102;break;case"#!/information/service/operations":a.pageType=101;break;case"#!/rsb/reconciliation/statement":a.pageType=67;break;case"#!/information/service/reconciliation":default:a.pageType=0;break}},activateAction:function(){var a=this;a.findPageInfoByUrl();a.getHeadData()},loadFilters:function(a,c){var b=this;a=a||0;c=c||0;if(0!==a){b.getIndex().setLoading(true);LkIp.Request.request({url:"/api/rsb/cards/getFilters",params:{date:a,codeNO:c}},function(d){if(false!==d&&!Ext.isEmpty(d.response)){if(typeof b.noStore!="undefined"&&!Ext.isEmpty(d.response.no)){Ext.Array.erase(d.response.no,0,1);b.noStore.loadData(d.response.no)}if(0!=c){if(typeof b.kbkStore!="undefined"&&!Ext.isEmpty(d.response.kbk)){b.kbkStore.loadData(d.response.kbk)}if(typeof b.typeTaxStore!="undefined"&&!Ext.isEmpty(d.response.typeTax)){b.typeTaxStore.loadData(d.response.typeTax)}if(typeof b.statusIPStore!="undefined"&&!Ext.isEmpty(d.response.statusIP)){b.statusIPStore.loadData(d.response.statusIP)}b.filtersLoaded=true}}b.getIndex().setLoading(false)})}},getHeadData:function(){var a=this;a.headData=LkIp.User.get("head");if(Ext.isEmpty(a.headData)){LkIp.Msg.error(reference.lang.informationService.errors.nullHead);LkIp.Utils.goTo(Ext.isEmpty(a.backUrl)?"#!/information/service":a.backUrl);return false}},getYear:function(a){return a.slice(-4)},pushPdf:function(a){a.method="POST";LkIp.Utils.downloadDocument("informationServicePdf","/api/information/service/generatePdf/"+this.pageType+"/"+a.codeNO,a)},pushXml:function(a){var b=this;b.getIndex().setLoading(true);LkIp.Request.request({url:"/api/information/service/generateXml/"+b.pageType+"/"+a.codeNO,method:"POST",params:a},function(c){b.getController("Viewport").signAction(c,{loader:b.getIndex(),successCallback:function(){b.deactivateAction();LkIp.Msg.success(reference.lang.signature.successDefault,{rewriteDefaultButtons:true,buttons:[{text:reference.lang.buttons.close,handler:function(){LkIp.Msg.fireEvent("closemessagebox",LkIp.Msg);LkIp.Msg.close()}}]})}})})}},0,0,0,0,0,0,[LkIp.mixins.Information,"Service"],0));(Ext.cmd.derive("LkIp.mixins.Information.StatementWithoutGrid",Ext.Base,{changeDateAction:function(a){var b=this;b.resetFirstStep();b.loadFilters(a.getSendValue())},resetFirstStep:function(){var a=this,b=a.getIndex().down('[name="codeNO"]');if(!Ext.isEmpty(b)){b.reset()}a.getIndex().down('[name="ISSignButton"]').disable();a.getIndex().down('[name="ISShowButton"]').disable()},deactivateAction:function(){var a=this},pushShowButtonAction:function(){var a=this;a.pushPdf(a.getIndex().getForm().getValues())},pushSignButtonAction:function(){var a=this;a.pushXml(a.getIndex().getForm().getValues())}},0,0,0,0,0,0,[LkIp.mixins.Information,"StatementWithoutGrid"],0));(Ext.cmd.derive("LkIp.controller.Information.Service.PaymentsStatus",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"ISPaymentsStatus"}],models:[],cache:false,init:function(){this.control({ISPaymentsStatus:{activate:this.activateAction,deactivate:this.deactivateAction},'ISPaymentsStatus [name="date"]':{change:this.changeDateAction},'ISPaymentsStatus [name="ISShowButton"]':{click:this.pushShowButtonAction},'ISPaymentsStatus [name="ISSignButton"]':{click:this.pushSignButtonAction}});this.callParent()},loadIndex:function(){var a=this;a.callParent();a.noStore=Ext.getStore("ISPaymentsStatusNoStore");a.headDataAfterLoad()},headDataAfterLoad:function(){var b=this,a=b.getIndex().down('[name="date"]');a.setMinValue(LkIp.Utils.getDate(b.headData.SvedUchet["@DataPostMJ"]));a.setValue(LkIp.Utils.getNowDate())}},0,0,0,0,0,[["ISInfo",LkIp.mixins.Information.Service],["withoutGridService",LkIp.mixins.Information.StatementWithoutGrid]],[LkIp.controller.Information.Service,"PaymentsStatus"],0));(Ext.cmd.derive("LkIp.controller.Information.Service.Obligation",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"ISObligation"}],models:[],cache:false,init:function(){this.control({ISObligation:{activate:this.activateAction,deactivate:this.deactivateAction},'ISObligation [name="ISShowButton"]':{click:this.pushShowButtonAction},'ISObligation [name="ISSignButton"]':{click:this.pushSignButtonAction}});this.callParent()},loadIndex:function(){var a=this;a.callParent();a.headDataAfterLoad()},headDataAfterLoad:function(){var b=this,a=b.getIndex().down('[name="date"]'),c=b.getIndex().down('[name="codeNO"]');a.setMinValue(LkIp.Utils.getDate(b.headData.SvedUchet["@DataPostMJ"]));c.setValue(b.headData.SvedUchet["@KodNalOrg"]+"-"+b.headData.SvedUchet["@ImyaNalOrg"]);a.setValue(LkIp.Utils.getNowDate())},pushShowButtonAction:function(){var b=this,a=b.getIndex().getForm().getValues();if(!Ext.isEmpty(a.codeNO)&&a.codeNO.length>4){a.codeNO=a.codeNO.substring(0,4);if(Ext.isEmpty(a.codeNO)||0==a.codeNO){return false}}b.pushPdf(a)},pushSignButtonAction:function(){var b=this,a=b.getIndex().getForm().getValues();if(!Ext.isEmpty(a.codeNO)&&a.codeNO.length>4){a.codeNO=a.codeNO.substring(0,4);if(Ext.isEmpty(a.codeNO)||0==a.codeNO){return false}}b.pushXml(a)}},0,0,0,0,0,[["ISInfo",LkIp.mixins.Information.Service],["withoutGridService",LkIp.mixins.Information.StatementWithoutGrid]],[LkIp.controller.Information.Service,"Obligation"],0));(Ext.cmd.derive("LkIp.controller.Information.Service.Accounting",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"ISAccounting"}],models:[],cache:false,init:function(){this.control({ISAccounting:{activate:this.activateAction,deactivate:this.deactivateAction},'ISAccounting [name="dateStart"]':{change:this.changeStartDateAction},'ISAccounting [name="dateEnd"]':{change:this.changeEndDateAction},'ISAccounting [name="ISShowButton"]':{click:this.pushShowButtonAction},'ISAccounting [name="ISSignButton"]':{click:this.pushSignButtonAction}});this.callParent()},loadIndex:function(){var a=this;a.callParent();a.noStore=Ext.getStore("ISAccountingNoStore");a.headDataAfterLoad()},headDataAfterLoad:function(){var b=this,c=b.getIndex().down('[name="dateStart"]'),d=b.getIndex().down('[name="dateEnd"]'),a=Ext.Date.format(new Date(),"Y");c.setMinValue(LkIp.Utils.getDate(b.headData.SvedUchet["@DataPostMJ"]));c.setValue(b.getStartDate("01.01."+a));d.setMinValue(LkIp.Utils.getDate(b.headData.SvedUchet["@DataPostMJ"]))},changeStartDateAction:function(e){var f=this,d=f.getIndex().down('[name="dateEnd"]'),c=d.getSendValue(),b=f.getYear(c),a=f.getYear(e.getSendValue()),g=e.getValue(),h=d.getValue();if(b!=a||g>h){d.setValue(f.getEndDate("31.12."+a))}},changeEndDateAction:function(c){var d=this,e=d.getIndex().down('[name="dateStart"]'),g=e.getSendValue(),a=d.getYear(g),b=d.getYear(c.getSendValue()),h=c.getValue(),f=e.getValue();if(b!=a||h<f){e.setValue(d.getStartDate("01.01."+b))}d.changeDateAction(c)},getStartDate:function(b){var a=this,d=LkIp.Utils.getDateObject(a.headData.SvedUchet["@DataPostMJ"]),c=LkIp.Utils.getDateObject(b);if(c<d){b=LkIp.Utils.getDate(a.headData.SvedUchet["@DataPostMJ"])}return b},getEndDate:function(a){var c=LkIp.Utils.getDateObject(LkIp.Utils.getNowDate()),b=LkIp.Utils.getDateObject(a);if(b>c){a=LkIp.Utils.getNowDate()}return a}},0,0,0,0,0,[["ISInfo",LkIp.mixins.Information.Service],["withoutGridService",LkIp.mixins.Information.StatementWithoutGrid]],[LkIp.controller.Information.Service,"Accounting"],0));(Ext.cmd.derive("LkIp.store.Information.Service.Reconciliation.GridStore",LkIp.store.Rsb.Cards.GridStore,{},0,0,0,0,0,0,[LkIp.store.Information.Service.Reconciliation,"GridStore"],0));(Ext.cmd.derive("LkIp.mixins.Information.StatementWithGrid",Ext.Base,{selection:[],scrollDuration:{duration:800},chooseAll:false,changeDateAction:function(a){var b=this;b.resetFirstStep();b.loadFilters(a.getSendValue())},resetFirstStep:function(){var a=this;Ext.suspendLayouts();a.getIndex().down('[name="codeNO"]').reset();a.getIndex().down('[name="ISSignButton"]').disable();a.getIndex().down('[name="ISShowButton"]').disable();a.getIndex().down("#ISChooseCardsStep").show();a.getIndex().down("#ISChosenCardsStep").show();a.getIndex().down("#ISGridConditionStep").hide();a.getIndex().down("#ISChoosenAllCards").hide();a.reloadStores();a.removeAllSelection();LkIp.Utils.hideDomMask();Ext.resumeLayouts(true)},changeNoAction:function(b){var c=this,a=c.getIndex().down('[name="date"]').getSendValue();if(!LkIp.Utils.isEmpty(b.getValue())){Ext.suspendLayouts();c.showGridConditionStep();c.filtersLoaded=false;c.resetFiltersAction();if(!c.getFilterPanel().getCollapsed()){c.loadFilters(a,b.getValue())}LkIp.Utils.scrollTo(c.getIndex().down("#ISTextHelp"),c.scrollDuration);Ext.resumeLayouts(true)}},reloadStores:function(){this.getMainStore().removeAll();this.subGridStore.removeAll()},expandFilterPanel:function(){if(!this.filtersLoaded){this.loadFilters(this.getIndex().down('[name="date"]').getSendValue(),this.getIndex().down('[name="codeNO"]').getValue())}},showGridConditionStep:function(){var a=this;a.getIndex().down("#ISGridConditionStep").show();a.getIndex().down("#ISChoosenAllCards").hide()},beforeloadAction:function(){var a=this;a.applySelectedFilters();a.reloadChooseButtons();a.getMainStore().extraParams=Ext.Object.merge(a.getFiltersParams(true),{date:a.getIndex().down('[name="date"]').getSendValue(),codeNO:a.getIndex().down('[name="codeNO"]').getValue()})},loadAction:function(b){var d=this,a,c=d.subGridStore.getRange();if(b.getCount()>0&&c.length>0){Ext.Array.each(c,function(e){a=b.findRecord("@FIdKRSB",e.get("@FIdKRSB"));if(!Ext.isEmpty(a)){d.getMainGrid().getSelectionModel().select(a);a.set("selected",1)}});d.getMainGrid().getView().refresh();d.getIndex().down('[name="ISRemoveAllButton"]').enable();d.getIndex().down('[name="ISChooseOneButton"]').disable()}},reloadChooseButtons:function(){var a=this;Ext.suspendLayouts();a.getIndex().down('[name="ISChooseAllButton"]').enable();a.getIndex().down('[name="ISChooseOneButton"]').disable();a.getIndex().down('[name="ISRemoveOneButton"]').disable();a.getIndex().down('[name="ISRemoveAllButton"]').disable();Ext.resumeLayouts(true)},loadFirstPage:function(a){this.getMainStore().loadPage(1,{params:Ext.isObject(a)?a:{}})},removeAllSelection:function(){Ext.suspendLayouts();var a=this;a.deselectMainGrid();a.subGridStore.removeAll();a.getSubGrid().getView().refresh();a.markHiddenFieldInValid();Ext.resumeLayouts(true)},chooseAllAction:function(){var a=this;Ext.suspendLayouts();a.removeAllSelection();a.reloadChooseButtons();a.getIndex().down('[name="ISChooseAllButton"]').disable();a.getIndex().down('[name="ISRemoveAllButton"]').enable();a.getIndex().down("#ISChooseCardsStep").hide();a.getIndex().down("#ISChosenCardsStep").hide();a.getIndex().down("#ISChoosenAllCards").show();a.markHiddenFieldValid();LkIp.Utils.scrollTo(a.getIndex().down("#ISActionButtons"),a.scrollDuration);a.chooseAll=true;Ext.resumeLayouts(true)},removeAllAction:function(){var a=this;Ext.suspendLayouts();a.removeAllSelection();a.reloadChooseButtons();a.getIndex().down("#ISChooseCardsStep").show();a.getIndex().down("#ISChosenCardsStep").show();a.getIndex().down("#ISChoosenAllCards").hide();a.markHiddenFieldInValid();LkIp.Utils.scrollTo(a.getIndex().down("#ISTextHelp"),a.scrollDuration);a.chooseAll=false;Ext.resumeLayouts(true)},deselectMainGrid:function(){Ext.suspendLayouts();var b=this,a=b.getMainGrid().getSelectionModel().getSelection();Ext.Array.each(a,function(c){c.set("selected",0)});b.selection=[];b.getMainGrid().getView().refresh();b.getMainGrid().getSelectionModel().deselectAll();Ext.resumeLayouts(true)},markHiddenFieldValid:function(){this.getIndex().down("#checkChosenCards").setValue("true")},markHiddenFieldInValid:function(){this.getIndex().down("#checkChosenCards").setValue("")},chooseOneAction:function(){Ext.suspendLayouts();var b=this,a=b.getMainGrid().getSelectionModel().getSelection();Ext.Array.each(a,function(c){if(1!==c.get("selected")){c.set("selected",1);b.subGridStore.add(c)}});b.getSubGrid().getView().refresh();b.getMainGrid().getView().refresh();b.reloadChooseButtons();b.getIndex().down('[name="ISRemoveAllButton"]').enable();b.markHiddenFieldValid();Ext.resumeLayouts(true)},deselectOneCard:function(a){Ext.suspendLayouts();var c=this,b=c.getMainGrid().getSelectionModel().getSelection();Ext.Array.each(b,function(d){if(a===d.get("@FIdKRSB")){d.set("selected",0);c.getMainGrid().getSelectionModel().deselect(d)}});Ext.Array.each(c.selection,function(e,d){if(a===e["@FIdKRSB"]){Ext.Array.erase(c.selection,d,1)}});c.getMainGrid().getView().refresh();Ext.resumeLayouts(true)},removeOneAction:function(){Ext.suspendLayouts();var b=this,a=b.getSubGrid().getSelectionModel().getSelection();Ext.Array.each(a,function(c){if(1===c.get("selected")){b.deselectOneCard(c.get("@FIdKRSB"));b.subGridStore.remove(c)}});b.getSubGrid().getView().refresh();b.reloadChooseButtons();if(b.subGridStore.getCount()==0){b.markHiddenFieldInValid()}else{b.markHiddenFieldValid();b.getIndex().down('[name="ISRemoveAllButton"]').enable()}Ext.resumeLayouts(true)},deactivateAction:function(){Ext.suspendLayouts();var a=this;a.resetFirstStep();a.reloadStores();Ext.resumeLayouts()},pushShowButtonAction:function(){var b=this,a=b.getIndex().getForm().getValues(),c=[];if(!b.chooseAll){Ext.Array.each(b.subGridStore.getRange(),function(d){c.push(d.getData())});a.cards=Ext.JSON.encode(c)}else{a.checkAllCards=true}b.pushPdf(a)},pushSignButtonAction:function(){var b=this,a=b.getIndex().getForm().getValues(),c=[];if(!b.chooseAll){Ext.Array.each(b.subGridStore.getRange(),function(d){c.push(d.getData())});a.cards=Ext.JSON.encode(c)}else{a.checkAllCards=true}b.pushXml(a)}},0,0,0,0,0,0,[LkIp.mixins.Information,"StatementWithGrid"],0));(Ext.cmd.derive("LkIp.controller.Information.Service.Reconciliation",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"ISReconciliation"},{ref:"filterPanel",selector:"ISReconciliation #ISFilterPanel"},{ref:"mainGrid",selector:"ISReconciliation #ISMainGrid"},{ref:"subGrid",selector:"ISReconciliation #ISSubGrid"}],models:["Rsb.Cards.Grid"],cache:false,getMainStore:function(){return this.getStore("Information.Service.Reconciliation.GridStore")},init:function(){this.getMainStore().on({beforeload:{fn:this.beforeloadAction,scope:this},load:{fn:this.loadAction,scope:this}});this.control({ISReconciliation:{activate:this.activateAction,deactivate:this.deactivateAction},'ISReconciliation [name="date"]':{change:this.changeDateAction},'ISReconciliation [name="codeNO"]':{change:this.changeNoAction},'ISReconciliation [name="ISShowButton"]':{click:this.pushShowButtonAction},'ISReconciliation [name="ISSignButton"]':{click:this.pushSignButtonAction},"ISReconciliation #ISFilterPanel":{expand:this.expandFilterPanel},'ISReconciliation [rel="apply"]':{applyFilters:this.applyFiltersAction},'ISReconciliation [rel="reset"]':{resetFilters:this.resetFiltersAction},'ISReconciliation [name="ISChooseAllButton"]':{click:this.chooseAllAction},'ISReconciliation [name="ISRemoveAllButton"]':{click:this.removeAllAction},'ISReconciliation [name="ISChooseOneButton"]':{click:this.chooseOneAction},'ISReconciliation [name="ISRemoveOneButton"]':{click:this.removeOneAction}});this.callParent()},loadIndex:function(){var a=this;a.callParent();a.noStore=Ext.getStore("ISReconciliationNoStore");a.statusIPStore=Ext.getStore("ISReconciliationStatusIPStore");a.kbkStore=Ext.getStore("ISReconciliationKbkStore");a.subGridStore=Ext.getStore("ISReconciliationSubGridStore");a.headDataAfterLoad()},headDataAfterLoad:function(){var b=this,a=b.getIndex().down('[name="date"]');a.setMinValue(LkIp.Utils.getDate(b.headData.SvedUchet["@DataPostMJ"]));a.setValue(LkIp.Utils.getNowDate())},pushShowButtonAction:function(){var b=this,a=b.getIndex().getForm().getValues();b.pageType=a.statementType;b.mixins.gridService.pushShowButtonAction.call(this)},pushSignButtonAction:function(){var b=this,a=b.getIndex().getForm().getValues();b.pageType=a.statementType;b.mixins.gridService.pushSignButtonAction.call(this)}},0,0,0,0,0,[["ISInfo",LkIp.mixins.Information.Service],["gridService",LkIp.mixins.Information.StatementWithGrid],["filters",LkIp.mixins.Filters]],[LkIp.controller.Information.Service,"Reconciliation"],0));(Ext.cmd.derive("LkIp.store.Information.Service.Operations.GridStore",LkIp.store.Rsb.Cards.GridStore,{},0,0,0,0,0,0,[LkIp.store.Information.Service.Operations,"GridStore"],0));(Ext.cmd.derive("LkIp.controller.Information.Service.Operations",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"ISOperations"},{ref:"filterPanel",selector:"ISOperations #ISFilterPanel"},{ref:"mainGrid",selector:"ISOperations #ISMainGrid"},{ref:"subGrid",selector:"ISOperations #ISSubGrid"}],models:["Rsb.Cards.Grid"],cache:false,getMainStore:function(){return this.getStore("Information.Service.Operations.GridStore")},init:function(){this.getMainStore().on({beforeload:{fn:this.beforeloadAction,scope:this},load:{fn:this.loadAction,scope:this}});this.control({ISOperations:{activate:this.activateAction,deactivate:this.deactivateAction},'ISOperations [name="date"]':{change:this.changeDateAction},'ISOperations [name="codeNO"]':{change:this.changeNoAction},'ISOperations [name="ISShowButton"]':{click:this.pushShowButtonAction},'ISOperations [name="ISSignButton"]':{click:this.pushSignButtonAction},"ISOperations #ISFilterPanel":{expand:this.expandFilterPanel},'ISOperations [rel="apply"]':{applyFilters:this.applyFiltersAction},'ISOperations [rel="reset"]':{resetFilters:this.resetFiltersAction},'ISOperations [name="ISChooseAllButton"]':{click:this.chooseAllAction},'ISOperations [name="ISRemoveAllButton"]':{click:this.removeAllAction},'ISOperations [name="ISChooseOneButton"]':{click:this.chooseOneAction},'ISOperations [name="ISRemoveOneButton"]':{click:this.removeOneAction}});this.callParent()},loadIndex:function(){var a=this;a.callParent();a.noStore=Ext.getStore("ISOperationsNoStore");a.statusIPStore=Ext.getStore("ISOperationsStatusIPStore");a.kbkStore=Ext.getStore("ISOperationsKbkStore");a.subGridStore=Ext.getStore("ISOperationsSubGridStore");a.yearStore=Ext.getStore("ISReconciliationYearStore");a.headDataAfterLoad()},headDataAfterLoad:function(){var c=this,a=c.getIndex().down('[name="date"]'),b=Ext.Date.format(new Date(),"Y"),d=Ext.Date.format(LkIp.Utils.getDateObject(c.headData.SvedUchet["@DataPostMJ"]),"Y");c.yearStore.removeAll();c.yearStore.loadData(c.generateYearStore(b,d));a.setValue(b)},generateYearStore:function(c,d){var b=[],a;for(a=c;a>=d;a--){b.push({code:a,value:a})}return b}},0,0,0,0,0,[["ISInfo",LkIp.mixins.Information.Service],["gridService",LkIp.mixins.Information.StatementWithGrid],["filters",LkIp.mixins.Filters]],[LkIp.controller.Information.Service,"Operations"],0));(Ext.cmd.derive("LkIp.store.Rsb.Reconciliation.Statement.GridStore",LkIp.store.Rsb.Cards.GridStore,{},0,0,0,0,0,0,[LkIp.store.Rsb.Reconciliation.Statement,"GridStore"],0));(Ext.cmd.derive("LkIp.controller.Rsb.Reconciliation.Statement",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"rsbRStatement"},{ref:"filterPanel",selector:"rsbRStatement #ISFilterPanel"},{ref:"mainGrid",selector:"rsbRStatement #ISMainGrid"},{ref:"subGrid",selector:"rsbRStatement #ISSubGrid"}],models:["Rsb.Cards.Grid"],backUrl:"#!/index",cache:false,getMainStore:function(){return this.getStore("Rsb.Reconciliation.Statement.GridStore")},init:function(){this.getMainStore().on({beforeload:{fn:this.beforeloadAction,scope:this},load:{fn:this.loadAction,scope:this}});this.control({rsbRStatement:{activate:this.activateAction,deactivate:this.deactivateAction},'rsbRStatement [name="date"]':{change:this.changeDateAction},'rsbRStatement [name="codeNO"]':{change:this.changeNoAction},'rsbRStatement [name="ISShowButton"]':{click:this.pushShowButtonAction},'rsbRStatement [name="ISSignButton"]':{click:this.pushSignButtonAction},"rsbRStatement #ISFilterPanel":{expand:this.expandFilterPanel},'rsbRStatement [rel="apply"]':{applyFilters:this.applyFiltersAction},'rsbRStatement [rel="reset"]':{resetFilters:this.resetFiltersAction},'rsbRStatement [name="ISChooseAllButton"]':{click:this.chooseAllAction},'rsbRStatement [name="ISRemoveAllButton"]':{click:this.removeAllAction},'rsbRStatement [name="ISChooseOneButton"]':{click:this.chooseOneAction},'rsbRStatement [name="ISRemoveOneButton"]':{click:this.removeOneAction}});this.callParent()},loadIndex:function(){var a=this;a.callParent();a.noStore=Ext.getStore("rsbRStatementNoStore");a.statusIPStore=Ext.getStore("rsbRStatementStatusIPStore");a.kbkStore=Ext.getStore("rsbRStatementKbkStore");a.subGridStore=Ext.getStore("rsbRStatementSubGridStore")},headDataAfterLoad:function(){var b=this,a=b.getIndex().down('[name="date"]');a.setValue(LkIp.Utils.getNowDate())},pushPdf:function(a){a.method="POST";LkIp.Utils.downloadDocument("reconciliationStatement","/api/rsb/reconciliation/generatePdf/67/"+a.codeNO,a)},pushXml:function(a){var b=this;b.getIndex().setLoading(true);LkIp.Request.request({url:"/api/rsb/reconciliation/generateXml/67/"+a.codeNO,method:"POST",params:a},function(c){b.getController("Viewport").signAction(c,{loader:b.getIndex(),successCallback:function(d){var e=d;LkIp.Msg.success(reference.lang.signature.successDefault,{rewriteDefaultButtons:true,buttons:[{text:reference.lang.buttons.close,handler:function(){Ext.suspendLayouts();LkIp.Utils.scrollTo(e.getViewport());e.getIndex().getForm().reset();if(typeof e.kbkStore!="undefined"){e.kbkStore.removeAll()}if(typeof e.typeTaxStore!="undefined"){e.typeTaxStore.removeAll()}if(typeof e.statusIPStore!="undefined"){e.statusIPStore.removeAll()}e.resetFirstStep();e.reloadStores();e.getIndex().down('[name="date"]').setValue(LkIp.Utils.getNowDate());LkIp.Msg.fireEvent("closemessagebox",LkIp.Msg);LkIp.Msg.close();Ext.resumeLayouts(true)}}]})}})})}},0,0,0,0,0,[["ISInfo",LkIp.mixins.Information.Service],["gridService",LkIp.mixins.Information.StatementWithGrid],["filters",LkIp.mixins.Filters]],[LkIp.controller.Rsb.Reconciliation,"Statement"],0));(Ext.cmd.derive("LkIp.controller.Feedback",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"feedback"},{ref:"form",selector:"#feedbackForm"}],models:[],stopChange:false,cache:false,selectNoLoaded:false,chooseNoLoaded:false,filename:undefined,init:function(){this.control({feedback:{activate:function(){}},'feedback [name="selectNo"]':{change:this.changeSelectNo},'feedback [name="chooseNo"]':{change:this.changeChooseNo,blur:this.blur,keydown:this.keydown},'feedback [name="file"]':{change:this.fileUploadAction},'feedback [rel="submit"]':{click:this.submitFormAction},"feedback #postFieldset":{beforeexpand:function(){var a=this;if(a.regionsStore.count()==0){LkIp.Request.request({url:"/api/filters/getRegions",scope:this},function(c){if(!Ext.isEmpty(c.response)){a.regionsStore.loadData(c.response);var b=a.regionsStore.findRecord("code",LkIp.User.head.SvedFL.AdrRF["@KodRegion"]);if(!Ext.isEmpty(b)){a.getForm().down('[name="subjectRF"]').setValue(b.get("value"))}}})}},beforecollapse:function(){var b=this,a=b.getForm();a.down('[name="subjectRF"]').reset();a.down('[name="city"]').reset();a.down('[name="address"]').reset();a.down('[name="postCode"]').reset()}},"feedback #resetFile":{click:this.deleteFile}});this.callParent()},deletedByBackSpace:false,loadIndex:function(){var c=this,b=c.callParent(),a;c.selectNoStore=Ext.getStore("feedbackSelectNoStore");c.chooseNoStore=Ext.getStore("feedbackChooseNoStore");c.regionsStore=Ext.getStore("feedbackRegionsStore");if(false!=b&&!c.cache){a=c.getIndex();a.setLoading(true);LkIp.Request.request({url:"/api/egrn/getFilters",scope:this},function(d){if(!Ext.isEmpty(d.response[1])&&!Ext.isEmpty(d.response[1].no)){c.selectNoStore.loadData(d.response[1].no)}c.selectNoLoaded=true;c.checkLoader()});LkIp.Request.request({url:"/api/feedback/getNo",scope:this},function(d){if(!Ext.isEmpty(d.response)){c.chooseNoStore.loadData(d.response);if(typeof c.codeNo!="undefined"){c.stopChange=true;c.getForm().down('[name="chooseNo"]').setValue(c.codeNo);c.getForm().down('[name="selectNo"]').disable()}}c.chooseNoLoaded=true;c.checkLoader()})}},keydown:function(a,b){if(b.getKey()==b.BACKSPACE&&a.getValue().length==4){this.deletedByBackSpace=true}},blur:function(a){var b=this,c=a.getValue();if(LkIp.Utils.isEmpty(a.getValue())&&!b.deletedByBackSpace){LkIp.Msg.error(reference.lang.errors.feedback)}else{b.deletedByBackSpace=false}if(!Ext.isEmpty(c)&&-1==b.chooseNoStore.findExact("code",c)){a.reset()}},checkLoader:function(){var a=this;if(a.selectNoLoaded&&a.chooseNoLoaded){a.getIndex().setLoading(false);a.cache=true}},changeSelectNo:function(a,b){var c=this.getIndex().down('[name="chooseNo"]');if(!Ext.isEmpty(b)&&b!=0){c.disable()}else{c.enable()}},changeChooseNo:function(b,d){var c=this,a=c.getIndex().down('[name="selectNo"]');if(!c.stopChange){if(!Ext.isEmpty(d)&&!Ext.isEmpty(b.getRawValue())){a.disable()}else{a.enable();b.reset()}}else{c.stopChange=false}},fileUploadAction:function(b,e){var d=this,c=d.getForm(),a=d.getIndex();e=-1!=e.indexOf("fakepath")?e.replace("C:\\fakepath\\",""):e;if(!Ext.isEmpty(e)){d.deleteFileRequrst();b.setRawValue(e);a.setLoading(true);c.fireEvent("validitychange",c,false);LkIp.Request.formSubmit(c.down('[rel="fileUpload"]'),{url:"/web/file/upload",params:{feedback:1,support:1},scope:d,fileSubmit:true,success:function(g,f){a.setLoading(false);c.fireEvent("validitychange",c,c.isValid());c.down('[name="filename"]').setValue(f.result.response[0]);d.filename=f.result.response[0];a.down("#resetFile").enable();b.anchor="90%";a.doLayout();a.down("#resetFile").show()},failure:function(f,g){a.setLoading(false);c.fireEvent("validitychange",c,c.isValid());d.resetFileAction();LkIp.Msg.error(g.result.response)}})}},submitFormAction:function(a){var c=this,b=c.getForm(),d=c.getForm().getForm().getValues();if(d.subjectRF==0){d.subjectRF=""}if(b.isValid()){b.setLoading(true);LkIp.Request.request({url:"api/feedback/send",method:"POST",scope:this,params:d,dataType:"json"},function(e){b.setLoading(false);if(false!==e&&!(Ext.isEmpty(e.response))){if(0!==e.status){LkIp.app.fireEvent("clearCache");LkIp.Msg.success(reference.lang.feedback.success);b.down('[name="file"]').setRawValue("");c.resetFileAction()}else{LkIp.Msg.error(e.response)}}else{LkIp.Msg.error(reference.lang.errors.serverError)}})}else{a.disable()}},resetFileAction:function(){var e=this,c=e.getIndex(),b=c.down("#fileUpload"),d=e.getForm(),f=c.down("#file"),a=c.down("#resetFile");Ext.suspendLayouts();b.getForm().reset();f.setRawValue("");d.down('[name="filename"]').setValue();c.down("#resetFile").hide().disable();f.anchor="100%";a.hide().disable();Ext.resumeLayouts(true);c.doLayout();e.filename=undefined},deleteFile:function(){var a=this;a.deleteFileRequrst();a.resetFileAction()},deleteFileRequrst:function(){var a=this;if(!Ext.isEmpty(a.filename)){LkIp.Request.request({url:"api/feedback/delete-file",method:"POST",scope:a,params:{filename:a.filename}},function(b){})}}},0,0,0,0,0,0,[LkIp.controller,"Feedback"],0));(Ext.cmd.derive("LkIp.controller.Profile",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"profile"},{ref:"formPanel",selector:"#contactUserInfo-body"},{ref:"eventsNotify",selector:"#eventsNotifyTest"},{ref:"groupsNotify",selector:"#groupsNotifyTest"}],selectAll:false,subscriptions:null,stopAllSelect:false,loaded:false,cache:false,events:["doc.status","doc.answer"],groups:["egrip.docs","egrn.docs","rsb.adddocs","rsb.viewdocs","rsb.feedback","kkt"],subscriptionTtip:undefined,emailIsNotConfirmed:false,predefinedSubscriptions:{},init:function(){this.control({"profile #contactUserInfo-body #subscription-check":{change:this.changeGetInfo},'profile [type="all"]':{change:this.changeCheckAll},"profile #contactUserInfo-body #container-notify-settings checkboxgroup":{change:this.changeNotifySettings},'profile #contactUserInfo-body [rel="submit"]':{click:this.saveAction},'profile [rel="findZap"]':{findRow:this.findRecordsAction},'profile [rel="findSvid"]':{findRow:this.findRecordsAction},"profile #send-activation-email":{click:this.sendActivationEmailAction},'profile [name="email"]':{change:this.changeEmailAction},"profile [name=clickSetPassword]":{click:this.changePasswordAction},'profile [name="password"]':{change:this.resetRules}});this.callParent()},loadIndex:function(){var c=this,b=LkIp.FlashData.get("goTo"),a;c.callParent();a=c.getIndex();c.loadEgrip();c.updateSubscriptionsBlock();if(!LkIp.User.isEcrInspector()){c.updateContactData()}if(LkIp.User.isActiveUser()&&!Ext.isEmpty(b)){switch(b){case"accounting":a.down("#commonInfoTabs").setActiveTab("accountUserInfo-body");break;case"contact":a.down("#commonInfoTabs").setActiveTab("contactUserInfo-body");break}}},showConfirmEmailOptions:function(){var c=this,b=c.getIndex(),a=c.getFormPanel().getValues();c.emailIsNotConfirmed=true;c.predefinedSubscriptions=a;Ext.suspendLayouts();b.down('[name="email"]').setWidth(450);b.down("#emailConfirmation").show();b.down("#send-activation-email-el").show();b.down("#subscription-check").disable();b.down("#container-notify-settings").disable();Ext.resumeLayouts(true);c.subscriptionTtip=LkIp.Utils.tooltip(b.down("#subscription-check"),reference.lang.profile.subscriptionTtip)},loadEgrip:function(){var b=this,a=b.getIndex();if(false===b.cache){a.setLoading(true);LkIp.Request.request({url:"/api/egrip/get",method:"GET"},function(c){if(!Ext.isEmpty(c.response)&&Ext.isObject(c.response)){b.cache=c.response}else{a.setLoading(false);b.cache=false}b.showContent()})}else{b.showContent()}},updateSubscriptionsBlock:function(){var b=this,a=b.getIndex();if(!LkIp.User.isClosedUser()){if(!LkIp.User.isInspector()){b.setSubscriptions()}if(LkIp.User.isLoginUser()){if(Ext.isEmpty(LkIp.User.get("email"))||!LkIp.User.isEmailConfirmed()){a.down("#subscription-check").disable();b.subscriptionTtip=LkIp.Utils.tooltip(a.down("#subscription-check"),reference.lang.profile.subscriptionTtip,{anchor:"top"});if(!LkIp.User.isEmailConfirmed()){b.showConfirmEmailOptions()}}}}},updateContactData:function(){var b=this,a=b.getIndex(),c=!Ext.isEmpty(LkIp.User.get("head"))?LkIp.User.get("head")["SvedUchet"]:false;if(false!=c){a.down("#profile-inspections").update({code:c["@KodNalOrg"],name:c["@ImyaNalOrg"],adres:c["@AdresNalOrg"],phone:c["@TelNalOrg"]});if(!LkIp.User.isInspector()){a.down("#linkToFeedback").update({code:"?"+c["@KodNalOrg"]})}}a.down('[name="phone"]').setValue(LkIp.User.get("phone"))},getDefaultHead:function(){return{"@DataRojd":"",Address:"",UdLichn:{"@Naimenovanie":"","@SerNomDok":"","@DataDok":"","@NaimOrgVyidDok":""}}},showContent:function(){var c=this,a=typeof LkIp.User.get("head")["SvedFL"]=="undefined"?c.getDefaultHead():LkIp.User.get("head")["SvedFL"];if(Ext.getStore("commonInfoGrid").getCount()===0){Ext.getStore("commonInfoGrid").loadData([{key:reference.lang.egrip.info.columns.SvFL.fio,value:LkIp.User.get("fullName")},{key:reference.lang.egrip.info.columns.SvFL.birthday,value:LkIp.Utils.getDate(a["@DataRojd"])},{key:reference.lang.egrip.info.columns.SvFL.birthplace,value:!Ext.isEmpty(a.Address)?a.Address:"-"},{key:reference.lang.profile.userInfoBlock.document,value:!Ext.isEmpty(a.UdLichn["@Naimenovanie"])?a.UdLichn["@Naimenovanie"]:"-"},{key:reference.lang.profile.userInfoBlock.documentInfo,value:(!Ext.isEmpty(a.UdLichn["@SerNomDok"])?a.UdLichn["@SerNomDok"]:"-")+" "+(!Ext.isEmpty(a.UdLichn["@DataDok"])?LkIp.Utils.getDate(a.UdLichn["@DataDok"]):"")},{key:reference.lang.profile.userInfoBlock.documentGetFrom,value:!Ext.isEmpty(a.UdLichn["@NaimOrgVyidDok"])?a.UdLichn["@NaimOrgVyidDok"]:"-"}]);if(false!=c.cache){var b=[{key:reference.lang.egrip.info.columns.ogrn,value:c.cache.SvIp.ogrnIp}];if(!Ext.isEmpty(c.cache.SvIp.numberRegDate)){b.push({key:reference.lang.egrip.info.columns.regNumberDate,value:LkIp.Utils.getDate(c.cache.SvIp.numberRegDate)})}if(!Ext.isEmpty(c.cache.SvIp.numberReg)){b.push({key:reference.lang.egrip.info.columns.regNumber,value:c.cache.SvIp.numberReg})}b.push({key:reference.lang.egrip.info.columns.regDate,value:LkIp.Utils.getDate(c.cache.SvIp.dateEgrip)},{key:reference.lang.egrip.info.columns.regorgan,value:LkIp.Utils.noRenderer(c.cache.SvIp.regNoCode)+" - "+c.cache.SvIp.regNoNaim},{key:reference.lang.egrip.info.columns.status,value:c.cache.SvIp.status});if(!Ext.isEmpty(c.cache.SvIp.ceaseActivityStatus)){b.push({key:reference.lang.egrip.info.columns.ceaseActivityStatus,value:c.cache.SvIp.ceaseActivityStatus})}b.push({key:reference.lang.egrip.info.columns.inn,value:c.cache.SvIp.inn},{key:reference.lang.egrip.info.columns.noDate,value:LkIp.Utils.getDate(c.cache.SvIp.dataUchNo)},{key:reference.lang.egrip.info.columns.no,value:LkIp.Utils.noRenderer(c.cache.SvIp.codeNo)+" - "+c.cache.SvIp.naimNo},{key:reference.lang.egrip.info.columns.regNomPf,value:c.cache.SvIp.nomerPF},{key:reference.lang.egrip.info.columns.datePf,value:LkIp.Utils.getDate(c.cache.SvIp.dataPF)},{key:reference.lang.egrip.info.columns.namePf,value:c.cache.SvIp.naimPF});Ext.getStore("egripCommonInfo").loadData(b)}}if(false!=c.cache){if(!Ext.isEmpty(c.cache.SvOKVED)){Ext.getStore("egripInfoMainOkved").loadData(Ext.Array.filter(c.cache.SvOKVED,function(d){return d.type==="main"}));Ext.getStore("egripInfoSubOkved").loadData(Ext.Array.filter(c.cache.SvOKVED,function(d){return d.type==="sub"}))}if(!Ext.isEmpty(c.cache.SvZapEGRIP)){c.originalZapEgrip=c.cache.SvZapEGRIP;Ext.getStore("egripInfoRecord").loadData(c.cache.SvZapEGRIP)}if(!Ext.isEmpty(c.cache.SvSvid)){c.originalSvidEgrip=c.cache.SvSvid;Ext.getStore("egripInfoSvid").loadData(c.cache.SvSvid)}}c.getIndex().setLoading(false)},findRecordsAction:function(c){var b=this,f=b.getIndex().down('[name="'+c+'_from"]').getValue(),e=b.getIndex().down('[name="'+c+'_to"]').getValue(),a="egripDate"===c?Ext.getStore("egripInfoRecord"):Ext.getStore("egripInfoSvid"),d="egripDate"===c?b.originalZapEgrip:b.originalSvidEgrip;if(!Ext.isEmpty(f)&&!Ext.isEmpty(e)){a.loadData(Ext.Array.filter(d,function(h){var g=Ext.isIE8?LkIp.Utils.getDateObject(h.date):new Date(h.date);return !!(g>=f&&g<=e)}))}else{if(!Ext.isEmpty(f)&&Ext.isEmpty(e)){a.loadData(Ext.Array.filter(d,function(h){var g=Ext.isIE8?LkIp.Utils.getDateObject(h.date):new Date(h.date);return g>=f}))}else{if(Ext.isEmpty(f)&&!Ext.isEmpty(e)){a.loadData(Ext.Array.filter(d,function(h){var g=Ext.isIE8?LkIp.Utils.getDateObject(h.date):new Date(h.date);return g<=e}))}}}},setSubscriptions:function(){var a=this;if(null==a.subscriptions){a.subscriptions=LkIp.User.get("subscriptions")}if(!Ext.isEmpty(a.subscriptions.events)&&!Ext.isEmpty(a.subscriptions.groups)){a.getEventsNotify().down('[type="all"]').setValue(false);a.getGroupsNotify().down('[type="all"]').setValue(false);a.getIndex().down('[type="get-info-group"]').setValue({getInfo:1});if(!Ext.isEmpty(a.subscriptions.events)){if(a.events.length==a.subscriptions.events.length){a.getEventsNotify().down('[type="all"]').setValue(true)}else{Ext.Array.each(a.subscriptions.events,function(b){a.getEventsNotify().down('[name="'+b+'"]').setValue(true)})}}if(!Ext.isEmpty(a.subscriptions.groups)){if(a.groups.length==a.subscriptions.groups.length){a.getGroupsNotify().down('[type="all"]').setValue(true)}else{Ext.Array.each(a.subscriptions.groups,function(b){a.getGroupsNotify().down('[name="'+b+'"]').setValue(true)})}}}return true},changeGetInfo:function(b,d){var c=this,e=c.getGroupsNotify().down('[type="all"]'),a=c.getEventsNotify().down('[type="all"]');if(1==d.getInfo){c.getIndex().down("#container-notify-settings").show();if(Ext.Object.isEmpty(c.subscriptions)||(Ext.isEmpty(c.subscriptions.events)&&Ext.isEmpty(c.subscriptions.groups))){a.setValue(true);e.setValue(true)}}else{c.getIndex().down("#container-notify-settings").hide();c.subscriptions=null;e.fireEvent("change",e,false);a.fireEvent("change",a,false)}},changeCheckAll:function(a,d){var c=this,b="allEvents"==a.name?this.getEventsNotify().items.items:this.getGroupsNotify().items.items;if(c.stopAllSelect){c.stopAllSelect=false;return true}if(d){c.selectAll=true}Ext.Array.each(b,function(e){e.setValue(d)})},changeNotifySettings:function(d,g,c){var f=this,e=d.getChecked(),b,a=f.getIndex().down('[rel="submit"]');if(1==f.getIndex().down('[type="get-info-group"]').getValue().getInfo){if(0==e.length){a.disable()}else{a.enable()}}if(typeof g.allEvents!=="undefined"||typeof g.allGroups!=="undefined"){b=d.itemId=="eventsNotifyTest"?f.events.length+1:f.groups.length+1;if(e.length!=b&&!f.selectAll){f.stopAllSelect=true;d.down('[type="all"]').setValue(false)}else{if(e.length==b&&f.selectAll){f.selectAll=false}}}else{b=d.itemId=="eventsNotify"?f.events.length:f.groups.length;if((Ext.Object.getSize(c)<Ext.Object.getSize(g))&&e.length==b){f.stopAllSelect=true;d.down('[type="all"]').setValue(true)}}},saveAction:function(){var d=this,e=d.getFormPanel().getValues(),c=d.prepareSubscriptions(d.emailIsNotConfirmed?d.predefinedSubscriptions:e),a=LkIp.User.get("subscriptions"),f={},b=false;if((!Ext.isEmpty(a)&&(!Ext.Array.equals(c.events,a.events)||!Ext.Array.equals(c.groups,a.groups)))||(Ext.isEmpty(a)&&(!Ext.isEmpty(c.events)||!Ext.isEmpty(c.groups)))){f.subscriptions=Ext.JSON.encode(c)}if(e.email!==LkIp.User.get("email")){f.email=e.email}if(e.phone!==LkIp.User.get("phone")){f.phone=e.phone}if(e.address!==LkIp.User.get("address")){f.address=e.address}if(Ext.Object.isEmpty(f)){LkIp.Msg.error("\u0412\u0432\u0435\u0434\u0435\u043d\u043d\u044b\u0435 \u0412\u0430\u043c\u0438 \u0434\u0430\u043d\u043d\u044b\u0435 \u043d\u0435 \u0438\u0437\u043c\u0435\u043d\u0438\u043b\u0438\u0441\u044c.");return false}d.getIndex().setLoading(true);LkIp.Request.request({url:"/api/userinfo/update/updateUserInformation",scope:d,params:f,method:"POST"},function(h){d.getIndex().setLoading(false);if(false!==h&&0!==h.status){if(!Ext.isEmpty(f.email)){var g={};if(LkIp.User.isCertUser()){g={rewriteDefaultButtons:true,buttons:[{text:reference.lang.buttons.ok,handler:function(){LkIp.Request.request({url:"/api/auth/logout",scope:this,params:{t:1},method:"POST"},function(){LkIp.Msg.fireEvent("closemessagebox",LkIp.Msg);LkIp.Msg.close();window.location="/lk"})}}]}}LkIp.Msg.success(reference.lang.profile.success.updateEmail,g);d.showConfirmEmailOptions()}else{LkIp.Msg.success(reference.lang.profile.success.update)}Ext.Object.each(f,function(i,j){if("subscriptions"===i){j=c}LkIp.User.set(i,j)})}else{LkIp.Msg.error(reference.lang.profile.errors.cantUpdate)}})},prepareSubscriptions:function(c){var b=this,a={events:[],groups:[]};Ext.Object.each(c,function(d){if(Ext.Array.contains(b.events,d)){a.events.push(d)}if(Ext.Array.contains(b.groups,d)){a.groups.push(d)}});Ext.Array.sort(a.events);Ext.Array.sort(a.groups);return a},sendActivationEmailAction:function(){var a=this;a.getIndex().setLoading(true);LkIp.Request.request({url:"/api/user/sendActivationEmail",params:{t:1},method:"POST"},function(b){a.getIndex().setLoading(false);if(LkIp.Utils.isJsonSuccess(b)){LkIp.Msg.success(Ext.String.format(reference.lang.profile.activation.success,LkIp.User.get("email")))}else{LkIp.Msg.error(typeof b.response!="undefined"?b.response:reference.lang.profile.activation.error)}})},changeEmailAction:function(a,c){var b=this;if(b.emailIsNotConfirmed){if(c!=LkIp.User.get("email")){b.getIndex().down("#send-activation-email-el").hide()}else{b.getIndex().down("#send-activation-email-el").show()}}},changePasswordAction:function(){var b=this,a=b.getIndex().down("#accountUserInfo-body").getForm(),c=a.getValues();b.getIndex().setLoading(true);LkIp.Request.request({url:"/api/user/updatePassword",scope:b,params:c,method:"POST"},function(d){b.getIndex().setLoading(false);a.reset();if(false!==d&&1===d.status){LkIp.Msg.success(reference.lang.profile.password.success)}else{LkIp.Msg.error(reference.lang.profile.errors.cantUpdate)}})},resetRules:function(b,a){if(a===""){Ext.form.field.VTypes.passwordLetters(a,b)}}},0,0,0,0,0,0,[LkIp.controller,"Profile"],0));(Ext.cmd.derive("LkIp.controller.Deactivate",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"deactivate"}],init:function(){this.control({'deactivate [name="deactivateUser"]':{click:this.deactivateAction}});this.callParent()},loadIndex:function(){var a=this;a.callParent()},deactivateAction:function(){var a=this;LkIp.Msg.info(reference.lang.profile.deactivate.areYouSure,{rewriteDefaultButtons:true,buttons:[{text:reference.lang.buttons.yes,handler:function(){a.deactivate();LkIp.Msg.fireEvent("closemessagebox",LkIp.Msg);LkIp.Msg.close();a.getViewport().setLoading(true)}},{text:reference.lang.buttons.no,handler:function(){LkIp.Msg.fireEvent("closemessagebox",LkIp.Msg);LkIp.Msg.close()}}]})},deactivate:function(){var a=this;LkIp.Request.request({url:"/api/user/register/deactivate",method:"POST",scope:a},function(b){a.getViewport().setLoading(false);if(false!==b){if(0!==parseInt(b.status)){LkIp.Msg.success(reference.lang.profile.deactivate.msg.deactivationSuccess,{rewriteDefaultButtons:true,buttons:[{text:reference.lang.buttons.ok,handler:function(){a.afterDeactivate();LkIp.Msg.fireEvent("closemessagebox",LkIp.Msg);LkIp.Msg.close()}}]})}else{LkIp.Msg.error(b.response)}}else{LkIp.Msg.error(reference.lang.profile.deactivate.msg.server)}})},afterDeactivate:function(){this.getController("Viewport").logoutAction();window.location="/"}},0,0,0,0,0,0,[LkIp.controller,"Deactivate"],0));(Ext.cmd.derive("LkIp.controller.StatementList",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"statementList"}],loadIndex:function(){var a=this,c=LkIp.FlashData.get("gotToTaxSystems"),b;a.callParent();if(!Ext.isEmpty(c)){b=a.getIndex().down("#servicesList");LkIp.Utils.scrollTo(b,{duration:0});b.setActiveTab(3)}}},0,0,0,0,0,0,[LkIp.controller,"StatementList"],0));(Ext.cmd.derive("LkIp.controller.ServicesList",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"servicesList"}]},0,0,0,0,0,0,[LkIp.controller,"ServicesList"],0));(Ext.cmd.derive("LkIp.model.DeskAudit.Grid",Ext.data.Model,{fields:["@KodNalOrg","@NaimNalOrg","@DataPostNO","@DataOtpr","@SposOtpr","@SvedDokNalPer","@SvedDokOtchGod","@SvedDokNomKorr","@SvedDokKND","@SvedDokKNDNaim","@SvedProvDataOkKP","@SvedProvDataPrekrKP","@SvedProvNarushVyiyavl","@SposobOtprNaim"]},0,0,0,0,0,0,[LkIp.model.DeskAudit,"Grid"],0));(Ext.cmd.derive("LkIp.store.DeskAudit.GridStore",LkIp.store.DefaultStore,{model:"LkIp.model.DeskAudit.Grid",url:"/knp/getInfo"},0,0,0,0,0,0,[LkIp.store.DeskAudit,"GridStore"],0));(Ext.cmd.derive("LkIp.controller.DeskAudit",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"deskAudit"},{ref:"grid",selector:"#deskAuditGrid"},{ref:"filterPanel",selector:"#deskAuditFilterPanel"}],models:["DeskAudit.Grid"],cache:false,knp_type:1,firstLoad:true,filtersLoaded:false,filtersParams:{1:{},2:{}},defaultFiltersResult:[],gridIndicatorColumn:undefined,gridCheckInfoColumn:undefined,getDeskAuditStore:function(){return this.getStore("DeskAudit.GridStore")},init:function(){this.getDeskAuditStore().on({beforeload:{fn:this.beforeloadGrid,scope:this},load:{fn:this.loadGrid,scope:this}});this.control({'#statusBarTabsDeskAudit [type="status-bar-tab"]':{activate:this.activateStatusTab},'deskAudit [rel="apply"]':{applyFilters:this.applyFiltersAction},'deskAudit [rel="reset"]':{resetFilters:this.resetFiltersAction},"#deskAuditFilterPanel":{expand:this.expandFilterPanel},'#deskAuditFilterPanel [name="codeNO"]':{change:this.changeNo}});this.callParent()},loadIndex:function(){var a=this;a.callParent();if(false===a.cache){a.noStore=Ext.getStore("deskAuditCodeNoStore");a.yearStore=Ext.getStore("deskAuditYearStore");a.knpStore=Ext.getStore("deskAuditKnpStore");a.cache=true;a.firstLoad=false;a.loadFirstPage()}},loadFirstPage:function(a){this.getDeskAuditStore().loadPage(1,{params:Ext.isObject(a)?a:{}})},getFiltersParams:function(b){b=b||false;var c=Ext.Object.merge(this.filtersParams[this.knp_type],{type:this.knp_type});if(b){var a={};Ext.Object.each(c,function(d,e){if(!LkIp.Utils.isFilterEmpty(e)){a[d]=e}});return a}return c},beforeloadGrid:function(){var a=this;a.applySelectedFilters();a.getDeskAuditStore().extraParams=this.getFiltersParams(true)},applySelectedFilters:function(){var b=this,a=b.getFiltersParams();Ext.suspendLayouts();if(Ext.Object.getSize(a)>1){Ext.Object.each(a,function(c,d){if(c==="type"){return}if(!LkIp.Utils.isFilterEmpty(d)){b.getFilterPanel().down('[name="'+c+'"]').setValue(d)}else{b.getFilterPanel().down('[name="'+c+'"]').reset()}})}else{if(typeof b.getFilterPanel()!="undefined"){b.getFilterPanel().getForm().reset()}}Ext.resumeLayouts(true)},loadGrid:function(a){},activateStatusTab:function(a){Ext.suspendLayouts();switch(a.id){case"tab-all-finished":this.knp_type=2;break;case"tab-not-all-finished":default:this.knp_type=1;break}this.toggleElements();Ext.resumeLayouts(true);if(this.filtersLoaded){if(!LkIp.User.isInspectorWithCodeNO()){this.loadNo()}this.loadYear();this.loadKnp()}if(!this.firstLoad){this.getDeskAuditStore().removeAll();this.loadFirstPage()}},toggleElements:function(){var a=this;a.gridIndicatorColumn=Ext.getCmp("indicatorColumn");a.gridCheckInfoColumn=Ext.getCmp("checkInfoColumn");a.checkInfoDateStopColumn=Ext.getCmp("checkInfo-dateStopColumn");a.checkInfoDateTerminateColumn=Ext.getCmp("checkInfo-dateTerminateColumn");Ext.suspendLayouts();if(1===a.knp_type){a.gridIndicatorColumn.hide();a.gridCheckInfoColumn.hide();a.checkInfoDateStopColumn.hide();a.checkInfoDateTerminateColumn.hide()}else{a.gridIndicatorColumn.show();a.gridCheckInfoColumn.show();a.checkInfoDateStopColumn.show();a.checkInfoDateTerminateColumn.show()}Ext.resumeLayouts(true)},applyFiltersAction:function(){this.filtersParams[this.knp_type]=this.getFilterPanel().getForm().getValues();this.loadFirstPage()},resetFiltersAction:function(){this.filtersParams[this.knp_type]={};Ext.suspendLayouts();this.getFilterPanel().getForm().reset();Ext.resumeLayouts(true);this.loadFirstPage()},expandFilterPanel:function(){if(!this.filtersLoaded){this.loadFilters()}},loadFilters:function(){var a=this;a.getFilterPanel().setLoading(true);LkIp.Request.request({url:"/api/knp/getFilters",scope:this},function(b){a.getFilterPanel().setLoading(false);if(LkIp.Utils.isJsonSuccess(b)){a.defaultFiltersResult=b.response;if(!LkIp.User.isInspectorWithCodeNO()){a.loadNo()}a.loadYear();a.loadKnp();a.filtersLoaded=true}})},loadNo:function(){this.noStore.loadData(this.defaultFiltersResult[this.knp_type]["no"]);LkIp.Utils.checkFilterStore(this.getFilterPanel().down('[name="codeNO"]'))},loadYear:function(b){b=b||false;var a;if(false===b){a=this.defaultFiltersResult[this.knp_type]["year"]}else{a=this.getDataBy("no",this.defaultFiltersResult[this.knp_type]["year"],b)}this.yearStore.loadData(2===this.knp_type?LkIp.Utils.unique(a,"code"):a);LkIp.Utils.checkFilterStore(this.getFilterPanel().down('[name="year"]'))},loadKnp:function(e,b){var c=this,a=c.defaultFiltersResult[this.knp_type]["knp"],d=c.getFilterPanel().down('[name="knp"]');d.reset();e=e||false;b=b||false;if(false!==b){a=this.getDataBy("year",a,b)}else{if(false!==e){a=this.getDataBy("no",a,e)}}c.knpStore.loadData(LkIp.Utils.unique(a,"code"))},getDataBy:function(c,a,d){var b=[];Ext.Array.each(a,function(e){if(e[c]==d||"0"==e.code){b.push(e)}});return b},changeNo:function(b){var c=this,d=b.getValue(),a=b.getStore();if(0!==a.getCount()){d=0==d?false:d;c.loadYear(d);if(0==c.getFilterPanel().down('[name="year"]').getValue()){c.loadKnp(d)}}},changeYear:function(b){var c=this,d=b.getValue(),a=b.getStore();if(0!==a.getCount()){}}},0,0,0,0,0,0,[LkIp.controller,"DeskAudit"],0));(Ext.cmd.derive("LkIp.model.Calculator.ActivityModel",Ext.data.Model,{fields:["code","value","type",{name:"qtip",type:"string",convert:function(b,a){return a.get("value")}},{name:"fullName",type:"string",convert:function(c,a){var b=a.get("code");return(0!==b?b+"-":"")+a.get("value")}},{name:"shortName",type:"string",convert:function(b,a){var c=a.get("value");return a.get("code")+"-"+Ext.String.ellipsis(c,40,true)}},{name:"filterValue",type:"string",convert:function(d,a){var b="",c=a.get("code");if("0"!=c){b=c+"-"}return b+a.get("value")}},{name:"pokaz",type:"string"},{name:"bazdoh",type:"string"}],idProperty:"code"},0,0,0,0,0,0,[LkIp.model.Calculator,"ActivityModel"],0));(Ext.cmd.derive("LkIp.store.Calculator.ActivityStore",LkIp.store.DefaultStore,{model:"LkIp.model.Calculator.ActivityModel",sorters:[{property:"code",direction:"ASC"}],remoteSort:false},0,0,0,0,0,0,[LkIp.store.Calculator,"ActivityStore"],0));(Ext.cmd.derive("LkIp.controller.Calculator",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"#calculator"},{ref:"formPanel",selector:"#stateRegistration-form"}],models:["Calculator.ActivityModel"],getActivityStore:function(){return this.getStore("Calculator.ActivityStore")},firstLoad:true,activities:[],isUsn:false,isEnvd:false,isPsn:false,secondEnvdStep:false,faktPokTextTtip:undefined,currentInsurance:0,currentInsuranceEmp:0,faktPokValueTtip:undefined,envdCounted:false,calculationsecondEnvdStep:false,patentPeriodsLoading:false,bazDoh:0,tabs:["osn-tab","usnIncome-tab","usnIncomeMinusCosts-tab","envd-tab","psn-tab"],psnCounted:false,patentPeriod:undefined,chooseMO:false,formulas:{envd:{formula:"\u0415\u041d\u0412\u0414={value} \u0440\u0443\u0431. ({bazDoh}*{faktPokValue}*{koefK1}*{koefK2}*{monthes}*0,15-{insurance})",zero:"\u0415\u041d\u0412\u0414={value} \u0440\u0443\u0431.",noData:""},ornNds:{formula:"\u041e\u0431\u0449\u0430\u044f \u0441\u0443\u043c\u043c\u0430 \u041d\u0414\u0421={value} \u0440\u0443\u0431. ({income}*0,18)",otherCosts:"\u041e\u0431\u0449\u0430\u044f \u0441\u0443\u043c\u043c\u0430 \u041d\u0414\u0421={value} \u0440\u0443\u0431. ({income}*0,18-{otherCosts})"},ornNdfl:{formula:"\u041d\u0414\u0424\u041b={value} \u0440\u0443\u0431. (({income} - ({otherCosts} + {laborCosts} + {insurance} + {insuranceEmp})) * 0,13)",zero:"\u041d\u0414\u0424\u041b={value} \u0440\u0443\u0431."},usn:{formula:"\u041d\u0430\u043b\u043e\u0433 \u043f\u043e \u0423\u0421\u041d={value} \u0440\u0443\u0431. ({income}*{rate} - ({insurance}+{insuranceEmp}))",shortInsurance:"\u041d\u0430\u043b\u043e\u0433 \u043f\u043e \u0423\u0421\u041d={value} \u0440\u0443\u0431. ({income}*{rate} - {insurance})",zero:"\u041d\u0430\u043b\u043e\u0433 \u043f\u043e \u0423\u0421\u041d={value} \u0440\u0443\u0431.",noData:""},usnMinusCosts:{formula:"\u041d\u0430\u043b\u043e\u0433 \u043f\u043e \u0423\u0421\u041d={value} \u0440\u0443\u0431. (({income} - ({insurance} + {insuranceEmp} + {otherCosts} + {laborCosts})) * {rate})",formulaShort:"\u041d\u0430\u043b\u043e\u0433 \u043f\u043e \u0423\u0421\u041d={value} \u0440\u0443\u0431. (({income} - ({insurance} + {otherCosts} + {laborCosts})) * {rate})",noData:"",minTax:"\u041c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439 \u043d\u0430\u043b\u043e\u0433={value} \u0440\u0443\u0431. ({income}*0,01)",zero:"\u041d\u0430\u043b\u043e\u0433 \u043f\u043e \u0423\u0421\u041d={value} \u0440\u0443\u0431."}},init:function(){var a=Ext.getBody(),b=this;b.getActivityStore().on({beforeload:{fn:b.beforeloadGrid,scope:b},load:{fn:b.loadGrid,scope:b}});a.addListener("click",b.showMoreGoods,b,{preventDefault:true,delegate:".show-goods"});a.addListener("click",b.showEnvdVariables,b,{preventDefault:true,delegate:".show-envd-variables"});a.addListener("click",b.showRegionWindow,b,{preventDefault:true,delegate:".tax-nalog-link"});b.control({"#calculator #chooseTaxSystems":{click:b.chooseTaxSystemsAction},'#calculator [name="envdActivity"]':{change:b.changeActivityValue},'#calculator [name="faktPokValue"]':{change:b.changefaktPokValue},'#calculator [name="korrKoef2"]':{change:{fn:b.changekorrKoef2,scope:b}},"#calculator #psn-count-first-step":{change:this.changePatentRegion},"#calculator #psn-count-second-step":{select:this.changePatentMo},"#calculator #psn-count-third-step":{change:this.changePatentActivity},"#calculator #psn-count-forth-step":{change:this.changeObjectsValue},"#calculator #psn-count-step":{click:this.countPsn},'#calculator [name="rateIncomeMinusCosts"]':{change:b.changeRateIncomeMinusCosts},'#calculator [name="rateIncome"]':{change:b.changeRateIncome},'#calculator [name="monthes"]':{change:b.changeMonth}});b.callParent()},loadIndex:function(){var a=this;if(Ext.isEmpty(a.getIndex())||Ext.isEmpty(a.getIndex().inGuestViewport)){a.callParent();LkIp.Request.request("/api/calculator/counter",function(b){})}a.patentPeriod=Ext.Date.format(new Date(),"Y");if(a.firstLoad){a.loadActivitiesInBackground();a.loadRegionsInBackground();a.patentPeriodStore=Ext.getStore("patentPeriodStore");a.patentRegionsStore=Ext.getStore("patentRegionsStore");a.patentMOStore=Ext.getStore("patentMOStore");a.activityStore=Ext.getStore("activityStore")}},showMoreGoods:function(){this.getIndex().down("#showMoreGoodsValue").getEl().toggle();this.getIndex().doLayout()},showEnvdVariables:function(){var b=this,a=b.getIndex().down("#show-envd-variables-block");if(a.isHidden()){a.show()}else{a.hide()}},showRegionWindow:function(){var a=this;a.regionWindow=Ext.create("LkIp.view.Calculator.RegionWindow");a.regionWindow.down("#region").getStore().loadData(a.regions);a.regionWindow.show()},loadGrid:function(){},beforeloadGrid:function(){},loadActivitiesInBackground:function(){var a=this;LkIp.Request.request({url:"/api/filters/getActivities",method:"GET"},function(b){if(!Ext.isEmpty(b.response)){a.activities=b.response;a.getActivityStore().loadData(a.activities)}})},loadRegionsInBackground:function(){var a=this;if(!Ext.isEmpty(LkIp.User.get("inn"))){return}LkIp.Request.request("/api/filters/getRegions",function(b){if(!Ext.isEmpty(b.response)){a.regions=b.response}})},chooseTaxSystemsAction:function(){var b=this,a=b.getFirstStepValues();b.currentInsurance=0;b.currentInsuranceEmp=0;Ext.suspendLayouts();b.getIndex().down("#calculation-step2").show();b.hideAllTaxInfoBlocks();b.chooseTaxes(a);b.changeInsurance(a.income,a.laborCosts);b.countNds(a.income,a.otherCosts);b.countNdfl(a);b.getIndex().down("#usnIncome").update({usnIncomeCount:b.isUsn?b.countUsnIncome(a,b.getIndex().down('[name="rateIncome"]').getValue()):"-"});b.getIndex().down("#usnIncomeMinusCosts").update({usnIncomeMinusCosts:b.isUsn?b.countUsnIncomeMinusCosts(a,b.getIndex().down('[name="rateIncomeMinusCosts"]').getValue()):"-"});if(b.isEnvd&&b.envdCounted){b.getIndex().down("#envd-change-button").show();b.changeNumberOfEmployeesAction(b.getIndex().down('[name="numberEmployees"]').getValue());b.countEnvd()}else{b.getIndex().down("#envd-change-button").hide()}if(b.isPsn&&b.psnCounted){b.getIndex().down("#psn-change-button").show();b.countPsn()}else{b.getIndex().down("#psn-change-button").hide()}if(b.isUsn){b.getIndex().down("#usnIncome-button").show();b.getIndex().down("#usnIncomeMinusCosts-button").show()}else{b.getIndex().down("#usnIncome-button").hide();b.getIndex().down("#usnIncomeMinusCosts-button").hide()}Ext.resumeLayouts(true);LkIp.Utils.scrollTo(b.getIndex().down("#calculation-step2"),{duration:0});b.addEventToTaxes();if(b.isPsn){if(b.patentRegionsStore.getCount()==0){b.loadPatentRegions()}}},showTaxesWithSteps:function(d,g,b){d.down("#"+g+"-info").show();d.down("#"+b+"-button").hide();d.down("#"+b+"-change-button").hide();d.down("#"+b).show();var c=d.down("#"+b+"-count-first-step");c.show();if((c.getValue()===0)&&(!Ext.isEmpty(LkIp.User.get("head")))){var a=c.getStore(),f=LkIp.User.get("head").SvedUchet["@KodNalOrg"].substring(0,2),e;e=a.find("value",f);if(e>=0){c.setValue(a.getAt(e).get("code"))}}LkIp.Utils.scrollTo(c,{duration:0})},addEventToTaxes:function(){var b=this,a=b.getIndex();Ext.getBody().addListener("click",function(e,d){Ext.suspendLayouts();var f=Ext.get(d),g=f.getAttribute("id"),c=g.substring(0,g.indexOf("-"));if(!f.hasCls("unavailable-tab")){b.hideAllTaxInfoBlocks();f.addCls("tax-system-active");a.down("#tax-system-tab-info-container").show();if("envd-tab"===g){b.showTaxesWithSteps(a,g,c);if(b.psnCounted){b.getIndex().down("#psn-change-button").show()}}else{if(b.isEnvd){if(!b.envdCounted){a.down("#envd-button").show();a.down("#envd").hide()}else{b.getIndex().down("#envd-change-button").show()}}}if("psn-tab"===g){b.showTaxesWithSteps(a,g,c);if(b.envdCounted){b.getIndex().down("#envd-change-button").show()}}else{if(b.isPsn){if(!b.psnCounted){a.down("#psn-button").show();a.down("#psn").hide();a.down("#psn-period").hide()}else{b.getIndex().down("#psn-change-button").show()}}}if(Ext.Array.contains(["osn-tab","usnIncome-tab","usnIncomeMinusCosts-tab"],g)){a.down("#osn-tab-info").show();Ext.Array.each(["ndsRate","ndflRate","usnIncome-button","usnIncomeMinusCosts-button","rateIncome","rateIncomeMinusCosts","ornNds-formula","ornNdfl-formula","usn-formula","usnMinusCosts-formula"],function(h){a.down("#"+h).hide()});if(g==="usnIncome-tab"){a.down("#rateIncome").show();a.down("#usn-formula").show()}else{if(g==="usnIncomeMinusCosts-tab"){a.down("#rateIncomeMinusCosts").show();a.down("#usnMinusCosts-formula").show()}else{a.down("#ndsRate").show();a.down("#ndflRate").show();a.down("#ornNds-formula").show();a.down("#ornNdfl-formula").show()}}}if((g!=="usnIncomeMinusCosts-tab")&&b.isUsn){a.down("#usnIncomeMinusCosts-button").show()}if((g!=="usnIncome-tab")&&b.isUsn){a.down("#usnIncome-button").show()}}Ext.resumeLayouts(true)},this,{preventDefault:true,stopEvent:true,delegate:".tax-system-item"})},hideAllTaxInfoBlocks:function(){var b=this,a=b.getIndex();Ext.suspendLayouts();a.down("#tax-system-tab-info-container").hide();a.down("#rateIncome").hide();a.down("#rateIncomeMinusCosts").show();Ext.Array.each(b.tabs,function(c){var d=Ext.Array.contains(["osn-tab","usnIncome-tab","usnIncomeMinusCosts-tab"],c)?"osn-tab-info":c+"-info";a.down("#"+c).removeCls("tax-system-active");a.down("#"+d).hide()});Ext.resumeLayouts(true)},countNdfl:function(a){var c=this,b=LkIp.Utils.roundTaxValues(Ext.Number.correctFloat((a.income-(a.otherCosts+a.laborCosts+c.currentInsurance+c.currentInsuranceEmp))*0.13)),d="formula",e={income:a.income,otherCosts:a.otherCosts,laborCosts:a.laborCosts,insurance:c.currentInsurance,insuranceEmp:c.currentInsuranceEmp};if(b<0){b=0;d="zero"}e.value=b;c.getIndex().down("#ndflCount").update({ndflCount:b});c.updateFormula("ornNdfl",d,e)},countUsnIncome:function(b,d){var e=this,c="-",f=Ext.Number.correctFloat(0.01*d),a=e.round(Ext.Number.correctFloat((b.income*f)/2)),g="noData",h={income:b.income,rate:f};if(e.isUsn&&!Ext.isEmpty(d)&&d<=6&&d>=0){if(b.numberEmployees>0){c=e.round(Ext.Number.correctFloat(b.income*f-(e.currentInsurance+e.currentInsuranceEmp)));if(c<a){c=a;g="shortInsurance";h.insurance=e.round((b.income*f)/2)}else{g="formula";h.insurance=e.currentInsurance;h.insuranceEmp=e.currentInsuranceEmp}}else{c=Ext.Number.correctFloat(b.income*f-e.currentInsurance);if(c<0){c=0}else{g="shortInsurance";h.insurance=e.currentInsurance}}if(c==0){g="zero"}c=LkIp.Utils.roundTaxValues(c)}h.value=c;e.updateFormula("usn",g,h);return c},countUsnIncomeMinusCosts:function(a,c){var d=this,b="-",f=Ext.Number.correctFloat(0.01*c),e=Ext.Number.correctFloat(a.income*0.01),g="noData",h={income:a.income,rate:f,insurance:d.currentInsurance,otherCosts:a.otherCosts,laborCosts:a.laborCosts,insuranceEmp:0};if(d.isUsn&&!Ext.isEmpty(c)&&c<=15&&c>=0){if(a.numberEmployees>0){b=d.round(Ext.Number.correctFloat((a.income-(d.currentInsurance+d.currentInsuranceEmp+a.otherCosts+a.laborCosts))*f));h.insuranceEmp=d.currentInsuranceEmp;g="formula"}else{b=d.round(Ext.Number.correctFloat((a.income-(a.otherCosts+a.laborCosts+d.currentInsurance))*f));g="formulaShort"}if(e>b){b=e;g="minTax"}if(b<0){b=0;g="zero"}b=LkIp.Utils.roundTaxValues(b)}h.value=b;d.updateFormula("usnMinusCosts",g,h);return b},countNds:function(b,a){var c,d="formula",e={income:b};if(a>0){a=Ext.Number.correctFloat(a*0.18);d="otherCosts";e.otherCosts=a}else{a=0}c=LkIp.Utils.roundTaxValues((b*0.18)-a);e.value=c;this.getIndex().down("#ndsCount").update({ndsCount:c});this.updateFormula("ornNds",d,e)},chooseTaxes:function(b){var e=this,d=[],a=[],c=e.getIndex();Ext.suspendLayouts();e.isUsn=e.checkUsn(b);e.isEnvd=e.checkEnvd(b);e.isPsn=e.checkPsn(b);if(e.isUsn){d.push("usnIncome","usnIncomeMinusCosts")}else{a.push("usnIncome","usnIncomeMinusCosts")}if(e.isEnvd){d.push("envd")}else{a.push("envd")}if(e.isPsn){d.push("psn")}else{a.push("psn")}Ext.Array.each(d,function(f){c.down("#"+f).show();c.down("#"+f+"-tab").removeCls("unavailable-tab");c.down("#"+f+"-unavailable").hide();if("envd"===f||"psn"===f){e.showMoreActiveTaxElementsWhileInitialization(f,c)}});Ext.Array.each(a,function(f){c.down("#"+f+"-tab").addCls("unavailable-tab");c.down("#"+f+"-unavailable").show();c.down("#"+f).hide();if("envd"===f||"psn"===f||"usnIncomeMinusCosts"===f){c.down("#"+f+"-button").hide();if("psn"===f){c.down("#psn-period").hide()}}});Ext.resumeLayouts(true)},showMoreActiveTaxElementsWhileInitialization:function(d,a){var c=this,b="envd"===d?c.envdCounted:c.psnCounted;if(b){a.down("#"+d+"-button").hide()}else{a.down("#"+d).hide();a.down("#"+d+"-button").show()}},checkUsn:function(a){return a.excisable=="2"&&a.notary=="2"&&a.residual=="2"&&a.eshn=="2"&&(a.numberEmployees>=0&&a.numberEmployees<=100)&&a.income<=150000000},checkEnvd:function(a){return a.numberEmployees>=0&&a.numberEmployees<=100},checkPsn:function(a){return(a.numberEmployees>=0&&a.numberEmployees<=15)&&a.income<60000000},changeInsurance:function(c,a){var b=this;b.currentInsurance=b.countInsurance(c);b.getIndex().down("#insuranceCount").update({insuranceCount:LkIp.Utils.numberConvert(b.currentInsurance)});b.currentInsuranceEmp=b.countInsuranceEmp(a);b.getIndex().down("#insuranceCountEmp").update({insuranceCountEmp:LkIp.Utils.numberConvert(b.currentInsuranceEmp)})},countInsurance:function(c){var d=5840,b=0,a=Ext.Number.correctFloat(8*26545);if(c<=300000){b=26545}else{b=Ext.Number.correctFloat(26545+0.01*(c-300000));if(b>a){b=a}}return Ext.Number.correctFloat(d+b)},countInsuranceEmp:function(a){return Ext.Number.correctFloat(a*0.3)},getFirstStepValues:function(){var b=this,c=b.getIndex().down("#choose-form").getForm().getValues(),a={};Ext.Object.each(c,function(d,e){a[d]=parseFloat(e)});return a},changeActivityValue:function(b,d){var c=this,a=c.getActivityStore().findRecord("code",d),e=c.getIndex().down("#envd-count-second-step");if(!Ext.isEmpty(a)&&!Ext.isEmpty(d)&&0!==d){Ext.suspendLayouts();c.resetEnvd();e.show();c.secondEnvdStep=true;e.down("#faktPokName").update({faktPokName:a.get("pokaz")});c.bazDoh=a.get("bazdoh");e.down("#bazDoh").update({bazDoh:c.bazDoh});Ext.resumeLayouts(true);c.addDefaultValuesToSecondStep(d);c.countEnvd()}},addDefaultValuesToSecondStep:function(d){if(!Ext.isEmpty(d)){var c=this,b=c.getFirstStepValues(),e=c.getIndex().down("#envd-count-second-step"),a=e.down('[name="faktPokValue"]');if(typeof c.faktPokValueTtip!="undefined"){c.faktPokValueTtip.destroy();c.faktPokValueTtip=undefined}if(typeof c.faktPokTextTtip!="undefined"){c.faktPokTextTtip.destroy();c.faktPokTextTtip=undefined}a.minValue=undefined;a.maxValue=undefined;a.editable=true;a.setValue(0);switch(d){case"05":a.maxValue=20;break;case"18":a.maxValue=5;break;case"19":a.setValue(5);a.minValue=5;break;case"20":a.maxValue=10;break;case"21":a.setValue(10);a.minValue=10;break;case"08":a.maxValue=5;break;case"09":a.setValue(5);a.minValue=5;break;case"01":case"02":case"03":case"12":case"10":c.faktPokValueTtip=LkIp.Utils.tooltip(a,reference.lang.calculator.faktPokValueTtip);c.faktPokTextTtip=LkIp.Utils.tooltip(e.down("#faktPokName"),reference.lang.calculator.faktPokValueTtip);a.setValue(b.numberEmployees+1).editable=false;break;case"07":case"11":a.maxValue=150;break;default:a.editable=true;a.setValue(0);break}}},changekorrKoef2:function(a,d){var b=this,c=b.getIndex().down('[name="faktPokValue"]').getValue();if(!Ext.isEmpty(c)&&a.isValid()&&c<=150){b.countEnvd()}else{b.resetEnvd("korrKoef2")}},changefaktPokValue:function(b,d){var c=this,a=c.getIndex().down('[name="korrKoef2"]').getValue();if(!Ext.isEmpty(a)&&a>=0.005&&a<=1&&b.isValid()){c.countEnvd()}else{c.resetEnvd("korrKoef2")}},changeRateIncomeMinusCosts:function(d,f){var e=this,a=e.getFirstStepValues(),c=e.getIndex(),b;c.down("#usnIncomeMinusCosts").update({usnIncomeMinusCosts:e.countUsnIncomeMinusCosts(a,f)})},changeRateIncome:function(b,d){var c=this,a=c.getFirstStepValues();c.getIndex().down("#usnIncome").update({usnIncomeCount:c.countUsnIncome(a,d)})},round:function(a){return Math.round(a)},countEnvd:function(){var j=this,g=j.getIndex().down("#envd-count-block").getForm().getValues(),a=j.getFirstStepValues(),n=12,m=1.868,c=parseFloat(j.getIndex().down('[name="faktPokValue"]').getValue()),l=parseFloat(g.korrKoef2.replace(",",".")),e=parseFloat(j.bazDoh),i=Ext.Number.correctFloat(e*m*c*l),o=j.countInsurance(j.getIndex().down('[name="income"]').getValue()),d=j.round(i*n*0.15),h,b,f={bazDoh:e,faktPokValue:c,koefK1:m,koefK2:l,monthes:12,insurance:0},k="formula";if(a.numberEmployees>0){h=j.round(d/2);b=d-j.currentInsuranceEmp;if(b<h){b=h;f.insurance=d-h}else{f.insurance=j.currentInsuranceEmp}}else{b=Ext.Number.correctFloat(d-o);f.insurance=o;if(b<0){b=0}}if(b==0){k="zero"}j.envdCounted=true;f.value=LkIp.Utils.roundTaxValues(b);j.updateFormula("envd",k,f);j.showEnvd(i,o,j.currentInsuranceEmp,b)},updateFormula:function(b,g,e){var d=this,c=d.getIndex().down("#"+b+"-formula"),a=new Ext.XTemplate(d.formulas[b][g]),f={};Ext.Object.each(e,function(i,h){f[i]=(h+"").replace(/\./,",")});c.update({formula:a.apply(f)})},showEnvd:function(c,a,e,d){var b=this;d=LkIp.Utils.roundTaxValues(d);Ext.suspendLayouts();b.getIndex().down("#vmenDoh").update({vmenDoh:LkIp.Utils.roundTaxValues(c)});b.getIndex().down("#insuranceEnvd").update({insuranceEnvd:LkIp.Utils.numberConvert(a)});b.getIndex().down("#insuranceEmplEnvd").update({insuranceEmplEnvd:LkIp.Utils.numberConvert(e)});b.getIndex().down("#vmenNal").update({vmenNal:d});b.getIndex().down("#envd").update({nalEnvd:d});Ext.resumeLayouts(true)},resetEnvd:function(a){var b=this;a=a||false;b.getIndex().down("#envd-count-block").getForm().isValid();Ext.suspendLayouts();if("korrKoef2"!==a){b.getIndex().down('[name="korrKoef2"]').reset()}b.getIndex().down("#vmenDoh").update({vmenDoh:"-"});b.getIndex().down("#insuranceEnvd").update({insuranceEnvd:"-"});b.getIndex().down("#insuranceEmplEnvd").update({insuranceEmplEnvd:"-"});b.getIndex().down("#vmenNal").update({vmenNal:"-"});b.getIndex().down("#envd").update({nalEnvd:"-"});b.envdCounted=false;b.updateFormula("envd","noData",{});Ext.resumeLayouts(true)},loadPatentActivities:function(a){var c=this,b=c.getIndex().down("#psn-form");c.activityStore.removeAll();b.setLoading(true);LkIp.Request.request({url:"/api/taxmode/getPatentActivities/"+a+"/"+c.patentPeriod},function(d){b.setLoading(false);if(!Ext.isEmpty(d.response)){c.activityStore.loadData(d.response)}else{c.getIndex().down("#psn-count-third-step").setValue(0)}},0,true)},loadPatentMO:function(a){var c=this,b=c.getIndex().down("#psn-form");b.setLoading(true);c.patentMOStore.removeAll();LkIp.Request.request({url:"/api/taxmode/getPatentMo/"+a+"/"+c.patentPeriod},function(d){b.setLoading(false);if(!Ext.isEmpty(d.response)){c.patentMOStore.loadData(d.response)}else{c.getIndex().down("#psn-count-second-step").setValue(0)}},0,true)},loadPatentRegions:function(){var b=this,a=b.getIndex().down("#psn-form");a.setLoading(true);LkIp.Request.request({url:"/api/taxmode/getPatentRegions/"+b.patentPeriod,method:"GET"},function(d){a.setLoading(false);if(!Ext.isEmpty(d.response)){b.patentRegionsStore.loadData(d.response);if(!Ext.isEmpty(LkIp.User.get("head"))&&!Ext.isEmpty(LkIp.User.get("head").SvedUchet["@KodNalOrg"])){var c=b.patentRegionsStore.find("value",LkIp.User.get("head").SvedUchet["@KodNalOrg"].substring(0,2));if(c>=0){b.getIndex().down("#psn-count-first-step").setValue(b.patentRegionsStore.getAt(c).get("code"))}}}else{b.getIndex().down("#psn-count-first-step").setValue(0)}},0,true)},changeMonth:function(a,c){var b=this;b.resetPsn("month")},changePatentRegion:function(d,f){if(!Ext.isEmpty(f)&&f!==0){var e=this,c=e.patentRegionsStore.getById(f),b=c.get("mo"),a=(b=="1"?e.getIndex().down("#psn-count-second-step"):e.getIndex().down("#psn-count-third-step"));e.chooseMO=b;e.resetPsn("region");a.show().enable();if(b=="1"){e.loadPatentMO(f)}else{e.getIndex().down("#psn-count-second-step").hide().disable();e.loadPatentActivities(f)}}},changePatentMo:function(c,b){var d=this,b=b[0],e=b.get("code"),a=d.getIndex().down("#psn-count-third-step");if(!Ext.isEmpty(e)&&e!==0){d.resetPsn("mo");a.show();d.loadPatentActivities(e)}},changePatentActivity:function(f,h){if(!Ext.isEmpty(h)&&h!==0){var g=this,a=g.getIndex().down("#psn-count-forth-step"),c=g.activityStore.findRecord("code",h),b=g.getIndex().down("#psn-count-first-step").getValue();g.resetPsn("activity");if(c.get("type")==="\u041e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442"){a.setValue(0);a.hide()}else{var d=b=="1234"?"\u0421\u0440\u0435\u0434\u043d\u044f\u044f \u0447\u0438\u0441\u043b\u0435\u043d\u043d\u043e\u0441\u0442\u044c \u043d\u0430\u0435\u043c\u043d\u044b\u0445 \u0440\u0430\u0431\u043e\u0442\u043d\u0438\u043a\u043e\u0432, \u0432\u043a\u043b\u044e\u0447\u0430\u044f \u0418\u041f":c.get("type");a.show().setFieldLabel(d+'<span class="form-required-field" data-qtip="'+reference.lang.form.required+'">*</span>');if(c.get("type")==="\u0421\u0440\u0435\u0434\u043d\u044f\u044f \u0447\u0438\u0441\u043b\u0435\u043d\u043d\u043e\u0441\u0442\u044c \u043d\u0430\u0435\u043c\u043d\u044b\u0445 \u0440\u0430\u0431\u043e\u0442\u043d\u0438\u043a\u043e\u0432"){var e=g.getIndex().down('[name="numberEmployees"]').getValue();a.setValue(b=="1234"?e+1:e)}}}},changeObjectsValue:function(a,c){var b=this;b.resetPsn("objects")},countPsn:function(){var e=this,c=e.getIndex(),b=c.down("#psn-form"),f=b.getForm().getValues(),d,a;b.setLoading(true);if(e.chooseMO){f.regionCodeMO=e.patentMOStore.getAt(e.patentMOStore.findExact("type",f.regionCodeMO)).get("code");f.regionCode=f.regionCodeMO}delete f.regionCodeMO;LkIp.Request.request({url:"/api/taxmode/countPatent/"+e.patentPeriod+"/"+f.regionCode+"/"+f.monthes+"/"+f.activity+"/"+f.value},function(i){var h,g;b.setLoading(false);if(!Ext.isEmpty(i.response)){e.psnCounted=true;g=e.getPsnResultFromString(i.response.sum);a=e.countPsnPVGD(g,f.monthes);d=e.countInsurance(a);if(parseInt(f.monthes)<=5){h=Ext.String.format(reference.lang.calculator.psn.halfYearPatent,'<span class="bold">'+LkIp.Utils.rouble(g)+"</span>")}else{h=Ext.String.format(reference.lang.calculator.psn.fullYearPatent,'<span class="bold">'+LkIp.Utils.rouble(e.getPsnResultFromString(i.response.payments.p1))+"</span>",'<span class="bold">'+LkIp.Utils.rouble(e.getPsnResultFromString(i.response.payments.p2))+"</span>")}c.down("#psn-count-text").show().update(h);c.down("#psn-pay-info").show();c.down("#insurancePsn").update({insurancePsn:LkIp.Utils.numberConvert(d)});c.down("#insuranceEmplPsn").update({insuranceEmplPsn:LkIp.Utils.numberConvert(e.currentInsuranceEmp)});c.down("#psn-count-result").show().setValue(g);c.down("#psn").update({psn:g});c.down("#psn-period").show().update({psnPeriod:parseInt(f.monthes)})}else{e.psnCounted=false;c.down("#psn-count-text").show().update('<span class="bold">'+reference.lang.calculator.psn.noData+"</span>")}})},countPsnPVGD:function(c,b){var d=this,a;c=parseFloat(c.replace(" ",""));if(b==12){a=c/0.06}else{a=((c/parseInt(b))*12)/0.06}return d.round(a)},getPsnResultFromString:function(a){return LkIp.Utils.roundTaxValues(parseFloat(a))},resetPsn:function(c){var b=this,a=b.getIndex();Ext.suspendLayouts();a.down("#psn-count-result").setValue("").hide();a.down("#psn-count-text").update("");a.down("#psn-pay-info").hide();a.down("#insurancePsn").update({insurancePsn:"-"});a.down("#insuranceEmplPsn").update({insuranceEmplPsn:"-"});a.down("#psn").update({psn:"-"});a.down("#psn-period").hide().update({psnPeriod:"-"});switch(c){case"region":a.down("#psn-count-second-step").hide().reset();a.down("#psn-count-third-step").hide().reset();a.down("#psn-count-forth-step").hide().reset();break;case"mo":a.down("#psn-count-third-step").hide().reset();a.down("#psn-count-forth-step").hide().reset();break;case"activity":a.down("#psn-count-forth-step").reset();break}Ext.resumeLayouts(true);b.psnCounted=false},changeNumberOfEmployeesAction:function(b){var a=this;if(Ext.Array.contains(["01","02","03","12","10"],a.getIndex().down("#envd-count-first-step").getValue())){a.getIndex().down('[name="faktPokValue"]').setValue(parseInt(b)+1)}}},0,0,0,0,0,0,[LkIp.controller,"Calculator"],0));(Ext.cmd.derive("LkIp.controller.TaxSystems.Eshn.Notification",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"eshnNotification"}],dateRegistrationAsIP:undefined,_30daysLeft:undefined,cache:false,init:function(){var a=this;a.control({eshnNotification:{activate:function(){if(!this.cache){this.getIndex().setLoading(true)}}},'eshnNotification [name="userIndicator"]':{change:a.changeIndicatorStore},'eshnNotification [name="eshnSignButton]':{click:a.submitForm},'eshnNotification [name="eshnShowButton]':{click:a.getPdf},'eshnNotification [name="date]':{change:a.changeDate}});a.callParent()},loadIndex:function(){var b=this,c=LkIp.User.get("head"),a=LkIp.User.getDateIPFromHead();b.callParent();if(!b.cache){b.noStore=Ext.getStore("eshnNotificationNoStore");b.indicatorStore=Ext.getStore("userIndicatorStore");b.periodStore=Ext.getStore("incomePeriodStore");LkIp.Request.request({url:"/api/eshn/getReferenceData"},function(d){b.noStore.loadData(d.response.no);b.indicatorStore.loadData(d.response.indicator);b.periodStore.loadData(d.response.period);if(!Ext.isEmpty(c)){b.getIndex().down("#no").setValue(c.SvedUchet["@KodNalOrg"])}b.dateRegistrationAsIP=a;b.drawPageByCheckingRegistrationDate();b.getIndex().setLoading(false);b.cache=true})}},drawPageByCheckingRegistrationDate:function(){var d=this,c=LkIp.Utils.getDateObject(d.dateRegistrationAsIP),b=Ext.Date.add(c,Ext.Date.DAY,30),a=new Date(),e=d.getIndex().down("#userIndicator");if(b>a){e.setValue(2);d._30daysLeft=false;d.drawPageWithIndicatorCode2And30dayNotLeftView()}else{e.setValue(3);d._30daysLeft=true;d.drawPageWithIndicatorCode3View()}},drawPageWithIndicatorCode2And30dayNotLeftView:function(){var b=this,a=b.getIndex();a.down("#visibleDate").hide();a.down('[name="date"]').show().setValue(LkIp.Utils.getDate(b.dateRegistrationAsIP));a.down("#dateText").show()},drawPageWithIndicatorCode2And30dayLeftView:function(){var d=this,b=d.getIndex(),c=b.down("#visibleDate"),a=b.down('[name="date"]');Ext.suspendLayouts();c.hide();a.show().setValue(LkIp.Utils.getDate(d.dateRegistrationAsIP));b.down("#eshnHelpBlock").show();Ext.resumeLayouts(true)},drawPageWithIndicatorCode3View:function(){var c=this,a=c.getIndex(),b=parseInt(Ext.Date.format(new Date(),"Y"))+1;Ext.suspendLayouts();a.down('[name="date"]').hide().setValue("01.01."+b);a.down("#visibleDate").show().setValue("1 "+reference.lang.taxSystem.eshn.january+" "+b+" "+reference.lang.taxSystem.eshn.year);a.down("#dateChangeText").hide();a.down("#eshnIncome").show();a.down("#incomeValue").enable();a.down("#incomePeriod").enable();Ext.resumeLayouts(true)},changeIndicatorStore:function(b,d){var c=this,a=c.getIndex().down('[name="date"]');c.resetView();if("2"==d){a.vtype="date30";a.maxValue=new Date();if(c._30daysLeft){c.drawPageWithIndicatorCode2And30dayLeftView()}else{c.drawPageWithIndicatorCode2And30dayNotLeftView()}}else{if("3"==d){a.vtype=undefined;a.maxValue=undefined;c.drawPageWithIndicatorCode3View()}}c.getIndex().down("#eshnNotificationForm").getForm().isValid()},changeDate:function(e,g){if(!Ext.isEmpty(g)){var f=this,b=f.getIndex(),d=!Ext.isDate(g)?LkIp.Utils.getDateObject(g):g,c=Ext.Date.add(d,Ext.Date.DAY,30),a=new Date();if(Ext.isDate(d)){if(!Ext.Date.isEqual(d,LkIp.Utils.getDateObject(f.dateRegistrationAsIP))){b.down("#dateChangeText").show()}else{b.down("#dateChangeText").hide()}if(c<a){b.down("#eshnHelpBlock").show()}else{b.down("#eshnHelpBlock").hide()}}}},submitForm:function(){var d=this,b=d.getIndex(),c=b.down("#eshnNotificationForm"),a=c.getForm().getValues();a.eshnType="notification";d.successCallback=function(){LkIp.Msg.success(reference.lang.signature.successDefault);if(b.down("#phone").getValue()){LkIp.User.set("phone",b.down("#phone").getValue())}};b.setLoading(true);LkIp.Request.request({url:"/api/eshn/request",method:"POST",params:a},function(e){d.getController("Viewport").signAction(e,{loader:d.getIndex()})})},getPdf:function(){var d=this,b=d.getIndex(),c=b.down("#eshnNotificationForm"),a=c.getForm().getValues();a.eshnType="notification";LkIp.Utils.downloadDocument("eshnNotification","/api/eshn/pdf",a)},resetView:function(){var c=this,b=c.getIndex(),a=b.down('[name="date"]');Ext.suspendLayouts();a.setValue("");b.down("#dateText").hide();b.down("#eshnHelpBlock").hide();b.down("#eshnIncome").hide();b.down("#incomeValue").disable().reset();b.down("#incomePeriod").disable().reset();Ext.resumeLayouts(true)}},0,0,0,0,0,0,[LkIp.controller.TaxSystems.Eshn,"Notification"],0));(Ext.cmd.derive("LkIp.controller.TaxSystems.Eshn.Statement",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"eshnStatement"}],eshnType:"statement",cache:false,init:function(){var a=this;a.control({eshnStatement:{activate:function(){if(!this.cache){this.getIndex().setLoading(true)}}},'eshnStatement [name="eshnSignButton]':{click:a.submitForm},'eshnStatement [name="eshnShowButton]':{click:a.getPdf}});a.callParent()},loadIndex:function(){var a=this,b=LkIp.User.get("head");a.callParent();if(!a.cache){a.noStore=Ext.getStore("eshnStatementNoStore");a.nkrfPoint=Ext.getStore("eshnStatementNkrfPoint");LkIp.Request.request({url:"/api/eshn/getReferenceData",params:{eshnType:a.eshnType}},function(c){a.noStore.loadData(c.response.no);a.nkrfPoint.loadData(c.response.nkrfPoint);if(!Ext.isEmpty(b)){a.getIndex().down("#no").setValue(b.SvedUchet["@KodNalOrg"])}a.getIndex().setLoading(false);a.cache=true})}},submitForm:function(){var d=this,b=d.getIndex(),c=b.down("#eshnStatementForm"),a=c.getForm().getValues();b.setLoading(true);LkIp.Request.request({url:"/api/taxmode/checkEshn",params:{date:a.date}},function(e){b.setLoading(false);if(e.status==1){d.makeRequest()}else{LkIp.Msg.info(reference.lang.taxSystem.eshn.dateMessage,{rewriteDefaultButtons:true,buttons:[{text:reference.lang.buttons.yes,handler:function(){d.makeRequest();LkIp.Msg.fireEvent("closemessagebox",LkIp.Msg);LkIp.Msg.close()}},{text:reference.lang.buttons.no,handler:function(){LkIp.Msg.fireEvent("closemessagebox",LkIp.Msg);LkIp.Msg.close()}}]})}})},makeRequest:function(){var d=this,b=d.getIndex(),c=b.down("#eshnStatementForm"),a=c.getForm().getValues();a.eshnType=d.eshnType;if(!Ext.isEmpty(a.phone)){LkIp.User.set("phone",a.phone)}b.setLoading(true);LkIp.Request.request({url:"/api/eshn/request",method:"POST",params:a},function(e){d.getController("Viewport").signAction(e,{loader:d.getIndex()})})},getPdf:function(){var d=this,b=d.getIndex(),c=b.down("#eshnStatementForm"),a=c.getForm().getValues();a.eshnType=d.eshnType;LkIp.Utils.downloadDocument("eshnStatement","/api/eshn/pdf",a)}},0,0,0,0,0,0,[LkIp.controller.TaxSystems.Eshn,"Statement"],0));(Ext.cmd.derive("LkIp.controller.TaxSystems.Eshn.Stop",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"eshnStop"}],eshnType:"stop",cache:false,init:function(){var a=this;a.control({eshnStop:{activate:function(){if(!this.cache){this.getIndex().setLoading(true)}}},'eshnStop [name="date"]':{change:a.changeDate},'eshnStop [name="eshnSignButton]':{click:a.submitForm},'eshnStop [name="eshnShowButton]':{click:a.getPdf}});a.callParent()},loadIndex:function(){var a=this,b=LkIp.User.get("head");a.callParent();if(!a.cache){a.noStore=Ext.getStore("eshnStopNoStore");LkIp.Request.request({url:"/api/eshn/getReferenceData",params:{eshnType:a.eshnType}},function(c){a.noStore.loadData(c.response.no);if(!Ext.isEmpty(b)){a.getIndex().down("#no").setValue(b.SvedUchet["@KodNalOrg"])}a.getIndex().setLoading(false);a.cache=true})}},changeDate:function(c,e){var d=this,a=new Date(),b=d.getIndex().down("#dateNotification");e=Ext.Date.add(e,Ext.Date.DAY,15);if(e<a){b.show()}else{b.hide()}},submitForm:function(){var d=this,b=d.getIndex(),c=b.down("#eshnStopForm"),a=c.getForm().getValues();b.setLoading(true);LkIp.Request.request({url:"/api/taxmode/checkEshn",params:{date:a.date}},function(e){b.setLoading(false);if(e.status==1){d.makeRequest()}else{LkIp.Msg.info(reference.lang.taxSystem.eshn.stop.dateMessage,{rewriteDefaultButtons:true,buttons:[{text:reference.lang.buttons.yes,handler:function(){d.makeRequest();LkIp.Msg.fireEvent("closemessagebox",LkIp.Msg);LkIp.Msg.close()}},{text:reference.lang.buttons.no,handler:function(){LkIp.Msg.fireEvent("closemessagebox",LkIp.Msg);LkIp.Msg.close()}}]})}})},makeRequest:function(){var d=this,b=d.getIndex(),c=b.down("#eshnStopForm"),a=c.getForm().getValues();a.eshnType=d.eshnType;if(!Ext.isEmpty(a.phone)){LkIp.User.set("phone",a.phone)}b.setLoading(true);LkIp.Request.request({url:"/api/eshn/request",method:"POST",params:a},function(e){d.getController("Viewport").signAction(e,{loader:d.getIndex()})})},getPdf:function(){var d=this,b=d.getIndex(),c=b.down("#eshnStopForm"),a=c.getForm().getValues();a.eshnType=d.eshnType;LkIp.Utils.downloadDocument("eshnStop","/api/eshn/pdf",a)}},0,0,0,0,0,0,[LkIp.controller.TaxSystems.Eshn,"Stop"],0));(Ext.cmd.derive("LkIp.controller.TaxSystems.Eshn.Refuse",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"eshnRefuse"}],eshnType:"refuse",cache:false,defaultYear:undefined,init:function(){var a=this;a.control({eshnRefuse:{activate:function(){if(!this.cache){this.getIndex().setLoading(true)}}},"#eshnRefuseForm":{validitychange:a.afterFormValidation},'eshnRefuse [name="year"]':{change:a.changeYear},'eshnRefuse [name="eshnSignButton]':{click:a.submitForm},'eshnRefuse [name="eshnShowButton]':{click:a.getPdf}});a.callParent()},loadIndex:function(){var a=this,b=LkIp.User.get("head");a.callParent();if(!a.cache){a.noStore=Ext.getStore("eshnRefuseNoStore");LkIp.Request.request({url:"/api/eshn/getReferenceData",params:{eshnType:a.eshnType}},function(c){a.noStore.loadData(c.response.no);if(!Ext.isEmpty(b)){a.getIndex().down("#no").setValue(b.SvedUchet["@KodNalOrg"])}a.getIndex().setLoading(false);a.cache=true});a.setDefaultYear()}},setDefaultYear:function(){var d=this,a=d.getIndex().down("#year"),c=new Date(),b=Ext.Date.format(c,"Y");if(Ext.Date.between(c,new Date("1/1/"+b),new Date("1/16/"+b))){d.defaultYear=b}else{d.defaultYear=parseInt(b)+1}a.setValue(d.defaultYear)},afterFormValidation:function(c,e){var d=this,a=d.getIndex().down("#eshnSignButton"),b=d.getIndex().down("#eshnShowButton");if(e){if(c.fieldIsInvalid){a.disable();b.disable()}else{a.enable();b.enable()}}},changeYear:function(e,h){if(4==(""+h).length){var g=this,c=g.getIndex(),a=c.down("#eshnSignButton"),b=c.down("#eshnShowButton"),f=c.down("#eshnRefuseForm").getForm(),d=c.down("#dateNotification");if(h!=g.defaultYear){d.show();e.addCls("mark-invalid");Ext.get(e.inputId).addCls("mark-invalid-field");f.fieldIsInvalid=true;if(f.isValid()){a.disable();b.disable()}}else{Ext.get(e.inputId).removeCls("mark-invalid-field");d.hide();f.fieldIsInvalid=false;if(f.isValid()){a.enable();b.enable()}}}},submitForm:function(){var d=this,b=d.getIndex(),c=b.down("#eshnRefuseForm"),a=c.getForm().getValues();b.setLoading(true);LkIp.Request.request({url:"/api/taxmode/checkEshn",params:{date:a.date}},function(e){b.setLoading(false);if(e.status==1){d.makeRequest()}else{LkIp.Msg.info(reference.lang.taxSystem.eshn.refuse.dateMessage,{rewriteDefaultButtons:true,buttons:[{text:reference.lang.buttons.yes,handler:function(){d.makeRequest();LkIp.Msg.fireEvent("closemessagebox",LkIp.Msg);LkIp.Msg.close()}},{text:reference.lang.buttons.no,handler:function(){LkIp.Msg.fireEvent("closemessagebox",LkIp.Msg);LkIp.Msg.close()}}]})}})},makeRequest:function(){var d=this,b=d.getIndex(),c=b.down("#eshnRefuseForm"),a=c.getForm().getValues();a.eshnType=d.eshnType;if(!Ext.isEmpty(a.phone)){LkIp.User.set("phone",a.phone)}b.setLoading(true);LkIp.Request.request({url:"/api/eshn/request",method:"POST",params:a},function(e){d.getController("Viewport").signAction(e,{loader:d.getIndex()})})},getPdf:function(){var d=this,b=d.getIndex(),c=b.down("#eshnRefuseForm"),a=c.getForm().getValues();a.eshnType=d.eshnType;LkIp.Utils.downloadDocument("eshnRefuse","/api/eshn/pdf",a)}},0,0,0,0,0,0,[LkIp.controller.TaxSystems.Eshn,"Refuse"],0));(Ext.cmd.derive("LkIp.controller.TaxSystems.Usn.Notification",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"usnNotification"}],cache:false,usnType:"notification",dateCheck:false,init:function(){var a=this;a.control({usnNotification:{activate:function(){if(!this.cache){this.getIndex().setLoading(true)}}},'usnNotification [name="statusGroup"]':{change:a.changeStatus},'usnNotification [name="endEnvdDate"]':{change:a.setStartDate},'usnNotification [name="usnSignButton]':{click:a.submitForm},'usnNotification [name="usnShowButton]':{click:a.getPdf},'usnNotification [name="startDate]':{change:a.changeDate}});a.callParent()},loadIndex:function(){var d=this,e=LkIp.User.get("head"),c=LkIp.User.getDateIPFromHead();d.callParent();if(!d.cache){d.noStore=Ext.getStore("usnNotificationNoStore");d.TaxObjectStore=Ext.getStore("usnTaxObjectStore");LkIp.Request.request({url:"/api/usn/getReferenceData",params:{usnType:d.usnType}},function(f){d.noStore.loadData(f.response.no);d.TaxObjectStore.loadData(f.response.objects);if(!Ext.isEmpty(e)){d.getIndex().down("#no").setValue(e.SvedUchet["@KodNalOrg"])}d.getIndex().down("#taxObject").setValue(1);d.cache=true;d.getIndex().setLoading(false)});var a=c.split("-"),b=LkIp.Utils.getDateObject(c);d.getIndex().down("#startDate").setValue(a[2]+"."+a[1]+"."+a[0]);d.checkDate(b)}},checkDate:function(b){var c=this,d=Ext.Date.add(b,Ext.Date.DAY,30),a=new Date();if(d<a){c.dateCheck=true;c.getIndex().down("#statusGroupNew").setValue(false);c.getIndex().down("#statusGroupFromEnvd").setValue(true)}},statusIp:3,changeStatus:function(g,f,c){var e=this,b=e.getIndex();e.resetStatus();b.down("#startDate").hide().disable();b.down("#startDate2").hide().disable();e.statusIp=parseInt(f.statusIp);switch(f.statusIp){case"2":b.down("#newIpNotice").show();b.down("#startDate").show().enable();var d=LkIp.User.getDateIPFromHead().split("-");b.down("#startDate").setValue(d[2]+"."+d[1]+"."+d[0]);if(e.dateCheck){b.down("#dateError").show()}break;case"3":Ext.apply(b.down("#endEnvdDate"),{allowBlank:false},{});b.down("#endEnvdDate").enable().show();b.down("#startDate2").show().enable();b.down("#startDate2").setValue("");break;case"1":Ext.apply(b.down("#income"),{allowBlank:false},{});b.down("#income").enable().show();var a=new Date();b.down("#startDate").hide().disable();b.down("#startDate2").show().enable();b.down("#startDate2").setValue("01.01."+(a.getFullYear()+1));b.down("#prNP").setValue("3");break;default:break}b.down("#usnNotificationForm").getForm().checkValidity()},changeDate:function(e,g){if(!Ext.isEmpty(g)&&this.statusIp!=3&&this.statusIp!=1){var f=this,b=f.getIndex(),d=!Ext.isDate(g)?LkIp.Utils.getDateObject(g):g,c=Ext.Date.add(d,Ext.Date.DAY,30),a=new Date();if(Ext.isDate(d)){if(!Ext.Date.isEqual(d,LkIp.Utils.getDateObject(LkIp.User.getDateIPFromHead()))){b.down("#dateChangeText").show()}else{b.down("#dateChangeText").hide()}if(c<a){b.down("#dateError").show()}else{b.down("#dateError").hide()}}}},resetStatus:function(){var b=this,a=b.getIndex();Ext.suspendLayouts();a.down("#newIpNotice").hide();a.down("#dateChangeText").hide();a.down("#endEnvdDate").disable().hide().reset();a.down("#income").disable().hide().reset();a.down("#prNP").setValue("2");a.down("#dateError").hide();Ext.resumeLayouts(true)},setStartDate:function(c,b){var a=this;if(b){a.getIndex().down("#startDate2").setValue("01"+c.getSendValue().substr(2))}else{a.getIndex().down("#startDate2").setValue("")}},submitForm:function(){var d=this,b=d.getIndex(),c=b.down("#usnNotificationForm"),a=c.getForm().getValues();a.usnType=d.usnType;d.successCallback=function(){LkIp.Msg.success(reference.lang.signature.successDefault);if(b.down("#phone").getValue()){LkIp.User.set("phone",b.down("#phone").getValue())}};b.setLoading(true);LkIp.Request.request({url:"/api/usn/request",method:"POST",params:a},function(e){d.getController("Viewport").signAction(e,{loader:d.getIndex()})})},getPdf:function(){var d=this,b=d.getIndex(),c=b.down("#usnNotificationForm"),a=c.getForm().getValues();a.usnType=d.usnType;LkIp.Utils.downloadDocument("usnNotification","/api/usn/pdf",a)}},0,0,0,0,0,0,[LkIp.controller.TaxSystems.Usn,"Notification"],0));(Ext.cmd.derive("LkIp.controller.TaxSystems.Usn.Statement",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"usnStatement"}],usnType:"statement",cache:false,defaultArticleStore:undefined,anyReasonChecked:true,init:function(){var a=this;a.control({usnStatement:{activate:function(){if(!this.cache){this.getIndex().setLoading(true)}}},'usnStatement [name="reasonOneBox"]':{change:a.clickReasonOne},'usnStatement [name="reasonTwoBox"]':{change:a.clickReasonTwo},'usnStatement [name="usnSignButton]':{click:a.submitForm},'usnStatement [name="usnShowButton]':{click:a.getPdf},"usnStatement #point":{change:a.changePoint},"usnStatement #usnStatementForm":{validitychange:this.validateFormEvent}});a.callParent()},loadIndex:function(){var a=this,b=LkIp.User.get("head");a.callParent();if(!a.cache){a.noStore=Ext.getStore("usnStatementNoStore");a.nkrfPoint=Ext.getStore("usnStatementNkrfPoint");a.nkrfArticle=Ext.getStore("usnStatementNkrfArticle");a.nkrfPeriodOne=Ext.getStore("usnStatementNkrfPeriodOne");a.nkrfPeriodTwo=Ext.getStore("usnStatementNkrfPeriodTwo");LkIp.Request.request({url:"/api/usn/getReferenceData",params:{usnType:a.usnType}},function(c){a.noStore.loadData(c.response.no);a.nkrfPoint.loadData(c.response.nkrfPoint);a.nkrfArticle.loadData(c.response.nkrfArticle);a.defaultArticleStore=c.response.nkrfArticle;a.nkrfPeriodOne.loadData(c.response.nkrfPeriod);a.nkrfPeriodTwo.loadData(c.response.nkrfPeriod);if(!Ext.isEmpty(b)){a.getIndex().down("#no").setValue(b.SvedUchet["@KodNalOrg"])}a.getIndex().setLoading(false);a.cache=true})}},clickReasonOne:function(c,d){var b=this,a=b.getIndex();b.changeReason(c,a.down("#reasonOne"),d);b.checkIfAnyReasonIsChecked()},clickReasonTwo:function(c,d){var b=this,a=b.getIndex();b.changeReason(c,a.down("#reasonTwo"),d);b.checkIfAnyReasonIsChecked()},validateFormEvent:function(c,b){var a=this,e=a.getIndex().down("#usnSignButton"),d=a.getIndex().down("#usnShowButton");if(!a.anyReasonChecked){e.disable();d.disable()}else{if(b){e.enable();d.enable()}}},checkIfAnyReasonIsChecked:function(){var b=this,a=b.getIndex(),d=a.down("#usnSignButton"),c=a.down("#usnShowButton");b.anyReasonChecked=a.down("#reasonOneBox").getValue()||a.down("#reasonTwoBox").getValue();if(!b.anyReasonChecked){d.disable();c.disable()}},changeReason:function(b,a,c){a.items.each(function(d){if(d.getXType()==="container"){d.items.each(function(e){e.setDisabled(!c)})}else{d.setDisabled(!c)}});this.getIndex().down("#usnStatementForm").getForm().checkValidity()},submitForm:function(){var d=this,b=d.getIndex(),c=b.down("#usnStatementForm"),a=c.getForm().getValues();b.setLoading(true);LkIp.Request.request({url:"/api/taxmode/checkUsn",params:{date:a.date}},function(e){b.setLoading(false);if(e.status==1){d.makeRequest()}else{LkIp.Msg.info(reference.lang.taxSystem.usn.dateMessage,{rewriteDefaultButtons:true,buttons:[{text:reference.lang.buttons.yes,handler:function(){d.makeRequest();LkIp.Msg.fireEvent("closemessagebox",LkIp.Msg);LkIp.Msg.close()}},{text:reference.lang.buttons.no,handler:function(){LkIp.Msg.fireEvent("closemessagebox",LkIp.Msg);LkIp.Msg.close()}}]})}})},makeRequest:function(){var d=this,b=d.getIndex(),c=b.down("#usnStatementForm"),a=c.getForm().getValues();a.usnType=d.usnType;if(!d.anyReasonChecked){LkIp.Msg.error(reference.lang.taxSystem.usn.statement.reasonError);return false}if(a.reasonOneBox){a.reasonOne=1;delete a.reasonOneBox}if(a.reasonTwoBox){a.reasonTwo=1;delete a.reasonTwoBox}if(!Ext.isEmpty(a.phone)){LkIp.User.set("phone",a.phone)}b.setLoading(true);LkIp.Request.request({url:"/api/usn/request",method:"POST",params:a},function(e){d.getController("Viewport").signAction(e,{loader:d.getIndex()})})},getPdf:function(){var d=this,b=d.getIndex(),c=b.down("#usnStatementForm"),a=c.getForm().getValues();a.usnType=d.usnType;if(a.reasonOneBox){a.reasonOne=1;delete a.reasonOneBox}if(a.reasonTwoBox){a.reasonTwo=1;delete a.reasonTwoBox}LkIp.Utils.downloadDocument("usnNotification","/api/usn/pdf",a)},changePoint:function(a,c){var b=this;if(c=="4"){b.getIndex().down("#article").setValue("346.12");b.nkrfArticle.loadData(Ext.Array.filter(b.defaultArticleStore,function(d){return d.code=="346.12"}))}else{b.nkrfArticle.loadData(b.defaultArticleStore)}}},0,0,0,0,0,0,[LkIp.controller.TaxSystems.Usn,"Statement"],0));(Ext.cmd.derive("LkIp.controller.TaxSystems.Usn.Refuse",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"usnRefuse"}],usnType:"refuse",cache:false,defaultYear:undefined,init:function(){var a=this;a.control({usnRefuse:{activate:function(){if(!this.cache){this.getIndex().setLoading(true)}}},"#usnRefuseForm":{validitychange:a.afterFormValidation},'usnRefuse [name="year"]':{change:a.changeYear},'usnRefuse [name="usnSignButton]':{click:a.submitForm},'usnRefuse [name="usnShowButton]':{click:a.getPdf}});a.callParent()},loadIndex:function(){var a=this,b=LkIp.User.get("head");a.callParent();if(!a.cache){a.noStore=Ext.getStore("usnRefuseNoStore");LkIp.Request.request({url:"/api/usn/getReferenceData",params:{usnType:a.usnType}},function(c){a.noStore.loadData(c.response.no);if(!Ext.isEmpty(b)){a.getIndex().down("#no").setValue(b.SvedUchet["@KodNalOrg"])}a.getIndex().setLoading(false);a.cache=true});a.setDefaultYear()}},afterFormValidation:function(c,e){var d=this,a=d.getIndex().down("#usnSignButton"),b=d.getIndex().down("#usnShowButton");if(e){if(c.fieldIsInvalid){a.disable();b.disable()}else{a.enable();b.enable()}}},setDefaultYear:function(){var d=this,a=d.getIndex().down("#year"),c=new Date(),b=Ext.Date.format(c,"Y");if(Ext.Date.between(c,new Date("1/1/"+b),new Date("1/16/"+b))){d.defaultYear=b}else{d.defaultYear=parseInt(b)+1}a.setValue(d.defaultYear)},changeYear:function(e,h){if(4==(""+h).length){var g=this,c=g.getIndex(),a=c.down("#usnSignButton"),b=c.down("#usnShowButton"),f=c.down("#usnRefuseForm").getForm(),d=c.down("#dateNotification");if(h!=g.defaultYear){d.show();e.addCls("mark-invalid");Ext.get(e.inputId).addCls("mark-invalid-field");f.fieldIsInvalid=true;if(f.isValid()){a.disable();b.disable()}}else{Ext.get(e.inputId).removeCls("mark-invalid-field");d.hide();f.fieldIsInvalid=false;if(f.isValid()){a.enable();b.enable()}}}},submitForm:function(){var d=this,b=d.getIndex(),c=b.down("#usnRefuseForm"),a=c.getForm().getValues();b.setLoading(true);LkIp.Request.request({url:"/api/taxmode/checkUsn",params:{date:a.year+"-01-01"}},function(e){b.setLoading(false);if(e.status==1){d.makeRequest()}else{LkIp.Msg.info(reference.lang.taxSystem.usn.refuse.dateMessage,{rewriteDefaultButtons:true,buttons:[{text:reference.lang.buttons.yes,handler:function(){d.makeRequest();LkIp.Msg.fireEvent("closemessagebox",LkIp.Msg);LkIp.Msg.close()}},{text:reference.lang.buttons.no,handler:function(){LkIp.Msg.fireEvent("closemessagebox",LkIp.Msg);LkIp.Msg.close()}}]})}})},makeRequest:function(){var d=this,b=d.getIndex(),c=b.down("#usnRefuseForm"),a=c.getForm().getValues();a.usnType=d.usnType;if(!Ext.isEmpty(a.phone)){LkIp.User.set("phone",a.phone)}b.setLoading(true);LkIp.Request.request({url:"/api/usn/request",method:"POST",params:a},function(e){d.getController("Viewport").signAction(e,{loader:d.getIndex()})})},getPdf:function(){var d=this,b=d.getIndex(),c=b.down("#usnRefuseForm"),a=c.getForm().getValues();a.usnType=d.usnType;LkIp.Utils.downloadDocument("usnRefuse","/api/usn/pdf",a)}},0,0,0,0,0,0,[LkIp.controller.TaxSystems.Usn,"Refuse"],0));(Ext.cmd.derive("LkIp.controller.TaxSystems.Usn.Change",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"usnChange"}],usnType:"change",cache:false,defaultObject:undefined,init:function(){var a=this;a.control({usnChange:{activate:function(){if(!this.cache){this.getIndex().setLoading(true)}}},'usnChange [name="object"]':{change:a.changeObject},'usnChange [name="usnSignButton]':{click:a.submitForm},'usnChange [name="usnShowButton]':{click:a.getPdf}});a.callParent()},loadIndex:function(){var a=this,b=LkIp.User.get("head");a.callParent();if(!a.cache){a.noStore=Ext.getStore("usnChangeNoStore");a.objectStore=Ext.getStore("usnChangeObjectStore");LkIp.Request.request({url:"/api/usn/getReferenceData",params:{usnType:a.usnType}},function(c){a.noStore.loadData(c.response.no);a.objectStore.loadData(c.response.objects);if(!Ext.isEmpty(b)){a.getIndex().down("#no").setValue(b.SvedUchet["@KodNalOrg"])}if(!Ext.isEmpty(c.response.usnObj)){a.defaultObject=c.response.usnObj;a.getIndex().down("#object").setValue(c.response.usnObj)}a.getIndex().setLoading(false);a.cache=true})}},changeObject:function(a,d){var c=this,b=c.getIndex().down("#objectNotification");if(typeof c.defaultObject!="undefined"){if(d!=c.defaultObject){b.show()}else{b.hide()}}},submitForm:function(){var c=this,a=c.getIndex(),b=a.down("#usnChangeForm");a.setLoading(true);LkIp.Request.request({url:"/api/taxmode/checkUsn",params:{date:(parseInt(Ext.Date.format(new Date(),"Y"))+1)+"-01-01"}},function(d){a.setLoading(false);if(d.status==1){c.makeRequest()}else{LkIp.Msg.info(reference.lang.taxSystem.usn.change.dateMessage,{rewriteDefaultButtons:true,buttons:[{text:reference.lang.buttons.yes,handler:function(){c.makeRequest();LkIp.Msg.fireEvent("closemessagebox",LkIp.Msg);LkIp.Msg.close()}},{text:reference.lang.buttons.no,handler:function(){LkIp.Msg.fireEvent("closemessagebox",LkIp.Msg);LkIp.Msg.close()}}]})}})},makeRequest:function(){var d=this,b=d.getIndex(),c=b.down("#usnChangeForm"),a=c.getForm().getValues();a.usnType=d.usnType;if(!Ext.isEmpty(a.phone)){LkIp.User.set("phone",a.phone)}b.setLoading(true);LkIp.Request.request({url:"/api/usn/request",method:"POST",params:a},function(e){d.getController("Viewport").signAction(e,{loader:d.getIndex()})})},getPdf:function(){var d=this,b=d.getIndex(),c=b.down("#usnChangeForm"),a=c.getForm().getValues();a.usnType=d.usnType;LkIp.Utils.downloadDocument("usnChange","/api/usn/pdf",a)}},0,0,0,0,0,0,[LkIp.controller.TaxSystems.Usn,"Change"],0));(Ext.cmd.derive("LkIp.controller.TaxSystems.Usn.Stop",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"usnStop"}],usnType:"stop",cache:false,defaultArticleStore:undefined,anyReasonChecked:true,init:function(){var a=this;a.control({usnStop:{activate:function(){if(!this.cache){this.getIndex().setLoading(true)}}},'usnStop [name="date"]':{change:a.changeDate},'usnStop [name="usnSignButton]':{click:a.submitForm},'usnStop [name="usnShowButton]':{click:a.getPdf}});a.callParent()},loadIndex:function(){var a=this,b=LkIp.User.get("head");a.callParent();if(!a.cache){a.noStore=Ext.getStore("usnStopNoStore");LkIp.Request.request({url:"/api/usn/getReferenceData",params:{usnType:a.usnType}},function(c){a.noStore.loadData(c.response.no);if(!Ext.isEmpty(b)){a.getIndex().down("#no").setValue(b.SvedUchet["@KodNalOrg"])}a.getIndex().setLoading(false);a.cache=true})}},changeDate:function(c,e){var d=this,a=new Date(),b=d.getIndex().down("#dateNotification");e=Ext.Date.add(e,Ext.Date.DAY,15);if(e<a){b.show()}else{b.hide()}},submitForm:function(){var d=this,b=d.getIndex(),c=b.down("#usnStopForm"),a=c.getForm().getValues();b.setLoading(true);LkIp.Request.request({url:"/api/taxmode/checkUsn",params:{date:a.date}},function(e){b.setLoading(false);if(e.status==1){d.makeRequest()}else{LkIp.Msg.info(reference.lang.taxSystem.usn.stop.dateMessage,{rewriteDefaultButtons:true,buttons:[{text:reference.lang.buttons.yes,handler:function(){d.makeRequest();LkIp.Msg.fireEvent("closemessagebox",LkIp.Msg);LkIp.Msg.close()}},{text:reference.lang.buttons.no,handler:function(){LkIp.Msg.fireEvent("closemessagebox",LkIp.Msg);LkIp.Msg.close()}}]})}})},makeRequest:function(){var d=this,b=d.getIndex(),c=b.down("#usnStopForm"),a=c.getForm().getValues();a.usnType=d.usnType;if(!Ext.isEmpty(a.phone)){LkIp.User.set("phone",a.phone)}b.setLoading(true);LkIp.Request.request({url:"/api/usn/request",method:"POST",params:a},function(e){d.getController("Viewport").signAction(e,{loader:d.getIndex()})})},getPdf:function(){var d=this,b=d.getIndex(),c=b.down("#usnStopForm"),a=c.getForm().getValues();a.usnType=d.usnType;LkIp.Utils.downloadDocument("usnStop","/api/usn/pdf",a)}},0,0,0,0,0,0,[LkIp.controller.TaxSystems.Usn,"Stop"],0));(Ext.cmd.derive("LkIp.store.TaxSystem.Psn.Patent.VehicleCodesStore",LkIp.store.DefaultStore,{model:"LkIp.model.Filters.SelectFilters"},0,0,0,0,0,0,[LkIp.store.TaxSystem.Psn.Patent,"VehicleCodesStore"],0));(Ext.cmd.derive("LkIp.store.TaxSystem.Psn.Patent.PlacementTypeStore",LkIp.store.DefaultStore,{model:"LkIp.model.Filters.SelectFilters"},0,0,0,0,0,0,[LkIp.store.TaxSystem.Psn.Patent,"PlacementTypeStore"],0));(Ext.cmd.derive("LkIp.store.TaxSystem.Psn.Patent.PlacementFeatureStore",LkIp.store.DefaultStore,{model:"LkIp.model.Filters.SelectFilters"},0,0,0,0,0,0,[LkIp.store.TaxSystem.Psn.Patent,"PlacementFeatureStore"],0));(Ext.cmd.derive("LkIp.controller.TaxSystems.Psn.Patent",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"psnPatent"}],models:["Filters.SelectFilters"],vehicleIndex:0,placementIndex:0,addressIndex:0,defaultActivityStore:undefined,pageType:undefined,defaultPlacementFeatureStore:undefined,placementFeatureCode:undefined,defaultPlacementCodeStore:undefined,placementCodeCode:undefined,defaultVehicleStore:undefined,vehicleCode:undefined,regionCode:undefined,regionName:undefined,addressData:[],placementAddressData:[],defaultAddressObject:{region:"",regionName:"",postcode:"",oktmo:"",district:"",city:"",locality:"",street:"",house:"",housing:"",apartment:"",noFromAddress:""},defaultUserAddressObject:{region:"",regionName:"",postcode:"",oktmo:"",district:"",city:"",locality:"",street:"",house:"",housing:"",apartment:"",noFromAddress:""},addressObject:{},psnNo:"",init:function(){this.control({'psnPatent [name="employee"]':{change:this.changeEmployeeFlag},'psnPatent [name="activity"]':{change:this.changeActivity},"psnPatent #addvehicle":{click:this.addVehicle},"psnPatent #removeVehicle":{click:this.removeVehicle},"psnPatent #addplacement":{click:this.addPlacement},"psnPatent #removePlacement":{click:this.removePlacement},"psnPatent #addaddress":{click:this.addAddressBlock},"psnPatent #removeAddress":{click:this.removeAddress},"psnPatent #editAddress":{click:this.editAddress},'psnPatent [name="no"]':{select:this.changeNo},'psnPatent [name="psnPatentSignButton"]':{click:this.submitForm},'psnPatent [name="psnPatentShowButton"]':{click:this.getPdf},'psnPatent [rel="placementCode"]':{changeCode:this.changePlacementCode},"psnPatent #employeeCount":{change:this.changeEmployeeNumber},addressBlock:{addAddress:this.addAddress,addUserAddress:this.addUserAddress,addPlacementAddress:this.addPlacementAddress,checkPlacementExist:this.checkPlacementExist,checkAddressExist:this.checkAddressExist},"psnPatent #editUserAddress":{click:this.editUserAddress}});this.callParent()},loadIndex:function(){var b=this,c=LkIp.User.get("head"),a;b.callParent();a=b.getIndex();if(!b.cache){a.setLoading(true);b.noStore=Ext.getStore("psnPatentNoStore");b.patentEmployee=Ext.getStore("psnPatentEmployeeStore");b.activities=Ext.getStore("psnPatentActivitiesStore");LkIp.Request.request({url:"/api/psn/getReferenceData"},function(d){b.defaultActivityStore=d.response.activities;b.regionStore=d.response.region;b.noStore.loadData(d.response.no);b.psnNo=d.response.psnNo[0];if(!Ext.isEmpty(c)){b.getIndex().down("#no").setValue(c.SvedUchet["@KodNalOrg"]);b.getIndex().down("#no").fireEvent("select",b.getIndex().down("#no"))}b.patentEmployee.loadData(d.response.patentEmployee);b.defaultVehicleStore=d.response.vehicleCode;b.defaultPlacementCodeStore=d.response.placementType;b.defaultPlacementFeatureStore=d.response.placementFeature;a.setLoading(false);b.cache=true})}},getVehicleCodesStore:function(){return this.getStore("TaxSystem.Psn.Patent.VehicleCodesStore")},getPlacementTypeStore:function(){return this.getStore("TaxSystem.Psn.Patent.PlacementTypeStore")},getPlacementFeatureStore:function(){return this.getStore("TaxSystem.Psn.Patent.PlacementFeatureStore")},changeEmployeeFlag:function(a,b){if(b==1){this.enableEmployeeCount()}else{this.disableEmployeeCount()}},changeActivity:function(c,e){this.resetPage();if(e!=0){var d=this,b=c.getStore().findRecord("code",e),a;if(!Ext.isEmpty(b)){a=b.get("type");switch(a){case"10":case"11":case"32":case"33":d.loadVehicleCodeByActivityType(a);d.drawVehiclePage();d.pageType="vehicle";d.setVehicleCode();break;case"19":case"45":case"46":case"47":case"48":d.loadPlacementCodesByActivityType(a);d.loadPlacementFeatureByActivityType(a);d.drawPlacementPage();d.pageType="placement";d.setPlacementFeature();d.setPlacementCode();break;default:d.drawAddressPage();d.pageType="address";break}}}},changeEmployeeNumber:function(b,d){var c=this,a=c.getIndex();if(parseInt(d)>15){a.down("#employeeCountWarning").show()}else{a.down("#employeeCountWarning").hide()}},resetPage:function(){var b=this,a=b.getIndex();Ext.suspendLayouts();a.down("#vehiclePart").hide();a.down("#vehicleContainer").removeAll();a.down("#placementPart").hide();a.down("#placementContainer").removeAll();a.down("#addressPart").hide();a.down("#addressContainer").removeAll();b.vehicleIndex=0;b.placementIndex=0;b.addressIndex=0;b.addressData=[];b.placementAddressData=[];b.pageType=undefined;Ext.resumeLayouts(true)},drawVehiclePage:function(){var a=this;a.addVehicle()},drawPlacementPage:function(){var a=this;Ext.suspendLayouts();a.addPlacement();Ext.resumeLayouts(true)},drawAddressPage:function(){var b=this,a=b.getIndex();Ext.suspendLayouts();a.down("#addressPart").show();Ext.resumeLayouts(true)},addAddressBlock:function(){var b=this,a=b.getIndex();b.addressData[b.addressIndex]=b.defaultAddressObject;a.down("#addressContainer").add(a.getAddressFields(b.addressIndex,""));b.editAddress(a.down("#addressDescription"+b.addressIndex));b.validateForm();++b.addressIndex},editAddress:function(a){var b=this,c=b.getAddressDataById(a.index,a.placement);if(!a.placement||a.required){c.no=b.getIndex().down("#no").getValue()}Ext.create("LkIp.view.AddressBlock",{data:c,oktmoRequired:false,hideOktmo:true,closable:a.placement?true:false,event:a.placement?"addPlacementAddress":"addAddress",checkExistEvent:a.placement?undefined:"checkAddressExist",insertId:a.index,selectRegion:a.placement&&!a.required}).show()},editUserAddress:function(c){var b=Ext.clone(this.defaultUserAddressObject);Ext.create("LkIp.view.AddressBlock",{data:b,oktmoRequired:false,event:"addUserAddress",checkExistEvent:undefined,hideOktmo:true,selectRegion:true}).show()},checkAddressExist:function(d,b){var c=Ext.Array.filter(this.addressData,function(f,e){return f.addressString==b&&d!=e}),a=c==0;if(!a){LkIp.Msg.error(reference.lang.taxSystem.psn.patent.addressError)}return a},removeAddressById:function(b){var a=this;a.addressData.splice(b,1)},getAddressDataById:function(c,a){var b=this;return a?b.placementAddressData[c]:b.addressData[c]},addAddress:function(a,b){var c=this;c.addressData[b]=a;c.getIndex().down("#addressString"+b).update(a.addressString)},addUserAddress:function(a,b){var c=this;c.addressObject=a;c.defaultUserAddressObject=a;c.getIndex().down("#userAddressString").update(a.addressString)},addPlacementAddress:function(a,b){var c=this;c.placementAddressData[b]=a;if(c.getIndex().down("#addressDescription"+b).isHidden()){c.getIndex().down("#addressDescription"+b).show();c.getIndex().down("#addAdressBtn"+b).hide()}c.getIndex().down("#address"+b).down("#addressString"+b).update(a.addressString)},addPlacement:function(){var b=this,a=b.getIndex();a.down("#placementPart").show();a.down("#placementContainer").add(a.getPlacementFields(b.placementIndex));b.placementAddressData[b.placementIndex]=b.defaultAddressObject;++b.placementIndex;b.setRegion(a.down("#no").getValue().substring(0,2));b.setPlacementFeature();b.setPlacementCode()},changePlacementCode:function(b,d){var c=this,a=c.getIndex();a.down("#address"+b.index).removeAll();if(d){if(Ext.isEmpty(c.placementAddressData[b.index])){c.placementAddressData[b.index]=c.defaultAddressObject}a.down("#address"+b.index).add(a.getAddressFields(b.index,c.placementAddressData[b.index].addressString,true,true));if(!b.addressRequired){a.down("#addressLabel"+b.index).hide()}else{a.down("#addressLabel"+b.index).show()}}else{c.placementAddressData.splice(b.index,1);a.down("#address"+b.index).add({xtype:"button",text:reference.lang.taxSystem.psn.patent.address.add,itemId:"addAdressBtn"+b.index,handler:function(){Ext.create("LkIp.view.AddressBlock",{data:{},oktmoRequired:false,hideOktmo:true,closable:true,event:"addPlacementAddress",checkExistEvent:undefined,insertId:b.index,selectRegion:true}).show();a.down("#address"+b.index).add(a.getAddressFields(b.index,"",true,false));a.down("#addressLabel"+b.index).hide();a.down("#addressDescription"+b.index).hide()}})}},addVehicle:function(){var b=this,a=b.getIndex();a.down("#vehiclePart").show();a.down("#vehicleContainer").add(a.getVehicleFields(b.vehicleIndex));++b.vehicleIndex;b.setVehicleCode()},removeVehicle:function(a){var b=this;Ext.suspendLayouts();b.getIndex().down("#vehicleContainer").remove(a.idBlock);b.validateForm();Ext.resumeLayouts(true);--b.vehicleIndex},removePlacement:function(a){var b=this;Ext.suspendLayouts();b.getIndex().down("#placementContainer").remove(a.idBlock);b.validateForm();Ext.resumeLayouts(true);--b.placementIndex},removeAddress:function(b){var c=this,a=c.getIndex();Ext.suspendLayouts();a.down(b.placement?"#address"+b.index:"#addressContainer").remove(b.idBlock);if(b.placement){a.down("#addAdressBtn"+b.index).show();c.placementAddressData.splice(b.index,1)}else{c.removeAddressById(b.index);--c.addressIndex}c.validateForm();Ext.resumeLayouts(true)},submitForm:function(){var d=this,b=d.getIndex(),a=d.getValuesFromForm(),c=["02","03","27","43","77","86"];b.setLoading(true);d.successCallback=function(){LkIp.Msg.success(reference.lang.signature.successDefault);if(b.down("#phone").getValue()){LkIp.User.set("phone",b.down("#phone").getValue())}};LkIp.Request.request({url:"/api/psn/request",method:"POST",params:a},function(e){d.getController("Viewport").signAction(e,{loader:d.getIndex(),gp3:c.indexOf(a.no.substring(0,2))>=0})})},getValuesFromForm:function(){var c=this,b=c.getIndex().down("#psnPatentForm"),a=b.getForm().getValues();switch(c.pageType){case"address":a=Ext.Object.merge(a,c.generateAddressValues());break;case"placement":a=Ext.Object.merge(a,c.generatePlacementAddressValues());break}a.psnType="patent";a.pageType=c.pageType;a.userAddress=Ext.JSON.encode(c.addressObject);a.patentNo=c.psnNo;return a},generatePlacementAddressValues:function(){var b=this,a={};Ext.Array.each(b.placementAddressData,function(c,d){Ext.Object.each(c,function(e,f){a["placement["+d+"][address]["+e+"]"]=f})});return a},generateAddressValues:function(){var b=this,a={};Ext.Array.each(b.addressData,function(c,d){Ext.Object.each(c,function(e,f){a["address["+d+"]["+e+"]"]=f})});return a},getPdf:function(){var b=this,a=b.getValuesFromForm();LkIp.Utils.downloadDocument("psnPatent","/api/psn/pdf",a)},enableEmployeeCount:function(){this.getIndex().down("#employeeCount").enable().show();this.validateForm()},disableEmployeeCount:function(){this.getIndex().down("#employeeCount").disable().hide().reset();this.validateForm()},validateForm:function(){this.getIndex().down("#psnPatentForm").getForm().checkValidity()},setRegion:function(b){var f=this,e=0,d=0,c=f.getIndex(),a=Ext.Array.findBy(f.regionStore,function(g){return g.code==b});if(!Ext.isEmpty(a)&&b!=f.regionCode){f.regionCode=b;f.regionName=b+" - "+a.value;c.down("#linkToNalogActivities").update({regionCode:b});Ext.suspendLayouts();if("address"==f.pageType){f.resetAllAddresses()}else{if("placement"==f.pageType){f.resetAllAddressesInPlacement()}}Ext.resumeLayouts(true);f.addressData=[];f.placementAddressData=[];f.setAddressDefaults()}},resetAllAddressesInPlacement:function(){var c=this,b=0,d,a=c.getIndex();Ext.suspendLayouts();for(;b<c.placementIndex;b++){d=a.down("#placementCode"+b);if(d.getValue()!==0){c.changePlacementCode(d,d.addressRequired)}}Ext.resumeLayouts(true)},resetAllAddresses:function(){var b=this,a=b.getIndex();a.down("#addressContainer").removeAll();b.addressData=[];b.addressIndex=0},setAddressDefaults:function(){var a=this;a.defaultAddressObject.region=a.regionCode;a.defaultAddressObject.regionName=a.regionName;a.getIndex().setLoading(true);LkIp.Request.request({url:"/api/filters/getOktmoByRegion",params:{regionCode:a.regionCode}},function(b){a.getIndex().setLoading(false);a.defaultAddressObject.noFromAddress=b.response[0].codeNo;a.defaultAddressObject.addressString=a.regionName})},changeNo:function(b,a){var c=this,d=b.getValue(),e;if(!LkIp.Utils.isEmpty(d)){e=d.substring(0,2);c.setRegion(e);c.loadActivityStoreByRegionCode(e)}},loadActivityStoreByRegionCode:function(a){var b=this;b.getIndex().down("#activity").reset();b.activities.loadData(Ext.Array.filter(b.defaultActivityStore,function(c){return c.regionCode==a}))},placementCodes:{"19":["05","06","07","08"],"45":["09","10"],"46":["11","12","13","14","15","16","17","18","19","20","21","22"],"47":["23","24","25","26","27","28"],"48":["29"]},placementFeatures:{"19":["1"],"45":["2","3"],"46":["4"],"47":["5","6"],"48":["7"]},vehicleCodes:{"10":"01","33":"04","11":"02","32":"03"},setPlacementFeature:function(){var b=this,a=b.placementIndex-1;if(typeof b.placementFeatureCode!="undefined"){b.getIndex().down("#placementFeature"+a).setValue(b.placementFeatureCode)}},setPlacementCode:function(){var b=this,a=b.placementIndex-1;if(typeof b.placementCodeCode!="undefined"){b.getIndex().down("#placementCode"+a).setValue(b.placementCodeCode)}else{b.getIndex().down("#placementCode"+a).getStore().clearFilter(true)}},setVehicleCode:function(){var b=this,a=b.vehicleIndex-1;if(typeof b.vehicleCode!="undefined"){b.getIndex().down("#vehicleCode"+a).setValue(b.vehicleCode)}},loadVehicleCodeByActivityType:function(a){var c=this,b=c.vehicleCodes[a],d=Ext.Array.filter(c.defaultVehicleStore,function(e){return b==(e.code+"")});c.getVehicleCodesStore().loadData(d);if(d.length==1){c.vehicleCode=d[0].code}else{c.vehicleCode=undefined}},loadPlacementCodesByActivityType:function(a){var c=this,b=c.placementCodes[a],d=Ext.Array.filter(c.defaultPlacementCodeStore,function(e){return Ext.Array.contains(b,e.code+"")});c.getPlacementTypeStore().loadData(d);if(d.length==1){c.placementCodeCode=d[0].code}else{c.placementCodeCode=undefined}},loadPlacementFeatureByActivityType:function(a){var c=this,b=c.placementFeatures[a],d=Ext.Array.filter(c.defaultPlacementFeatureStore,function(e){return Ext.Array.contains(b,e.code+"")});c.getPlacementFeatureStore().loadData(d);if(d.length==1){c.placementFeatureCode=d[0].code}else{c.placementFeatureCode=undefined}}},0,0,0,0,0,0,[LkIp.controller.TaxSystems.Psn,"Patent"],0));(Ext.cmd.derive("LkIp.store.TaxSystem.Psn.Orn.CodeNoStore",LkIp.store.DefaultStore,{model:"LkIp.model.Filters.SelectFilters"},0,0,0,0,0,0,[LkIp.store.TaxSystem.Psn.Orn,"CodeNoStore"],0));(Ext.cmd.derive("LkIp.controller.TaxSystems.Psn.Orn",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"psnOrn"}],models:["Filters.SelectFilters","TaxSystems.Psn.Grid"],patentActivityIndex:0,patentOriginalInformation:[],canSendPatent:true,selectedPatentsAreValid:true,getNoStore:function(){return this.getStore("TaxSystem.Psn.Orn.CodeNoStore")},init:function(){this.control({psnOrn:{deactivate:this.deactivateView},"psnOrn #addPatentActivity":{click:this.addPatent},"psnOrn #no":{change:this.changeNo},'psnOrn [name="psnOrnSignButton"]':{click:this.submitForm},'psnOrn [name="psnOrnShowButton"]':{click:this.getPdf},"psnOrn #psnOrnForm":{validitychange:this.validateFormEvent},"psnOrn psnOrnGrid":{selectionchange:this.changeSelectionOfGrid},"#patentNumberColumn":{change:this.changePatentNumberField}});this.callParent()},loadIndex:function(){var b=this,c=LkIp.User.get("head"),a;b.callParent();a=b.getIndex();if(!b.cache){a.setLoading(true);b.noStore=Ext.getStore("psnOrnNoStore");LkIp.Request.request({url:"/api/psn/getReferenceData",params:{psnType:"orn"}},function(d){if(!Ext.isEmpty(d.response.no)){b.noStore.loadData(d.response.no);b.getNoStore().loadData(d.response.no);b.patentOriginalInformation=d.response.patentInformation;if(!Ext.isEmpty(c)){b.getIndex().down("#no").setValue(c.SvedUchet["@KodNalOrg"])}b.cache=true}else{b.canSendPatent=false;LkIp.Msg.info(reference.lang.taxSystem.psn.orn.noPatent);b.disableEverything()}a.setLoading(false)})}},deactivateView:function(){var b=this,a=b.getIndex();Ext.suspendLayouts();a.down("#addPatentActivity").enable();a.down("#noDataInfo").hide();Ext.resumeLayouts(true)},disableEverything:function(){var b=this,a=b.getIndex();Ext.suspendLayouts();a.down("#addPatentActivity").disable();a.down("#noDataInfo").show();Ext.resumeLayouts(true)},submitForm:function(){var e=this,c=e.getIndex(),b=c.down("#psnOrnForm").getForm().getValues(),a=e.getIndex().down("#psnOrnGrid").getSelectionModel().getSelection(),d=["02","03","27","43","77","86"];if(!e.selectedPatentsAreValid){LkIp.Msg.info(reference.lang.taxSystem.psn.orn.patentError);return false}if(e.canSendPatent){if(!Ext.isEmpty(a)){b=Ext.Object.merge(b,e.getDataFromGrid(a))}b.psnType="orn";c.setLoading(true);LkIp.Request.request({url:"/api/psn/request",method:"POST",params:b},function(f){e.getController("Viewport").signAction(f,{loader:e.getIndex(),gp3:d.indexOf(b.no.substring(0,2))>=0})})}},getPdf:function(){var d=this,c=d.getIndex(),b=c.down("#psnOrnForm").getForm().getValues(),a=d.getIndex().down("#psnOrnGrid").getSelectionModel().getSelection();if(!d.selectedPatentsAreValid){LkIp.Msg.info(reference.lang.taxSystem.psn.orn.patentError);return false}if(d.canSendPatent){if(!Ext.isEmpty(a)){b=Ext.Object.merge(b,d.getDataFromGrid(a))}b.psnType="orn";LkIp.Utils.downloadDocument("psnOrn","/api/psn/pdf",b)}},getDataFromGrid:function(b){var c=this,a={};Ext.Array.each(b,function(e,d){var f=e.getData();a[c.generateName("number",d)]=f["@NomerPt"];a[c.generateName("date_from",d)]=f["@DataNach"];a[c.generateName("date_to",d)]=f["@DataKon"]});return a},generateName:function(b,a){return"patentActivity["+a+"]["+b+"]"},validateForm:function(){this.getIndex().down("#psnOrnForm").getForm().checkValidity()},addPatent:function(){var b=this,a=b.getIndex(),c=a.down("#no").getValue();Ext.suspendLayouts();a.down("#addPatentActivity").hide();a.down("#patentActivities").show();Ext.resumeLayouts(true);Ext.getStore("psnOrnGridStore").loadData(b.getGridValuesByCodeNo(c))},validateFormEvent:function(c,b){var a=this;return b&&a.canSendPatent},getGridValuesByCodeNo:function(b){var a=this;return Ext.Array.filter(a.patentOriginalInformation,function(c){return c["@KodNalOrg"]==b})},changeNo:function(b,d){var c=this,a=c.getIndex();if(a.down("#addPatentActivity").isHidden()){a.down("#psnOrnGrid").getSelectionModel().deselectAll();Ext.getStore("psnOrnGridStore").loadData(c.getGridValuesByCodeNo(d))}},changeSelectionOfGrid:function(c,a){var b=this;b.selectedPatentsAreValid=b.checkPatentActivities(a);b.validateForm()},checkPatentActivities:function(e){var d=this,b=0,a=e.length,c=true,g=d.getIndex().down("#patentNumberError"),f=d.getIndex().down("#patentNumberCheck");for(;b<a;b++){if(Ext.isEmpty(e[b].get("patentNumber"))){c=false;break}}Ext.suspendLayouts();if(!c){g.show();f.enable()}else{g.hide();f.disable()}d.validateForm();Ext.resumeLayouts(true);return c},changePatentNumberField:function(b,d){var c=this,a=c.getIndex().down("psnOrnGrid").getSelectionModel();b.record.data.patentNumber=d;b.record.data["@NomerPt"]=d;c.changeSelectionOfGrid(a,a.getSelection());c.validateForm()}},0,0,0,0,0,0,[LkIp.controller.TaxSystems.Psn,"Orn"],0));(Ext.cmd.derive("LkIp.controller.TaxSystems.Psn.Stop",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"psnStop"}],psnType:"stop",cache:false,defaultNo:undefined,patentInformation:[],init:function(){var a=this;a.control({psnStop:{activate:function(){if(!this.cache){this.getIndex().setLoading(true)}}},'psnStop [name="date"]':{change:a.changeDate},'psnStop [name="no"]':{select:a.changeNo},'psnStop [name="psnSignButton]':{click:a.submitForm},'psnStop [name="psnShowButton]':{click:a.getPdf}});a.callParent()},loadIndex:function(){var a=this,b=LkIp.User.get("head");a.callParent();if(!a.cache){a.noStore=Ext.getStore("psnStopNoStore");a.patentStore=Ext.getStore("psnStopPatentStore");LkIp.Request.request({url:"/api/psn/getReferenceData",params:{psnType:a.psnType}},function(c){a.noStore.loadData(c.response.no);a.patentInformation=c.response.patentInformation;if(!Ext.isEmpty(b)){a.defaultNo=b.SvedUchet["@KodNalOrg"];a.getIndex().down("#no").setValue(b.SvedUchet["@KodNalOrg"]);a.changeNo()}a.getIndex().setLoading(false);a.cache=true})}},changeDate:function(c,e){if(!Ext.isEmpty(e)){var d=this,a=new Date(),b=d.getIndex().down("#dateNotification");e=Ext.Date.add(e,Ext.Date.DAY,10);if(e<a){b.show()}else{b.hide()}}},changeNo:function(){var b=this,a=b.getIndex();if(a.down("#no").getValue()==0){return}a.down("#patentNumber").reset();a.down("#patentNumber").enable();b.patentStore.loadData(Ext.Array.filter(b.patentInformation,function(c){return c.no==a.down("#no").getValue()}))},submitForm:function(){var e=this,b=e.getIndex(),c=b.down("#psnStopForm"),a=c.getForm().getValues(),d=["02","03","27","43","77","86"];a.psnType=e.psnType;if(!Ext.isEmpty(a.phone)){LkIp.User.set("phone",a.phone)}b.setLoading(true);LkIp.Request.request({url:"/api/psn/request",method:"POST",params:a},function(f){e.getController("Viewport").signAction(f,{loader:e.getIndex(),gp3:d.indexOf(a.no.substring(0,2))>=0});c.getForm().reset();if(typeof e.defaultNo!="undefined"){e.getIndex().down("#no").setValue(e.defaultNo)}})},getPdf:function(){var d=this,b=d.getIndex(),c=b.down("#psnStopForm"),a=c.getForm().getValues();a.psnType=d.psnType;LkIp.Utils.downloadDocument("psnStop","/api/psn/pdf",a)}},0,0,0,0,0,0,[LkIp.controller.TaxSystems.Psn,"Stop"],0));(Ext.cmd.derive("LkIp.controller.Address",Ext.app.Controller,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"addressBlock"}],models:["Address.SelectFilters"],districtStore:undefined,regionStore:undefined,cityStore:undefined,localityStore:undefined,streetStore:undefined,districtLoaded:true,cityLoaded:true,streetLoaded:true,localityLoaded:true,loaderIsDisabled:false,noFromAddress:undefined,specialRegions:["77","78","92","99"],oktmoArray:[],selectedType:true,init:function(){var a=this;this.control({addressBlock:{show:a.showBlock,close:a.closeBlock},"addressBlock #region":{select:a.selectRegion,blur:function(b){if(b.getValue()!=0&&b.getValue()==b.getRawValue()){b.reset();b.fireEvent("select",b,"")}}},"addressBlock #district":{select:a.selectDistrict,blur:function(b){if(b.getValue()!=0&&b.getValue()==b.getRawValue()){b.reset();b.fireEvent("select",b,"")}}},"addressBlock #city":{select:a.selectCity,blur:function(b){if(b.getValue()!=0&&b.getValue()==b.getRawValue()){b.reset();b.fireEvent("select",b,"")}}},"addressBlock #locality":{select:a.selectLocality,blur:function(b){if(b.getValue()!=0&&b.getValue()==b.getRawValue()){b.reset();b.fireEvent("select",b,"")}}},"addressBlock #street":{select:a.selectStreet,blur:function(b){if(b.getValue()!=0&&b.getValue()==b.getRawValue()){b.reset();b.fireEvent("select",b,"")}}},"addressBlock #house":{blur:a.selectedHouse},"addressBlock #housing":{blur:a.selectedHousing},'addressBlock [name="saveAddress"]':{click:a.saveAddress},'addressBlock [name="closeAddress"]':{click:a.closeAddress},'addressBlock [rel="checkValidity"]':{change:a.checkFormValidity}})},showBlock:function(){var b=this,c=b.getDataFromView(),a=b.getIndex();b.regionStore=Ext.getStore("addressRegionStore");b.districtStore=Ext.getStore("addressDistrictStore");b.cityStore=Ext.getStore("addressCityStore");b.localityStore=Ext.getStore("addressLocalityStore");b.streetStore=Ext.getStore("addressStreetStore");a.setLoading(true);LkIp.Request.request("/api/filters/getRegions",function(d){if(!Ext.isEmpty(b.regionStore)){b.regionStore.loadData(d.response);if(!Ext.isEmpty(c.region)){a.down("#region").setValue(c.region)}}if(!Ext.isEmpty(c)){b.parseInnerData();if(a.hasCustomAddressField){a.down("#custom_address").setValue(c.custom_address)}}})},parseInnerData:function(){var b=this,c=b.getDataFromView();var a=new Ext.util.DelayedTask(function(){b.getIndex().setLoading(true);if(!LkIp.Utils.isEmpty(c.street)){b.loadByType("street")}else{if(!LkIp.Utils.isEmpty(c.locality)){b.loadByType("locality")}else{if(!LkIp.Utils.isEmpty(c.city)){b.loadByType("city")}else{if(!LkIp.Utils.isEmpty(c.district)){b.loadByType("district")}else{if(!LkIp.Utils.isEmpty(c.region)){b.loadByRegion()}else{b.getIndex().setLoading(false)}}}}}});a.delay(100)},loadByType:function(b){var c=this,a=c.getIndex(),d=c.getDataFromView();a.setLoading(true);LkIp.Request.request({url:"/api/filters/loadFromKladr",params:{type:b,value:d.classification_code,region:d.region}},function(e){switch(b){case"street":c.districtStore.loadData(e.response.district);c.cityStore.loadData(e.response.city);c.localityStore.loadData(e.response.locality);c.streetStore.loadData(e.response.street);break;case"locality":c.districtStore.loadData(e.response.district);c.cityStore.loadData(e.response.city);c.localityStore.loadData(e.response.locality);break;case"city":c.districtStore.loadData(e.response.district);c.cityStore.loadData(e.response.city);break;case"district":c.districtStore.loadData(e.response.district);break}c.selectFields(b);a.setLoading(false)})},selectFields:function(b){var c=this,a=c.getIndex(),d=c.getDataFromView();Ext.suspendLayouts();c.updateOkato(d.oktmo);switch(b){case"street":if(!LkIp.Utils.isEmpty(d.district)){c.selectField("district",d.district,true)}if(!LkIp.Utils.isEmpty(d.city)){c.selectField("city",d.city,true)}if(!LkIp.Utils.isEmpty(d.locality)){c.selectField("locality",d.locality,true)}c.selectField("street",d.street);break;case"locality":if(!LkIp.Utils.isEmpty(d.district)){c.selectField("district",d.district,true)}if(!LkIp.Utils.isEmpty(d.city)){c.selectField("city",d.city,true)}c.selectField("locality",d.locality);break;case"city":if(!LkIp.Utils.isEmpty(d.district)){c.selectField("district",d.district,true)}c.selectField("city",d.city);break;case"district":c.selectField("district",d.district);break}if(!LkIp.Utils.isEmpty(d.house)){a.down("#house").setValue(d.house)}if(!LkIp.Utils.isEmpty(d.housing)){a.down("#housing").setValue(d.housing)}if(!LkIp.Utils.isEmpty(d.apartment)){a.down("#apartment").setValue(d.apartment)}if(!LkIp.Utils.isEmpty(d.postcode)){a.down("#postcode").setValue(d.postcode)}if(!LkIp.Utils.isEmpty(d.noFromAddress)){c.updateNoFromAddress(d.noFromAddress)}Ext.resumeLayouts(true)},selectField:function(f,e,b){var d=this,c=d.getIndex().down("#"+f),a=c.findRecord("value",e);b=b||false;if(a){c.select(a);if(!b){c.fireEvent("select",c,a)}}},loadByRegion:function(){var a=this,b=a.getDataFromView();a.districtLoaded=false;a.cityLoaded=false;a.getIndex().setLoading(true);a.loadDistricts();a.loadCities();a.loadLocalities();if(Ext.Array.contains(a.specialRegions,b.region)){a.streetLoaded=false;a.loadStreets()}a.selectFields("region")},closeBlock:function(){var a=this;if(!Ext.isEmpty(a.regionStore)){a.regionStore.removeAll()}a.districtStore.removeAll();a.cityStore.removeAll();a.streetStore.removeAll();a.localityStore.removeAll();a.getIndex().down("#district").reset()},loadDistricts:function(){this.loadData("district")},selectDistrict:function(b,a){var c=this;a=c.getRecord(a);c.cityStore.removeAll();c.localityStore.removeAll();c.streetStore.removeAll();if(!Ext.isEmpty(a)){c.cityLoaded=false;c.localityLoaded=false;c.getIndex().setLoading(true);c.loadCities();c.loadLocalities();c.updateOkato(a);c.updateNoFromAddress(a);c.updatePostcode(a);c.streetStore.removeAll();if(Ext.Array.contains(c.specialRegions,c.getRegionCode())){c.streetLoaded=false;c.loadStreets()}}c.checkFormValidity()},selectRegion:function(b,a){var c=this;a=c.getRecord(a);c.districtStore.removeAll();c.cityStore.removeAll();c.localityStore.removeAll();c.streetStore.removeAll();if(!Ext.isEmpty(a)){c.districtLoaded=false;c.cityLoaded=false;c.localityLoaded=false;c.selectedType="region";c.getIndex().setLoading(true);c.loadDistricts();c.loadCities();c.loadLocalities();if(a.get("code")=="77"||a.get("code")=="78"||a.get("code")=="92"){c.streetLoaded=false;c.loadStreets()}}c.checkFormValidity()},selectCity:function(c,a){var d=this,b=d.getIndex();a=d.getRecord(a);d.localityStore.removeAll();d.streetStore.removeAll();if(!Ext.isEmpty(a)){b.setLoading(true);d.localityLoaded=false;d.streetLoaded=false;d.selectedType="city";d.loadLocalities();d.loadStreets();d.updateOkato(a);d.updateNoFromAddress(a);d.updatePostcode(a)}d.checkFormValidity()},selectLocality:function(b,a){var c=this;a=c.getRecord(a);c.streetStore.removeAll();if(!Ext.isEmpty(a)){c.streetStore.removeAll();c.getIndex().setLoading(true);c.selectedType="locality";c.streetLoaded=false;c.loadStreets();c.updateOkato(a);c.updateNoFromAddress(a);c.updatePostcode(a)}c.checkFormValidity()},selectStreet:function(b,a){var c=this;a=c.getRecord(a);c.selectedType="street";c.updateOkato(a);c.updateNoFromAddress(a);c.updatePostcode(a);c.checkFormValidity()},selectedHouse:function(b){var d=this,f=b.getValue(),e=d.getIndex().down("#housing").getValue(),c=d.getIndex().down("#street").getValue(),a=d.streetStore;if(!d.getIndex().hideOktmo){if(LkIp.Utils.isEmpty(c)){c=d.getIndex().down("#locality").getValue();a=d.localityStore}if(LkIp.Utils.isEmpty(f)){d.updateOkato(a.getAt(a.findExact("code",c)))}else{if(!LkIp.Utils.isEmpty(e)){f+="/"+e}d.getIndex().setLoading(true);LkIp.Request.request({url:"/api/filters/getOkatoByHouse",params:{house:f,code:c}},function(g){d.getIndex().setLoading(false);if(!Ext.isEmpty(g.response)){d.updateOkato(g.response[0].ocatd)}})}}},selectedHousing:function(a){var d=this,e=a.getValue(),c=d.getIndex().down("#house").getValue(),b=d.getIndex().down("#street").getValue();if(!d.getIndex().hideOktmo){if(LkIp.Utils.isEmpty(b)){b=d.getIndex().down("#locality").getValue()}if(LkIp.Utils.isEmpty(e)){return d.selectedHouse(d.getIndex().down("#house"))}else{e=c+"/"+e;d.getIndex().setLoading(true);LkIp.Request.request({url:"/api/filters/getOkatoByHouse",params:{house:e,code:b}},function(f){d.getIndex().setLoading(false);if(!Ext.isEmpty(f.response)){d.updateOkato(f.response[0].ocatd)}})}}},updateNoFromAddress:function(a){var b=this;b.noFromAddress=(!a||Ext.isEmpty(a))?"":(Ext.isString(a)?a:a.get("codeNo"))},updateOkato:function(b){var e=this,a=Ext.isString(b)?b:(Ext.isObject(b)?b.get("ocatd"):""),d=(Ext.isString(b)||Ext.Object.isEmpty(b))?null:b.get("code"),c=e.getIndex().down("#oktmo");if(LkIp.Utils.isEmpty(a)){a=e.getOkatoFrom()}if(LkIp.Utils.isEmpty(a)){a=e.oktmoArray[e.oktmoArray.length-1]}else{e.oktmoArray.push(a)}c.setValue(a)},getOkatoFrom:function(){var g=this,d=g.getIndex(),i=!LkIp.Utils.isEmpty(d.down("#street").getValue()),e=!LkIp.Utils.isEmpty(d.down("#locality").getValue()),f=!LkIp.Utils.isEmpty(d.down("#city").getValue()),a=!LkIp.Utils.isEmpty(d.down("#district").getValue()),c=false,h,b;switch(true){case i:c=true;h="street";break;case e:c=true;h="locality";break;case f:c=true;h="city";break;case a:c=true;h="district";break}if(c){b=d.down("#"+h).findRecordByValue(d.down("#"+h).getValue());return LkIp.Utils.isEmpty(b.get("ocatd"))?"":b.get("ocatd")}else{return""}},updatePostcode:function(a){var c=this,b=Ext.isString(a)?a:(LkIp.Utils.isEmpty(a.get("index"))?"":a.get("index"));c.getIndex().down("#postcode").setValue(b)},checkForSomethingEdited:function(){var c=this,b=c.getAddressValues(),d=c.getDataFromView(),a=true;Ext.Object.each(b,function(e,f){a=f==d[e];if(false===a){return}});return !a},checkFormValidity:function(){var c=this,b=c.getIndex().down("#saveAddress"),d=c.getIndex().down("#region").getValue(),a=c.checkForSomethingEdited();Ext.suspendLayouts();if(c.getIndex().buttonCheck&&!c.getIndex().selectRegion){if(a){b.enable()}else{b.disable()}}Ext.resumeLayouts(true)},getAddressValues:function(){var c=this,b=c.getIndex(),a=b.down("#addressForm").getForm().getValues(),d=c.generateAddressString(a);a=c.getRawFormValues(a);a.addressString=d;if(b.hasCustomAddressField){a.custom_address=b.down("#custom_address").getValue()}return a},saveAddress:function(){var c=this,b=c.getIndex(),a=c.getAddressValues(),d=c.getDataFromView();a.classification_code=c.generateClassificationCode(c.selectedType);if(b.isKkt){c.applyAddress(a)}else{if(Ext.isEmpty(d.addressString)||d.addressString!=a.addressString||!Ext.isEmpty(a.custom_address)){if(b.checkNo&&!Ext.isEmpty(d.no)&&!Ext.isEmpty(c.noFromAddress)&&d.no!=c.noFromAddress){LkIp.Msg.info(new Ext.XTemplate(reference.lang.address.noException).apply({no:d.no,noFromAddress:c.noFromAddress}),{rewriteDefaultButtons:true,buttons:[{text:reference.lang.buttons.ok,handler:function(e){this.close();c.applyAddress(a)}}]})}else{c.applyAddress(a)}}else{b.close()}}},applyAddress:function(b){var d=this,c=d.getIndex(),a=c.event;if(!Ext.isEmpty(c.checkExistEvent)){if(c.fireEvent(c.checkExistEvent,c.insertId,b.addressString)){d.fireCustomAddressEventAfterSave(a,b)}}else{d.fireCustomAddressEventAfterSave(a,b)}},fireCustomAddressEventAfterSave:function(d,a){var c=this,b=c.getIndex();b.fireEvent(d,a,b.insertId);b.close()},getRawFormValues:function(b){var d=this.getIndex(),a={},e=["region","district","house","housing","locality","oktmo","city","apartment","postcode","street","regionName","noFromAddress"],c;Ext.Object.each(b,function(f,g){if(Ext.Array.contains(e,f)){if(LkIp.Utils.isEmpty(g)){a[f]=""}else{if("district"==f||"locality"==f||"city"==f||"street"==f){a[f]=d.down('[name="'+f+'"]').getRawValue()}else{a[f]=g}}}});a.noFromAddress=this.noFromAddress;return a},generateAddressString:function(b){var f=this,d=f.getIndex(),e=[],c,a="";if(!Ext.isEmpty(b.region)){a=b.region+"-"}if(d.selectRegion){if(!LkIp.Utils.isEmpty(b.region)){c=d.down("#region").findRecordByValue(b.region);e.push(a+c.get("value"))}}else{if(!LkIp.Utils.isEmpty(b.regionName)){e.push(a+b.regionName)}}if(!LkIp.Utils.isEmpty(b.postcode)){e.push(b.postcode)}if(!LkIp.Utils.isEmpty(b.district)){c=d.down("#district").findRecordByValue(b.district);e.push(c.get("value"))}if(!LkIp.Utils.isEmpty(b.city)){c=d.down("#city").findRecordByValue(b.city);e.push(c.get("value"))}if(!LkIp.Utils.isEmpty(b.locality)){c=d.down("#locality").findRecordByValue(b.locality);e.push(c.get("value"))}if(!LkIp.Utils.isEmpty(b.street)){c=d.down("#street").findRecordByValue(b.street);e.push(c.get("value"))}if(!LkIp.Utils.isEmpty(b.house)){var g="\u0434. "+b.house;if(!LkIp.Utils.isEmpty(b.housing)){g+="/"+b.housing}e.push(g)}if(!LkIp.Utils.isEmpty(b.apartment)){e.push("\u043a\u0432. "+b.apartment)}if(!LkIp.Utils.isEmpty(b.oktmo)&&false===d.hideOktmo){e.push("\u041e\u041a\u0422\u041c\u041e "+b.oktmo)}return e.join(", ")},generateAddressStringFromRaw:function(a){var c=[],d=this,b=d.getIndex();if(!LkIp.Utils.isEmpty(a.region)){c.push(b.down("#region").getRawValue())}if(!LkIp.Utils.isEmpty(a.postcode)){c.push(a.postcode)}if(!LkIp.Utils.isEmpty(a.district)){c.push(a.district)}if(!LkIp.Utils.isEmpty(a.city)){c.push(a.city)}if(!LkIp.Utils.isEmpty(a.locality)){c.push(a.locality)}if(!LkIp.Utils.isEmpty(a.street)){c.push(a.street)}if(!LkIp.Utils.isEmpty(a.house)){var e="\u0434. "+a.house;if(!LkIp.Utils.isEmpty(a.housing)){e+="/"+a.housing}c.push(e)}if(!LkIp.Utils.isEmpty(a.apartment)){c.push("\u043a\u0432. "+a.apartment)}if(!LkIp.Utils.isEmpty(a.oktmo)&&false===b.hideOktmo){c.push("\u041e\u041a\u0422\u041c\u041e "+a.oktmo)}return c.join(", ")},loadCities:function(){this.loadData("city")},loadStreets:function(){this.loadData("street")},loadLocalities:function(){this.loadData("locality")},loadData:function(c){var d=this,b,a,e;switch(c){case"district":b="getDistrictsFromKladr";a="districtStore";e="districtLoaded";break;case"city":b="getCitiesFromKladr";a="cityStore";e="cityLoaded";break;case"street":b="getStreetsFromKladr";a="streetStore";e="streetLoaded";break;case"locality":b="getLocalityFromKladr";a="localityStore";e="localityLoaded";break;default:return}LkIp.Request.request({url:"/api/filters/"+b,params:{code:d.generateClassificationCode(c)}},function(f){d[a].loadData(d.transformAdressData(f.response));d[e]=true;d.checkLoader()})},checkLoader:function(){var a=this;if(a.districtLoaded&&a.streetLoaded&&a.cityLoaded&&a.localityLoaded){if(!a.loaderIsDisabled){a.getIndex().setLoading(false)}return true}return false},getRegionCode:function(){return this.getIndex().down("#region").getValue()},getDataFromView:function(){return typeof this.getIndex().data=="undefined"?{}:this.getIndex().data},generateClassificationCode:function(d){var f=this,e=f.getRegionCode(),a=f.getIndex(),c=a.down("#district").getValue(),b=a.down("#city").getValue(),h=a.down("#locality").getValue(),g=a.down("#street").getValue();switch(d){case"district":e=!LkIp.Utils.isEmpty(c)?c:(!LkIp.Utils.isEmpty(e)?e:"");break;case"city":e=!LkIp.Utils.isEmpty(b)?b:(!LkIp.Utils.isEmpty(c)?c:(!LkIp.Utils.isEmpty(e)?e:""));break;case"locality":e=!LkIp.Utils.isEmpty(h)?h:(!LkIp.Utils.isEmpty(b)?b:(!LkIp.Utils.isEmpty(c)?c:(!LkIp.Utils.isEmpty(e)?e:"")));break;case"street":e=!LkIp.Utils.isEmpty(g)?g:(!LkIp.Utils.isEmpty(h)?h:(!LkIp.Utils.isEmpty(b)?b:(!LkIp.Utils.isEmpty(c)?c:(!LkIp.Utils.isEmpty(e)?e:""))));break}return e},transformAdressData:function(a){if(Ext.isObject(a)){a=Ext.Object.getValues(a)}return a},getRecord:function(a){return Ext.isArray(a)?a[0]:a},closeAddress:function(){this.getIndex().fireEvent("close");this.getIndex().close()}},0,0,0,0,0,0,[LkIp.controller,"Address"],0));(Ext.cmd.derive("LkIp.model.FnsMail.Grid",Ext.data.Model,{fields:["id","num","answer","articles","date_publication","date_write","download","question","articles","tax"]},0,0,0,0,0,0,[LkIp.model.FnsMail,"Grid"],0));(Ext.cmd.derive("LkIp.store.FnsMail.GridStore",LkIp.store.DefaultStore,{model:"LkIp.model.FnsMail.Grid",url:"/fnsMail/letters",pageSize:5},0,0,0,0,0,0,[LkIp.store.FnsMail,"GridStore"],0));(Ext.cmd.derive("LkIp.model.FnsMail.SelectFilters",Ext.data.Model,{fields:["code","value","type","link",{name:"qtip",type:"string",convert:function(b,a){return a.get("value")}},{name:"fullName",type:"string",convert:function(c,a){var b=a.get("code");return(0!==b?b+"-":"")+a.get("value")}},{name:"shortName",type:"string",convert:function(b,a){var c=a.get("value");return a.get("code")+"-"+Ext.String.ellipsis(c,40,true)}},{name:"filterValue",type:"string",convert:function(d,a){var b="",c=a.get("code");if("0"!=c){b=c+"-"}return b+a.get("value")}}],idProperty:"code"},0,0,0,0,0,0,[LkIp.model.FnsMail,"SelectFilters"],0));(Ext.cmd.derive("LkIp.controller.FnsMail",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"fnsMail"},{ref:"filterPanel",selector:"#fnsMailFilterPanel"}],models:["FnsMail.SelectFilters","FnsMail.Grid"],cache:false,filtersLoaded:true,firstLoad:true,updateStorePageSizeInProcess:false,getFnsMailStore:function(){return this.getStore("FnsMail.GridStore")},init:function(){this.getFnsMailStore().on({beforeload:{fn:this.beforeloadGrid,scope:this},load:{fn:this.loadGrid,scope:this}});this.control({"fnsMail #limitFilter":{change:this.updateNumberOrRecordsOnPage},'fnsMail [rel="apply"]':{applyFilters:this.applyFiltersAction},'fnsMail [rel="reset"]':{resetFilters:this.resetFiltersAction}});this.callParent()},loadIndex:function(){var b=this,a;b.callParent();a=b.getIndex();if(false==b.cache){a.setLoading(true);b.taxStore=Ext.getStore("taxTypeStore");b.articleStore=Ext.getStore("articleStore");b.fnsMailStore=Ext.getStore("fnsMailsStore");LkIp.Request.request({url:"/api/fnsMail/filters"},function(c){c=c.response;if(!Ext.isEmpty(c.taxes)){b.taxStore.loadData(c.taxes)}if(!Ext.isEmpty(c.articles)){b.articleStore.loadData(c.articles)}b.loadFirstPage()})}},beforeloadGrid:function(a){var c=this,b=c.getFiltersParams(true);if(a.extraParams!=b||c.firstLoad){c.getFnsMailStore().removeAll();a.extraParams=b;c.removeAllLetters();c.getIndex().setLoading(true);a.updateProxy();return true}return false},loadGrid:function(a){var d=this,b=d.getIndex(),c=a.getCount(),e=a.getRange();if(c>0){d.showLetters(e)}else{d.removeAllLetters()}b.setLoading(false);if(d.firstLoad){d.applyToggleAnswerListener()}d.firstLoad=false;d.updateStorePageSizeInProcess=false},applyToggleAnswerListener:function(){var b=this,a=Ext.getBody();a.addListener("click",this.answerExpand,this,{preventDefault:true,delegate:".fns-toggle-answer"})},answerExpand:function(f,b){var c=this,g=b.id.split("-")[1],a=Ext.get("answer-"+g),d=Ext.get("question-"+g);Ext.suspendLayouts();if(a.hasCls("collapsed")){a.removeCls("collapsed").addCls("expanded");d.removeCls("collapsed").addCls("expanded")}else{a.removeCls("expanded").addCls("collapsed");d.removeCls("expanded").addCls("collapsed")}Ext.resumeLayouts(true)},getTaxNameById:function(d){var c=this,b=c.taxStore.findExact("code",d),a;if(b!=-1){a=c.taxStore.getAt(b);return a.get("value")}return""},updateNumberOrRecordsOnPage:function(b,d){var c=this,a=b.up('[rel="paginator-container"]').itemId;if(!c.updateStorePageSizeInProcess){c.updateStorePageSizeInProcess=true;c.getFnsMailStore().setPageSize(d);c.loadFirstPage();c.updateAnotherPaginator(a,d)}},updateAnotherPaginator:function(c,b){var a=this,c=c=="paginator-container-top"?"paginator-container-bottom":"paginator-container-top";a.getIndex().down("#"+c).down("#limitFilter").setValue(b)},loadFirstPage:function(a){this.getFnsMailStore().loadPage(1,{params:Ext.isObject(a)?a:{}})},showLetters:function(f){var e=this,d=e.getIndex(),c=d.down("#listOfValues"),b=[],a;Ext.Array.each(f,function(g){a=g.getData();a.tax_name=e.getTaxNameById(a.tax);b.push(a)});Ext.suspendLayouts();c.update(b);c.show();d.down("#emptyListOfValues").hide();Ext.resumeLayouts(true)},removeAllLetters:function(){var c=this,b=c.getIndex(),a=b.down("#listOfValues");Ext.suspendLayouts();a.update();a.hide();b.down("#emptyListOfValues").show();Ext.resumeLayouts(true)}},0,0,0,0,0,[["filters",LkIp.mixins.Filters]],[LkIp.controller,"FnsMail"],0));(Ext.cmd.derive("LkIp.controller.FnsStands",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"fnsStands"},{ref:"filterPanel",selector:"#fnsStandsFilterPanel"}],cache:false,filtersLoaded:true,firstLoad:true,regionStore:undefined,noStore:undefined,categoriesStore:undefined,disableChangeRegion:false,disableChangeNo:false,loadedStandsByCategories:[],autoloadIfns:false,changeMyInspectionFromFilter:false,init:function(){this.control({"fnsStands #region":{select:this.changeRegion},"fnsStands #no":{select:this.changeNo},"fnsStands #myInspection":{change:this.changeMyInspection}});this.callParent()},loadIndex:function(){var b=this,a;b.callParent();a=b.getIndex();if(false==b.cache){a.setLoading(true);b.regionStore=Ext.getStore("regionStore");b.noStore=Ext.getStore("noStore");LkIp.Request.request("/api/fnsStands/reference",function(c){c=c.response;b.regionStore.loadData(c.region);b.categoriesStore=c.categories;a.down("#myInspection").setValue(true)});b.applyListenersToCategories()}},loadMyRegion:function(b){var a=this;a._loadMyInfo("regionStore",b,"region")},loadMyNo:function(b){var a=this;a._loadMyInfo("noStore",b,"no",true)},changeRegion:function(c,a){var d=this,b=d.getIndex(),e=c.getValue();if(!d.disableChangeRegion){d.removeNo();d.reloadCategories();if(!LkIp.Utils.isEmpty(e)){b.setLoading(true);LkIp.Request.request({url:"/api/fnsStands/no",params:{region:e}},function(f){f=f.response;d.noStore.loadData(f.no);if(d.autoloadIfns){d.autoloadIfns=false;d.loadMyNo(LkIp.User.getCodeNO())}else{d.changeMyInspectionFromFilter=true;b.down("#myInspection").setValue(false);b.setLoading(false)}})}}else{d.disableChangeRegion=true}},changeNo:function(d,b){var e=this,c=e.getIndex(),f=b[0].get("refCode"),a=f==LkIp.User.getCodeNO();if(a!=c.down("#myInspection").getValue()){e.changeMyInspectionFromFilter=true;c.down("#myInspection").setValue(f==LkIp.User.getCodeNO())}e.applyFiltersAction()},changeMyInspection:function(b,d){var c=this,a=c.getIndex(),e=LkIp.User.getCodeNO();if(!Ext.isEmpty(e)){if(!c.changeMyInspectionFromFilter){if(d){c.loadMyRegion(e.substring(0,2));a.setLoading(true);c.autoloadIfns=true}else{c.resetFiltersAction()}}else{c.changeMyInspectionFromFilter=false}}},removeNo:function(){var a=this;a.getIndex().down("#no").reset();a.noStore.removeAll()},_loadMyInfo:function(e,d,g,f){var c=this,b=c.getIndex(),a=c[e].getAt(c[e].findExact("refCode",d));f=f||false;b.down("#"+g).select(a);g!="no"&&b.down("#"+g).fireEvent("select",b.down("#"+g),a);if(f){c.applyFiltersAction()}},applyFiltersAction:function(){var d=this,b=d.getIndex(),c=d.getFilterPanel();d.filtersParams=c=="undefined"?{}:c.getForm().getValues();b.setLoading(true);d.reloadCategories();var a=new Ext.util.DelayedTask(function(){b.setLoading(true);d.loadCategories()});a.delay(200)},resetFiltersAction:function(){var b=this,a=b.getFilterPanel();b.filtersParams={};Ext.suspendLayouts();typeof a!="undefined"&&a.getForm().reset();b.noStore.removeAll();Ext.resumeLayouts(true);b.reloadCategories()},loadCategories:function(){var c=this,b=c.getIndex(),a=b.down("#categories");Ext.Array.each(c.categoriesStore,function(d){a.add([{xtype:"component",itemId:"category-"+d.code,componentCls:"fns-category",html:'<div id="category-'+d.code+'" class="fns-category-header-click"><span class="fns-category-header">'+d.value+'</span><div id="arrow-'+d.code+'" class="collapsed fns-stands-arrow fns-toggle-answer"></div></div>'},{xtype:"component",itemId:"category-data-"+d.code,hidden:true,cls:"fns-category-data collapsed",tpl:'<table class="fns-stand"><tpl for="."><tr><td class="fns-stand-name">{name}</td><td class="fns-stand-download">'+reference.lang.fnsStands.download+' <a href="{doc}" target="_blank">DOC</a> <a href="{pdf}" target="_blank">PDF</a> </td></tr></tpl></table>'}])});a.show();b.down("#categoriesInfo").hide();b.setLoading(false)},showByCategory:function(f,b){var h=this,d=h.getIndex(),a=b.id.split("-")[1],c=d.down("#category-data-"+a),k=Ext.get("arrow-"+a),g=Ext.Array.contains(h.loadedStandsByCategories,a),i,j=false;Ext.suspendLayouts();if(c.hasCls("collapsed")){c.removeCls("collapsed").addCls("expanded");k.removeCls("collapsed").addCls("expanded");if(g){c.show()}else{i=h.getFiltersParams();i.category=a;d.setLoading(true);j=true}}else{c.removeCls("expanded").addCls("collapsed");k.removeCls("expanded").addCls("collapsed");c.hide()}Ext.resumeLayouts(true);if(j){h.loadStands(c,i)}},loadStands:function(b,d){var c=this,a=c.getIndex();LkIp.Request.request({url:"/api/fnsStands/stands",params:d},function(e){Ext.suspendLayouts();b.show().update(e.response);a.setLoading(false);Ext.resumeLayouts(true);c.loadedStandsByCategories.push(d.category)})},reloadCategories:function(){var b=this,a=b.getIndex();b.loadedStandsByCategories=[];a.down("#categories").hide().removeAll();a.down("#categoriesInfo").show()},applyListenersToCategories:function(){var b=this,a=Ext.getBody();a.addListener("click",this.showByCategory,this,{preventDefault:true,delegate:".fns-category-header-click"})}},0,0,0,0,0,[["filters",LkIp.mixins.Filters]],[LkIp.controller,"FnsStands"],0));(Ext.cmd.derive("LkIp.controller.Complaints",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"complaints"},{ref:"form",selector:"#complaintsForm"}],stopChange:false,cache:false,selectNoLoaded:false,chooseNoLoaded:false,init:function(){this.control({complaints:{activate:function(){}},'complaints [name="selectNo"]':{change:this.changeSelectNo,select:this.selectNo},'complaints [name="chooseNo"]':{change:this.changeChooseNo,select:this.selectNo,blur:this.blurChooseNo},'complaints [name="file"]':{change:this.fileUploadAction},'complaints [rel="submit"]':{click:this.submitFormAction},"complaints #resetFile":{click:this.resetFileAction},"complaints #answerType":{change:this.changeAnswerType}});this.callParent()},loadIndex:function(){var c=this,b=c.callParent(),a;c.selectNoStore=Ext.getStore("complaintsSelectNoStore");c.chooseNoStore=Ext.getStore("complaintsChooseNoStore");c.answerTypeStore=Ext.getStore("complaintsAnswerType");if(false!=b&&!c.cache){a=c.getIndex();a.setLoading(true);LkIp.Request.request({url:"/api/egrn/getFilters",scope:this},function(d){if(!Ext.isEmpty(d.response[1])&&!Ext.isEmpty(d.response[1].no)){c.selectNoStore.loadData(d.response[1].no)}c.selectNoLoaded=true;c.checkLoader()});LkIp.Request.request({url:"/api/complaints/reference",scope:this},function(d){if(!Ext.isEmpty(d.response)){c.chooseNoStore.loadData(d.response.no);c.answerTypeStore.loadData(d.response.answerType);a.down("#answerType").setValue(1);if(typeof c.codeNo!="undefined"){c.stopChange=true;c.getForm().down('[name="chooseNo"]').setValue(c.codeNo);c.getForm().down('[name="selectNo"]').disable()}}c.chooseNoLoaded=true;c.checkLoader()})}},checkLoader:function(){var a=this;if(a.selectNoLoaded&&a.chooseNoLoaded){a.getIndex().setLoading(false);a.cache=true}},changeSelectNo:function(a,b){var c=this.getIndex().down('[name="chooseNo"]');if(!Ext.isEmpty(b)&&b!=0){c.disable()}else{c.enable()}},changeChooseNo:function(b,d){var c=this,a=c.getIndex().down('[name="selectNo"]');if(!c.stopChange){if(!Ext.isEmpty(d)&&!Ext.isEmpty(b.getRawValue())){a.disable()}else{a.enable();b.reset()}}else{c.stopChange=false}},fileUploadAction:function(b,e){var d=this,c=d.getForm(),a=d.getIndex();e=-1!=e.indexOf("fakepath")?e.replace("C:\\fakepath\\",""):e;if(!Ext.isEmpty(e)){b.setRawValue(e);a.setLoading(true);c.fireEvent("validitychange",c,false);LkIp.Request.formSubmit(c.down('[rel="fileUpload"]'),{url:"/web/file/upload",params:{complaints:1,support:1},scope:d,fileSubmit:true,success:function(g,f){a.setLoading(false);c.fireEvent("validitychange",c,c.isValid());c.down('[name="filename"]').setValue(f.result.response[0]);a.down("#resetFile").enable();b.anchor="90%";a.doLayout();a.down("#resetFile").show()},failure:function(f,g){a.setLoading(false);c.fireEvent("validitychange",c,c.isValid());d.resetFileAction();LkIp.Msg.error(g.result.response)}})}},submitFormAction:function(a){var c=this,b=c.getForm();if(!Ext.isEmpty(c.mainNo)){if(b.isValid()){b.setLoading(true);LkIp.Request.request({url:"api/complaints/send",method:"POST",scope:this,params:c.getForm().getForm().getValues(),dataType:"json"},function(d){b.setLoading(false);if(false!==d&&!(Ext.isEmpty(d.response))){if(0!==d.status){LkIp.app.fireEvent("clearCache");LkIp.Msg.success(new Ext.XTemplate(reference.lang.pages.complaints.success).apply({name:c.selectedNo,kodv:c.mainNo.value}));b.getForm().reset();c.resetFileAction();c.getIndex().down("#mainNoInfo").hide().update()}else{LkIp.Msg.error(d.response)}}else{LkIp.Msg.error(reference.lang.errors.serverError)}})}else{a.disable()}}else{LkIp.Msg.error(reference.lang.pages.complaints.kodVError)}},getNoRawValue:function(){var b=this,a=b.getIndex();if(!LkIp.Utils.isEmpty(a.down('[name="selectNo"]').getValue())){return a.down('[name="selectNo"]').getRawValue()}else{return a.down('[name="chooseNo"]').getRawValue()}},resetFileAction:function(){var e=this,c=e.getIndex(),b=c.down("#fileUpload"),d=e.getForm(),f=c.down("#file"),a=c.down("#resetFile");Ext.suspendLayouts();b.getForm().reset();f.setRawValue("");d.down('[name="filename"]').setValue();c.down("#resetFile").hide().disable();f.anchor="100%";a.hide().disable();Ext.resumeLayouts(true);c.doLayout()},changeAnswerType:function(b,e){var d=this,c=d.getForm(),a=d.getIndex();if(e==1){a.down("#emailAddress").show().enable();a.down("#address").hide().disable();a.down("#answerFormat").show().enable()}else{a.down("#address").show().enable();a.down("#emailAddress").hide().disable();a.down("#answerFormat").hide().disable()}c.fireEvent("validitychange",c,c.isValid())},selectedNo:undefined,mainNo:undefined,selectNo:function(d,a){var e=this,c=e.getIndex(),b=a[0].get("value");if(!LkIp.Utils.isEmpty(d.getValue())){e.selectedNo=b;c.setLoading(true);LkIp.Request.request({url:"/api/filters/getNoByKodV",params:{no:d.getValue()}},function(f){c.setLoading(false);if(f.status==1){e.mainNo=f.response;c.down("#mainNoInfo").show().update({name:b,mainName:f.response.value})}else{e.mainNo=undefined;c.down("#mainNoInfo").hide().update({})}})}else{e.mainNo=undefined;c.down("#mainNoInfo").hide().update({})}},blurChooseNo:function(a){var b=this,c=a.getValue();if(!Ext.isEmpty(c)&&-1==b.chooseNoStore.findExact("code",c)){a.reset()}}},0,0,0,0,0,0,[LkIp.controller,"Complaints"],0));(Ext.cmd.derive("LkIp.controller.OnlineBooking",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"onlineBooking"},{ref:"filterPanel",selector:"#onlineBookingFilterPanel"},{ref:"editWindow",selector:"editTimeWindow"}],models:["OnlineBooking.SelectFilters","OnlineBooking.NoFilter","OnlineBooking.ServiceFilter"],cache:false,appointmentsLoaded:false,noLoaded:false,regionStore:undefined,noStore:undefined,tormStore:undefined,serviceStore:undefined,subServiceStore:undefined,appointmentsStore:undefined,serviceOriginalData:undefined,changeMyInspectionFromFilter:false,editRecordFlag:false,availableDates:[],init:function(){var a=Ext.getBody(),b=this;a.addListener("click",b.showRules,b,{preventDefault:true,delegate:".show-online-record-rules"});a.addListener("click",b.editAppointment,b,{preventDefault:true,delegate:".editTime-appointment"});a.addListener("click",b.printAppointment,b,{preventDefault:true,delegate:".print-appointment"});a.addListener("click",b.removeAppointment,b,{preventDefault:true,delegate:".remove-appointment"});a.addListener("click",b.chooseTime,b,{preventDefault:true,delegate:".time-click-element"});a.addListener("click",b.goToProfile,b,{preventDefault:true,delegate:".go-to-ptofile-link"});b.control({'onlineBooking [rel="apply"]':{applyFilters:b.showAvailableDays},"onlineBooking #region":{select:b.selectRegion},"onlineBooking #no":{select:b.selectNo},"onlineBooking #torm":{select:b.selectTorm},"onlineBooking #service":{select:b.selectService},"onlineBooking #myInspection":{change:b.changeMyInspection},"onlineBooking #subService":{select:b.selectSubService}});b.callParent()},loadIndex:function(){var b=this,a;b.callParent();a=b.getIndex();if(!b.cache){a.setLoading(true);b.regionStore=Ext.getStore("regionStore");b.noStore=Ext.getStore("noStore");b.tormStore=Ext.getStore("tormStore");b.serviceStore=Ext.getStore("serviceStore");b.subServiceStore=Ext.getStore("subServiceStore");b.appointmentsStore=Ext.getStore("appointmentsStore");LkIp.Request.request("/api/onlineBooking/regions/list",function(c){if(!Ext.isEmpty(c.response)){b.regionStore.loadData(c.response);if(!Ext.isEmpty(LkIp.User.getCodeNO())&&LkIp.User.isActiveUser()){a.down("#myInspection").setValue(true)}else{a.setLoading(false);a.down("#myInspection").disable();if(!LkIp.User.isActiveUser()){a.down("#myInspection").hide()}}}else{a.setLoading(false)}});b.loadDataForAppointments()}a.down("#email").setValue(LkIp.User.get("email"));a.down("#phone").setValue(LkIp.User.get("phone"));Ext.query('[name="phone"]')[0].disabled=!a.down("#phone").isValid()},callUpdateEventsOnIndex:function(){LkIp.app.getController("Index").updateEvents()},selectRegion:function(a){var b=this;b.resetPage("region");b.loadNo(a.getValue())},loadNo:function(c){var b=this,a=b.getIndex();a.setLoading(true);LkIp.Request.request({url:"/api/onlineBooking/no/list",params:{region:c}},function(d){if(false!==d){b.noStore.loadData(d.response);b.noLoaded=true;b.isPageLoaded();if(b.autoloadIfns){b.autoloadIfns=false;b.loadMyNo(LkIp.User.getCodeNO())}else{b.changeMyInspectionFromFilter=true;a.down("#myInspection").setValue(false)}}else{a.setLoading(false)}})},loadMyNo:function(b){var a=this;return a._loadMyInfo("no",b,"noStore","refCode")},loadMyRegion:function(b){var a=this;return a._loadMyInfo("region",b,"regionStore","code")},_loadMyInfo:function(g,f,e,d){var c=this,b=c.getIndex(),a=c[e].getAt(c[e].findExact(d,f));b.down("#"+g).setValue(a.get("code"));b.down("#"+g).fireEvent("select",b.down("#"+g),[a]);c.changeMyInspectionFromFilter=false},selectNo:function(c,a){var d=this,b=d.getIndex(),a=a[0],e=a.get("refCode");d.resetPage("no");d.changeMyInspectionFromFilter=true;b.down("#myInspection").setValue(e==LkIp.User.getCodeNO());d.changeMyInspectionFromFilter=false;d.showNoComment(a.get("info"));d.loadTorm(a)},showNoComment:function(b){var a=this,c=a.getIndex().down("#noComment");if(!Ext.isEmpty(b)&&b.length!=4){c.show().setText(b)}else{c.hide().setText("")}},loadTorm:function(a){var c=this,b=c.getIndex();if(!Ext.isEmpty(a.get("torm"))){b.down("#torm").show().enable();c.tormStore.loadData(a.get("torm"))}else{b.down("#torm").hide().disable()}c.loadServices(a.get("code"))},selectTorm:function(b,a){var c=this,a=a[0];if(!LkIp.Utils.isEmpty(b.getValue())){c.resetPage("torm");c.showNoComment(a.get("info"));c.loadServices(b.getValue())}else{b.reset();var e=c.getIndex().down("#no").getValue(),d=c.noStore.getAt(c.noStore.findExact("code",e));c.selectNo(c.getIndex().down("#no"),[d])}},loadServices:function(c){var b=this,a=b.getIndex();a.setLoading(true);LkIp.Request.request({url:"/api/onlineBooking/services/list",params:{codeNo:c}},function(d){if(d!==false){if(d.response.service.length>0){a.down("#service").show().enable();b.serviceStore.loadData(d.response.service);b.serviceOriginalData=d.response.subService}else{LkIp.Msg.info(reference.lang.onlineBooking.noServices)}b.validateForm()}a.setLoading(false)})},selectService:function(c,a){var d=this,b=d.getIndex(),a=a[0],e=c.getValue();d.resetPage("service");if(d.hasSubService(e)){d.subServiceStore.loadData(d.serviceOriginalData[c.getValue()]);b.down("#subService").show().enable()}else{b.down("#subService").hide().disable()}d.validateForm()},selectSubService:function(b,a){var c=this;c.resetPage("subService")},hasSubService:function(b){var a=this;return typeof a.serviceOriginalData[b]!="undefined"},changeMyInspection:function(b,d){var c=this,a=c.getIndex(),e=LkIp.User.getCodeNO();if(!Ext.isEmpty(e)){if(!c.changeMyInspectionFromFilter){if(d){c.loadMyRegion(e.substring(0,2));a.setLoading(true);c.autoloadIfns=true}else{c.resetPage()}}else{c.changeMyInspectionFromFilter=false}}},resetPage:function(c){var b=this,a=b.getIndex();c=c||false;Ext.suspendLayouts();switch(c){case"region":a.down("#no").reset();b.noStore.removeAll();b.resetPage("no");break;case"no":b.tormStore.removeAll();a.down("#torm").hide().disable();b.resetPage("torm");a.down("#noComment").hide().update();break;case"torm":b.serviceStore.removeAll();a.down("#service").hide().disable();b.resetPage("service");break;case"service":b.subServiceStore.removeAll();a.down("#subService").hide().disable();break;case"subService":break;default:a.down("#region").reset();b.resetPage("region");break}a.down("#availableDates").update([]);a.down("#availableDatesContainer").hide();a.down("#ifnsInfo").update([]);b.availableDates=[];b.updateCalendar();Ext.resumeLayouts(true)},showAvailableDays:function(){var b=this,a=b.getIndex(),d=b.getIfnsData(),c=b.getServiceData();a.setLoading(true);LkIp.Request.request({url:"/api/onlineBooking/availableDates",method:"GET",params:{no:d.no,service:c.service}},function(e){a.setLoading(false);if(e!=false){if(e.response.list.length>0){e.response.list=b.transformAvailableDates(e.response.list);b.availableDates=e.response.list;a.down("#availableDatesContainer").show();a.down("#availableDates").update(e.response.list);a.down("#ifnsInfo").update(d);b.updateCalendar(e.response.calendar);LkIp.Utils.scrollTo(a.down("#noComment"))}else{b.updateCalendar();a.down("#availableDates").update([]);a.down("#availableDatesContainer").hide();LkIp.Msg.info(reference.lang.onlineBooking.noSlots)}}else{b.updateCalendar();a.down("#availableDates").update([]);a.down("#availableDatesContainer").hide();LkIp.Msg.info(reference.lang.onlineBooking.slotsError)}})},updateCalendar:function(d,e){e=e||false;var b=this,a=new Date(),c=!e?b.getIndex().down("#bookingCalendar"):b.getEditWindow().down("#bookingCalendar");d=d||false;if(d!==false){c.setMinDate(new Date(d.min)).setMaxDate(new Date(d.max));if(d.disabledDates.length>0){c.setDisabledDates(Ext.Array.map(d.disabledDates,function(f){return new Date(f)}))}}else{c.setMinDate(a);c.setMaxDate(a);c.setDisabledDates([new Date()])}},chooseTime:function(d,b){var c=this,g=b.id,f=new Ext.XTemplate(reference.lang.onlineBooking.confirmTime),a=c.findDateRecordByTimeId(g);if(c.checkUserInfo()){if(!Ext.isEmpty(a)){LkIp.Msg.info(f.apply({textDate:a.fullDate,dayName:Ext.Date.format(LkIp.Utils.getDateObject(a.times.date),"l").toLowerCase(),time:a.times.time}),{rewriteDefaultButtons:true,buttons:[{text:reference.lang.onlineBooking.chooseTimeYes,handler:function(){LkIp.Msg.fireEvent("closemessagebox",LkIp.Msg);LkIp.Msg.close();if(c.editRecordFlag){c.editRecord(a,c.getEditWindow().getRecord());c.editRecordFlag=false}else{c.bookRecord(a)}}},{text:reference.lang.onlineBooking.chooseTimeNo,handler:function(){LkIp.Msg.fireEvent("closemessagebox",LkIp.Msg);LkIp.Msg.close()}}]})}}else{LkIp.Msg.error(reference.lang.onlineBooking.userInfo,{rewriteDefaultButtons:true,buttons:[{text:reference.lang.buttons.close,handler:function(){LkIp.Msg.fireEvent("closemessagebox",LkIp.Msg);LkIp.Msg.close();LkIp.Utils.scrollTo(c.getIndex().down("#mainForm"))}}]})}},checkUserInfo:function(){var a=this,b=a.getIndex().down("#mainForm").getForm().getValues();return !LkIp.Utils.isEmpty(b.phone)&&!LkIp.Utils.isEmpty(b.email)},editRecord:function(d,a){var e=this,c=e.getIndex(),f=e.getEditParams(d,a),b;c.setLoading(true);e.getEditWindow().close();LkIp.Request.request({url:"/api/onlineBooking/edit",method:"POST",params:f},function(g){if(false!=g){if(1==g.status){f.bookingId=g.response.bookingId;if(!Ext.isEmpty(g.response.pin)){f.pin=g.response.pin}else{if(!Ext.isEmpty(g.response.window)){f.window=g.response.window}}LkIp.Request.request({url:"/api/appointment/add",method:"POST",params:f},function(h){c.setLoading(false);if(h!=false&&h.status==1){e.loadAppointments(h.response.appointments);b=e.transformDate(f.chosenDate);LkIp.Msg.success(new Ext.XTemplate(reference.lang.onlineBooking.successSet).apply({no:f.noName,textDate:b.fullDate,dayName:b.fullDayName.toLowerCase(),time:f.chosenTime}),{rewriteDefaultButtons:true,buttons:[{text:reference.lang.buttons.ok,handler:function(){LkIp.Msg.fireEvent("closemessagebox",LkIp.Msg);LkIp.Msg.close();LkIp.Utils.scrollTo(c.down("#gridContainer"));e.resetPage("subService")}}]});e.callUpdateEventsOnIndex()}else{LkIp.Msg.error(reference.lang.onlineBooking.technicalError)}})}else{c.setLoading(false);LkIp.Msg.error(!Ext.isEmpty(g.response)?g.response:reference.lang.onlineBooking.editBookingError)}}else{c.setLoading(false);LkIp.Msg.error(reference.lang.onlineBooking.technicalError)}})},bookRecord:function(c){var d=this,b=d.getIndex(),e=d.getBookingParams(c),a;b.setLoading(true);LkIp.Request.request({url:"/api/onlineBooking/book",method:"POST",params:e},function(f){if(false!=f){if(1==f.status){e.bookingId=f.response.bookingId;if(!Ext.isEmpty(f.response.pin)){e.pin=f.response.pin}else{if(!Ext.isEmpty(f.response.window)){e.window=f.response.window}}LkIp.Request.request({url:"/api/appointment/add",method:"POST",params:e},function(g){b.setLoading(false);if(g!=false&&g.status==1){d.loadAppointments(g.response.appointments);a=d.transformDate(e.chosenDate);LkIp.Msg.success(new Ext.XTemplate(reference.lang.onlineBooking.successSet).apply({no:e.noName,textDate:a.fullDate,dayName:a.fullDayName.toLowerCase(),time:e.chosenTime}),{rewriteDefaultButtons:true,buttons:[{text:reference.lang.buttons.ok,handler:function(){LkIp.Msg.fireEvent("closemessagebox",LkIp.Msg);LkIp.Msg.close();LkIp.Utils.scrollTo(b.down("#gridContainer"));d.resetPage("subService")}}]});d.callUpdateEventsOnIndex()}else{LkIp.Msg.error(reference.lang.onlineBooking.technicalError)}})}else{b.setLoading(false);LkIp.Msg.error(!Ext.isEmpty(f.response)?f.response:reference.lang.onlineBooking.bookingError)}}else{b.setLoading(false);LkIp.Msg.error(reference.lang.onlineBooking.technicalError)}})},findDateRecordByTimeId:function(c){var b=this,a={};Ext.Array.each(b.availableDates,function(d){var e=Ext.Array.findBy(d.times,function(f){return"time"+f.id==c});if(!Ext.isEmpty(e)){a=Ext.clone(d);a.times=e;return false}});return a},loadDataForAppointments:function(){var a=this;a.appointmentsLoaded=false;LkIp.Request.request("/api/appointment/list",function(b){a.loadAppointments(b.status!=0?b.response:[])})},editAppointment:function(d,b){var c=this,a=c._getAppointmentRecord(b.id);c.editRecordFlag=true;c.showAvailableDatesFromEdit(a)},showAvailableDatesFromEdit:function(a){var c=this,b=c.getIndex(),d;b.setLoading(true);LkIp.Request.request({url:"/api/onlineBooking/availableDates",method:"GET",params:{no:a.get("noCode"),service:a.get("service"),showAll:true}},function(e){b.setLoading(false);if(e.response.list.length>0){e.response.list=c.transformAvailableDates(e.response.list);c.availableDates=e.response.list;Ext.suspendLayouts();d=Ext.create("LkIp.view.OnlineBooking.EditTimeWindow",{indexPage:c.getIndex(),record:a});d.show();d.down("#availableDates").update(e.response.list);d.down("#ifnsInfo").update({noName:a.get("noName"),noAddress:a.get("noAddress"),noPhone:a.get("noPhone")});c.updateCalendar(e.response.calendar,true);Ext.resumeLayouts(true)}else{LkIp.Msg.info(reference.lang.onlineBooking.noSlots)}})},printAppointment:function(d,b){var c=this,a=c._getAppointmentRecord(b.id);LkIp.Utils.downloadDocument("onlineBooking","/api/onlineBooking/pdf",{bookingId:a.get("bookingId")})},removeAppointment:function(f,c){var d=this,a=d._getAppointmentRecord(c.id),b=new Ext.XTemplate(reference.lang.onlineBooking.deleteConfirm);LkIp.Msg.info(b.apply(a.getData()),{rewriteDefaultButtons:true,buttons:[{text:reference.lang.buttons.yes,handler:function(){d._removeAppointment(a);LkIp.Msg.fireEvent("closemessagebox",LkIp.Msg);LkIp.Msg.close()}},{text:reference.lang.buttons.no,handler:function(){LkIp.Msg.fireEvent("closemessagebox",LkIp.Msg);LkIp.Msg.close()}}]})},_removeAppointment:function(a){var c=this,b=c.getIndex();b.setLoading(true);LkIp.Request.request({url:"/api/onlineBooking/delete",method:"POST",params:a.getData()},function(d){if(d.status==1){LkIp.Msg.success(reference.lang.onlineBooking.removeBooking);c.loadDataForAppointments();c.callUpdateEventsOnIndex()}else{b.setLoading(false);LkIp.Msg.error(reference.lang.onlineBooking.removeBookingError)}})},_getAppointmentRecord:function(d){var b=this,c=d.split("-")[1],a=b.appointmentsStore.findExact("bookingId",c);return a!==-1?b.appointmentsStore.getAt(a):null},loadAppointments:function(a){var c=this,b=c.getIndex(),e=b.down("#emptyRecordsList"),d=b.down("#recordsList");c.appointmentsStore.removeAll();if(typeof a=="undefined"||a.length==0){e.show();d.hide()}else{e.hide();c.appointmentsStore.loadData(a);d.show()}c.appointmentsLoaded=true;c.isPageLoaded()},getBookingParams:function(b){var c=this,a=c.getIndex(),d=a.down("#mainForm").getForm().getValues();d.fns_service_id=b.times.fns_service_id;d.date=b.times.originalDate;d.chosenDate=b.times.date;d.chosenTime=b.times.time;d=Ext.Object.merge(d,c.getServiceData());d=Ext.Object.merge(d,c.getIfnsData());return d},getEditParams:function(b,a){var c=this,d=a.getData();d.fns_service_id=b.times.fns_service_id;d.originalDate=d.date;d.date=b.times.originalDate;d.chosenDate=b.times.date;d.chosenTime=b.times.time;d.no=d.noCode;return d},getServiceData:function(){var c=this,a=c.getIndex(),d=c.getIndex().down("#mainForm").getForm().getValues(),b={};b.serviceName=a.down("#service").getRawValue();b.service=b.originalService=d.service;if(!LkIp.Utils.isEmpty(d.subService)){b.service=d.subService;b.subServiceName=a.down("#subService").getRawValue()}return b},getIfnsData:function(){var e=this,f=e.getIndex().down("#mainForm").getForm().getValues(),d,b,a,c={},h=false,g;if(!LkIp.Utils.isEmpty(f.torm)){d=f.torm;a=e.tormStore;h=true;c.torm=f.torm}else{d=f.no;a=e.noStore}b=a.getAt(a.findExact("code",d));g=e.noStore.getAt(e.noStore.findExact("code",f.no)).get("value");if(!Ext.isEmpty(b)){c.noName=h?g+": "+b.get("value"):g;c.noPhone=b.get("phone");c.noAddress=b.get("address");c.noPhone=b.get("phone");c.noWay=b.get("way");c.tormName=h?b.get("value"):"";c.no=d}return c},transformAvailableDates:function(c){var b=this,a=[];Ext.Array.each(c,function(d){d=Ext.Object.merge(d,b.transformDate(d.times[0].date));a.push(d)});return a},transformDate:function(b){var d=LkIp.Utils.getDateObject(b),a=Ext.Date.format(d,"d"),c=Ext.Date.format(d,"Y"),e=reference.lang.monthes[Ext.Date.format(d,"F")].genitive;return{fullDate:a+" "+e+" "+c,dayName:reference.lang.date[Ext.Date.format(d,"l")],fullDayName:Ext.Date.format(d,"l")}},showRules:function(){var a=this;a.getIndex().down("#recordRules").getEl().toggle();a.getViewport().doLayout()},isPageLoaded:function(){var a=this;if(a.appointmentsLoaded&&a.noLoaded){a.getIndex().setLoading(false)}},validateForm:function(){this.getFilterPanel().getForm().checkValidity()},goToProfile:function(){LkIp.FlashData.set("goTo","contact");LkIp.Utils.goTo("#!/profile")}},0,0,0,0,0,0,[LkIp.controller,"OnlineBooking"],0));(Ext.cmd.derive("LkIp.model.Kkt.KktModel",Ext.data.Model,{fields:["id","status","address","rnm","model","factory_code","date","status_name","no","no_name","from_lk","dateEndFp","countAttempts","ofdName"]},0,0,0,0,0,0,[LkIp.model.Kkt,"KktModel"],0));(Ext.cmd.derive("LkIp.store.Kkt.KktStore",LkIp.store.DefaultStore,{model:"LkIp.model.Kkt.KktModel",url:"/kkt/list"},0,0,0,0,0,0,[LkIp.store.Kkt,"KktStore"],0));(Ext.cmd.derive("LkIp.view.Kkt.FiscalizationWindow",Ext.window.Window,{autoHeight:true,layout:"auto",modal:true,ui:"nalogThemeWindow",padding:5,width:660,componentCls:"kktFiscalization",type:"fiscalizationReport",initComponent:function(){var a=this,b="";switch(a.type){case"closeFiscalizationReport":b="_close";break;case"changeFiscalizationReport":b="_change";break;default:break}Ext.apply(a,{items:[{xtype:"form",itemId:"fiscalizationForm",layout:{type:"auto"},rel:"form",border:false,fieldDefaults:{labelAlign:"left",labelWidth:320,width:620,margin:5},items:[{xtype:"component",itemId:"attempts-text",tpl:reference.lang.kkt.fiscalization.attempt_tpl},{xtype:"displayfield",itemId:"rnm",fieldLabel:reference.lang.kkt.fiscalization.rnm},{xtype:"container",layout:"hbox",items:[{xtype:"filterDate",fieldLabel:'<span class="page-action-link help-tooltip" data-help="'+reference.lang.kkt.help["date_fp"+b]+'">'+reference.lang.kkt.fiscalization.date+"</span>",hidden:false,allowBlank:false,afterLabelTextTpl:LkIp.Utils.requiredLabel(),name:"date_fp",maxValue:undefined,width:450},{xtype:"timefield",fieldLabel:"",name:"time_fp",labelWidth:0,width:70,format:"H:i",hideTrigger:true,allowBlank:false,invalidText:reference.lang.kkt.fiscalization.timeError}]},{xtype:"textfield",maskRe:/[0-9]+/,minLength:1,enforceMaxLength:true,allowBlank:false,afterLabelTextTpl:LkIp.Utils.requiredLabel(),name:"kpk_number",vtype:"kpkNumber",fieldLabel:'<span class="page-action-link help-tooltip" data-help="'+reference.lang.kkt.help["kpk_number"+b]+'">'+reference.lang.kkt.fiscalization.kpkNumber+"</span>"},{xtype:"component",cls:"gray",hidden:true,itemId:"zerosMsg",margin:"0 20 0 5",style:{fontSize:"11px"},html:reference.lang.kkt.kpkNumberZeros},{xtype:"textfield",maskRe:/[0-9]+/,minLength:1,maxLength:10,enforceMaxLength:true,allowBlank:false,afterLabelTextTpl:LkIp.Utils.requiredLabel(),name:"kpk_value",fieldLabel:'<span class="page-action-link help-tooltip" data-help="'+reference.lang.kkt.help["kpk_value"+b]+'">'+reference.lang.kkt.fiscalization.kpkValue+"</span>"},{xtype:"hiddenfield",name:"factory_code",itemId:"factory_code"},{xtype:"hiddenfield",name:"rnm",itemId:"rnm_value"},{xtype:"hiddenfield",name:"report_type",itemId:"report_type"},{xtype:"note",hidden:LkIp.User.canSendKkt(),text:reference.lang.kkt.headError},{xtype:"note",hidden:!LkIp.User.isClosedUser(),text:reference.lang.errors.closedUser},{xtype:"container",items:[{xtype:"button",text:reference.lang.buttons.signSend,rel:"submit",formBind:true,margin:"0 15 0 0",name:"fiscalizationSubmit",listeners:{enable:function(c){if(!LkIp.User.canSendKkt()||!LkIp.User.isActiveUser()){c.disable()}}}}]}]}]});a.callParent(arguments)},listeners:{afterrender:function(){var a=LkIp.app.getController("Content");a.addMouseOverListener(".help-tooltip",function(c,b){var d=Ext.get(b).dom.getAttribute("data-help");if(typeof a.helpTooltip!=="undefined"){a.helpTooltip.destroy()}if(!Ext.isEmpty(d)){a.helpTooltip=LkIp.Utils.tooltip(Ext.get(b),d,{dismissDelay:10000,width:350});a.helpTooltip.show()}})}}},0,["fiscalizationWindow"],["panel","fiscalizationWindow","window","component","container","box"],{panel:true,fiscalizationWindow:true,window:true,component:true,container:true,box:true},["widget.fiscalizationWindow"],0,[LkIp.view.Kkt,"FiscalizationWindow"],0));Ext.apply(Ext.form.field.VTypes,{kpkNumber:function(b,a){b=parseInt(b);return b<=16777215},kpkNumberText:reference.lang.kkt.registration.kpkNumber});(Ext.cmd.derive("LkIp.view.Kkt.KktHistoryGrid",LkIp.view.Default.Grid,{itemId:"kktHistoryGrid",paging:false,getFileAction:false,limitFilter:false,contextMenu:false,height:"auto",maxHeight:400,store:"Kkt.KktHistoryStore",sortableColumns:false,initComponent:function(){var b=this;Ext.apply(b,{columns:{items:[{text:reference.lang.kkt.grid.history.statement,dataIndex:"statement",flex:1},{text:reference.lang.kkt.grid.history.date_statement,dataIndex:"date_statement",width:85,renderer:function(c){return !Ext.isEmpty(c)?LkIp.Utils.getDate(c):""}},{text:reference.lang.kkt.grid.history.download,menuDisabled:true,sortable:false,width:65,xtype:"actioncolumn",menuText:"",items:[{getClass:function(c){return"pdf-32-icon"},tooltip:reference.lang.download,handler:function(c,d){c.ownerCt.fireEvent("downloadStatement",c.getStore().getAt(d))}}]},{text:reference.lang.kkt.grid.history.status,dataIndex:"status",width:200},{text:reference.lang.kkt.grid.history.answer,dataIndex:"answer",width:200},{text:reference.lang.kkt.grid.history.date_answer,dataIndex:"date_answer",width:85,renderer:function(c){return !Ext.isEmpty(c)?LkIp.Utils.getDate(c):""}},{text:reference.lang.kkt.grid.history.download,dataIndex:"has_answer",menuDisabled:true,sortable:false,width:65,xtype:"actioncolumn",menuText:"",items:[{getClass:function(c){if(Ext.isEmpty(c)){return"x-hide-display"}return"pdf-32-icon"},tooltip:reference.lang.download,handler:function(c,d){c.ownerCt.fireEvent("downloadAnswer",c.getStore().getAt(d))}}]}],defaults:{menuDisabled:true}}});b.callParent(arguments);var a=b.getStore();a.on({load:{fn:b.load,scope:b},beforeLoad:{fn:b.beforeLoad,scope:b}})},load:function(b,a,d){var c=this;c.beforeLoadFlag=true;b.resetAttempts()},beforeLoad:function(a){if(this.beforeLoadFlag){a.updateProxy();this.setLoading(false);this.toggleGridDockedElements();this.beforeLoadFlag=false}}},0,["kktHistoryGrid"],["panel","gridtable","component","tablepanel","container","kktHistoryGrid","grid","box","gridpanel"],{panel:true,gridtable:true,component:true,tablepanel:true,container:true,kktHistoryGrid:true,grid:true,box:true,gridpanel:true},["widget.kktHistoryGrid"],0,[LkIp.view.Kkt,"KktHistoryGrid"],0));(Ext.cmd.derive("LkIp.view.Kkt.HistoryWindow",Ext.window.Window,{autoHeight:true,layout:"auto",modal:true,ui:"nalogThemeWindow",padding:"0 5",factoryCode:undefined,rnm:undefined,width:950,minHeight:120,y:200,getFactoryCode:function(){return this.factoryCode},getRnm:function(){return this.rnm},initComponent:function(){var a=this;Ext.apply(a,{items:[{xtype:"kktHistoryGrid"}],tools:[{type:"refresh",tooltip:reference.lang.buttons.refreshTtip,handler:function(d,c,b){a.fireEvent("refreshKktHistory")}}]});a.callParent(arguments)}},0,["historyWindow"],["panel","window","component","container","historyWindow","box"],{panel:true,window:true,component:true,container:true,historyWindow:true,box:true},["widget.historyWindow"],0,[LkIp.view.Kkt,"HistoryWindow"],0));(Ext.cmd.derive("LkIp.controller.Kkt.Index",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"kkt"},{ref:"filterPanel",selector:"#kktFilters"}],models:["Kkt.KktModel"],fiscalizationStatuses:["13003","13012"],regCardStatuses:["13004","13009","13010","13011"],kktInformationWindow:undefined,cache:false,canChangePosition:true,selectedKktId:undefined,fiscalizationWindow:undefined,kktProgressTooltip:undefined,selectedKkt:{},getKktStore:function(){return this.getStore("Kkt.KktStore")},init:function(){var b=this,a=Ext.getBody();a.addListener("click",b.showFiscalizationWindowAction,b,{preventDefault:true,delegate:".show-fiscalization-window"});a.addListener("click",b.showKktInformationWindow,b,{preventDefault:true,delegate:".rnm-click"});a.addListener("mouseover",function(d,c){if(!Ext.isEmpty(b.kktProgressTooltip)){b.kktProgressTooltip.destroy()}var e=reference.lang.kkt.grid.tooltips[Ext.get(c).getAttribute("tooltip_text")];if(!Ext.isEmpty(e)){b.kktProgressTooltip=LkIp.Utils.tooltip(Ext.get(c),e,{dismissDelay:0,width:300,hideDelay:4000,listeners:{hide:function(f){f.destroy();b.kktProgressTooltip=undefined}}});b.kktProgressTooltip.show()}},this,{preventDefault:true,stopEvent:true,delegate:".kkt-progress-with-tooltip"});b.getKktStore().on({beforeload:{fn:b.beforeLoad,scope:b},load:{fn:b.afterLoad,scope:b}});b.control({'#kktFilters [rel="apply"]':{applyFilters:b.applyFiltersAction},'#kktFilters [rel="reset"]':{resetFilters:b.resetFiltersAction},kktGrid:{showHistory:b.showHistoryAction,getFile:this.getFileAction},"#kktInformationWindow #kktReRegistrationButton":{click:b.goToReRegistration},"#kktInformationWindow #kktDeRegistrationButton":{click:b.goToDeregistration},"#kktInformationWindow #kktContinueRegistrationButton":{click:b.goToRegistration},"#kktInformationWindow #kktFinishRegistrationButton":{click:b.finishRegistration},"#kktInformationWindow #kktRegistrationOneMoreTimeButton":{click:b.registerOneMoreTime},"#kktInformationWindow #kktFinishReRegistrationButton":{click:b.finishRegistration},"#kktInformationWindow #kktChangeReRegistrationButton":{click:b.finishRegistration},"#kktInformationWindow":{close:b.onCloseKktWindow},"#kktInformationWindow #kktDownloadRegistrationCardButton":{click:b.downloadRegistrationCardFromDetails}})},loadIndex:function(){var b=this,a;b.callParent();a=b.getIndex();if(!b.cache){b.getFilterPanel().disable();b.stateStore=Ext.getStore("kktStateStore");b.noStore=Ext.getStore("kktNoStore");b.modelStore=Ext.getStore("kktModelStore");b.fnModelStore=Ext.getStore("kktFnModelStore");b.ofdListStore=Ext.getStore("ofdListStore");LkIp.Request.request("/api/kkt/reference",function(c){if(!Ext.isEmpty(c.response.state)){b.stateStore.loadData(c.response.state)}if(!Ext.isEmpty(c.response.no)){b.noStore.loadData(c.response.no)}if(!Ext.isEmpty(c.response.model)){b.modelStore.loadData(c.response.model)}if(!Ext.isEmpty(c.response.fnModel)){b.fnModelStore.loadData(c.response.fnModel)}if(!Ext.isEmpty(c.response.ofdList)){b.ofdListStore.loadData(c.response.ofdList)}a.setLoading(false);b.cache=true;b.getFilterPanel().enable()});b.loadFirstPage()}else{b.getKktStore().removeAll();b.loadFirstPage()}a.setLoading(true);LkIp.Request.request("/api/notice/getNewCount",function(c){a.setLoading(false);a.down("#newNoticeNote").setVisible(false!=c&&!Ext.isEmpty(c)&&c.status==1&&!Ext.isEmpty(c.response)&&parseInt(c.response.count)>0)})},beforeLoad:function(){var a=this;a.applySelectedFilters();a.getKktStore().extraParams=a.getFiltersParams(true);a.getIndex().down("#kktGrid").getSelectionModel().deselectAll()},afterLoad:function(a){var c=this,b=c.getIndex().down("#getFileBtn");c.gridLoaded=true;if(a.getCount()>0){b.enable()}else{b.disable()}if(LkIp.app.getController("Index").loaded&&a.getCount()>0){LkIp.Settings.set("kktList",{count:a.getCount(),root:[a.getRange()[0].getData()]});LkIp.app.getController("Index").drawKkt()}},downloadLastDocumentCard:function(d,a){var b=this,c=Ext.get(a).dom.getAttribute("factory_code");if(!Ext.isEmpty(c)){LkIp.Utils.downloadDocument("download-last-document-card","/api/kkt/document",{factory_code:c})}},downloadRegistrationCardFromDetails:function(){var b=this,a=b.selectedKkt.id;if(!Ext.isEmpty(a)){LkIp.Utils.downloadDocument("download-reg-card","/api/kkt/reg-card",{id:a})}},loadFirstPage:function(){this.getKktStore().loadFirstPage()},goToReRegistration:function(){var a=this;if(!Ext.isEmpty(a.selectedKkt.id)){LkIp.Utils.goTo("#!/kkt/reregistration?"+a.selectedKkt.id);a.closeKktInformationWindow()}},goToDeregistration:function(){var a=this;if(!Ext.isEmpty(a.selectedKkt.id)){LkIp.Utils.goTo("#!/kkt/deregistration?"+a.selectedKkt.id);a.closeKktInformationWindow()}},goToRegistration:function(){var a=this;if(!Ext.isEmpty(a.selectedKkt.id)){LkIp.Utils.goTo("#!/kkt/registration?"+a.selectedKkt.id);a.closeKktInformationWindow()}},registerOneMoreTime:function(){var a=this,b=new Ext.XTemplate(reference.lang.kkt.confirmOneMoreRegistration).apply({number:a.selectedKkt.model_factory_code});LkIp.Msg.info(b,{rewriteDefaultButtons:true,buttons:[{text:reference.lang.buttons.yes,handler:function(){a.goToRegistration();LkIp.Msg.fireEvent("closemessagebox",LkIp.Msg);LkIp.Msg.close()}},{text:reference.lang.buttons.no,handler:function(){LkIp.Msg.fireEvent("closemessagebox",LkIp.Msg);LkIp.Msg.close()}}]})},showKktInformationWindow:function(g,d){var f=this,b=f.getIndex(),h=Ext.get(d).dom,a=h.getAttribute("data-kkt-id"),c=parseInt(h.getAttribute("data-fn-attempts"));f.closeKktInformationWindow();if(!Ext.isEmpty(a)&&Ext.isNumeric(a)){b.setLoading(true);LkIp.Request.request({url:"/api/kkt/details",params:{id:a}},function(j){b.setLoading(false);if(false!=j&&!Ext.isEmpty(j)&&j.status==1&&!Ext.isEmpty(j.response)){var i=j.response,e=Ext.Array.contains(f.fiscalizationStatuses,i.status_key)&&c>0;i.model_kkt_full=!Ext.isEmpty(i.model_version)?i.model_kkt+" \u0432\u0435\u0440\u0441\u0438\u044f "+i.model_version:i.model_kkt;i.rnm=!Ext.isEmpty(i.rnm)?LkIp.Utils.formatRnm(i.rnm):"";f.kktInformationWindow=Ext.create("LkIp.view.Kkt.KktInformation",{itemId:"kktInformationWindow",data:i,hideKktRegistrationInfoBlock:!e,title:i.model_kkt_full+", \u2116"+i.model_factory_code});f.kktInformationWindow.show();f.selectedKkt=i;f.selectedKkt.id=a;if(Ext.isEmpty(f.selectedKkt.attempts)){f.selectedKkt.attempts=c}}else{LkIp.Msg.error("\u041d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043f\u043e \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u0439 \u043a\u0430\u0441\u0441\u0435. \u041f\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u0412\u0430\u0448\u0443 \u043f\u043e\u043f\u044b\u0442\u043a\u0443 \u043f\u043e\u0437\u0436\u0435.")}b.setLoading(false)})}},onCloseKktWindow:function(){this.selectedKkt={}},closeKktInformationWindow:function(){var a=this;if(!Ext.isEmpty(a.kktInformationWindow)){a.kktInformationWindow.close()}},showHistoryAction:function(a){var d=this,b=d.getIndex(),e=a.get("factory_code"),c=a.get("rnm");Ext.create("LkIp.view.Kkt.HistoryWindow",{title:new Ext.XTemplate(reference.lang.kkt.grid.history.title).apply({code:e,rnm:c,name:a.get("model")}),factoryCode:e,rnm:c}).show()},getFileAction:function(){var a=this;a.applySelectedFilters();LkIp.Utils.downloadDocument("kktListFile","/api/kkt/file",a.getFiltersParams(true))},finishRegistration:function(d){var e=this,b=e.selectedKkt.attempts,c=d.type,f,a;switch(c){case"closeFiscalizationReport":f=reference.lang.kkt.fiscalization.closeTitle;a=reference.lang.kkt.fiscalization.document_close;break;case"changeFiscalizationReport":f=reference.lang.kkt.fiscalization.changeTitle;a=reference.lang.kkt.fiscalization.document_change;break;case"fiscalizationReport":default:f=reference.lang.kkt.fiscalization.title;a=reference.lang.kkt.fiscalization.document_default}if(Ext.isEmpty(b)||0!=b){e.fiscalizationWindow=Ext.create("LkIp.view.Kkt.FiscalizationWindow",{itemId:"kktIndexFiscalizationWindow",title:new Ext.XTemplate(f).apply({name:e.selectedKkt.model_kkt_full,factory_code:e.selectedKkt.model_factory_code}),type:c});e.fiscalizationWindow.down("#factory_code").setValue(e.selectedKkt.model_factory_code);e.fiscalizationWindow.down("#report_type").setValue(c);e.fiscalizationWindow.down("#rnm").setValue(e.selectedKkt.rnm);e.fiscalizationWindow.down("#rnm_value").setValue(e.selectedKkt.rnm);if(!Ext.isEmpty(b)){e.fiscalizationWindow.down("#attempts-text").show().update({number:b,attempt_text:b==1?reference.lang.kkt.fiscalization.attempts_one:((b>1&&b<5)?reference.lang.kkt.fiscalization.attempts:reference.lang.kkt.fiscalization.attempts_many),attempt_start:b==1?reference.lang.kkt.fiscalization.attempts_start_one:reference.lang.kkt.fiscalization.attempts_start,document:a})}else{e.fiscalizationWindow.down("#attempts-text").hide()}e.fiscalizationWindow.show()}},drawIndicator:function(a){var b=this;a=parseInt(a);switch(a){case 13001:return b.drawProgressTable("ok-progress-table-1",a);case 13002:return b.drawProgressTable("bad-progress-table-1",a);case 13003:case 13005:case 13006:case 13007:case 13008:return b.drawProgressTable("ok-progress-table-2",a);case 13004:case 13009:case 13010:case 13011:return b.drawProgressTable("ok-progress-table-3",a);case 13012:return b.drawProgressTable("bad-progress-table-2",a);case 0:default:return"";break}},drawProgressTable:function(b,a){b=b+" kkt-progress-with-tooltip";var c=' tooltip_text="'+a+'"';return"<table "+c+' class="'+b+'" cellpadding="0" cellspacing="0"><tr><td><div class="first-part"></div></td><td><div class="second-part"></div></td><td><div class="third-part"></div></td></tr></table>'}},0,0,0,0,0,[["filters",LkIp.mixins.Filters]],[LkIp.controller.Kkt,"Index"],0));(Ext.cmd.derive("LkIp.model.Kkt.Manufacturer.KktInstancesModel",Ext.data.Model,{fields:["model_name","factory_code","produced_date"]},0,0,0,0,0,0,[LkIp.model.Kkt.Manufacturer,"KktInstancesModel"],0));(Ext.cmd.derive("LkIp.store.Kkt.Manufacturer.KktInstancesStore",LkIp.store.DefaultStore,{model:"LkIp.model.Kkt.Manufacturer.KktInstancesModel",url:"/kkt/models/instances"},0,0,0,0,0,0,[LkIp.store.Kkt.Manufacturer,"KktInstancesStore"],0));(Ext.cmd.derive("LkIp.model.Kkt.Manufacturer.FnInstancesModel",Ext.data.Model,{fields:["factory_code","reg_number","produced_date","fn_name"]},0,0,0,0,0,0,[LkIp.model.Kkt.Manufacturer,"FnInstancesModel"],0));(Ext.cmd.derive("LkIp.store.Kkt.Manufacturer.FnInstancesStore",LkIp.store.DefaultStore,{model:"LkIp.model.Kkt.Manufacturer.FnInstancesModel",url:"/kkt/fn/instances"},0,0,0,0,0,0,[LkIp.store.Kkt.Manufacturer,"FnInstancesStore"],0));(Ext.cmd.derive("LkIp.controller.Kkt.Manufacturer.Index",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"kktManufacturer"},{ref:"kktInstancesFilters",selector:"#kktInstancesFilters"},{ref:"fnInstancesFilters",selector:"#fnInstancesFilters"}],models:["Kkt.Manufacturer.KktInstancesModel","Kkt.Manufacturer.FnInstancesModel"],kktInstancesFilters:{},fnInstancesFilters:{},getKktInstancesStore:function(){return this.getStore("Kkt.Manufacturer.KktInstancesStore")},getFnInstancesStore:function(){return this.getStore("Kkt.Manufacturer.FnInstancesStore")},init:function(){this.getKktInstancesStore().on({beforeload:{fn:this.beforeLoadKktInstancesGrid,scope:this}});this.getFnInstancesStore().on({beforeload:{fn:this.beforeLoadFnInstancesGrid,scope:this}});this.control({"kktManufacturer #statusBarTabsKktManufacturer #tab-models-instances":{activate:this.activateModelInstancesBlock,deactivate:this.deactivateModelInstancesBlock},"kktManufacturer #statusBarTabsKktManufacturer #tab-fn-instances":{activate:this.activateFnInstancesBlock,deactivate:this.deactivateFnInstancesBlock},'#kktInstancesFilters [rel="apply"]':{applyFilters:this.applyKktInstancesFilters},'#kktInstancesFilters [rel="reset"]':{resetFilters:this.resetKktInstancesFilters},'#fnInstancesFilters [rel="apply"]':{applyFilters:this.applyFnInstancesFilters},'#fnInstancesFilters [rel="reset"]':{resetFilters:this.resetFnInstancesFilters}})},modelInstancesFiltersLoaded:false,fnInstancesFiltersLoaded:false,activateModelInstancesBlock:function(){var b=this,a=b.getIndex();Ext.suspendLayouts();a.down("#models-instances-block").show();Ext.resumeLayouts(true);if(!b.modelInstancesFiltersLoaded){b.kktModelsStore=Ext.getStore("kktModelsStore");a.setLoading(true);LkIp.Request.request("/api/kkt/models/instances/reference",function(c){a.setLoading(false);if(!Ext.isEmpty(c.response.models)){b.kktModelsStore.loadData(c.response.models)}b.getKktInstancesStore().loadFirstPage();b.modelInstancesFiltersLoaded=true})}else{b.getKktInstancesStore().loadFirstPage()}},deactivateModelInstancesBlock:function(){var b=this,a=b.getIndex();a.down("#models-instances-block").hide();b.getKktInstancesStore().removeAll()},activateFnInstancesBlock:function(){var b=this,a=b.getIndex();Ext.suspendLayouts();a.down("#fn-instances-block").show();Ext.resumeLayouts(true);if(!b.fnInstancesFiltersLoaded){b.fnModelsStore=Ext.getStore("fnModelsStore");a.setLoading(true);LkIp.Request.request("/api/kkt/fn/instances/reference",function(c){a.setLoading(false);if(!Ext.isEmpty(c.response.fn)){b.fnModelsStore.loadData(c.response.fn)}b.getFnInstancesStore().loadFirstPage();b.fnInstancesFiltersLoaded=true})}else{b.getFnInstancesStore().loadFirstPage()}},deactivateFnInstancesBlock:function(){var b=this,a=b.getIndex();a.down("#fn-instances-block").hide();b.getFnInstancesStore().removeAll()},beforeLoadKktInstancesGrid:function(){var a=this;a.getKktInstancesStore().extraParams=a.getFiltersParams("kktInstances",true)},beforeLoadFnInstancesGrid:function(){var a=this;a.getFnInstancesStore().extraParams=a.getFiltersParams("fnInstances",true)},getFiltersParams:function(c,b){var e=this,a={},d={};b=b||false;switch(c){case"kktInstances":d=e.kktInstancesFilters;break;case"fnInstances":d=e.fnInstancesFilters;break;default:return{}}if(b){Ext.Object.each(d,function(f,g){if(!LkIp.Utils.isFilterEmpty(g)){a[f]=g}});return a}return d},applyKktInstancesFilters:function(){var a=this;a.applyFilters("kkt")},applyFilters:function(c){var e=this,d,b="kkt"===c?e.getKktInstancesFilters():e.getFnInstancesFilters(),a="kkt"===c?e.getKktInstancesStore():e.getFnInstancesStore();d=b=="undefined"?{}:b.getForm().getValues();if("kkt"===c){e.kktInstancesFilters=d}else{e.fnInstancesFilters=d}a.loadFirstPage()},applyFnInstancesFilters:function(){var a=this;a.applyFilters("fn")},resetKktInstancesFilters:function(){var a=this;a.resetProducedFiltersWithNoReload("kkt");a.getKktInstancesStore().loadFirstPage()},resetFnInstancesFilters:function(){var a=this;a.resetProducedFiltersWithNoReload("fn");a.getFnInstancesStore().loadFirstPage()},resetProducedFiltersWithNoReload:function(b,d){var c=this,a="kkt"===b?c.getKktInstancesFilters():c.getFnInstancesFilters();d=d||false;if("kkt"===b){c.kktInstancesFilters={}}else{c.fnInstancesFilters={}}Ext.suspendLayouts();a.getForm().reset();d&&a.collapse();Ext.resumeLayouts(true)}},0,0,0,0,0,0,[LkIp.controller.Kkt.Manufacturer,"Index"],0));(Ext.cmd.derive("LkIp.controller.Kkt.Registration",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"kktRegistration"}],defaultAddressObject:{region:"",postcode:"",district:"",city:"",locality:"",street:"",house:"",housing:"",apartment:"",no:"",fias_id:"",addressString:""},addressObject:{},kktModelObject:{},fnModelObject:{},temporarySelectedKkt:{},temporarySelectedFn:{},chooseKktWindow:undefined,chooseFnWindow:undefined,cacheKktList:false,cacheFnList:false,referenceLoaded:false,detailsLoaded:false,newNoticeCountLoaded:false,selectedAddress:undefined,modelFactoryCodeValid:false,fnFactoryCodeValid:false,chooseKktStore:undefined,chooseFnStore:undefined,selectedKkt:{},selectedAddressGuid:null,selectedAddressRemote:null,selectedAddressIsLastChild:false,hasOldAddressDetails:false,oldAddress:false,init:function(){var b=this,a=Ext.getBody();a.addListener("click",b.editKkt,b,{preventDefault:true,stopEvent:true,delegate:".editChosenKkt"});a.addListener("click",b.editFn,b,{preventDefault:true,stopEvent:true,delegate:".editChosenFn"});a.addListener("click",function(c,d,e){b.showAddressBlock(false)},b,{delegate:".editAddressReg"});b.control({kktRegistration:{deactivate:function(){this.resetPage()}},"kktRegistration #addressFIAS":{changeFiasAddress:b.changeAddress,addressLoader:b.addressLoader},"kktRegistration #editKkt":{click:b.editKkt},"#kktRegistrationChooseKkt":{close:b.closeKkt},"#kktRegistrationChooseKkt #chooseKktModelFilter":{change:b.changeKktListFilter},"#kktRegistrationChooseKkt #kktRegistrationChooseKktGrid":{selectionchange:b.selectKktModelInGrid},"#kktRegistrationChooseKkt #kktRegistrationChooseKktFactoryCode":{change:b.changeKktFactoryCode},"#kktRegistrationChooseKkt #kktRegistrationChooseKktButton":{click:b.chooseKkt},"#kktRegistrationChooseFn":{close:b.closeFn},"kktRegistration #editFn":{click:b.editFn},"#kktRegistrationChooseFn #chooseFnModelFilter":{change:b.changeFnListFilter},"#kktRegistrationChooseFn #kktRegistrationChooseFnGrid":{selectionchange:b.selectFnModelInGrid},"#kktRegistrationChooseFn #kktRegistrationChooseFnFactoryCode":{change:b.changeFnFactoryCode},"#kktRegistrationChooseFn #kktRegistrationChooseFnButton":{click:b.chooseFn},'kktRegistration #kktRegistrationForm [name="kktRegisterSubmit"]':{click:b.submitRegisterForm},'kktRegistration #kktRegistrationForm [name="kktRegisterPdfSubmit"]':{click:b.pdfAction},"kktRegistration #kktRegistrationForm":{validitychange:function(d,g){var e=this,c=e.getIndex(),h=c.down('[name="kktRegisterSubmit"]'),f=c.down('[name="kktRegisterPdfSubmit"]');if(g){e.checkFormForValidity()}else{h.disable();f.disable()}}},"kktRegistration #autoMode":{change:b.changeAutoMode},"kktRegistration #ofd_code":{select:b.selectOfd},"kktRegistration #internet":{change:b.changeInternet}});b.callParent()},loadIndex:function(){var b=this,a,c;b.callParent();if(!LkIp.User.canSendKkt()){LkIp.app.getController("Viewport").tellUserAboutHeadProblems()}else{if(!LkIp.User.isActiveUser()){LkIp.app.getController("Viewport").tellUserThatHeCannotSendDocumentsBecauseHeIsClosed()}}a=b.getIndex();if(Ext.isEmpty(b.kktId)){b.resetPage();b.detailsLoaded=true}a.setLoading(true);LkIp.Request.request("/api/notice/getNewCount",function(e){b.newNoticeCountLoaded=true;b.checkLoader();var d=false!=e&&!Ext.isEmpty(e)&&e.status==1&&!Ext.isEmpty(e.response)&&parseInt(e.response.count)>0;a.down("#newNoticeNote").setVisible(d);a.down("#steps").setDisabled(d)});if(!b.cache){a.setLoading(true);b.ofdForRegisterStore=Ext.getStore("ofdForRegisterStore");LkIp.Request.request("/api/kkt/registration/reference",function(d){if(!Ext.isEmpty(d.response.ofd)){b.ofdForRegisterStore.loadData(d.response.ofd)}b.referenceLoaded=true;b.checkLoader();b.tryToLoadDetails()});b.cache=true}else{a.setLoading(true);b.tryToLoadDetails()}},changeAddress:function(a,c,e){var d=this,b=d.getIndex();d.selectedAddressGuid=a;d.selectedAddressRemote=c;d.selectedAddressIsLastChild=e;d.selectedAddress=d.getController("AddressFIAS").selectedAddressString;if(d.selectedAddressGuid==d.defaultAddressObject.fias_id&&d.hasOldAddressDetails){d.defaultAddressRemote=d.selectedAddressRemote}if(e&&c!==null){if(!c){if(b.down("#autoMode").getValue()==1){b.down("#noAutonom").show()}b.down("#autoMode").setValue(false);b.down("#autoMode").disable()}else{b.down("#autoMode").enable();b.down("#noAutonom").hide()}}else{if(b.down("#autoMode").getValue()==1){b.down("#noAutonom").show()}b.down("#autoMode").disable();b.down("#autoMode").setValue(false)}d.checkFormForValidity()},addressLoader:function(a){var c=this,b=c.getIndex();b.setLoading(a)},editKkt:function(){var b=this,a=b.getIndex();if(!b.cacheKktList){a.setLoading(true);LkIp.Request.request({url:"/api/kkt/model/list"},function(c){a.setLoading(false);if(false!=c&&!Ext.isEmpty(c)&&c.status==1){b.cacheKktList=c.response;b.showEditKktBlock()}else{LkIp.Msg.error("\u0412\u044b\u0431\u043e\u0440 \u043c\u043e\u0434\u0435\u043b\u0438 \u041a\u041a\u0422 \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d \u043f\u043e \u0442\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u0438\u043c \u043f\u0440\u0438\u0447\u0438\u043d\u0430\u043c. \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u0412\u0430\u0448\u0443 \u043f\u043e\u043f\u044b\u0442\u043a\u0443 \u043f\u043e\u0437\u0436\u0435.")}})}else{b.showEditKktBlock()}},showEditKktBlock:function(){var b=this,a=b.getIndex();b.chooseKktWindow=Ext.create("LkIp.view.Kkt.ChooseKkt",{itemId:"kktRegistrationChooseKkt"});b.chooseKktStore=Ext.getStore("kktRegistrationChooseKktStore");b.chooseKktStore.removeAll();b.chooseKktStore.loadData(b.cacheKktList);b.resetKktSelection();b.chooseKktWindow.show();if(!Ext.Object.isEmpty(b.kktModelObject)){b.chooseKktWindow.down("#kktRegistrationChooseKktGrid").getSelectionModel().select(b.chooseKktStore.findExact("code",b.kktModelObject.code));b.chooseKktWindow.down("#kktRegistrationChooseKktFactoryCode").setValue(b.kktModelObject.factory_code)}a.down("#editKkt").disable()},changeKktListFilter:function(b,d){var c=this,a=true;try{new RegExp(d,"i")}catch(f){a=false}if(d.length>0&&a){c.chooseKktStore.filterBy(function(e){var g=e.get("value");return g.search(new RegExp(d,"i"))>=0})}else{c.chooseKktStore.clearFilter()}},selectKktModelInGrid:function(g,b){this.resetKktSelection();if(b.length){Ext.suspendLayouts();var e=this,a=b[0],f=e.chooseKktWindow.down("#kktRegistrationChooseKktSelected"),d=e.chooseKktWindow.down("#kktRegistrationChooseKktFactoryCode"),c=e.chooseKktWindow.down("#kktRegistrationChooseKktButton");d.show().reset();f.update({selectedModel:e.generateKktModelString(a.get("value"),a.get("version"))});e.temporarySelectedKkt=a;c.disable();Ext.resumeLayouts(true);d.focus()}},chooseKkt:function(){var a=this,b=a.chooseKktWindow.down("#kktRegistrationChooseKktFactoryCode").getValue();a.chooseKktWindow.setLoading(true);LkIp.Request.request({url:"/api/kkt/model/check",params:{factory_code:b,model_code:a.temporarySelectedKkt.get("code")}},function(d){a.chooseKktWindow.setLoading(false);if(false!=d&&d.status!=0){if(d.response.result==0){a.saveChosenKktData(b)}else{a.kktFactoryCodeValid=false;if(!Ext.isEmpty(d.response.errorText)){a.chooseKktWindow.down("#kktRegistrationChooseKktFactoryCode").markInvalid(d.response.errorText)}}}else{var c=!Ext.isEmpty(d.response)?d.response:"\u0423\u0432\u0430\u0436\u0430\u0435\u043c\u044b\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c, \u0432 \u0434\u0430\u043d\u043d\u044b\u0439 \u043c\u043e\u043c\u0435\u043d\u0442 \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u0443\u044e \u043c\u043e\u0434\u0435\u043b\u044c \u041a\u041a\u0422 \u043d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e. \u041f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u043f\u043e\u043f\u044b\u0442\u043a\u0443 \u043f\u043e\u0437\u0436\u0435.";LkIp.Msg.error(c)}})},saveChosenKktData:function(c,d){var b=this,a=b.getIndex();d=d||false;if(!d){b.kktModelObject=b.temporarySelectedKkt.getData();b.kktModelObject.factory_code=c}if(typeof b.chooseKktWindow!="undefined"){b.resetKktSelection();b.chooseKktWindow.close()}a.down("#editKkt").hide();b.kktFactoryCodeValid=true;b.updateStringValue("modelKktString",b.generateKktModelString(b.kktModelObject.value,b.kktModelObject.version,c,b.selectedKkt.status_key!="13012"));b.checkFormForValidity();if(!d){b.resetFnFields()}b.getIndex().down("#fnBlock").show()},changeKktFactoryCode:function(b,d){var c=this,a=c.chooseKktWindow.down("#kktRegistrationChooseKktButton");if(d.length>0&&!Ext.Object.isEmpty(c.temporarySelectedKkt)&&c.chooseKktWindow.down("#kktRegistrationChooseKktForm").isValid()){a.enable()}else{a.disable()}},resetKktSelection:function(){var a=this;Ext.suspendLayouts();a.chooseKktWindow.down("#kktRegistrationChooseKktSelected").update({selectedModel:"-"});a.chooseKktWindow.down("#kktRegistrationChooseKktFactoryCode").hide().reset();a.chooseKktWindow.down("#kktRegistrationChooseKktButton").disable();Ext.resumeLayouts(true);a.temporarySelectedKkt={}},generateKktModelString:function(e,a,d,c){var b=e;c=c||false;if(!Ext.isEmpty(a)){b+=", \u0412\u0435\u0440\u0441\u0438\u044f: "+a}if(!Ext.isEmpty(d)){b+=", \u0417\u0430\u0432\u043e\u0434\u0441\u043a\u043e\u0439 \u043d\u043e\u043c\u0435\u0440: "+d}if(c){b+='<div class="edit-icon pencil-icon editChosenKkt"></div>'}return b},closeKkt:function(){this.getIndex().down("#editKkt").enable()},editFn:function(){var b=this,a=b.getIndex();a.setLoading(true);LkIp.Request.request({url:"/api/fn/model/list"},function(c){a.setLoading(false);if(c.status){b.cacheFnList=c.response;b.showEditFnBlock()}else{LkIp.Msg.error("\u041f\u043e \u0442\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u0438\u043c \u043f\u0440\u0438\u0447\u0438\u043d\u0430\u043c \u043d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0444\u0438\u0441\u043a\u0430\u043b\u044c\u043d\u044b\u0445 \u043d\u0430\u043a\u043e\u043f\u0438\u0442\u0435\u043b\u0435\u0439. \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u0412\u0430\u0448 \u0437\u0430\u043f\u0440\u043e\u0441 \u043f\u043e\u0437\u0436\u0435.")}})},showEditFnBlock:function(){var b=this,a=b.getIndex();b.chooseFnWindow=Ext.create("LkIp.view.Kkt.ChooseFn",{itemId:"kktRegistrationChooseFn",title:b.generateTitleForFn()});b.chooseFnStore=Ext.getStore("kktRegistrationChooseFnStore");b.chooseFnStore.removeAll();b.chooseFnStore.loadData(b.cacheFnList);b.resetFnSelection();b.chooseFnWindow.show();if(!Ext.Object.isEmpty(b.fnModelObject)){b.chooseFnWindow.down("#kktRegistrationChooseFnGrid").getSelectionModel().select(b.chooseFnStore.findExact("code",b.fnModelObject.code));b.chooseFnWindow.down("#kktRegistrationChooseFnFactoryCode").setValue(b.fnModelObject.factory_code)}a.down("#editFn").disable()},changeFnListFilter:function(b,d){var c=this,a=true;try{new RegExp(d,"i")}catch(f){a=false}if(d.length>0&&a){c.chooseFnStore.filterBy(function(e){var g=e.get("value");return g.search(new RegExp(d,"i"))>=0})}else{c.chooseFnStore.clearFilter()}},selectFnModelInGrid:function(g,b){this.resetFnSelection();if(b.length){Ext.suspendLayouts();var e=this,a=b[0],f=e.chooseFnWindow.down("#kktRegistrationChooseFnSelected"),d=e.chooseFnWindow.down("#kktRegistrationChooseFnFactoryCode"),c=e.chooseFnWindow.down("#kktRegistrationChooseFnButton");d.show().reset();f.update({selectedModel:e.generateFnModelString(a.get("value"))});e.temporarySelectedFn=a;c.disable();Ext.resumeLayouts(true);d.focus()}},generateFnModelString:function(b,d,c){var a=b;c=c||false;if(!Ext.isEmpty(d)){a+=" \u0417\u0430\u0432\u043e\u0434\u0441\u043a\u043e\u0439 \u043d\u043e\u043c\u0435\u0440: "+d}if(c){a+='<div class="edit-icon pencil-icon editChosenFn"></div>'}return a},changeFnFactoryCode:function(b,d){var c=this,a=c.chooseFnWindow.down("#kktRegistrationChooseFnButton");if(d.length>0&&!Ext.Object.isEmpty(c.temporarySelectedFn)&&c.chooseFnWindow.down("#kktRegistrationChooseFnForm").isValid()){a.enable()}else{a.disable()}},chooseFn:function(){var a=this,b=a.chooseFnWindow.down("#kktRegistrationChooseFnFactoryCode").getValue();a.chooseFnWindow.setLoading(true);LkIp.Request.request({url:"/api/kkt/fn/check",params:{factory_code:b,model_code:a.temporarySelectedFn.get("code")}},function(d){a.chooseFnWindow.setLoading(false);if(false!=d&&d.status!=0){if(d.response.result==0){a.saveChosenFnData(b)}else{a.fnFactoryCodeValid=false;if(!Ext.isEmpty(d.response.errorText)){a.chooseFnWindow.down("#kktRegistrationChooseFnFactoryCode").markInvalid(d.response.errorText)}}}else{var c=!Ext.isEmpty(d.response)?d.response:"\u0423\u0432\u0430\u0436\u0430\u0435\u043c\u044b\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c, \u0432 \u0434\u0430\u043d\u043d\u044b\u0439 \u043c\u043e\u043c\u0435\u043d\u0442 \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u0443\u044e \u043c\u043e\u0434\u0435\u043b\u044c \u0444\u0438\u0441\u043a\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043d\u0430\u043a\u043e\u043f\u0438\u0442\u0435\u043b\u044f \u043d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e. \u041f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u043f\u043e\u043f\u044b\u0442\u043a\u0443 \u043f\u043e\u0437\u0436\u0435.";LkIp.Msg.error(c)}})},saveChosenFnData:function(b,c){var a=this;c=c||false;if(!c){a.fnModelObject=a.temporarySelectedFn.getData();a.fnModelObject.factory_code=b}if(typeof a.chooseFnWindow!="undefined"){a.resetFnSelection();a.chooseFnWindow.close()}a.getIndex().down("#editFn").hide();a.fnFactoryCodeValid=true;a.updateStringValue("modelFnString",a.generateFnModelString(a.fnModelObject.value,b,true));a.checkFormForValidity()},closeFn:function(){this.getIndex().down("#editFn").enable()},generateTitleForFn:function(){var b=this,a=reference.lang.kkt.registration.chooseFnWindowTitle+b.kktModelObject.value;if(!Ext.isEmpty(b.kktModelObject.version)){a+=", \u0412\u0435\u0440\u0441\u0438\u044f "+b.kktModelObject.version}return a},resetFnSelection:function(){var a=this;Ext.suspendLayouts();a.chooseFnWindow.down("#kktRegistrationChooseFnSelected").update({selectedModel:"-"});a.chooseFnWindow.down("#kktRegistrationChooseFnFactoryCode").hide().reset();a.chooseFnWindow.down("#kktRegistrationChooseFnButton").disable();Ext.resumeLayouts(true);a.temporarySelectedFn={}},resetFnFields:function(){var b=this,a=b.getIndex();a.down("#fnBlock").hide();a.down("#editFn").show();b.fnFactoryCodeValid=false;b.fnModelObject={};b.updateStringValue("modelFnString");b.checkFormForValidity()},changeAutoMode:function(b,d){var c=this,a=c.getIndex();Ext.suspendLayouts();if(d){a.down("#ofdBlock").hide();a.down("#ofd_code").disable();a.down("#ofd_code").labelEl.update(a.down("#ofd_code").fieldLabel);a.down("#ofd_code").allowBlank=true;a.down("#ofd_code").validate()}else{a.down("#ofdBlock").show();a.down("#ofd_code").enable();a.down("#ofd_code").allowBlank=false;a.down("#ofd_code").labelEl.update(a.down("#ofd_code").fieldLabel+LkIp.Utils.requiredLabel())}c.checkFormForValidity();Ext.resumeLayouts(true)},selectOfd:function(b,e){var c=this,d="",a=c.getIndex().down("#ofd_inn");if(e.length>0){d=e[0].get("inn")}a.show().setValue(d)},changeInternet:function(d,f){var e=this,b=e.getIndex(),a=b.down("#web_address"),c=b.down("#place_name");if(f){a.show().enable();c.hide().disable()}else{a.hide().disable();c.show().enable()}e.checkFormForValidity()},submitRegisterForm:function(){var e=this,b=e.getIndex(),a=b.down("#kktRegistrationForm").getForm().getValues(),c={},d={};c.model_code=e.kktModelObject.code;c.model_factory_code=e.kktModelObject.factory_code;d.fn_code=e.fnModelObject.code;d.model_fn_code=e.fnModelObject.factory_code;a=Ext.Object.merge(a,c,d);if(!Ext.isEmpty(e.selectedKkt.rnm)){a.rnm=e.selectedKkt.rnm}if(e.oldAddress){a=Ext.Object.merge(a,e.defaultAddressObject)}else{a.fias_id=e.selectedAddressGuid}b.setLoading(true);LkIp.Request.request({url:"/api/kkt/register",method:"POST",params:a},function(f){e.getController("Viewport").signAction(f,{loader:e.getIndex(),successCallback:function(){var g=e.getIndex();g.down("#kktRegistrationForm").getForm().reset();LkIp.Msg.success(reference.lang.kkt.registration.success,{rewriteDefaultButtons:true,buttons:[{text:reference.lang.buttons.ok,handler:function(){LkIp.Msg.fireEvent("closemessagebox",LkIp.Msg);LkIp.Msg.close();LkIp.Utils.goTo("#!/kkt")}}]});e.updateStringValue("addressString");e.resetPage()},errorCallback:function(g){var h=Ext.isEmpty(g)?reference.lang.kkt.registration.error:g;LkIp.Msg.error(h)}})})},pdfAction:function(){var e=this,b=e.getIndex(),a=b.down("#kktRegistrationForm").getForm().getValues(),c={},d={};c.model_code=e.kktModelObject.code;c.model_factory_code=e.kktModelObject.factory_code;d.fn_code=e.fnModelObject.code;d.model_fn_code=e.fnModelObject.factory_code;a=Ext.Object.merge(a,c,d);if(e.oldAddress){a=Ext.Object.merge(a,e.defaultAddressObject)}LkIp.Utils.downloadDocument("kktRegisterPdf","/api/kkt/register/pdf",a)},tryToLoadDetails:function(){var b=this,a=b.getIndex();if(Ext.isEmpty(b.kktId)){b.checkLoader()}else{LkIp.Request.request({url:"/api/kkt/details",params:{id:b.kktId}},function(c){if(false!=c&&!Ext.isEmpty(c)&&c.status==1&&(c.response.status_key=="13002"||c.response.status_key=="13012")){b.selectedKkt=c.response;b.kktModelObject={code:b.selectedKkt.model_code,value:b.selectedKkt.model_kkt,version:b.selectedKkt.model_version,factory_code:b.selectedKkt.model_factory_code};b.fnModelObject={code:b.selectedKkt.fn_code,value:b.selectedKkt.model_fn,factory_code:b.selectedKkt.model_fn_code};b.defaultAddressObject=Ext.Object.merge(b.defaultAddressObject,b.selectedKkt.address_details);b.defaultAddressObject.addressString=b.selectedKkt.address;b.defaultAddressObject.no=b.selectedKkt.no;b.hasOldAddressDetails=!Ext.isEmpty(b.defaultAddressObject.fias_id)&&!Ext.isEmpty(b.defaultAddressObject.no);if(b.hasOldAddressDetails){b.selectedAddress=b.defaultAddressObject.addressString;b.selectedAddressGuid=b.defaultAddressObject.fias_id;b.selectedAddressIsLastChild=true;b.getController("AddressFIAS").selectedAddressGuid=b.selectedAddressGuid;b.getController("AddressFIAS").selectedAddressIsLastChild=b.selectedAddressIsLastChild;b.getController("AddressFIAS").selectedAddressString=b.selectedAddress;b.checkIfRemote(b.defaultAddressObject.fias_id);b.showAddressBlock(true)}else{b.changeAddress(b.selectedAddressGuid,b.selectedAddressRemote,b.selectedAddressIsLastChild);b.remoteLoader=true}b.updateForm()}else{a.down("#predefinedNote").hide();b.resetPage()}b.detailsLoaded=true;b.checkLoader()})}},showAddressBlock:function(c){var b=this,a=b.getIndex();c=c||false;if(c){a.down("#addressString").disable();a.down("#addressFIAS").hide();a.down("#cancelEditAddress").hide();a.down("#kktAddressBlock").show();a.down("#address").update(b.defaultAddressObject.addressString+'<div class="edit-icon pencil-icon editAddressReg"></div>');b.changeAddress(b.defaultAddressObject.fias_id,b.defaultAddressRemote,true);b.oldAddress=true}else{b.selectedAddressGuid=null;b.selectedAddressRemote=null;b.selectedAddressIsLastChild=false;a.down("#addressString").enable();a.down("#addressFIAS").show();a.down("#cancelEditAddress").show();a.down("#addressString").setWidth(830);a.doLayout();a.down("#kktAddressBlock").hide();b.getController("AddressFIAS").resetAddressForm();b.getController("AddressFIAS").clearAddressFields(1);b.getController("AddressFIAS").disableApartmentField();b.changeAddress(b.selectedAddressGuid,b.selectedAddressRemote,b.selectedAddressIsLastChild);b.oldAddress=false}b.checkFormForValidity()},canFullyUpdateStatement:function(){return this.selectedKkt.status_key=="13002"},updateForm:function(){var b=this,a=b.getIndex();Ext.suspendLayouts();a.down("#addressBlock").hide();b.saveChosenKktData(b.kktModelObject.factory_code,true);b.saveChosenFnData(b.fnModelObject.factory_code,true);if(!Ext.isEmpty(b.selectedKkt.place_name)){a.down("#place_name").setValue(b.selectedKkt.place_name)}if(!Ext.isEmpty(b.selectedKkt.autoMode)&&b.selectedKkt.autoMode==1){a.down("#autoMode").setValue(true);a.down("#autoMode").fireEvent("change",a.down("#autoMode"),true)}b.changeAddress(b.selectedAddressGuid,b.selectedAddressRemote,b.selectedAddressIsLastChild);if(!Ext.isEmpty(b.selectedKkt.lottery)&&b.selectedKkt.lottery==1){a.down("#lottery").setValue(true)}if(!Ext.isEmpty(b.selectedKkt.rates)&&b.selectedKkt.rates==1){a.down("#rates").setValue(true)}if(!Ext.isEmpty(b.selectedKkt.rates)&&b.selectedKkt.rates==1){a.down("#rates").setValue(true)}if(!Ext.isEmpty(b.selectedKkt.bank)&&b.selectedKkt.bank==1){a.down("#bank").setValue(true)}if(!Ext.isEmpty(b.selectedKkt.calculation_device)&&b.selectedKkt.calculation_device==1){a.down("#calculation_device").setValue(true);a.down("#calculation_device").fireEvent("change",a.down("#calculation_device"),true);a.down("#calculation_device_number").setValue(b.selectedKkt.calculation_device_number)}if(!Ext.isEmpty(b.selectedKkt.internet)&&b.selectedKkt.internet==1){a.down("#internet").setValue(true);a.down("#web_address").setValue(b.selectedKkt.place_name)}if(!Ext.isEmpty(b.selectedKkt.peddling)&&b.selectedKkt.peddling==1){a.down("#peddling").setValue(true)}if(!Ext.isEmpty(b.selectedKkt.blank)&&b.selectedKkt.blank==1){a.down("#blank").setValue(true)}if(!Ext.isEmpty(b.selectedKkt.ofd_code)){var c=b.ofdForRegisterStore.getAt(b.ofdForRegisterStore.findExact("code",b.selectedKkt.ofd_code));if(c){a.down("#ofd_code").select(c);a.down("#ofd_code").fireEvent("select",a.down("#ofd_code"),[c])}}a.down("#predefinedNote").show();Ext.resumeLayouts(true)},checkForChanges:function(b){var c=this;var a=c.originalAddress.addressString==b.addressString&&b.model_factory_code==c.selectedKkt.model_factory_code&&b.model_fn_code==c.selectedKkt.model_fn_code&&b.model_code==c.selectedKkt.model_code&&b.fn_code==c.selectedKkt.fn_code&&((typeof b.autoMode=="undefined"&&c.selectedKkt.autoMode==2)||b.autoMode==c.selectedKkt.autoMode)&&((typeof b.lottery=="undefined"&&c.selectedKkt.lottery==2)||b.lottery==c.selectedKkt.lottery)&&((typeof b.rates=="undefined"&&c.selectedKkt.rates==2)||b.rates==c.selectedKkt.rates)&&((typeof b.bank=="undefined"&&c.selectedKkt.bank==2)||b.bank==c.selectedKkt.bank)&&((typeof b.calculation_device=="undefined"&&c.selectedKkt.calculation_device==2)||b.calculation_device==c.selectedKkt.calculation_device)&&((typeof b.internet=="undefined"&&c.selectedKkt.internet==2)||b.internet==c.selectedKkt.internet)&&((typeof b.peddling=="undefined"&&c.selectedKkt.peddling==2)||b.peddling==c.selectedKkt.peddling)&&((typeof b.blank=="undefined"&&c.selectedKkt.blank==2)||b.blank==c.selectedKkt.blank);if(a){return !!(b.ofd_code&&b.ofd_code!=c.selectedKkt.ofd_code)}return true},resetPage:function(){var b=this,a=b.getIndex();Ext.suspendLayouts();a.down("#editKkt").show();a.down("#editFn").show();a.down("#predefinedNote").hide();a.down("#kktRegistrationForm").getForm().reset();a.down("#addressFIAS").fireEvent("clearAddress",1);b.updateStringValue("modelKktString");b.updateStringValue("modelFnString");b.resetFnFields();Ext.resumeLayouts(true);b.kktFactoryCodeValid=false;b.fnFactoryCodeValid=false;b.kktModelObject={};b.fnModelObject={};b.selectedKkt={};b.temporarySelectedKkt={};b.temporarySelectedFn={};b.chooseKktWindow=undefined;b.chooseFnWindow=undefined;b.detailsLoaded=false;b.kktId=undefined;b.checkFormForValidity()},checkLoader:function(){var a=this;if(a.referenceLoaded&&a.detailsLoaded&&a.newNoticeCountLoaded){a.getIndex().setLoading(false)}},updateStringValue:function(c,a){var b=this;a=a||"";b.getIndex().down("#"+c).update(a)},checkFormForValidity:function(){var b=this,a=b.getIndex(),d=a.down('[name="kktRegisterSubmit"]'),c=a.down('[name="kktRegisterPdfSubmit"]');if(a.down("#kktRegistrationForm").getForm().isValid()&&!Ext.isEmpty(b.selectedAddress)&&b.selectedAddressGuid!==null&&b.selectedAddressIsLastChild&&b.kktFactoryCodeValid&&b.fnFactoryCodeValid){d.enable();c.enable()}else{d.disable();c.disable()}},checkIfRemote:function(b){var c=this,a=c.getIndex();LkIp.Request.request({url:"/api/fiasservice",params:{guid:b,param:"check"},method:"GET"},function(d){if(false!==d&&!(Ext.isEmpty(d.response))){if(d.status==1){d=d.response;c.defaultAddressRemote=d.IsRemote;c.selectedAddressRemote=c.defaultAddressRemote;c.changeAddress(b,d.IsRemote,true);c.remoteLoader=true;c.checkLoader()}else{LkIp.Msg.error(reference.lang.address.notFullAddress);return false}}else{LkIp.Msg.error(reference.lang.address.notFullAddress);return false}})}},0,0,0,0,0,0,[LkIp.controller.Kkt,"Registration"],0));(Ext.cmd.derive("LkIp.controller.Kkt.RegistrationFile",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"kktRegistrationFile"},{ref:"formPanel",selector:"#kktRegistrationForm"},{ref:"exampleLink",selector:"#downloadKktExample"}],hash:"",id:"",selectedFile:undefined,init:function(){var a=this;a.control({"#kktRegistrationFile":{activate:function(){var b=this.getFormPanel();b.getForm().reset();b.down('[name="file"]').setRawValue("");b.down('[name="signButton"]').disable()}},'#kktRegistrationFile [name="signButton"]':{click:this.submitFormAction},'#kktRegistrationFile [name="file"]':{change:this.chooseFileToUpload},"#kktRegistrationFile #resetFile":{click:this.resetFileAction}});Ext.getBody().addListener("click",a.downloadXmlExample,a,{preventDefault:true,stopEvent:false,delegate:".download-kkt-example"});a.callParent()},loadIndex:function(){var b=this,a;b.callParent();a=b.getIndex();if(!LkIp.User.canSendKkt()){LkIp.app.getController("Viewport").tellUserAboutHeadProblems()}else{if(!LkIp.User.isActiveUser()){LkIp.app.getController("Viewport").tellUserThatHeCannotSendDocumentsBecauseHeIsClosed()}}a.setLoading(true);LkIp.Request.request("/api/notice/getNewCount",function(d){a.setLoading(false);var c=false!=d&&!Ext.isEmpty(d)&&d.status==1&&!Ext.isEmpty(d.response)&&parseInt(d.response.count)>0;a.down("#newNoticeNote").setVisible(c);a.down("#steps").setDisabled(c)})},chooseFileToUpload:function(b,e){var d=this,c=d.getFormPanel(),a=d.getIndex();e=-1!=e.indexOf("fakepath")?e.replace("C:\\fakepath\\",""):e;if(!Ext.isEmpty(e)){b.setRawValue(e);a.setLoading(true);LkIp.Request.formSubmit(c.down('[rel="fileUpload"]'),{url:"api/kkt/registration/file/upload",scope:d,fileSubmit:true,success:function(g,f){d.selectedFile=f.result.response;b.anchor="90%";a.down("#resetFile").show().enable();a.doLayout();d.signDocument()},failure:function(f,g){a.setLoading(false);d.resetFileAction();LkIp.Msg.error(g.result.response)}})}},signDocument:function(){var b=this,a=b.getIndex();LkIp.Request.request({url:"api/kkt/registration/file/send",scope:b,params:{file:b.selectedFile},method:"POST"},function(c){if(!c){LkIp.Msg.error("\u0412\u043e \u0432\u0440\u0435\u043c\u044f \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u0444\u0430\u0439\u043b\u0430 \u043f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u0442\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430.");b.resetFileAction();a.setLoading(false);return false}if(!c.status){LkIp.Msg.error(c.response);b.resetFileAction();a.setLoading(false);return false}b.hash=Ext.isEmpty(c.response["@hash"])?"":c.response["@hash"];b.id=c.response["@id"];b.type=c.response["@typeId"];b.analiseFile()})},analiseFile:function(){var b=this,a=b.getIndex();LkIp.Request.request({url:"api/kkt/registration/file/analise",scope:b,params:{file:b.selectedFile},method:"POST"},function(g){a.setLoading(false);if(!g){LkIp.Msg.error("\u0412\u043e \u0432\u0440\u0435\u043c\u044f \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u0444\u0430\u0439\u043b\u0430 \u043f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u0442\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430.");b.resetFileAction();return false}if(!g.status){LkIp.Msg.error(g.response);b.resetFileAction();return false}var d=a.down("#gridContainer"),f=a.down("#fileList"),c=a.down("#signBtn"),e;d.show();f.getStore().loadData(g.response);e=b.getFiltered(f.getStore().getRange());if(e.length>0){c.enable()}})},getFiltered:function(a){var b=[];Ext.Array.each(a,function(c){if(Ext.isEmpty(c.get("file_status"))){b.push(c.getData())}});return b},resetFileAction:function(){var i=this,g=i.getIndex(),e=g.down("#fileUpload"),b=i.getFormPanel(),d=g.down("#file"),h=g.down("#resetFile"),f=g.down("#gridContainer"),a=g.down("#fileList"),c=g.down("#signBtn");i.selectedFile=undefined;a.getStore().removeAll();Ext.suspendLayouts();f.hide();e.getForm().reset();d.setRawValue("");g.down("#resetFile").hide().disable();d.anchor="100%";h.hide().disable();c.disable();Ext.resumeLayouts(true);g.doLayout()},submitFormAction:function(){var c=this,a=c.getIndex(),e=c.getFormPanel().getValues(),b=a.down("#fileList"),d=b.getStore().getRange(),f=c.getFiltered(d);if(f.length>0&&LkIp.User.canSendKkt()){a.setLoading(true);e.names=Ext.JSON.encode(f);e.file=c.selectedFile;LkIp.Request.request({url:"api/kkt/registration/file/load",scope:c,params:e,method:"POST"},function(g){if(0!=g.status){c.getController("Viewport").signAction({status:1,response:{"@hash":c.hash,"@id":c.id,"@typeId":c.type}},{loader:c.getIndex(),successCallback:function(){c.resetFileAction();LkIp.Msg.success(reference.lang.signature.successDefault)}})}else{a.setLoading(false);LkIp.Msg.error("\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430 \u0444\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u043f\u0430\u043a\u0435\u0442\u0430 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u043e\u0432")}})}else{LkIp.app.getController("Viewport").tellUserAboutHeadProblems()}},downloadXmlExample:function(){var a=this;Ext.DomHelper.append(Ext.getBody(),{tag:"form",id:"get-kkt-file",action:"api/kkt/registration/file/example",method:"POST",cn:[]}).submit()}},0,0,0,0,0,0,[LkIp.controller.Kkt,"RegistrationFile"],0));(Ext.cmd.derive("LkIp.controller.Kkt.ReRegistration",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"kktReRegistration"}],defaultAddressObject:{region:"",regionName:"",postcode:"",oktmo:"",district:"",city:"",locality:"",street:"",house:"",housing:"",apartment:"",no:"",fias_id:"",addressString:""},fnModelObject:{},modelFnCodeValid:true,chooseFnWindow:undefined,temporarySelectedFn:{},selectedKkt:{},originalAddress:{},selectedAddress:undefined,selectedAddressGuid:null,selectedAddressRemote:null,selectedAddressIsLastChild:false,hasOldAddressDetails:false,init:function(){var b=this,a=Ext.getBody();a.addListener("click",b.editFn,b,{preventDefault:true,stopEvent:true,delegate:".editChosenFnInRe"});a.addListener("click",b.editAddress,b,{preventDefault:true,stopEvent:true,delegate:".editChosenAddressInRe"});a.addListener("click",function(){b.showAddressBlock(false)},b,{delegate:".editAddressRereg"});b.control({'#kktReRegistrationForm [rel="changeAddress"]':{change:b.toggleAddress},'#kktReRegistrationForm [rel="changeOfd"]':{change:b.toggleOfd},'#kktReRegistrationForm [rel="changeFn"]':{change:b.toggleFn},'#kktReRegistrationForm [rel="changeCalculationDevice"]':{change:b.toggleCalculationDevice},'#kktReRegistrationForm [rel="changeOtherReasons"]':{change:b.toggleOther},kktReRegistration:{deactivate:function(){var c=this;c.getIndex().down("#modelInfo").update({});c.resetAllFields();c.selectedKkt={};c.fnModelObject={};Ext.suspendLayouts();c.getIndex().down("#reason_reregistration").setValue();c.getIndex().down("#changeAddress").show();c.getIndex().down("#changeCheckOfd").show();c.getIndex().down("#changeCalculationDevice").show();c.getIndex().down("#changeFn").show();c.getIndex().down("#autoToCommon").show();c.getIndex().down("#commonToAuto").show();c.getIndex().down("#commonToAuto").show();Ext.resumeLayouts(true)}},"kktReRegistration #addressFIAS":{changeFiasAddress:b.changeAddress,addressLoader:b.addressLoader},'#kktReRegistration [name="kktReRegisterSubmit"]':{click:b.submitRegisterForm},'#kktReRegistration [name="kktReRegisterPdfSubmit"]':{click:b.showPdf},"#kktReRegistration #ofd_code":{blur:b.blurOfd,select:b.selectOfd},"kktReRegistration #kktReRegistrationForm":{validitychange:function(c,e){var d=this;d.checkFormForValidity()}},"#kktReRegistration #flagBroken":{change:b.changeBrokenFlag},"#kktReRegistrationChooseFn":{close:b.closeFn},"kktReRegistration #editFnInRe":{click:b.editFn},"#kktReRegistrationChooseFn #chooseFnModelFilter":{change:b.changeFnListFilter},"#kktReRegistrationChooseFn #kktRegistrationChooseFnGrid":{selectionchange:b.selectFnModelInGrid},"#kktReRegistrationChooseFn #kktRegistrationChooseFnFactoryCode":{change:b.changeFnFactoryCode},"#kktReRegistrationChooseFn #kktRegistrationChooseFnButton":{click:b.chooseFn},"#kktReRegistration #internet":{change:b.changeInternet},'kktReRegistration [name="kpk_number"]':{change:b.changeKpkNumber},"kktReRegistration #in_calculation_device":{change:b.changeCalculationDevice}});b.callParent()},loadIndex:function(){var b=this,a,c;b.callParent();if(!LkIp.User.canSendKkt()){LkIp.app.getController("Viewport").tellUserAboutHeadProblems()}else{if(!LkIp.User.isActiveUser()){LkIp.app.getController("Viewport").tellUserThatHeCannotSendDocumentsBecauseHeIsClosed()}}a=b.getIndex();a.setLoading(true);LkIp.Request.request("/api/notice/getNewCount",function(e){b.newNoticeCountLoaded=true;b.checkLoader();var d=false!=e&&!Ext.isEmpty(e)&&e.status==1&&!Ext.isEmpty(e.response)&&parseInt(e.response.count)>0;a.down("#newNoticeNote").setVisible(d);a.down("#kktReRegistrationForm").setDisabled(d)});b.ofdForReRegisterStore=Ext.getStore("ofdForReRegisterStore");LkIp.Request.request({url:"/api/kkt/details",params:{id:b.kktId}},function(d){if(!Ext.isEmpty(d)&&d.status==1&&!Ext.isEmpty(d.response.date)){b.selectedKkt=d.response}else{LkIp.Utils.goTo("#!/kkt");return false}b.resetAllFields();b.kktLoaded=true;b.checkLoader();b.selectedKkt.rnm=!Ext.isEmpty(b.selectedKkt.rnm)?LkIp.Utils.formatRnm(b.selectedKkt.rnm):"";b.selectedKkt.model_kkt=!Ext.isEmpty(b.selectedKkt.model_version)?b.selectedKkt.model_kkt+" \u0432\u0435\u0440\u0441\u0438\u044f "+b.selectedKkt.model_version:b.selectedKkt.model_kkt;a.down("#modelInfo").update(b.selectedKkt);b.defaultAddressObject=Ext.Object.merge(b.defaultAddressObject,b.selectedKkt.address_details);b.defaultAddressObject.addressString=b.selectedKkt.address;b.defaultAddressObject.no=b.selectedKkt.no;b.hasOldAddressDetails=!Ext.isEmpty(b.defaultAddressObject.fias_id)&&!Ext.isEmpty(b.defaultAddressObject.no);if(b.hasOldAddressDetails){b.selectedAddress=b.selectedKkt.address;b.selectedAddressGuid=b.defaultAddressObject.fias_id;b.selectedAddressIsLastChild=true;b.getController("AddressFIAS").selectedAddressGuid=b.selectedAddressGuid;b.getController("AddressFIAS").selectedAddressIsLastChild=b.selectedAddressIsLastChild;b.getController("AddressFIAS").selectedAddressString=b.selectedAddress;b.checkIfRemote(b.defaultAddressObject.fias_id)}else{b.remoteLoader=true}if(b.selectedKkt.autoMode==2){a.down("#autoToCommon").hide()}else{if(b.selectedKkt.autoMode==1){a.down("#commonToAuto").hide();a.down("#changeCheckOfd").hide()}}LkIp.Request.request({url:"/api/kkt/registration/reference"},function(e){if(!Ext.isEmpty(e.response.ofd)){b.ofdForReRegisterStore.loadData(e.response.ofd)}b.referenceLoaded=true;b.checkLoader()})})},showAddressBlock:function(c){var b=this,a=b.getIndex();c=c||false;if(c){a.down("#addressString").disable();a.down("#addressFIAS").hide();a.down("#cancelEditAddress").hide();a.down("#kktAddressBlock").show();a.down("#address").update(b.defaultAddressObject.addressString+'<div class="edit-icon pencil-icon editAddressRereg"></div>');b.changeAddress(b.defaultAddressObject.fias_id,b.defaultAddressRemote,true);b.oldAddress=true}else{b.selectedAddressGuid=null;b.selectedAddressRemote=null;b.selectedAddressIsLastChild=false;a.down("#addressString").enable();a.down("#addressFIAS").show();a.down("#cancelEditAddress").show();a.down("#addressString").setWidth(830);a.doLayout();a.down("#kktAddressBlock").hide();b.getController("AddressFIAS").resetAddressForm();b.getController("AddressFIAS").clearAddressFields(1);b.getController("AddressFIAS").disableApartmentField();b.changeAddress(b.selectedAddressGuid,b.selectedAddressRemote,b.selectedAddressIsLastChild);b.oldAddress=false}b.checkFormForValidity()},generateAddressString:function(a){var b=[];if(!LkIp.Utils.isEmpty(a.regionName)){b.push(a.region+"-"+a.regionName)}if(!LkIp.Utils.isEmpty(a.postcode)){b.push(a.postcode)}if(!LkIp.Utils.isEmpty(a.district)){b.push(a.district)}if(!LkIp.Utils.isEmpty(a.city)){b.push(a.city)}if(!LkIp.Utils.isEmpty(a.locality)){b.push(a.locality)}if(!LkIp.Utils.isEmpty(a.street)){b.push(a.street)}if(!LkIp.Utils.isEmpty(a.house)){var c=a.house;if(!LkIp.Utils.isEmpty(a.housing)){c+=" "+a.housing}b.push(c)}if(!LkIp.Utils.isEmpty(a.apartment)){b.push(a.apartment)}return b.join(", ")},toggleAddress:function(c,e){var d=this,b=d.getIndex(),f=b.down("#changeOtherReasons").getValue(),a=b.down("#internet").getValue();if(e){Ext.suspendLayouts();b.down("#step2-address-container").show();Ext.Array.forEach(b.down("#step2-address-container").query(".field"),function(g){g.setDisabled(false)});if(d.hasOldAddressDetails){d.showAddressBlock(true)}if(d.selectedKkt.internet==1){b.down("#place_name").disable().hide()}else{b.down("#place_name").enable().show();b.down("#place_name").setValue(d.selectedKkt.place_name)}if(f){if(a){b.down("#place_name").disable().hide()}else{b.down("#place_name").enable().show()}}Ext.resumeLayouts(true)}else{d.getController("AddressFIAS").resetAddressForm();d.getController("AddressFIAS").clearAddressFields();d.selectedAddress=undefined;Ext.suspendLayouts();Ext.Array.forEach(b.down("#step2-address-container").query(".field"),function(g){g.setDisabled(true)});b.down("#step2-address-container").hide();Ext.resumeLayouts(true)}d.checkFormForValidity()},changeAddress:function(a,c,e){var d=this,b=d.getIndex();d.selectedAddressGuid=a;d.selectedAddressRemote=c;d.selectedAddressIsLastChild=e;d.selectedAddress=d.getController("AddressFIAS").selectedAddressString;d.checkFormForValidity()},addressLoader:function(a){var c=this,b=c.getIndex();b.setLoading(a)},toggleOfd:function(b,d){var c=this,a=c.getIndex();if(d){a.down("#step2-ofd-container").show();Ext.Array.forEach(a.down("#step2-ofd-container").query(".field"),function(f){f.setDisabled(false)})}else{Ext.suspendLayouts();Ext.Array.forEach(a.down("#step2-ofd-container").query(".field"),function(f){f.setDisabled(true)});a.down("#step2-ofd-container").hide();Ext.resumeLayouts(true)}c.checkFormForValidity()},toggleOther:function(b,d){var c=this,a=c.getIndex();if(d){Ext.suspendLayouts();a.down("#step2-other-container").show();Ext.Array.forEach(a.down("#step2-other-container").query(".field"),function(f){f.setDisabled(false)});a.down("#lottery").setValue(c.selectedKkt.lottery==1);a.down("#rates").setValue(c.selectedKkt.rates==1);a.down("#bank").setValue(c.selectedKkt.bank==1);a.down("#internet").setValue(c.selectedKkt.internet==1);a.down("#internet").fireEvent("change",a.down("#internet"),c.selectedKkt.internet==1);a.down("#peddling").setValue(c.selectedKkt.peddling==1);a.down("#blank").setValue(c.selectedKkt.blank==1);a.down("#akciz").setValue(c.selectedKkt.akciz==1);a.down("#payment_agent").setValue(c.selectedKkt.payment_agent==1);Ext.resumeLayouts(true)}else{Ext.suspendLayouts();Ext.Array.forEach(a.down("#step2-other-container").query(".field"),function(f){f.setDisabled(true)});a.down("#step2-other-container").hide();a.down("#internet").fireEvent("change",a.down("#internet"),c.selectedKkt.internet==1);Ext.resumeLayouts(true)}c.checkFormForValidity()},toggleFn:function(b,d){var c=this,a=c.getIndex();c.resetFnFields();if(d){a.down("#step2-fn-container").show();Ext.Array.forEach(a.down("#step2-fn-container").query(".field"),function(f){f.setDisabled(false)})}else{Ext.suspendLayouts();Ext.Array.forEach(a.down("#step2-fn-container").query(".field"),function(f){f.setDisabled(true)});a.down("#step2-fn-container").hide();Ext.resumeLayouts(true)}c.checkFormForValidity()},toggleCalculationDevice:function(b,d){var c=this,a=c.getIndex();if(d){a.down("#step2-calculation-container").show();Ext.Array.forEach(a.down("#step2-calculation-container").query(".field"),function(f){f.setDisabled(false)});a.down("#step2-calculation-container").down("#in_calculation_device").setValue(c.selectedKkt.calculation_device=="1");a.down("#step2-calculation-container").down("#calculation_device_number").setValue(c.selectedKkt.calculation_device_number);a.down("#step2-calculation-container").down("#calculation_device_number").setDisabled(Ext.isEmpty(c.selectedKkt.calculation_device_number))}else{Ext.suspendLayouts();Ext.Array.forEach(a.down("#step2-calculation-container").query(".field"),function(f){f.setDisabled(true)});a.down("#step2-calculation-container").hide();Ext.resumeLayouts(true)}c.checkFormForValidity()},resetAllFields:function(){var c=this,a=c.getIndex(),b=a.down("#kktReRegistrationForm");Ext.suspendLayouts();Ext.Array.forEach(b.query("[isFormField]"),function(d){d.reset();if(typeof d.alwaysEnabled=="undefined"||!d.alwaysEnabled){d.setDisabled(true)}});a.down("#step2-address-container").hide();a.down("#step2-ofd-container").hide();a.down("#step2-fn-container").hide();a.down("#step2-other-container").hide();a.down("#addressFIAS").fireEvent("clearAddress",1);Ext.resumeLayouts(true);c.getViewport().doLayout();c.selectedAddress=undefined;c.resetFnFields()},checkLoader:function(){var b=this,a=b.getIndex();if(b.kktLoaded&&b.referenceLoaded&&b.newNoticeCountLoaded){a.setLoading(false);b.afterLoading()}},afterLoading:function(){var a=this},submitRegisterForm:function(){var d=this,b=d.getIndex(),a=b.down("#kktReRegistrationForm").getForm().getValues(),c={};a.factory_code=d.selectedKkt.model_factory_code;a.id=d.kktId;if(!Ext.isArray(a.reason_reregistration)){a.reason_reregistration=[a.reason_reregistration]}if(Ext.Array.contains(a.reason_reregistration,"1")){a.fias_id=d.selectedAddressGuid}if(Ext.Array.contains(a.reason_reregistration,"4")){c.fn_code=d.fnModelObject.code;c.model_fn_code=d.fnModelObject.factory_code;a=Ext.Object.merge(a,c)}a.reason_reregistration=Ext.JSON.encode(a.reason_reregistration);b.setLoading(true);LkIp.Request.request({url:"/api/kkt/reregister",method:"POST",params:a},function(e){d.getController("Viewport").signAction(e,{loader:d.getIndex(),successCallback:function(){var f=d.getIndex();d.resetAllFields();LkIp.Msg.success(reference.lang.kkt.reregistration.success,{rewriteDefaultButtons:true,buttons:[{text:reference.lang.buttons.ok,handler:function(){LkIp.Msg.fireEvent("closemessagebox",LkIp.Msg);LkIp.Msg.close();LkIp.Utils.goTo("#!/kkt")}}]})},errorCallback:function(f){var g=Ext.isEmpty(f)?reference.lang.kkt.reregistration.error:f;LkIp.Msg.error(g)}})})},showPdf:function(){var d=this,b=d.getIndex(),a=b.down("#kktReRegistrationForm").getForm().getValues(),c={};a.factory_code=d.selectedKkt.model_factory_code;a.id=d.kktId;if(!Ext.isArray(a.reason_reregistration)){a.reason_reregistration=[a.reason_reregistration]}if(!Ext.Array.contains(a.reason_reregistration,"1")){a=Ext.Object.merge(a,d.defaultAddressObject)}if(Ext.Array.contains(a.reason_reregistration,"4")){c.fn_code=d.fnModelObject.code;c.model_fn_code=d.fnModelObject.factory_code;a=Ext.Object.merge(a,c)}a.reason_reregistration=Ext.JSON.encode(a.reason_reregistration);LkIp.Utils.downloadDocument("kktReRegisterPdf","/api/kkt/reregister/pdf",a)},blurOfd:function(a){var b=this,c=a.getValue();if(-1==b.ofdForReRegisterStore.findExact("code",c)){a.reset();b.getIndex().down("#ofd_inn").hide().reset()}},enableReRegistration:function(c){var b=this,a=b.getIndex();b[c]=true;if(!Ext.isEmpty(a.down("#"+c))){a.down("#"+c).hide()}b.checkFormForValidity()},disableReRegistration:function(c){var b=this,a=b.getIndex();b[c]=false;if(!Ext.isEmpty(a.down("#"+c))){a.down("#"+c).show()}a.down('[name="kktReRegisterSubmit"]').disable();a.down('[name="kktReRegisterPdfSubmit"]').disable()},selectOfd:function(b,e){var c=this,d="",a=c.getIndex().down("#ofd_inn");if(e.length>0){d=e[0].get("inn")}a.show().setValue(d)},setFnFactoryCodeAction:function(b){var c=this,a=c.getIndex(),d=b.getValue(),f=a.down('[name="kktReRegisterSubmit"]'),e=a.down('[name="kktReRegisterPdfSubmit"]');c.removeExtJsError("model_fn_code_custom_error_re");if(!Ext.isEmpty(d)&&b.isValid()){a.setLoading(true);LkIp.Request.request({url:"/api/kkt/fn/check",params:{factory_code:d}},function(g){a.setLoading(false);if(g.status!=0){if(g.response.result==0){if(!Ext.isEmpty(g.response.fn_code)){c.modelFnCodeValid=true;if(a.down("#kktReRegistrationForm").isValid()){f.enable();e.enable()}a.down("#fn_code").setValue(g.response.fn_code);a.down("#fn_name").show().setValue(g.response.fn_name)}}else{c.modelFnCodeValid=false;a.down("#fn_name").hide();f.disable();e.disable();if(!Ext.isEmpty(g.response.errorText)){c.insertExtJsError("model_fn_code",g.response.errorText,"model_fn_code_custom_error_re")}}a.doLayout()}else{c.modelFnCodeValid=false;f.disable();e.disable()}})}},removeExtJsError:function(b){var a=Ext.get(b);if(!Ext.isEmpty(a)){a.remove()}},insertExtJsError:function(d,c,e){var b=this,a=b.getIndex();b.removeExtJsError(e);Ext.DomHelper.insertAfter(a.down("#"+d).inputEl,'<div role="presentation" id="'+e+'" class="x-form-invalid-under" colspan="2"><ul class="x-list-plain"><li role="alert">'+c+"</li></ul></div>")},changeBrokenFlag:function(b,d){var c=this,e=c.getIndex().down("#fiscClose"),a=c.getIndex().down("#noCloseStatement");Ext.suspendLayouts();if(d){Ext.Array.forEach(e.query(".field"),function(f){f.setDisabled(true)});e.hide();a.show()}else{Ext.Array.forEach(e.query(".field"),function(f){f.setDisabled(false)});e.show();a.hide()}Ext.resumeLayouts(true);c.checkFormForValidity()},editFn:function(){var b=this,a=b.getIndex();a.setLoading(true);LkIp.Request.request({url:"/api/fn/model/list",params:{model:b.selectedKkt.model_code}},function(c){a.setLoading(false);if(c.status){b.cacheFnList=c.response;b.showEditFnBlock()}else{LkIp.Msg.error("\u041f\u043e \u0442\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u0438\u043c \u043f\u0440\u0438\u0447\u0438\u043d\u0430\u043c \u043d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0444\u0438\u0441\u043a\u0430\u043b\u044c\u043d\u044b\u0445 \u043d\u0430\u043a\u043e\u043f\u0438\u0442\u0435\u043b\u0435\u0439. \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u0412\u0430\u0448 \u0437\u0430\u043f\u0440\u043e\u0441 \u043f\u043e\u0437\u0436\u0435.")}})},showEditFnBlock:function(){var b=this,a=b.getIndex();b.chooseFnWindow=Ext.create("LkIp.view.Kkt.ChooseFn",{itemId:"kktReRegistrationChooseFn",storeId:"kktReRegistrationChooseFnStore",title:b.generateTitleForFn()});b.chooseFnStore=Ext.getStore("kktReRegistrationChooseFnStore");b.chooseFnStore.removeAll();b.chooseFnStore.loadData(b.cacheFnList);b.resetFnSelection();b.chooseFnWindow.show();if(!Ext.Object.isEmpty(b.fnModelObject)){b.chooseFnWindow.down("#kktRegistrationChooseFnGrid").getSelectionModel().select(b.chooseFnStore.findExact("code",b.fnModelObject.code));b.chooseFnWindow.down("#kktRegistrationChooseFnFactoryCode").setValue(b.fnModelObject.factory_code)}a.down("#editFnInRe").disable()},changeFnListFilter:function(b,d){var c=this,a=true;try{new RegExp(d,"i")}catch(f){a=false}if(d.length>0&&a){c.chooseFnStore.filterBy(function(e){var g=e.get("value");return g.search(new RegExp(d,"i"))>=0})}else{c.chooseFnStore.clearFilter()}},selectFnModelInGrid:function(g,b){this.resetFnSelection();if(b.length){Ext.suspendLayouts();var e=this,a=b[0],f=e.chooseFnWindow.down("#kktRegistrationChooseFnSelected"),d=e.chooseFnWindow.down("#kktRegistrationChooseFnFactoryCode"),c=e.chooseFnWindow.down("#kktRegistrationChooseFnButton");d.show().reset();f.update({selectedModel:e.generateFnModelString(a.get("value"))});e.temporarySelectedFn=a;c.disable();Ext.resumeLayouts(true);d.focus()}},generateFnModelString:function(b,d,c){var a=b;c=c||false;if(!Ext.isEmpty(d)){a+=" \u0417\u0430\u0432\u043e\u0434\u0441\u043a\u043e\u0439 \u043d\u043e\u043c\u0435\u0440: "+d}if(c){a+='<div class="edit-icon pencil-icon editChosenFnInRe"></div>'}return a},changeFnFactoryCode:function(b,d){var c=this,a=c.chooseFnWindow.down("#kktRegistrationChooseFnButton");if(d.length>0&&!Ext.Object.isEmpty(c.temporarySelectedFn)&&c.chooseFnWindow.down("#kktRegistrationChooseFnForm").isValid()){a.enable()}else{a.disable()}},chooseFn:function(){var a=this,b=a.chooseFnWindow.down("#kktRegistrationChooseFnFactoryCode").getValue();if(a.selectedKkt.fn_code==a.temporarySelectedFn.get("code")&&a.selectedKkt.model_fn_code==b){LkIp.Msg.error("\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0432\u044b\u0431\u0440\u0430\u0442\u044c \u0424\u0438\u0441\u043a\u0430\u043b\u044c\u043d\u044b\u0439 \u043d\u0430\u043a\u043e\u043f\u0438\u0442\u0435\u043b\u044c \u0438 \u0435\u0433\u043e \u0437\u0430\u0432\u043e\u0434\u0441\u043a\u043e\u0439 \u043d\u043e\u043c\u0435\u0440 \u043e\u0442\u043b\u0438\u0447\u043d\u044b\u0435 \u043e\u0442 \u0443\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0433\u043e.");return false}a.chooseFnWindow.setLoading(true);LkIp.Request.request({url:"/api/kkt/fn/check",params:{factory_code:b,model_code:a.temporarySelectedFn.get("code")}},function(d){a.chooseFnWindow.setLoading(false);if(false!=d&&d.status!=0){if(d.response.result==0){a.saveChosenFnData(b)}else{a.fnFactoryCodeValid=false;if(!Ext.isEmpty(d.response.errorText)){a.chooseFnWindow.down("#kktRegistrationChooseFnFactoryCode").markInvalid(d.response.errorText)}}}else{var c=!Ext.isEmpty(d.response)?d.response:"\u0423\u0432\u0430\u0436\u0430\u0435\u043c\u044b\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c, \u0432 \u0434\u0430\u043d\u043d\u044b\u0439 \u043c\u043e\u043c\u0435\u043d\u0442 \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u0443\u044e \u043c\u043e\u0434\u0435\u043b\u044c \u0444\u0438\u0441\u043a\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043d\u0430\u043a\u043e\u043f\u0438\u0442\u0435\u043b\u044f \u043d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e. \u041f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u043f\u043e\u043f\u044b\u0442\u043a\u0443 \u043f\u043e\u0437\u0436\u0435.";LkIp.Msg.error(c)}})},saveChosenFnData:function(b,c){var a=this;c=c||false;if(!c){a.fnModelObject=a.temporarySelectedFn.getData();a.fnModelObject.factory_code=b}if(typeof a.chooseFnWindow!="undefined"){a.resetFnSelection();a.chooseFnWindow.close()}a.getIndex().down("#editFnInRe").hide();a.modelFnCodeValid=true;a.updateStringValue("modelFnString",a.generateFnModelString(a.fnModelObject.value,b,true));a.checkFormForValidity()},closeFn:function(){this.getIndex().down("#editFnInRe").enable()},generateTitleForFn:function(){var b=this,a=reference.lang.kkt.registration.chooseFnWindowTitle+b.selectedKkt.model_kkt;if(!Ext.isEmpty(b.selectedKkt.model_version)){a+=", \u0412\u0435\u0440\u0441\u0438\u044f "+b.selectedKkt.model_version}return a},resetFnSelection:function(){var a=this;Ext.suspendLayouts();a.chooseFnWindow.down("#kktRegistrationChooseFnSelected").update({selectedModel:"-"});a.chooseFnWindow.down("#kktRegistrationChooseFnFactoryCode").hide().reset();a.chooseFnWindow.down("#kktRegistrationChooseFnButton").disable();Ext.resumeLayouts(true);a.temporarySelectedFn={}},resetFnFields:function(){var b=this,a=b.getIndex();a.down("#editFnInRe").enable().show();b.modelFnCodeValid=false;b.fnModelObject={};b.selectedFile=undefined;b.updateStringValue("modelFnString");b.checkFormForValidity()},changeInternet:function(e,g){var f=this,c=f.getIndex(),b=c.down("#web_address"),d=c.down("#place_name"),a=c.down("#changeAddress").getValue();if(g){b.show().enable();if(f.selectedKkt.internet==1){b.setValue(f.selectedKkt.place_name)}d.hide().disable()}else{b.hide().disable();if(a){d.show().enable()}}f.checkFormForValidity()},checkFormForValidity:function(){var c=this,a=c.getIndex(),f=a.down("#reason_reregistration").getValue(),b=a.down('[name="kktReRegisterSubmit"]'),e=a.down('[name="kktReRegisterPdfSubmit"]'),d=a.down("#kktReRegistrationForm").getForm().isValid();if(!Ext.isArray(f.reason_reregistration)){f.reason_reregistration=[f.reason_reregistration]}f=f.reason_reregistration;if(d){if(Ext.Array.contains(f,"1")&&(Ext.isEmpty(c.selectedAddress)||c.selectedAddressGuid===null||!c.selectedAddressIsLastChild||(c.autoMode==1&&!c.selectedAddressRemote))){b.disable();e.disable();return}if(Ext.Array.contains(f,"4")&&(c.modelFnCodeValid==false)){b.disable();e.disable();return}b.enable();e.enable()}else{b.disable();e.disable()}},updateStringValue:function(c,a){var b=this;a=a||"";b.getIndex().down("#"+c).update(a)},checkIfRemote:function(b){var c=this,a=c.getIndex();LkIp.Request.request({url:"/api/fiasservice",params:{guid:b,param:"check"},method:"GET"},function(d){if(false!==d&&!(Ext.isEmpty(d.response))){if(d.status==1){d=d.response;c.defaultAddressRemote=d.IsRemote;c.selectedAddressRemote=c.defaultAddressRemote;c.changeAddress(b,d.IsRemote,true);c.remoteLoader=true;c.checkLoader()}else{LkIp.Msg.error(reference.lang.address.notFullAddress);return false}}else{LkIp.Msg.error(reference.lang.address.notFullAddress);return false}})},changeKpkNumber:function(a,c){var b=this;b.getIndex().down("#zerosMsg").setVisible(!Ext.isEmpty(c)&&c!="0"&&c.indexOf("0")==0)},changeCalculationDevice:function(a,c){var b=this;b.getIndex().down("#step2-calculation-container").down("#calculation_device_number").setDisabled(!c);b.checkFormForValidity()},fileUploadAction:function(b,d){var c=this,a=c.getIndex();d=-1!=d.indexOf("fakepath")?d.replace("C:\\fakepath\\",""):d;if(!Ext.isEmpty(d)){b.setRawValue(d);if(!b.isValid()){return}a.setLoading(true);LkIp.Request.formSubmit(a.down('[rel="fileUpload"]'),{url:"/web/file/upload",params:{extensions:Ext.JSON.encode(["fnc"]),maxSize:36700160,unique:1},scope:c,fileSubmit:true,success:function(f,e){a.setLoading(false);c.selectedFile=e.result.response;c.checkFormForValidity()},failure:function(e,f){a.setLoading(false);c.selectedFile=undefined;a.down("#fileUpload").getForm().reset();b.setRawValue("");c.checkFormForValidity();LkIp.Msg.error(f.result.response)}})}}},0,0,0,0,0,0,[LkIp.controller.Kkt,"ReRegistration"],0));(Ext.cmd.derive("LkIp.controller.Kkt.DeRegistration",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"kktDeRegistration"}],kktLoaded:false,referenceLoaded:false,selectedKkt:{},init:function(){var a=this;a.control({'#kktDeRegistration [name="kktDeRegisterSubmit"]':{click:a.submitRegisterForm},'#kktDeRegistration [name="kktDeRegisterPdfSubmit"]':{click:a.showPdf},"#kktDeRegistration #reason_deregistration":{change:a.changeReason},kktDeRegistration:{deactivate:function(){var b=this;b.getIndex().down("#modelInfo").update({});b.selectedKkt={};b.resetAllFields()}},'#kktDeRegistration [name="kpk_number"]':{change:a.changeKpkNumber}});a.callParent()},loadIndex:function(){var b=this,a;b.callParent();if(!LkIp.User.canSendKkt()){LkIp.app.getController("Viewport").tellUserAboutHeadProblems()}else{if(!LkIp.User.isActiveUser()){LkIp.app.getController("Viewport").tellUserThatHeCannotSendDocumentsBecauseHeIsClosed()}}a=b.getIndex();a.setLoading(true);LkIp.Request.request("/api/notice/getNewCount",function(d){b.newNoticeCountLoaded=true;b.checkLoader();var c=false!=d&&!Ext.isEmpty(d)&&d.status==1&&!Ext.isEmpty(d.response)&&parseInt(d.response.count)>0;a.down("#newNoticeNote").setVisible(c);a.down("#kktDeRegistrationForm").setDisabled(c)});LkIp.Request.request({url:"/api/kkt/details",params:{id:b.kktId}},function(c){if(!Ext.isEmpty(c)&&c.status==1&&!Ext.isEmpty(c.response.date)&&c.response.status_key!="13011"){b.selectedKkt=c.response;b.selectedKkt.rnm=!Ext.isEmpty(b.selectedKkt.rnm)?LkIp.Utils.formatRnm(b.selectedKkt.rnm):"";b.selectedKkt.model_kkt=!Ext.isEmpty(b.selectedKkt.model_version)?b.selectedKkt.model_kkt+" \u0432\u0435\u0440\u0441\u0438\u044f "+b.selectedKkt.model_version:b.selectedKkt.model_kkt;a.down("#modelInfo").update(b.selectedKkt);b.kktLoaded=true}else{LkIp.Utils.goTo("#!/kkt");return false}b.referenceLoaded=true;b.checkLoader()})},resetAllFields:function(){var c=this,a=c.getIndex(),b=a.down("#kktDeRegistrationForm");Ext.suspendLayouts();Ext.Array.forEach(b.query('[isFormField][name!="factory_code"][name!="rnm"]'),function(d){d.reset()});Ext.resumeLayouts(true)},checkLoader:function(){var b=this,a=b.getIndex();if(b.referenceLoaded&&b.kktLoaded&&b.newNoticeCountLoaded){a.setLoading(false);b.afterLoading()}},afterLoading:function(){var a=this},submitRegisterForm:function(){var c=this,b=c.getIndex(),a=b.down("#kktDeRegistrationForm").getForm().getValues();a.factory_code=c.selectedKkt.model_factory_code;a.id=c.kktId;if(!Ext.isArray(a.reason_deregistration)){a.reason_deregistration=[a.reason_deregistration]}if(Ext.isEmpty(a.reason_deregistration[0])){a.reason_deregistration=[]}a.reason_deregistration=Ext.JSON.encode(a.reason_deregistration);b.setLoading(true);LkIp.Request.request({url:"/api/kkt/deregister",method:"POST",params:a},function(d){c.getController("Viewport").signAction(d,{loader:c.getIndex(),successCallback:function(){c.resetAllFields();LkIp.Msg.success(reference.lang.kkt.deregistrationBlock.success,{rewriteDefaultButtons:true,buttons:[{text:reference.lang.buttons.ok,handler:function(){LkIp.Msg.fireEvent("closemessagebox",LkIp.Msg);LkIp.Msg.close();LkIp.Utils.goTo("#!/kkt")}}]})},errorCallback:function(e){var f=Ext.isEmpty(e)?reference.lang.kkt.deregistrationBlock.error:e;LkIp.Msg.error(f)}})})},showPdf:function(){var c=this,b=c.getIndex(),a=b.down("#kktDeRegistrationForm").getForm().getValues();a.factory_code=c.selectedKkt.model_factory_code;a.id=c.kktId;if(!Ext.isArray(a.reason_deregistration)){a.reason_deregistration=[a.reason_deregistration]}a.reason_deregistration=Ext.JSON.encode(a.reason_deregistration);LkIp.Utils.downloadDocument("kktDeRegisterPdf","/api/kkt/deregister/pdf",a)},changeReason:function(d,e,b){var c=this,a=c.getIndex();a.down("#step2").setVisible(Ext.Object.isEmpty(e));a.down('[name="date_fp"]').setDisabled(!Ext.Object.isEmpty(e));a.down('[name="time_fp"]').setDisabled(!Ext.Object.isEmpty(e));a.down('[name="kpk_number"]').setDisabled(!Ext.Object.isEmpty(e));a.down('[name="kpk_value"]').setDisabled(!Ext.Object.isEmpty(e));a.down("#kktDeRegistrationForm").isValid();if(a.down("#step2").hidden){a.down("#step3Number").update("2");a.down("#step4Number").update("3")}else{a.down("#step3Number").update("3");a.down("#step4Number").update("4")}},changeKpkNumber:function(a,c){var b=this;b.getIndex().down("#zerosMsg").setVisible(!Ext.isEmpty(c)&&c!="0"&&c.indexOf("0")==0)},fileUploadAction:function(b,d){var c=this,a=c.getIndex();d=-1!=d.indexOf("fakepath")?d.replace("C:\\fakepath\\",""):d;if(!Ext.isEmpty(d)){b.setRawValue(d);if(!b.isValid()){return}a.setLoading(true);LkIp.Request.formSubmit(a.down('[rel="fileUpload"]'),{url:"/web/file/upload",params:{extensions:Ext.JSON.encode(["fnc"]),maxSize:36700160,unique:1},scope:c,fileSubmit:true,success:function(f,e){a.setLoading(false);c.selectedFile=e.result.response;c.checkFormForValidity()},failure:function(e,f){a.setLoading(false);c.selectedFile=undefined;a.down("#fileUpload").getForm().reset();b.setRawValue("");c.checkFormForValidity();LkIp.Msg.error(f.result.response)}})}}},0,0,0,0,0,0,[LkIp.controller.Kkt,"DeRegistration"],0));(Ext.cmd.derive("LkIp.mixins.File",Ext.Base,{in_zip:true,fileUploadAction:function(b,e){var d=this,c=d.getForm(),a=d.getIndex();e=-1!=e.indexOf("fakepath")?e.replace("C:\\fakepath\\",""):e;if(!Ext.isEmpty(e)&&b.up("form").isValid()){b.setRawValue(e);a.setLoading(true);c.fireEvent("validitychange",c,false);LkIp.Request.formSubmit(b.up("form"),{url:"/web/file/uploadV2",params:{return_b64:true,in_zip:d.in_zip},scope:d,fileSubmit:true,success:function(g,f){a.setLoading(false);b.up('[rel="file-container"]').down("#hiddenFile").setValue(f.result.response[0]);c.fireEvent("validitychange",c,c.isValid());b.up("form").down('[name="resetFile"]').enable().show();b.anchor="90%";a.doLayout()},failure:function(f,g){a.setLoading(false);c.fireEvent("validitychange",c,c.isValid());d.resetFileAction(b);LkIp.Msg.error(g.result.response)}})}},resetFileAction:function(d){var f=this,c=f.getIndex(),b=d.up("form"),e=f.getForm(),g=b.down('[name="file"]'),a=b.down('[name="resetFile"]');Ext.suspendLayouts();b.getForm().reset();g.setRawValue("");d.up('[rel="file-container"]').down("#hiddenFile").setValue();a.hide().disable();g.anchor="100%";Ext.resumeLayouts(true);c.doLayout();e.fireEvent("validitychange",e,e.isValid())}},0,0,0,0,0,0,[LkIp.mixins,"File"],0));(Ext.cmd.derive("LkIp.controller.Kkt.Manufacturer.Models.Instances.Register",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"kktModelInstanceRegistration"},{ref:"form",selector:"#kktModelInstanceRegistrationForm"}],models:[],cache:false,modelsLoaded:false,itemIndex:0,in_zip:false,init:function(){var a=this;a.control({'kktModelInstanceRegistration [name="file"]':{change:this.fileUploadAction},'kktModelInstanceRegistration [name="resetFile"]':{click:this.resetFileAction},'kktModelInstanceRegistration [name="addItem"]':{click:this.addItem},'kktModelInstanceRegistration [name="removeItem"]':{click:this.removeItem},'kktModelInstanceRegistration [name="kktModelInstanceRegister"]':{click:this.registerProduced},"kktModelInstanceRegistration #loadType":{change:this.changeLoadType},"#kktModelInstanceRegistrationForm":{validitychange:function(d,f){var e=this,g=e.getIndex().down("#loadType").getValue(),c=e.getIndex().down('[name="kktModelInstanceRegister"]'),b=e.getIndex().down("#hiddenFile").getValue();if("1"==g&&f){if(Ext.isEmpty(b)){c.disable();return}c.enable()}}}});a.callParent()},loadIndex:function(){var b=this,a;b.callParent();b.modelsStore=Ext.getStore("kktModelInstanceModelNameStore");a=b.getIndex();if(!b.cache){a.setLoading(true);LkIp.Request.request("/api/kkt/models/instances/reference",function(c){if(!Ext.isEmpty(c.response.models)){b.modelsStore.loadData(c.response.models)}b.modelsLoaded=true;b.checkLoader()});b.cache=true}},addItem:function(){var c=this,b=c.getIndex(),a=b.down("#producedItems");Ext.suspendLayouts();a.add({xtype:"container",itemId:"producedItem_"+c.itemIndex,cls:"produced_item",items:[{xtype:"textfield",fieldLabel:reference.lang.kkt.produced.registration.item.factoryNumber,afterLabelTextTpl:LkIp.Utils.requiredLabel(),name:"factory_number["+c.itemIndex+"]",maxLength:36,enforceMaxLength:true,allowBlank:false},{xtype:"filterDate",hidden:false,fieldLabel:reference.lang.kkt.produced.registration.item.factoryDate,afterLabelTextTpl:LkIp.Utils.requiredLabel(),name:"factory_date["+c.itemIndex+"]",width:650,allowBlank:false},c.itemIndex!=0?{xtype:"button",index:c.itemIndex,name:"removeItem",text:reference.lang.buttons.remove}:{cls:"display-none"}]});Ext.resumeLayouts(true);c.itemIndex++},removeItem:function(c){var e=this,b=e.getIndex(),a=b.down("#producedItems"),d=c.index;a.down("#producedItem_"+d).destroy()},registerProduced:function(){var d=this,b=d.getIndex(),c=b.down("#kktModelInstanceRegistrationForm"),e=b.down("#loadType").getValue(),a=c.getForm().getValues();if("2"==e){delete a.produced_items_file}a.model_name=b.down("#model_code").getRawValue();b.setLoading(true);LkIp.Request.request({url:"/api/kkt/models/instances/register",method:"POST",params:a},function(f){d.getController("Viewport").signAction(f,{loader:d.getIndex(),successCallback:function(){var g=d.getIndex(),h=g.down("#loadType").getValue();Ext.suspendLayouts();d.resetProducedItems();if("2"==h){d.addItem()}else{d.resetFileAction(g.down('[name="file"]'))}Ext.resumeLayouts(true);LkIp.Msg.success(reference.lang.kkt.produced.registration.success)},errorCallback:function(g){var h=Ext.isEmpty(g)?reference.lang.kkt.produced.registration.defaultError:reference.lang.kkt.produced.registration.errorText+" "+g;LkIp.Msg.error(h)}})})},checkLoader:function(){var a=this;if(a.modelsLoaded){a.getIndex().setLoading(false)}},changeLoadType:function(b,d){var c=this,a=c.getIndex();switch(d){case"1":Ext.suspendLayouts();a.down("#loadWithFile").show();a.down("#loadByHand").hide();Ext.resumeLayouts(true);c.resetProducedItems();break;case"2":Ext.suspendLayouts();a.down("#loadWithFile").hide();a.down("#loadByHand").show();Ext.resumeLayouts(true);c.resetFileAction(a.down('[name="file"]'));c.addItem();break;default:break}},resetProducedItems:function(){var a=this;a.getIndex().down("#producedItems").removeAll();a.itemIndex=0}},0,0,0,0,0,[["file",LkIp.mixins.File]],[LkIp.controller.Kkt.Manufacturer.Models.Instances,"Register"],0));(Ext.cmd.derive("LkIp.controller.Kkt.Manufacturer.Fn.Instances.Register",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"kktFnInstancesRegistration"},{ref:"form",selector:"#kktFnInstancesRegistrationForm"}],models:[],cache:false,fnLoaded:false,itemIndex:0,in_zip:false,init:function(){var a=this;a.control({'kktFnInstancesRegistration [name="addItem"]':{click:this.addItem},'kktFnInstancesRegistration [name="removeItem"]':{click:this.removeItem},'kktFnInstancesRegistration [name="kktFnInstancesSubmit"]':{click:this.registerProduced},'kktFnInstancesRegistration [name="file"]':{change:this.fileUploadAction},'kktFnInstancesRegistration [name="resetFile"]':{click:this.resetFileAction},"kktFnInstancesRegistration #loadType":{change:this.changeLoadType},"#kktFnInstancesRegistrationForm":{validitychange:function(d,f){var e=this,g=e.getIndex().down("#loadType").getValue(),c=e.getIndex().down('[name="kktFnInstancesSubmit"]'),b=e.getIndex().down("#hiddenFile").getValue();if("1"==g&&f){if(Ext.isEmpty(b)){c.disable();return}c.enable()}}}});a.callParent()},loadIndex:function(){var c=this,b,a;c.callParent();b=c.getIndex();if(!c.cache){b.setLoading(true);c.fnStore=Ext.getStore("fnStore");LkIp.Request.request("/api/kkt/fn/instances/reference",function(d){if(!Ext.isEmpty(d.response.fn)){c.fnStore.loadData(d.response.fn)}c.fnLoaded=true;c.checkLoader()});c.cache=true}},addItem:function(){var c=this,b=c.getIndex(),a=b.down("#producedItems");Ext.suspendLayouts();a.add({xtype:"container",itemId:"producedItem_"+c.itemIndex,cls:"produced_item",items:[{xtype:"textfield",fieldLabel:reference.lang.kkt.fn.produced.registration.factoryNumber,afterLabelTextTpl:LkIp.Utils.requiredLabel(),name:"factory_number["+c.itemIndex+"]",maxLength:100,enforceMaxLength:true,allowBlank:false},{xtype:"textfield",fieldLabel:reference.lang.kkt.fn.produced.registration.factoryRegCode,afterLabelTextTpl:LkIp.Utils.requiredLabel(),name:"factory_reg_code["+c.itemIndex+"]",maxLength:13,enforceMaxLength:true,allowBlank:false},{xtype:"filterDate",hidden:false,fieldLabel:reference.lang.kkt.fn.produced.registration.factoryDate,afterLabelTextTpl:LkIp.Utils.requiredLabel(),name:"factory_date["+c.itemIndex+"]",width:650,allowBlank:false},c.itemIndex!=0?{xtype:"button",index:c.itemIndex,name:"removeItem",text:reference.lang.buttons.remove}:{cls:"display-none"}]});Ext.resumeLayouts(true);c.itemIndex++},removeItem:function(c){var e=this,b=e.getIndex(),a=b.down("#producedItems"),d=c.index;a.down("#producedItem_"+d).destroy()},registerProduced:function(){var d=this,b=d.getIndex(),c=b.down("#kktFnInstancesRegistrationForm").getForm(),e=b.down("#loadType").getValue(),a=c.getValues();if("2"==e){delete a.produced_items_file}a.fn_name=b.down("#fn_code").getRawValue();b.setLoading(true);LkIp.Request.request({url:"/api/kkt/fn/instances/register",method:"POST",params:a},function(f){d.getController("Viewport").signAction(f,{loader:d.getIndex(),successCallback:function(){var g=d.getIndex(),h=g.down("#loadType").getValue();Ext.suspendLayouts();d.resetProducedItems();if("2"==h){d.addItem()}else{d.resetFileAction(g.down('[name="file"]'))}Ext.resumeLayouts(true);LkIp.Msg.success(reference.lang.kkt.fn.produced.registration.success)},errorCallback:function(g){var h=Ext.isEmpty(g)?reference.lang.kkt.fn.produced.registration.defaultError:reference.lang.kkt.fn.produced.registration.errorText+" "+g;LkIp.Msg.error(h)}})})},checkLoader:function(){var a=this;if(a.fnLoaded){a.getIndex().setLoading(false)}},changeLoadType:function(b,d){var c=this,a=c.getIndex();switch(d){case"1":Ext.suspendLayouts();a.down("#loadWithFile").show();a.down("#loadByHand").hide();Ext.resumeLayouts(true);c.resetProducedItems();break;case"2":Ext.suspendLayouts();a.down("#loadWithFile").hide();a.down("#loadByHand").show();Ext.resumeLayouts(true);c.resetFileAction(a.down('[name="file"]'));c.addItem();break;default:break}},resetProducedItems:function(){var a=this;a.getIndex().down("#producedItems").removeAll();a.itemIndex=0}},0,0,0,0,0,[["file",LkIp.mixins.File]],[LkIp.controller.Kkt.Manufacturer.Fn.Instances,"Register"],0));(Ext.cmd.derive("LkIp.controller.Kkt.Fiscalization",Ext.app.Controller,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"fiscalizationWindow"}],type:undefined,init:function(){var a=this;this.control({'fiscalizationWindow [name="fiscalizationSubmit"]':{click:a.submitFiscalizationForm},'fiscalizationWindow [name="autoMode"]':{change:a.changeAutoMode},'fiscalizationWindow [name="kpk_number"]':{change:a.changeKpkNumber}})},changeAutoMode:function(b,c){var a=this.getIndex().down("#inn_ofd");if(c){a.disable().hide()}else{a.enable().show()}this.getIndex().down("#fiscalizationForm").isValid()},changeKpkNumber:function(a,c){var b=this;b.getIndex().down("#zerosMsg").setVisible(!Ext.isEmpty(c)&&c!="0"&&c.indexOf("0")==0)},submitFiscalizationForm:function(){var d=this,b=d.getIndex(),c=b.down("#fiscalizationForm"),a=c.getForm().getValues();d.type=a.report_type;b.setLoading(true);LkIp.Request.request({url:"/api/kkt/fiscalization",method:"POST",params:a},function(e){d.getController("Viewport").signAction(e,{loader:d.getIndex(),successCallback:function(){var f=d.getIndex(),g=reference.lang.kkt.fiscalization.success;f.close();switch(d.type){case"closeFiscalizationReport":g=reference.lang.kkt.fiscalization.successClose;break;case"changeFiscalizationReport":g=reference.lang.kkt.fiscalization.successChange;break;case"fiscalizationReport":default:g=reference.lang.kkt.fiscalization.success}LkIp.Msg.success(g);d.getController("Kkt.Index").closeKktInformationWindow();d.getController("Kkt.Index").loadFirstPage()},errorCallback:function(f){var g=Ext.isEmpty(f)?reference.lang.kkt.fiscalization.error:f;if(Ext.isEmpty(f)){switch(d.type){case"closeFiscalizationReport":g=reference.lang.kkt.fiscalization.errorClose;break;case"changeFiscalizationReport":g=reference.lang.kkt.fiscalization.errorChange;break;case"fiscalizationReport":default:g=reference.lang.kkt.fiscalization.error}}else{g=f}LkIp.Msg.error(g)}})})}},0,0,0,0,0,0,[LkIp.controller.Kkt,"Fiscalization"],0));(Ext.cmd.derive("LkIp.model.Kkt.KktHistoryModel",Ext.data.Model,{fields:["date_statement","statement","status","codeNo","answer","date_answer","fid_statement","fid_answer","has_answer","type_statement","type_answer","document_send_type"]},0,0,0,0,0,0,[LkIp.model.Kkt,"KktHistoryModel"],0));(Ext.cmd.derive("LkIp.store.Kkt.KktHistoryStore",LkIp.store.DefaultStore,{model:"LkIp.model.Kkt.KktHistoryModel",url:"/kkt/history"},0,0,0,0,0,0,[LkIp.store.Kkt,"KktHistoryStore"],0));(Ext.cmd.derive("LkIp.controller.Kkt.History",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"grid",selector:"kktHistoryGrid"},{ref:"index",selector:"historyWindow"}],models:["Kkt.KktHistoryModel"],getHistoryStore:function(){return this.getStore("Kkt.KktHistoryStore")},init:function(){var a=this;a.getHistoryStore().on({beforeload:{fn:a.beforeLoad,scope:a}});a.control({historyWindow:{render:a.showWindow,close:a.closeWindow,refreshKktHistory:a.refreshGridAction},kktHistoryGrid:{downloadStatement:a.downloadStatementAction,downloadAnswer:a.downloadAnswerAction}})},beforeLoad:function(){var a=this;a.getHistoryStore().extraParams={factory_code:a.getIndex().getFactoryCode(),rnm:a.getIndex().getRnm()}},showWindow:function(){var a=this;a.getHistoryStore().loadFirstPage()},closeWindow:function(){var a=this;a.getHistoryStore().removeAll()},downloadStatementAction:function(a){this.downloadDocument(a,"fid_statement","type_statement","request")},downloadAnswerAction:function(a){this.downloadDocument(a,"fid_answer","type_answer","answer")},downloadDocument:function(b,g,f,a){var e=this,c=b.get(g),d=b.get(f);if(0!=c){LkIp.Utils.downloadDocument("docflowDocument","/api/documents/getDocument/"+c+"/"+d)}},refreshGridAction:function(){var a=this;a.getHistoryStore().loadFirstPage()}},0,0,0,0,0,0,[LkIp.controller.Kkt,"History"],0));(Ext.cmd.derive("LkIp.controller.Kkt.FiscalReport",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"kktFiscalReport"},{ref:"formPanel",selector:"#kktFiscalReportForm"}],selectedFile:undefined,cacheFnList:undefined,chooseFnWindow:undefined,chooseFnStore:undefined,fnModelObject:undefined,temporarySelectedFn:undefined,init:function(){var b=this,a=Ext.getBody();a.addListener("click",b.editFn,b,{preventDefault:true,stopEvent:true,delegate:".editChosenReportFn"});b.control({kktFiscalReport:{activate:function(){b.resetPage()}},"kktFiscalReport #kktFiscalReportForm":{validitychange:function(){b.checkFormForValidity()}},'#kktFiscalReportForm [name="file"]':{change:this.fileUploadAction},'kktFiscalReport #kktFiscalReportForm [name="kktReportSubmit"]':{click:b.submitForm},"kktFiscalReport #editFn":{click:b.editFn},"#kktFiscalReportChooseFn":{close:b.closeFn},"#kktFiscalReportChooseFn #chooseFnModelFilter":{change:b.changeFnListFilter},"#kktFiscalReportChooseFn #kktRegistrationChooseFnGrid":{selectionchange:b.selectFnModelInGrid},"#kktFiscalReportChooseFn #kktRegistrationChooseFnFactoryCode":{change:b.changeFnFactoryCode},"#kktFiscalReportChooseFn #kktRegistrationChooseFnButton":{click:b.chooseFn}})},loadIndex:function(){var a=this;a.callParent();if(!LkIp.User.canSendKkt()){LkIp.app.getController("Viewport").tellUserAboutHeadProblems()}else{if(!LkIp.User.isActiveUser()){LkIp.app.getController("Viewport").tellUserThatHeCannotSendDocumentsBecauseHeIsClosed()}}},editFn:function(){var b=this,a=b.getIndex();a.setLoading(true);LkIp.Request.request({url:"/api/fn/model/list"},function(c){a.setLoading(false);if(c.status){b.cacheFnList=c.response;b.showEditFnBlock()}else{LkIp.Msg.error("\u041f\u043e \u0442\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u0438\u043c \u043f\u0440\u0438\u0447\u0438\u043d\u0430\u043c \u043d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0444\u0438\u0441\u043a\u0430\u043b\u044c\u043d\u044b\u0445 \u043d\u0430\u043a\u043e\u043f\u0438\u0442\u0435\u043b\u0435\u0439. \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u0412\u0430\u0448 \u0437\u0430\u043f\u0440\u043e\u0441 \u043f\u043e\u0437\u0436\u0435.")}})},showEditFnBlock:function(){var b=this,a=b.getIndex();b.chooseFnWindow=Ext.create("LkIp.view.Kkt.ChooseFn",{itemId:"kktFiscalReportChooseFn",title:reference.lang.kkt.fiscalReport.windowTitle});b.chooseFnStore=Ext.getStore("kktRegistrationChooseFnStore");b.chooseFnStore.removeAll();b.chooseFnStore.loadData(b.cacheFnList);b.resetFnSelection();b.chooseFnWindow.show();if(!Ext.Object.isEmpty(b.fnModelObject)){b.chooseFnWindow.down("#kktRegistrationChooseFnGrid").getSelectionModel().select(b.chooseFnStore.findExact("code",b.fnModelObject.code));b.chooseFnWindow.down("#kktRegistrationChooseFnFactoryCode").setValue(b.fnModelObject.factory_code)}a.down("#editFn").disable()},resetFnSelection:function(){var a=this;Ext.suspendLayouts();a.chooseFnWindow.down("#kktRegistrationChooseFnSelected").update({selectedModel:"-"});a.chooseFnWindow.down("#kktRegistrationChooseFnFactoryCode").hide().reset();a.chooseFnWindow.down("#kktRegistrationChooseFnButton").disable();Ext.resumeLayouts(true);a.temporarySelectedFn={}},changeFnListFilter:function(b,d){var c=this,a=true;try{new RegExp(d,"i")}catch(f){a=false}if(d.length>0&&a){c.chooseFnStore.filterBy(function(e){var g=e.get("value");return g.search(new RegExp(d,"i"))>=0})}else{c.chooseFnStore.clearFilter()}},selectFnModelInGrid:function(g,b){this.resetFnSelection();if(b.length){Ext.suspendLayouts();var e=this,a=b[0],f=e.chooseFnWindow.down("#kktRegistrationChooseFnSelected"),d=e.chooseFnWindow.down("#kktRegistrationChooseFnFactoryCode"),c=e.chooseFnWindow.down("#kktRegistrationChooseFnButton");d.show().reset();f.update({selectedModel:e.generateFnModelString(a.get("value"))});e.temporarySelectedFn=a;c.disable();Ext.resumeLayouts(true);d.focus()}},generateFnModelString:function(b,d,c){var a=b;c=c||false;if(!Ext.isEmpty(d)){a+=" \u0417\u0430\u0432\u043e\u0434\u0441\u043a\u043e\u0439 \u043d\u043e\u043c\u0435\u0440: "+d}if(c){a+='<div class="edit-icon pencil-icon editChosenReportFn"></div>'}return a},changeFnFactoryCode:function(b,d){var c=this,a=c.chooseFnWindow.down("#kktRegistrationChooseFnButton");if(d.length>0&&!Ext.Object.isEmpty(c.temporarySelectedFn)&&c.chooseFnWindow.down("#kktRegistrationChooseFnForm").isValid()){a.enable()}else{a.disable()}},chooseFn:function(){var a=this,b=a.chooseFnWindow.down("#kktRegistrationChooseFnFactoryCode").getValue();a.chooseFnWindow.setLoading(true);LkIp.Request.request({url:"/api/kkt/fiscal-report/fn/check",params:{factory_code:b,model_code:a.temporarySelectedFn.get("code"),model_value:a.temporarySelectedFn.get("value")}},function(d){a.chooseFnWindow.setLoading(false);if(false!=d&&d.status!=0){if(d.response.result==0){a.saveChosenFnData(b)}else{a.fnFactoryCodeValid=false;if(!Ext.isEmpty(d.response.errorText)){a.chooseFnWindow.down("#kktRegistrationChooseFnFactoryCode").markInvalid(d.response.errorText)}}}else{var c=!Ext.isEmpty(d.response)?d.response:"\u0423\u0432\u0430\u0436\u0430\u0435\u043c\u044b\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c, \u0432 \u0434\u0430\u043d\u043d\u044b\u0439 \u043c\u043e\u043c\u0435\u043d\u0442 \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u0443\u044e \u043c\u043e\u0434\u0435\u043b\u044c \u0444\u0438\u0441\u043a\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043d\u0430\u043a\u043e\u043f\u0438\u0442\u0435\u043b\u044f \u043d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e. \u041f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u043f\u043e\u043f\u044b\u0442\u043a\u0443 \u043f\u043e\u0437\u0436\u0435.";LkIp.Msg.error(c)}})},saveChosenFnData:function(b,c){var a=this;c=c||false;if(!c){a.fnModelObject=a.temporarySelectedFn.getData();a.fnModelObject.factory_code=b}if(typeof a.chooseFnWindow!="undefined"){a.resetFnSelection();a.chooseFnWindow.close()}a.getIndex().down("#editFn").hide();a.fnFactoryCodeValid=true;a.getIndex().down("#modelFnString").update(a.generateFnModelString(a.fnModelObject.value,b,true));a.checkFormForValidity()},closeFn:function(){this.getIndex().down("#editFn").enable()},resetFnFields:function(){var b=this,a=b.getIndex();a.down("#fnBlock").hide();a.down("#editFn").show();b.fnFactoryCodeValid=false;b.fnModelObject={};b.updateStringValue("modelFnString");b.checkFormForValidity()},fileUploadAction:function(b,e){var d=this,c=d.getFormPanel(),a=d.getIndex();e=-1!=e.indexOf("fakepath")?e.replace("C:\\fakepath\\",""):e;if(!Ext.isEmpty(e)){b.setRawValue(e);if(!b.isValid()){return}a.setLoading(true);LkIp.Request.formSubmit(c.down('[rel="fileUpload"]'),{url:"/web/file/upload",params:{extensions:Ext.JSON.encode(["fnc"]),maxSize:36700160,unique:1},scope:d,fileSubmit:true,success:function(g,f){a.setLoading(false);d.selectedFile=f.result.response;d.checkFormForValidity()},failure:function(f,g){a.setLoading(false);d.selectedFile=undefined;a.down("#fileUpload").getForm().reset();b.setRawValue("");d.checkFormForValidity();LkIp.Msg.error(g.result.response)}})}},checkFormForValidity:function(){var b=this,a=b.getIndex(),c=a.down('[name="kktReportSubmit"]');c.setDisabled(!a.down("#kktFiscalReportForm").getForm().isValid()||Ext.isEmpty(b.selectedFile)||Ext.isEmpty(b.fnModelObject))},resetPage:function(){var b=this,a=b.getIndex();b.getFormPanel().getForm().reset();a.down('#kktFiscalReportForm [name="file"]').setRawValue("");a.down("#editFn").show();a.down("#modelFnString").update("");b.selectedFile=undefined;b.fnModelObject=undefined;b.temporarySelectedFn=undefined;b.checkFormForValidity()},submitForm:function(){var c=this,b=c.getIndex(),a=b.down("#kktFiscalReportForm").getForm().getValues();a.model=c.fnModelObject.value;a.factory_code=c.fnModelObject.factory_code;a.file=c.selectedFile;b.setLoading(true);LkIp.Request.request({url:"/api/kkt/fiscal-report/send",method:"POST",params:a},function(d){c.getController("Viewport").signAction(d,{loader:c.getIndex(),gp3:true,successCallback:function(){var e=c.getIndex();LkIp.Msg.success(reference.lang.kkt.fiscalReport.success);c.resetPage()},errorCallback:function(e){var f=Ext.isEmpty(e)?reference.lang.kkt.fiscalReport.error:e;LkIp.Msg.error(f)}})})}},0,0,0,0,0,0,[LkIp.controller.Kkt,"FiscalReport"],0));(Ext.cmd.derive("LkIp.controller.Anketa",Ext.app.Controller,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"anketaWindow"}],active:0,steps:2,init:function(){var a=this;this.control({anketaWindow:{nextStep:{fn:a.nextStep,scope:a},previousStep:{fn:a.previousStep,scope:a},send:{fn:a.send,scope:a},close:function(){a.active=0}},"anketaWindow #ipInfoGroupSelectAll":{change:a.ipInfoGroupSelectAll},'anketaWindow [name="ipInfo"]':{change:a.changeCheckbox},"anketaWindow #taxesGroupSelectAll":{change:a.taxesSelectAll},'anketaWindow [name="taxes"]':{change:a.changeCheckbox},"anketaWindow #rsbGroupSelectAll":{change:a.rsbSelectAll},"anketaWindow #feedbackAll":{change:a.singleAllElementChange},"anketaWindow #otherAll":{change:a.singleAllElementChange},'anketaWindow [name="rsb"]':{change:a.changeCheckbox},"anketaWindow #secondStep":{activate:a.activateSecondStep},"anketaWindow #lastElement":{activate:a.activateLastStep},"anketaWindow #step3-form":{validitychange:a.checkStep3Validity}})},nextStep:function(b){var e=this,d=e.getIndex(),g=d.down("#steps").getLayout(),a=d.down("#goToPreviousStep"),i=d.down("#sendBtn"),c=e.active,f=d.down("#step-"+c),h;++e.active;if(1==e.active&&Ext.Object.isEmpty(d.down("#step1-form").getValues())){++e.active}h=d.down("#step-"+e.active);g.setActiveItem(e.active);Ext.suspendLayouts();f.addCls("simple-number-disabled");h.removeCls("simple-number-disabled");if(e.active==e.steps){b.hide();i.show()}else{b.show();i.hide()}if(e.active>0){a.show()}Ext.resumeLayouts(true)},previousStep:function(b){var g=this,c=g.getIndex(),h=c.down("#steps").getLayout(),a=c.down("#goToNextStep"),i=c.down("#sendBtn"),d=g.active,e=c.down("#step-"+d),f;--g.active;if(g.active==1&&Ext.Object.isEmpty(c.down("#step1-form").getValues())){--g.active}f=c.down("#step-"+g.active);h.setActiveItem(g.active);Ext.suspendLayouts();e.addCls("simple-number-disabled");f.removeCls("simple-number-disabled");if(g.active==0){b.hide()}if(g.active<g.steps){a.show();i.hide()}Ext.resumeLayouts(true)},ipInfoGroupSelectAll:function(a,c){var b=this;if(Ext.isEmpty(a.suspendEventsFlag)||!a.suspendEventsFlag){b.changeCheckboxesState("ipInfoGroup",c)}},taxesSelectAll:function(a,c){var b=this;if(Ext.isEmpty(a.suspendEventsFlag)||!a.suspendEventsFlag){b.changeCheckboxesState("taxesGroup",c)}},rsbSelectAll:function(a,c){var b=this;if(Ext.isEmpty(a.suspendEventsFlag)||!a.suspendEventsFlag){b.changeCheckboxesState("rsbGroup",c)}},changeCheckbox:function(a,c){var b=this;if(Ext.isEmpty(a.suspendEventsFlag)||!a.suspendEventsFlag){b.changeSelectAllCheckboxState(a)}},changeSelectAllCheckboxState:function(c){var e=this,b=e.getIndex(),a,d,g,f=true;a=c.up("checkboxgroup");d=b.down("#"+a.getItemId()+"SelectAll");g=a.query("[isCheckbox]");Ext.Array.each(g,function(h){if(!h.getValue()){f=false;return false}});d.suspendEventsFlag=true;d.setValue(f);d.suspendEventsFlag=false},changeCheckboxesState:function(a,c){var b=this,d=b.getIndex().down("#"+a).query("[isCheckbox]");Ext.Array.each(d,function(e){e.suspendEventsFlag=true;e.setValue(c?1:0);e.suspendEventsFlag=false})},activateSecondStep:function(b){var h=this,g=h.getIndex(),d=g.down("#step-2-column-1"),c=g.down("#step-2-column-2"),f=["ipInfo","taxes","feedbackAll","otherAll","rsb"],j=g.down("#step1-form").getValues(),k=Ext.Object.getKeys(j),e={ipInfo:reference.lang.anketaWindow.ipInfo.title,feedbackAll:reference.lang.anketaWindow.feedback.title,otherAll:reference.lang.anketaWindow.other.title,taxes:reference.lang.anketaWindow.taxes.title,rsb:reference.lang.anketaWindow.rsb.title},i=["feedbackAll","otherAll"],a=0;Ext.suspendLayouts();d.removeAll();c.removeAll();Ext.Array.each(f,function(l){if(Ext.Array.contains(k,l)){if(a>0&&a!=12){h.addStep2Separator(a>11?c:d)}if(Ext.Array.contains(i,l)){h.addStep2SingleHeader(a>11?c:d,e[l],l);a++;return}else{h.addStep2ColumnHeader(a>11?c:d,e[l])}a++;if(Ext.isArray(j[l])){Ext.Array.each(j[l],function(m){h.addStep2Item(a>11?c:d,reference.lang.anketaWindow[l][m],m);a++})}else{h.addStep2Item(a>11?c:d,reference.lang.anketaWindow[l][j[l]],j[l]);a++}}});Ext.resumeLayouts(true)},addStep2SingleHeader:function(c,a,b){c.add({xtype:"container",layout:{type:"hbox"},cls:"anketa__header",defaults:{xtype:"component",cls:"fs-12"},width:"100%",items:[{width:"68%",margin:"5 0 0 0",componentCls:"bold",html:a},{width:"16%",xtype:"radio",cls:"ta-c",name:"r_"+b,inputValue:"0"},{width:"12%",xtype:"radio",name:"r_"+b,cls:"ta-c",inputValue:"1"}]})},addStep2Separator:function(a){a.add({xtype:"component",margin:"5 0",html:"<hr/>"})},addStep2ColumnHeader:function(a,b){a.add({xtype:"container",layout:{type:"hbox"},defaults:{xtype:"component",cls:"fs-12 anketa__header"},width:"100%",items:[{width:"100%",html:b}]})},addStep2Item:function(c,a,b){c.add({xtype:"container",layout:{type:"hbox"},defaults:{xtype:"component",cls:"fs-12"},margin:"0 0 0 15",width:"98%",items:[{width:"66%",margin:"5 0 0 0",html:a},{width:"14%",xtype:"radio",cls:"ta-c",name:"r_"+b,inputValue:"0"},{width:"14%",xtype:"radio",name:"r_"+b,cls:"ta-c",inputValue:"1"}]})},checkStep3Validity:function(c,e){var d=this,b=d.getIndex(),a=b.down("#sendBtn");if(e){a.enable()}else{a.disable()}},activateLastStep:function(){},singleAllElementChange:function(){},send:function(){var g=this,f=g.getIndex(),i=f.down("#step1-form").getValues(),l=Ext.Object.getKeys(i),c=f.down("#step2-form").getValues(),j=Ext.Object.getKeys(c),a=f.down("#step3-form").getValues(),e=[],b={},k,d=["ipInfo","taxes","feedbackAll","otherAll","rsb"],h=["feedbackAll","otherAll"];if(Ext.isEmpty(i)||Ext.isEmpty(a.quality)){LkIp.Msg.error(reference.lang.anketaWindow.error);return false}Ext.Array.each(d,function(m){if(Ext.Array.contains(l,m)){if(Ext.Array.contains(h,m)){e.push(g.addDataToSubmit(m))}else{if(Ext.isArray(i[m])){Ext.Array.each(i[m],function(n){e.push(g.addDataToSubmit(n))})}else{e.push(g.addDataToSubmit(i[m]))}}}});b.items=Ext.JSON.encode(e);b=Ext.Object.merge(b,a);f.setLoading(true);LkIp.Request.request({url:"/api/anketa/send",method:"POST",params:b},function(m){f.setLoading(false);if(1==m.status){LkIp.Msg.success(reference.lang.anketaWindow.success,{rewriteDefaultButtons:true,buttons:[{text:reference.lang.buttons.close,handler:function(){f.close();LkIp.Msg.fireEvent("closemessagebox",LkIp.Msg);LkIp.Msg.close()}}]})}else{LkIp.Msg.error(reference.lang.anketaWindow.errorSend)}})},addDataToSubmit:function(b){var e=this,a=e.getIndex(),f=a.down("#step2-form").getValues(),c=Ext.Object.getKeys(f),d={};d={name:b};if(Ext.Array.contains(c,"r_"+b)){d.mark=f["r_"+b]}return d}},0,0,0,0,0,0,[LkIp.controller,"Anketa"],0));(Ext.cmd.derive("LkIp.controller.SignDocumentController",Ext.app.Controller,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"signDocumentWindow"}],selectedCertificateId:undefined,init:function(){var a=this;a.control({signDocumentWindow:{afterrender:a.renderWindow,chooseCertificate:a.chooseCertificate,afterCertificateSelection:a.afterCertificateIsSelected,signSend:a.signDocumentAction,close:a.closeAction}});if(LkIp.User.get("jacarta")){}},renderWindow:function(){var a=this;if(!LkIp.Signature.isPluginEnabled()){a.showRequirements();return}if(a.showExtraRequirements()){a.getIndex().down("#certificateBlock").hide();return}var b=a.getHashFromCookie();if(!Ext.isEmpty(b)){a.afterCertificateIsSelected(b)}},chooseCertificate:function(){var c=this;c.selectCertificateWindow=Ext.create("LkIp.view.CertificateListWindow",{signDocumentWindow:c.getIndex(),selectedCertificateId:c.selectedCertificateId});if(!LkIp.Signature.hasCertificates()){c.selectCertificateWindow.down("#certificate").show();c.selectCertificateWindow.down("#certificates").hide()}else{var b=LkIp.Signature.getCertificates();if(LkIp.Signature.hasValidCertificates()){var a=[];Ext.Array.each(b.valid,function(d){d.active=typeof c.selectedCertificateId!="undefined"&&c.selectedCertificateId==d.id;a.push(d)});c.selectCertificateWindow.down("#validCertificatesList").update(a)}else{c.selectCertificateWindow.down("#validCertificates").hide()}if(b.invalid.length>0){c.selectCertificateWindow.down("#invalidCertificates").show();c.selectCertificateWindow.down("#invalidCertificatesList").update(b.invalid)}else{c.selectCertificateWindow.down("#invalidCertificates").hide()}}c.selectCertificateWindow.show();Ext.suspendLayouts();c.calculateCertificateItemHeight();Ext.resumeLayouts(true)},calculateCertificateItemHeight:function(){var b=0,a=0;Ext.Array.each(Ext.query(".realCertificateList .certificateList__item"),function(c){a=Ext.get(c).getHeight();if(a>b){b=a}});Ext.Array.each(Ext.query(".realCertificateList .certificateList__item"),function(c){Ext.get(c).setHeight(b)})},setLoading:function(a){this.getIndex().setLoading(a)},showExtraRequirements:function(){var b=this,a=b.getIndex();if(LkIp.User.get("jacarta")){if(!jaCarta.hasAnyToken()){Ext.suspendLayouts();a.down("#extraRequirements").update(reference.lang.certificateWindow.requirements.jacartaToken);a.down("#extraRequirements").show();Ext.resumeLayouts(true);return true}}return false},showRequirements:function(){var b=this,a=b.getIndex();Ext.suspendLayouts();if(LkIp.User.get("jacarta")){a.down("#requirements").update(reference.lang.certificateWindow.requirements.jacarta)}else{a.down("#requirements").update(reference.lang.certificateWindow.requirements.crypto)}a.down("#requirements").show();a.down("#certificateBlock").hide();Ext.resumeLayouts(true)},afterCertificateIsSelected:function(c){var f=this,d=f.getIndex(),e=d.down("#selectedCertificate"),g=d.down("#emptyCertificateBlock"),b=d.down("#signBtn"),a=LkIp.Signature.getCertificate(c);Ext.suspendLayouts();if(typeof a=="undefined"){e.hide();g.show();f.removeHash();b.disable()}else{f.setHash(c);e.show();g.hide();a=LkIp.Signature.parseCertificate(a);e.update(a);b.enable()}Ext.resumeLayouts(true)},removeHash:function(){var a=this;a.selectedCertificateId=undefined;Ext.util.Cookies.clear(a.getCertificateId())},setHash:function(a){var b=this;b.selectedCertificateId=a;Ext.util.Cookies.set(b.getCertificateId(),a,Ext.Date.add(new Date(),Ext.Date.YEAR,1))},getHashFromCookie:function(){var a=this;return Ext.util.Cookies.get(a.getCertificateId())},getCertificateId:function(){return LkIp.User.get("loginType")},signDocumentAction:function(){var a=this;if(typeof a.selectedCertificateId=="undefined"){return false}a.setLoading(true);a.getIndex().signDocumentCallback(a.selectedCertificateId);a.getIndex().close()},closeAction:function(){var a=this,b=a.getIndex().closeCallback;if(!Ext.isEmpty(b)){b()}}},0,0,0,0,0,0,[LkIp.controller,"SignDocumentController"],0));(Ext.cmd.derive("LkIp.controller.CertificateListController",Ext.app.Controller,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"certificateListWindow"}],lastChosenCertificate:undefined,init:function(){var a=this;a.control({certificateListWindow:{beforerender:function(d){if(Ext.isIE8){var c=LkIp.Utils.getClientWidth()*0.7,b=LkIp.Utils.getClientHeight()*0.7;d.setWidth(c);d.setHeight(b)}},afterrender:a.renderWindow,chooseCertificate:a.chooseCertificateAction,close:function(){this.lastChosenHash=undefined}}})},renderWindow:function(){var b=this,a=Ext.getBody();a.addListener("click",b.chooseCertificate,b,{preventDefault:true,stopEvent:true,delegate:".certificate-afc"});if(!Ext.isEmpty(b.lastChosenCertificate)){b.getIndex().down("#chooseCertificate").enable()}},chooseCertificate:function(f,c){var d=this,a=Ext.get(c).getAttribute("data-certificateIdentifier");if(a==d.lastChosenCertificate){return}var b=Ext.query('[data-certificateIdentifier="'+a+'"]');if(b.length==0){return}var g=Ext.get(b[0]);Ext.suspendLayouts();if(typeof d.lastChosenCertificate=="undefined"){g.addCls("certificateList__item-active")}else{g.addCls("certificateList__item-active");Ext.get(Ext.query('[data-certificateIdentifier="'+d.lastChosenCertificate+'"]')[0]).removeCls("certificateList__item-active")}d.getIndex().down("#chooseCertificate").enable();Ext.resumeLayouts(true);d.lastChosenCertificate=a},chooseCertificateAction:function(){var b=this,a=b.getIndex().getSignDocumentWindow();a.fireEvent("afterCertificateSelection",b.lastChosenCertificate);b.getIndex().close()}},0,0,0,0,0,0,[LkIp.controller,"CertificateListController"],0));(Ext.cmd.derive("LkIp.controller.SignCheck",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"signcheck"}],init:function(){var a=this;this.control({"signcheck #startCheck":{click:a.startCheckAction},"signcheck #continueCheck":{click:a.startCheckAction},"signcheck #reCheck":{click:a.restartCheckAction}});this.callParent()},steps:["step-plugin","step-csp","step-certificate","step-test-sign"],lastCheckedStep:undefined,checkProcess:{},checkIsReady:true,checkIsSuccessful:true,signDocumentWindow:undefined,firstLoad:true,oldCspVersion:false,descriptions:{notInstalled:"<div>"+reference.lang.signcheck.requirements.pluginInfo+"</div><div>"+reference.lang.signcheck.requirements.pluginInfoDownloadLink+"</div><div>"+reference.lang.signcheck.requirements.pluginInfoDownloadLink2+"</div>"+(Ext.isChrome?"<div>"+reference.lang.signcheck.requirements.pluginInfoDownloadLinkChrome+"</div>":"")+(Ext.isOpera?"<div>"+reference.lang.signcheck.requirements.pluginInfoDownloadLinkOpera+"</div>":""),blocked:reference.lang.signcheck.errors.blocked,unavailablePluginVersion:"<div>"+reference.lang.signcheck.errors.noVersion+"</div><div>"+reference.lang.signcheck.requirements.pluginInfoDownloadLink+"</div><div>"+reference.lang.signcheck.requirements.pluginInfoDownloadLink2+"</div>",oldPluginVersion:"<div>"+reference.lang.signcheck.errors.oldVersionInfo+"</div><div>"+reference.lang.signcheck.requirements.pluginInfoDownloadLink+"</div><div>"+reference.lang.signcheck.requirements.pluginInfoDownloadLink2+"</div>",noCsp:"<div>"+reference.lang.signcheck.errors.noCsp+"</div>",oldCspVersion:"<div>"+reference.lang.signcheck.errors.cspUpdate+"</div>",storeOpen:"<div>"+reference.lang.signcheck.errors.storeOpen+"</div>",noCertificates:"<div>"+reference.lang.signcheck.requirements.certInfo+"</div>",noValidCertificates:"<div>"+reference.lang.signcheck.requirements.certNoValid+"</div>",noSelectedCertificate:reference.lang.signcheck.requirements.noSelectedCertificate},loadIndex:function(){var b=this,a;b.callParent();a=b.getIndex();if(b.firstLoad){a.setLoading(true);b.loadFirstTime()}b.firstLoad=false},loadFirstTime:function(){var g=this,f=g.getIndex();if(!LkIp.Signature.isPluginLoaded()){var c=new Ext.util.DelayedTask(function(){g.loadFirstTime()});c.delay(200);return}Ext.suspendLayouts();g.firstLoad=true;var d=Ext.util.Cookies.get("login-checker"),b,a=true;if(!Ext.isEmpty(d)){try{b=Ext.JSON.decode(d)}catch(h){b=false}if(false!==b){Ext.Array.each(g.steps,function(i){if(Ext.isEmpty(b[i])){a=undefined;return false}if(!b[i].status){g.updateErrorMessage(i,b[i]);if(typeof b[i].critical=="undefined"||b[i].critical){f.down("#"+i).removeCls("check__question").addCls("check__wrong");g.lastCheckedStep=i;a=false;g.checkIsSuccessful=false;return false}else{f.down("#"+i).removeCls("check__question").removeCls("check__wrong").addCls("check__ok")}}else{if(i==="step-plugin"){var j=LkIp.Signature.getCryptoApi().getCspName(),e=LkIp.Signature.getCryptoApi().getCspVersion();g.oldCspVersion=j.toLowerCase().indexOf("crypto-pro gost")!=-1&&parseInt(e.split(".").join(""))<367777}f.down("#"+i).removeCls("check__question").addCls("check__ok")}});if(typeof a!="undefined"){g.checkProcess=b}Ext.suspendLayouts();if(true===a){f.down("#startCheck").hide();f.down("#reCheck").show();f.down("#successBlock").show();f.down("#successBlock").update({pVersion:LkIp.Signature.getCryptoApi().getPluginVersion(),csp:LkIp.Signature.getCryptoApi().getCspName(),cspV:LkIp.Signature.getCryptoApi().getCspVersion()});f.down("#infoBlock").hide()}else{if(false===a){f.down("#startCheck").hide();f.down("#continueCheck").show()}}Ext.resumeLayouts(true)}else{Ext.util.Cookies.clear("login-checker")}}Ext.resumeLayouts(true);f.setLoading(false);f.doLayout()},check:function(){var d=this,c=Ext.util.Cookies.get("login-checker"),b,a=true;if(!Ext.isEmpty(c)){try{b=Ext.JSON.decode(c)}catch(f){b=false}if(false!==b){Ext.Array.each(d.steps,function(e){if(Ext.isEmpty(b[e])){a=false;return false}if(!b[e].status){a=false;return false}});return a}else{return false}}return false},updateErrorMessage:function(f,e){var d=this,a=d.getIndex(),c=(typeof e.type!="undefined"?d.descriptions[e.type]:""),b=a.down("#"+f);Ext.suspendLayouts();if(typeof e.critical=="undefined"||e.critical){if((f=="step-test-sign"||f=="step-certificate")&&d.oldCspVersion){c+="<div>"+reference.lang.signcheck.errors.oldCspVersion+" ("+LkIp.Signature.getCryptoApi().getCspVersion()+")</div>"+d.descriptions.oldCspVersion}a.down("#infoBlock").hide();a.down("#errorBlock").update({msg:"\u041f\u043e\u0441\u043b\u0435\u0434\u043d\u044f\u044f \u043e\u0448\u0438\u0431\u043a\u0430: "+e.error,description:c});a.down("#errorBlock").show()}b.down("#textInfo").hide();b.down("#textError").show();b.down("#textError").update(e.error+"<br/>"+c);Ext.resumeLayouts(true)},startCheckAction:function(){var b=this;b.getViewport().setLoading(true);b.startCheck();var a=Ext.TaskManager.start({run:function(){if(b.isChecked()){b.getViewport().setLoading(false);Ext.util.Cookies.set("login-checker",Ext.JSON.encode(b.checkProcess));b.getIndex().doLayout();Ext.TaskManager.stop(a)}},interval:200})},startCheck:function(){var c=this,a;c.checkIsReady=false;if(Ext.isEmpty(c.lastCheckedStep)){c.checkProcess={}}if(!Ext.isEmpty(c.lastCheckedStep)){var b=Ext.Array.indexOf(c.steps,c.lastCheckedStep);if(b!=-1){a=Ext.Array.slice(c.steps,b)}}else{a=c.steps}c.startStep(a[0])},startStep:function(e){var d=this;if(!LkIp.Signature.isPluginLoaded()){var b=new Ext.util.DelayedTask(function(){d.startStep(e)});b.delay(200);return}switch(e){case"step-plugin":if(LkIp.Signature.isPluginEnabled()){var a=LkIp.Signature.getCryptoApi().getPluginVersion();if(typeof a=="undefined"){d.markAsFailureAndStop(e,"\u041f\u043b\u0430\u0433\u0438\u043d \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d")}else{if(parseInt(a.split(".").join(""))<2012438){d.markAsFailureAndStop(e,"\u0412\u0435\u0440\u0441\u0438\u044f \u043f\u043b\u0430\u0433\u0438\u043d\u0430 \u0443\u0441\u0442\u0430\u0440\u0435\u043b\u0430.")}else{d.markAsSuccessAndGoToAnotherStep(e)}}}else{d.markAsFailureAndStop(e,LkIp.Signature.getCryptoApi().getPluginException())}break;case"step-csp":var c=LkIp.Signature.getCryptoApi().getCspName(),a=LkIp.Signature.getCryptoApi().getCspVersion();if(Ext.isEmpty(c)){d.markAsFailureAndStop(e,"\u041d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d \u043a\u0440\u0438\u043f\u0442\u043e\u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440.")}else{if(Ext.isEmpty(a)){d.markAsFailureAndStop(e,"\u041d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d \u043a\u0440\u0438\u043f\u0442\u043e\u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440.")}else{if(c.toLowerCase().indexOf("crypto-pro gost")!=-1&&parseInt(a.split(".").join(""))<367777){d.markAsFailureAndContinue(e,"\u0412\u0435\u0440\u0441\u0438\u044f \u043a\u0440\u0438\u043f\u0442\u043e\u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440\u0430 \u0443\u0441\u0442\u0430\u0440\u0435\u043b\u0430.");d.oldCspVersion=true}else{d.markAsSuccessAndGoToAnotherStep(e)}}}break;case"step-certificate":LkIp.Signature.loadCertificates();if(LkIp.Signature.isCertificatesLoading()){var f=new Ext.util.DelayedTask(function(){d.startStep("step-certificate")});f.delay(200);return}if(LkIp.Signature.hasCertificateListError()){d.markAsFailureAndStop(e,"\u0412\u043e\u0437\u043d\u0438\u043a\u043b\u0430 \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u0430 \u043f\u0440\u0438 \u043e\u0442\u043a\u0440\u044b\u0442\u0438\u0438 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0430 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0432.",LkIp.Signature.getCertificateListError());return}if(!LkIp.Signature.hasCertificates()){d.markAsFailureAndStop(e,"\u0412 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0432 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0432.")}if(!LkIp.Signature.hasValidCertificates()){d.markAsFailureAndStop(e,"\u0412 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0432 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e \u043f\u043e\u0434\u0445\u043e\u0434\u044f\u0449\u0438\u0445 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0432.")}d.markAsSuccessAndGoToAnotherStep(e);break;case"step-test-sign":LkIp.Signature.loadCertificates();if(LkIp.Signature.isCertificatesLoading()){var f=new Ext.util.DelayedTask(function(){d.startStep("step-certificate")});f.delay(200);return}if(LkIp.Signature.hasCertificateListError()){d.markAsFailureAndStop(e,"\u0412\u043e\u0437\u043d\u0438\u043a\u043b\u0430 \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u0430 \u043f\u0440\u0438 \u043e\u0442\u043a\u0440\u044b\u0442\u0438\u0438 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0430 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0432.",LkIp.Signature.getCertificateListError());return}if(!LkIp.Signature.hasCertificates()){d.markAsFailureAndStop(e,"\u0412 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0432 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0432.")}if(!LkIp.Signature.hasValidCertificates()){d.markAsFailureAndStop(e,"\u0412 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0432 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e \u043f\u043e\u0434\u0445\u043e\u0434\u044f\u0449\u0438\u0445 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0432.")}d.signDocumentWindow=Ext.create("LkIp.view.SignDocumentWindow",{title:reference.lang.certificateWindow.checkTitle,signDocumentCallback:function(g){LkIp.Signature.sign("3wUiEa1xolsy1njLBVnHlwfZFLtiHEtfvrEbpZd25co=",g);d.tryToSignDocument(e)},closeCallback:function(){if(!LkIp.Signature.isSigning()){d.markAsFailureAndStop(e,"\u041f\u0440\u043e\u0446\u0435\u0441\u0441 \u043f\u043e\u0434\u043f\u0438\u0441\u0430\u043d\u0438\u044f \u043f\u0440\u0435\u0440\u0432\u0430\u043d \u043f\u043e \u0438\u043d\u0438\u0446\u0438\u0430\u0442\u0438\u0432\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f.")}},buttonText:reference.lang.certificateWindow.checkButtonText});d.signDocumentWindow.show();break}},tryToSignDocument:function(b){var a=this;if(LkIp.Signature.isSigning()){var d=new Ext.util.DelayedTask(function(){a.tryToSignDocument(b)});d.delay(500);return}if(LkIp.Signature.hasSigningError()){a.markAsFailureAndStop(b,LkIp.Signature.getSigningError());return}var c=LkIp.Signature.getSigningResults();if(Ext.isEmpty(c.hash)){a.markAsFailureAndStop(b,"\u041d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u043f\u043e\u0434\u043f\u0438\u0441\u0430\u0442\u044c \u0442\u0435\u0441\u0442\u043e\u0432\u0443\u044e \u0441\u0442\u0440\u043e\u043a\u0443.")}a.markAsSuccessAndGoToAnotherStep(b)},markAsFailureAndStop:function(h,c,a){var g=this,b=g.getIndex(),e,d=b.down("#"+h);d.removeCls("check__question").removeCls("check__ok").addCls("check__wrong");switch(c){case"\u041f\u043b\u0430\u0433\u0438\u043d \u043d\u0435 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d":c=c+".";e="notInstalled";break;case"\u041f\u043b\u0430\u0433\u0438\u043d \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d":c=c+".";e="blocked";break;case"\u041d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0432\u0435\u0440\u0441\u0438\u044e \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u043f\u043b\u0430\u0433\u0438\u043d\u0430.":e="unavailablePluginVersion";break;case"\u0412\u0435\u0440\u0441\u0438\u044f \u043f\u043b\u0430\u0433\u0438\u043d\u0430 \u0443\u0441\u0442\u0430\u0440\u0435\u043b\u0430.":c=reference.lang.signcheck.errors.oldVersion+" ("+LkIp.Signature.getCryptoApi().getPluginVersion()+")";e="oldPluginVersion";break;case"\u041d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d \u043a\u0440\u0438\u043f\u0442\u043e\u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440.":e="noCsp";break;case"\u0412\u0435\u0440\u0441\u0438\u044f \u043a\u0440\u0438\u043f\u0442\u043e\u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440\u0430 \u0443\u0441\u0442\u0430\u0440\u0435\u043b\u0430.":c=reference.lang.signcheck.errors.oldCspVersion+" ("+LkIp.Signature.getCryptoApi().getCspVersion()+")";e="oldCspVersion";break;case"\u0412\u043e\u0437\u043d\u0438\u043a\u043b\u0430 \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u0430 \u043f\u0440\u0438 \u043e\u0442\u043a\u0440\u044b\u0442\u0438\u0438 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0430 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0432.":c=c+'<span class="small-text gray">('+a+")</span>";e="storeOpen";break;case"\u0412 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0432 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0432.":e="noCertificates";break;case"\u0412 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0432 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e \u043f\u043e\u0434\u0445\u043e\u0434\u044f\u0449\u0438\u0445 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0432.":e="noValidCertificates";break;case"\u041d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0432 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435.":e="noSelectedCertificate";break;default:break}var f=typeof e!="undefined"?g.descriptions[e]:"";if((h=="step-test-sign"||h=="step-certificate")&&g.oldCspVersion){f+="<div>"+reference.lang.signcheck.errors.oldCspVersion+" ("+LkIp.Signature.getCryptoApi().getCspVersion()+")</div>"+g.descriptions.oldCspVersion}Ext.suspendLayouts();b.down("#infoBlock").hide();b.down("#errorBlock").update({msg:c,description:f});b.down("#errorBlock").show();d.down("#textInfo").hide();d.down("#textError").show().update(c+"<br/>"+f);g.checkIsReady=true;g.lastCheckedStep=h;g.checkProcess[h]={status:false,critical:true,error:c,type:e};b.down("#startCheck").hide();b.down("#continueCheck").show();Ext.resumeLayouts(true)},markAsFailureAndContinue:function(h,c,a){var g=this,b=g.getIndex(),e,d=b.down("#"+h);d.removeCls("check__question").removeCls("check__wrong").addCls("check__ok");switch(c){case"\u0412\u0435\u0440\u0441\u0438\u044f \u043a\u0440\u0438\u043f\u0442\u043e\u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440\u0430 \u0443\u0441\u0442\u0430\u0440\u0435\u043b\u0430.":c=reference.lang.signcheck.errors.oldCspVersion+" ("+LkIp.Signature.getCryptoApi().getCspVersion()+")";e="oldCspVersion";break;default:break}var f=typeof e!="undefined"?g.descriptions[e]:"";Ext.suspendLayouts();d.down("#textInfo").hide();d.down("#textError").show().update(c+"<br/>"+f);g.checkProcess[h]={status:false,critical:false,error:c,type:e};Ext.resumeLayouts(true);var b=Ext.Array.indexOf(g.steps,h);if(b==(g.steps.length-1)){g.stopProcess()}else{g.startStep(g.steps[b+1])}},markAsSuccessAndGoToAnotherStep:function(d){var c=this,a=c.getIndex(),b=a.down("#"+d);b.removeCls("check__question").removeCls("check__wrong").addCls("check__ok");b.down("#textInfo").show();b.down("#textError").hide().update("");c.checkProcess[d]={status:true};var a=Ext.Array.indexOf(c.steps,d);if(a==(c.steps.length-1)){c.stopProcess()}else{c.startStep(c.steps[a+1])}},stopProcess:function(){var b=this,a=b.getIndex();b.checkIsReady=true;b.checkIsSuccessful=true;Ext.suspendLayouts();a.down("#successBlock").show();a.down("#successBlock").update({pVersion:LkIp.Signature.getCryptoApi().getPluginVersion(),csp:LkIp.Signature.getCryptoApi().getCspName(),cspV:LkIp.Signature.getCryptoApi().getCspVersion()});a.down("#errorBlock").hide();a.down("#infoBlock").hide();a.down("#startCheck").hide();a.down("#continueCheck").hide();a.down("#reCheck").show();Ext.resumeLayouts(true)},restartCheckAction:function(){this.resetCheck();this.startCheckAction()},resetCheck:function(){var b=this,a=b.getIndex();b.lastCheckedStep=undefined;b.checkIsReady=true;b.checkProcess={};b.checkIsSuccessful=true;Ext.util.Cookies.clear("login-checker");Ext.suspendLayouts();a.down("#successBlock").hide();a.down("#errorBlock").hide();a.down("#infoBlock").show();a.down("#startCheck").show();a.down("#continueCheck").hide();a.down("#reCheck").hide();Ext.Array.each(Ext.query(".check__step"),function(c){Ext.get(c).removeCls("check__wrong").removeCls("check__ok").addCls("check__question")});Ext.resumeLayouts(true)},isChecked:function(){return this.checkIsReady}},0,0,0,0,0,0,[LkIp.controller,"SignCheck"],0));(Ext.cmd.derive("LkIp.controller.CertificatePinController",Ext.app.Controller,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"certificatePinWindow"}],init:function(){var a=this;a.control({"certificatePinWindow #pin":{change:a.changePin},"certificatePinWindow #enterPin":{click:a.enterPin}})},changePin:function(b,d){var c=this,a=c.getIndex().down("#enterPin");if(b.isValid()){a.enable()}else{a.disable()}},enterPin:function(){var c=this,b=c.getIndex(),a=b.down("#pin").getValue();b.close();b.bindCertificate(a)}},0,0,0,0,0,0,[LkIp.controller,"CertificatePinController"],0));(Ext.cmd.derive("LkIp.controller.AddressFIAS",Ext.app.Controller,{refs:[{ref:"indexEl",selector:"addressFiasBlock"}],selectedAddressGuid:null,selectedAddressString:"",selectedAddressRemote:null,selectedAddressIsLastChild:false,chooseAddressWindow:undefined,chooseAddress:false,init:function(){var b=this,a=Ext.getBody();a.addListener("click",b.showAddressWindow,b,{preventDefault:true,delegate:".show-address-window"});b.control({addressFiasBlock:{selectAddressFIAS:b.selectAddressFIAS,clearAddress:b.clearAddressFields},"addressFiasBlock #addressString":{blur:b.blurAddress},"addressFiasBlock #apartmentType":{change:b.changeApartmentType},addressWindow:{selectAddressFIAS:b.selectAddressFIAS,addressLoader:b.addressLoader},"addressWindow #addressStringWindow":{blur:b.blurAddress},'addressWindow [name="addressSubmit"]':{click:b.submitAddressForm},"addressWindow #holdType":{change:b.changeHoldType},"addressWindow #buildType":{change:b.changeBuildType},"addressWindow #houseNumber":{change:b.changeHouseNumber},"addressWindow #buildNumber":{change:b.changeBuildNumber},"addressWindow #addressForm":{validitychange:function(e,g){var f=this,c=f.chooseAddressWindow,d=c.down('[name="addressSubmit"]');if(g){f.checkFormForValidity()}else{d.disable()}}}})},getIndex:function(){return this.rootEl||this.getIndexEl()},showAddressWindow:function(){var b=this,a=b.getIndex();b.chooseAddress=false;b.chooseAddressWindow=Ext.create("LkIp.view.AddressWindow",{itemId:"kktAddressWindow"});b.chooseAddressWindow.show()},selectAddressFIAS:function(a,d,c){var e=this;e.rootEl=c;var b=d==1?e.getIndex():e.chooseAddressWindow;b.fireEvent("addressLoader",true);var f=a.data;e.selectedAddressString=d==1?e.getAddress():e.getAddressWindow();e.isLastChild(f,d)},getAddress:function(){var a=this;return a.getIndex().down("#addressString").getValue()},getAddressWindow:function(){var a=this;return a.chooseAddressWindow.down("#addressStringWindow").getValue()},fillAddressFields:function(d,b){var c=this;var a=b==1?c.getIndex():c.chooseAddressWindow;if(b==1){c.selectedAddressGuid=d.fias_id}else{if(d.street_fias_id){c.selectedAddressGuid=d.street_fias_id}else{if(d.settlement_fias_id){c.selectedAddressGuid=d.settlement_fias_id}else{if(d.city_fias_id){c.selectedAddressGuid=d.city_fias_id}else{if(d.area_fias_id){c.selectedAddressGuid=d.area_fias_id}else{if(d.region_fias_id){c.selectedAddressGuid=d.region_fias_id}}}}}}a.down("#addressBlock").show();d.region?a.down("#region_name").setValue(d.region_type+". "+d.region).show():a.down("#region_name").setValue("").hide();a.down("#region").setValue(d.region_kladr_id.substr(0,2)).show();d.area?a.down("#district").setValue(d.area_type+". "+d.area).show():a.down("#district").setValue("").hide();d.city?a.down("#city").setValue(d.city_type+". "+d.city).show():a.down("#city").setValue("").hide();d.settlement?a.down("#locality").setValue(d.settlement_type+". "+d.settlement).show():a.down("#locality").setValue("").hide();d.street?a.down("#street").setValue(d.street_type+". "+d.street).show():a.down("#street").setValue("").hide();a.down("#noFromAddress").setValue(d.tax_office?d.tax_office:"");if(b==1){d.postal_code?a.down("#postcode").setValue(d.postal_code).show():a.down("#postcode").setValue("").hide();d.house?a.down("#house").setValue(d.house_type+". "+d.house).show():a.down("#house").setValue("").hide();d.block?a.down("#housing").setValue(d.block_type+". "+d.block).show():a.down("#housing").setValue("").hide()}else{if(d.postal_code){a.down("#postcodeDf").setValue(d.postal_code).show();a.down("#postcodeDf").enable();a.down("#postcodeTf").setValue("").hide();a.down("#postcodeTf").disable()}else{a.down("#postcodeTf").setValue("").show();a.down("#postcodeTf").enable();a.down("#postcodeDf").setValue("").hide();a.down("#postcodeDf").disable()}}},setAddress:function(c){var b=this,a=b.getIndex();a.down("#addressBlock").show();c.region_name?a.down("#region_name").setValue(c.region_name).show():a.down("#region_name").setValue("").hide();c.region?a.down("#region").setValue(c.region).show():a.down("#region").setValue("").hide();c.district?a.down("#district").setValue(c.district).show():a.down("#district").setValue("").hide();c.city?a.down("#city").setValue(c.city).show():a.down("#city").setValue("").hide();c.locality?a.down("#locality").setValue(c.locality).show():a.down("#locality").setValue("").hide();c.street?a.down("#street").setValue(c.street).show():a.down("#street").setValue("").hide();c.house?a.down("#house").setValue(c.house).show():a.down("#house").setValue("").hide();c.block?a.down("#housing").setValue(c.block).show():a.down("#housing").setValue("").hide();c.postcode?a.down("#postcode").setValue(c.postcode).show():a.down("#postcode").setValue("").hide();a.down("#noFromAddress").setValue(c.tax_office)},addressChange:function(c,e){var d=this;var b=c.itemId=="addressString"?1:2;var a=b==1?d.getIndex():d.chooseAddressWindow;var f=b==1?a.down("#addressString").getValue():a.down("#addressStringWindow").getValue()},blurAddress:function(c){var d=this;var b=c.itemId=="addressString"?1:2;var a=b==1?d.getIndex():d.chooseAddressWindow;var e=b==1?a.down("#addressString").getValue():a.down("#addressStringWindow").getValue();if(d.selectedAddressGuid===null){d.getIndex().fireEvent("changeFiasAddress",d.selectedAddressGuid,d.selectedAddressRemote,d.selectedAddressIsLastChild)}if(e.length==0||d.selectedAddressString!=e){d.clearAddressFields(b);d.selectedAddressGuid=null;d.selectedAddressRemote=null;d.selectedAddressIsLastChild=false;if(b==1){d.disableApartmentField()}else{d.enableWindowField(false)}if(e.length!=0){a.down("#wrongAddress").show();a.down("#emptyNo").hide()}else{a.down("#wrongAddress").hide()}}if(b==2){d.checkFormForValidity()}},isLastChild:function(c,f){var e=this;var g=c.fias_id;var b=c.fias_level;var a=c.house;var h=c.house_fias_id;var d=f==1?e.getIndex():e.chooseAddressWindow;var i=c.tax_office;e.clearAddressFields(f);if(f==1){if(a!=null&&b!="8"){d.down("#wrongAddress").show();d.fireEvent("addressLoader",false);return}}if((f==1&&b=="8"&&!Ext.isEmpty(h))||(f==2&&(b=="8"||b=="7"))){if(Ext.isEmpty(i)){d.down("#emptyNo").show();d.fireEvent("changeFiasAddress",e.selectedAddressGuid,e.selectedAddressRemote,e.selectedAddressIsLastChild);d.fireEvent("addressLoader",false);return}e.fillAddressFields(c,f);e.selectedAddressIsLastChild=true;if(f==1){e.checkIfRemote(g);e.enableApartmentField()}else{e.enableWindowField(true);d.fireEvent("addressLoader",false)}return}LkIp.Request.request({url:"/api/fiasservice",params:{guid:g,param:"islastchild",searchSwitch:f==1?8:0},method:"GET"},function(j){if(false!==j&&!(Ext.isEmpty(j.response))){if(j.status==1){j=j.response;var k=j.isLastChild;if(!k){d.down("#notFullAddress").show();d.fireEvent("addressLoader",false);return}else{if(Ext.isEmpty(i)){d.down("#emptyNo").show();if(f==1){d.fireEvent("changeFiasAddress",e.selectedAddressGuid,e.selectedAddressRemote,e.selectedAddressIsLastChild)}d.fireEvent("addressLoader",false);return}e.fillAddressFields(c,f);e.selectedAddressIsLastChild=true;if(f==1){e.checkIfRemote(g);e.enableApartmentField()}else{e.enableWindowField(true);d.fireEvent("addressLoader",false)}return}}else{d.down("#fiasNot").show()}}else{d.down("#fiasNot").show()}d.fireEvent("addressLoader",false)})},checkIfRemote:function(b){var c=this,a=c.getIndex();c.getIndex().fireEvent("addressLoader",true);LkIp.Request.request({url:"/api/fiasservice",params:{guid:b,param:"check"},method:"GET"},function(d){if(false!==d&&!(Ext.isEmpty(d.response))){if(d.status==1){d=d.response;c.selectedAddressRemote=d.IsRemote;a.fireEvent("changeFiasAddress",c.selectedAddressGuid,c.selectedAddressRemote,c.selectedAddressIsLastChild)}else{a.down("#fiasNot").show()}}else{a.down("#fiasNot").show()}a.fireEvent("addressLoader",false)})},clearAddressFields:function(b){b=b||1;var c=this;var a=b==1?c.getIndex():c.chooseAddressWindow;a.down("#addressBlock").hide();a.down("#region").setValue("");a.down("#region_name").setValue("");a.down("#district").setValue("");a.down("#city").setValue("");a.down("#locality").setValue("");a.down("#street").setValue("");if(b==1){a.down("#postcode").setValue("");a.down("#house").setValue("");a.down("#housing").setValue("");a.down("#apartment").setValue("");a.down("#apartmentType").setValue(0);a.down("#responsibility").hide()}else{a.down("#postcodeDf").setValue("");a.down("#postcodeTf").setValue("");a.down("#houseNumber").setValue("");a.down("#buildNumber").setValue("");a.down("#housingNumber").setValue("");a.down("#holdType").reset();a.down("#buildType").reset()}a.down("#noFromAddress").setValue("");a.down("#wrongAddress").hide();a.down("#notFullAddress").hide();a.down("#emptyNo").hide();a.down("#fiasNot").hide()},disableApartmentField:function(){var b=this,a=b.getIndex();a.down("#apartment").disable();a.down("#apartmentType").disable();a.down("#apartmentHelpMessage").hide()},enableApartmentField:function(){var b=this,a=b.getIndex();a.down("#apartment").enable();a.down("#apartmentType").enable();a.down("#apartmentHelpMessage").show()},resetAddressForm:function(){var b=this,a=b.getIndex();a.down("#addressString").setValue("")},changeApartmentType:function(b,d){var c=this,a=c.getIndex();if(Ext.isEmpty(d)||d==0){b.reset();a.down("#apartment").reset();a.down("#apartment").allowBlank=true}else{a.down("#apartment").allowBlank=false;a.down("#apartment").focus()}},changeBuildType:function(b,d){var c=this,a=c.chooseAddressWindow;if(d==0){b.reset();a.down("#buildNumber").reset();a.down("#buildNumber").allowBlank=true;a.down("#buildType").allowBlank=true}else{a.down("#buildNumber").allowBlank=false;a.down("#buildType").allowBlank=false;a.down("#buildNumber").focus()}c.checkFormForValidity()},changeHoldType:function(b,d){var c=this,a=c.chooseAddressWindow;if(d==0){b.reset();a.down("#houseNumber").reset();a.down("#houseNumber").allowBlank=true;a.down("#holdType").allowBlank=true}else{a.down("#houseNumber").allowBlank=false;a.down("#holdType").allowBlank=false;a.down("#houseNumber").focus()}c.checkFormForValidity()},changeHouseNumber:function(b,d){var c=this,a=c.chooseAddressWindow;if(Ext.isEmpty(d)){b.reset();a.down("#holdType").reset();a.down("#houseNumber").allowBlank=true;a.down("#holdType").allowBlank=true}else{a.down("#houseNumber").allowBlank=false;a.down("#holdType").allowBlank=false}c.checkFormForValidity()},changeBuildNumber:function(b,d){var c=this,a=c.chooseAddressWindow;if(Ext.isEmpty(d)){b.reset();a.down("#buildType").reset();a.down("#buildNumber").allowBlank=true;a.down("#buildType").allowBlank=true}else{a.down("#buildNumber").allowBlank=false;a.down("#buildType").allowBlank=false}c.checkFormForValidity()},enableWindowField:function(c){var b=this,a=b.chooseAddressWindow;if(c){a.down("#holdType").enable();a.down("#buildType").enable();a.down("#houseNumber").enable();a.down("#buildNumber").enable();a.down("#housingNumber").enable()}else{a.down("#holdType").disable();a.down("#buildType").disable();a.down("#houseNumber").disable();a.down("#buildNumber").disable();a.down("#housingNumber").disable()}},submitAddressForm:function(){var d=this,b=d.chooseAddressWindow.down("#addressForm"),a=b.getForm().getValues();d.chooseAddress=true;d.chooseAddressWindow.setLoading(true);var c=a.houseNumber?a.holdType+a.houseNumber:"";if(!Ext.isEmpty(a.buildType)&&a.buildType=="\u043b\u0438\u0442\u0435\u0440"){a.buildType=""}c=(c?c+" ":"")+(a.buildNumber?a.buildType+a.buildNumber:"");a.house=c;a.housing=a.housingNumber?"\u043a."+a.housingNumber:"";d.disableApartmentField();d.setAddress(a);if(typeof d.chooseAddressWindow!="undefined"){d.chooseAddressWindow.close()}d.chooseAddressWindow.setLoading(false);d.checkIfRemote(d.selectedAddressGuid);d.enableApartmentField();d.getIndex().down("#responsibility").show();d.getIndex().down("#wrongAddress").hide();d.getIndex().down("#addressString").setValue(a.addressStringWindow)},addressLoader:function(a){var c=this,b=c.chooseAddressWindow;b.setLoading(a)},checkFormForValidity:function(){var f=this,d=f.chooseAddressWindow,e=d.down('[name="addressSubmit"]'),b=d.down("#holdType"),a=d.down("#buildType"),g=d.down("#houseNumber"),c=d.down("#buildNumber"),h=d.down("#addressStringWindow").getValue();if(d.down("#addressForm").getForm().isValid()&&((b.getValue()&&g.getValue())||(a.getValue()&&c.getValue()))&&f.selectedAddressGuid!==null&&f.selectedAddressString==h){e.enable()}else{e.disable()}}},0,0,0,0,0,0,[LkIp.controller,"AddressFIAS"],0));(Ext.cmd.derive("LkIp.controller.Consent.Index",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"consent"},{ref:"formPanel",selector:"#consentForm"}],itemIndex:0,selectedFile:undefined,cache:false,anyFlagSelected:true,init:function(){var a=this;a.control({"#consent":{activate:function(){if(!a.canSendStatement()){a.blockPage()}}},"#consent #loadType":{select:a.selectLoadType},'#consent [name="file"]':{change:a.chooseFileToUpload},'#consent [rel="fullPart"]':{change:a.selectPartDoc},"#consent #data14":{change:a.changeData14},"#consent #consentForm":{validitychange:a.validitychangeAction},"#consent #resetFile":{click:a.resetFileField},'#consent [name="signButton"]':{click:a.submitForm},'#consent [rel="cbx"]':{change:a.changeCheckbox}});a.callParent()},loadIndex:function(){var a=this;a.callParent()},canSendStatement:function(){return !Ext.isEmpty(LkIp.User.getCodeNO())},blockPage:function(){var b=this,a=b.getIndex();Ext.suspendLayouts();a.down("#fileContainer").hide();a.down("#manualContainer").hide();a.down("#loadType").hide();a.down("#blockPageInfo").show();Ext.resumeLayouts(true)},selectLoadType:function(b,a){var c=this,d=a[0].get("field1");c.resetFileContainer();c.resetManualContainer();if(d==1){c.showManualContainer();c.getIndex().down("#file").disable()}else{c.showFileContainer()}c.checkFormValidity()},selectPartDoc:function(b,d){var c=this,a=c.getIndex();if(d.fullPart==1){c.resetPartDoc();a.down("#partDocContainer").hide();c.anyFlagSelected=true}else{a.down("#partDocContainer").show();c.checkAnyFlagSelected()}c.checkFormValidity()},checkAnyFlagSelected:function(){var b=this,c=b.getIndex().down("#partDocContainer").query("[isCheckbox]"),a=b.getIndex().down("#partDocContainer").down("#chooseOneHelp");b.anyFlagSelected=false;Ext.Array.each(c,function(d){if(d.getValue()){b.anyFlagSelected=true;return}});if(!b.anyFlagSelected){a.show()}else{a.hide()}},changeData14:function(b,d){var c=this,a=c.getIndex();a.down("#otherText").reset();if(d){a.down("#otherText").show().enable()}else{a.down("#otherText").hide().disable()}c.checkFormValidity()},showManualContainer:function(){var b=this,a=b.getIndex();Ext.suspendLayouts();a.down("#fileContainer").hide();a.down("#manualContainer").show();a.down("#date_from").enable();Ext.resumeLayouts(true)},showFileContainer:function(){var b=this,a=b.getIndex();Ext.suspendLayouts();a.down("#fileContainer").show();a.down("#file").enable();a.down("#manualContainer").hide();Ext.resumeLayouts(true)},resetFileContainer:function(){var a=this;a.resetFileField()},resetManualContainer:function(){var a=this;a.getIndex().down("#date_from").reset();a.getIndex().down("#date_from").disable();a.resetPartDoc()},resetPartDoc:function(){var a=this;a.getIndex().down("#otherText").hide().disable();a.getIndex().down("#data01").reset();a.getIndex().down("#data02").reset();a.getIndex().down("#data03").reset();a.getIndex().down("#data04").reset();a.getIndex().down("#data05").reset();a.getIndex().down("#data06").reset();a.getIndex().down("#data07").reset();a.getIndex().down("#data08").reset();a.getIndex().down("#data09").reset();a.getIndex().down("#data10").reset();a.getIndex().down("#data11").reset();a.getIndex().down("#data12").reset();a.getIndex().down("#data13").reset();a.getIndex().down("#data14").reset()},chooseFileToUpload:function(b,e){var d=this,c=d.getFormPanel(),a=d.getIndex();e=-1!=e.indexOf("fakepath")?e.replace("C:\\fakepath\\",""):e;if(!Ext.isEmpty(e)){b.setRawValue(e);a.setLoading(true);LkIp.Request.formSubmit(c.down('[rel="fileUpload"]'),{url:"api/consent/file/upload",scope:d,fileSubmit:true,success:function(g,f){d.selectedFile=f.result.response;b.anchor="90%";a.down("#resetFile").show().enable();d.checkFormValidity();a.doLayout();a.setLoading(false)},failure:function(f,g){a.setLoading(false);d.resetFileContainer();LkIp.Msg.error(g.result.response)}})}},resetFileField:function(){var f=this,d=f.getIndex(),c=d.down("#fileUpload"),e=f.getFormPanel(),g=d.down("#file"),b=d.down("#resetFile"),a=d.down("#signBtn");f.selectedFile=undefined;Ext.suspendLayouts();c.getForm().reset();g.setRawValue("");d.down("#resetFile").hide().disable();g.anchor="100%";b.hide().disable();a.disable();Ext.resumeLayouts(true);d.doLayout()},submitForm:function(){var c=this,b=c.getIndex(),e=b.down("#loadType").getValue(),a,d;if(2==e){a="api/consent/file/send";d={file:c.selectedFile}}else{a="api/consent/send";d=b.down("#consentForm").getValues()}b.setLoading(true);LkIp.Request.request({url:a,scope:c,params:d,method:"POST"},function(f){c.getController("Viewport").signAction(f,{loader:c.getIndex(),gp3:true})})},successCallback:function(a){a.resetFileContainer();a.resetManualContainer();LkIp.Msg.success(reference.lang.signature.successDefault)},checkFormValidity:function(){var b=this,a=b.getIndex().down("#signBtn");if(b.getFormPanel().getForm().isValid()){if(b.anyFlagSelected){a.enable()}else{a.disable()}}},validitychangeAction:function(b,d){var c=this,a=c.getIndex().down("#signBtn");if(d){if(c.anyFlagSelected){a.enable()}else{a.disable()}}},changeCheckbox:function(a,c){var b=this;Ext.suspendLayouts();b.checkAnyFlagSelected();b.checkFormValidity();Ext.resumeLayouts(true)}},0,0,0,0,0,0,[LkIp.controller.Consent,"Index"],0));(Ext.cmd.derive("LkIp.controller.Foreign.Index",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"foreign"},{ref:"formPanel",selector:"#foreignForm"}],itemIndex:0,selectedFile:undefined,cache:false,init:function(){var a=this;a.control({"#foreign":{activate:function(){if(!a.canSendStatement()){a.blockPage()}}},"#foreign #loadType":{select:a.selectLoadType},'#foreign [name="file"]':{change:a.chooseFileToUpload},"#foreign #consentForm":{validitychange:a.validitychangeAction},"#foreign #resetFile":{click:a.resetFileField},'#foreign [name="signButton"]':{click:a.submitForm}});a.callParent()},loadIndex:function(){var a=this;a.callParent()},canSendStatement:function(){return !Ext.isEmpty(LkIp.User.getCodeNO())},blockPage:function(){var b=this,a=b.getIndex();Ext.suspendLayouts();a.down("#fileContainer").hide();a.down("#manualContainer").hide();a.down("#loadType").hide();a.down("#blockPageInfo").show();Ext.resumeLayouts(true)},selectLoadType:function(b,a){var c=this,d=a[0].get("field1");c.resetFileContainer();c.resetManualContainer();if(d==1){c.showManualContainer()}else{c.showFileContainer()}c.checkFormValidity()},showManualContainer:function(){var b=this,a=b.getIndex();Ext.suspendLayouts();a.down("#fileContainer").hide();a.down("#manualContainer").show();Ext.resumeLayouts(true)},showFileContainer:function(){var b=this,a=b.getIndex();Ext.suspendLayouts();a.down("#fileContainer").show();a.down("#file").enable();a.down("#manualContainer").hide();Ext.resumeLayouts(true)},resetFileContainer:function(){var a=this;a.resetFileField()},resetManualContainer:function(){var a=this},chooseFileToUpload:function(b,e){var d=this,c=d.getFormPanel(),a=d.getIndex();e=-1!=e.indexOf("fakepath")?e.replace("C:\\fakepath\\",""):e;if(!Ext.isEmpty(e)){b.setRawValue(e);a.setLoading(true);LkIp.Request.formSubmit(c.down('[rel="fileUpload"]'),{url:"api/foreign/file/upload",scope:d,fileSubmit:true,success:function(g,f){d.selectedFile=f.result.response;b.anchor="90%";a.down("#resetFile").show().enable();d.checkFormValidity();a.doLayout();a.setLoading(false)},failure:function(f,g){a.setLoading(false);d.resetFileContainer();LkIp.Msg.error(g.result.response)}})}},resetFileField:function(){var f=this,d=f.getIndex(),c=d.down("#fileUpload"),e=f.getFormPanel(),g=d.down("#file"),b=d.down("#resetFile"),a=d.down("#signBtn");f.selectedFile=undefined;Ext.suspendLayouts();c.getForm().reset();g.setRawValue("");d.down("#resetFile").hide().disable();g.anchor="100%";b.hide().disable();a.disable();Ext.resumeLayouts(true);d.doLayout()},submitForm:function(){var c=this,b=c.getIndex(),e=2,a,d;if(2==e){a="api/foreign/file/send";d={file:c.selectedFile}}else{a="api/consent/send";d=b.down("#consentForm").getValues()}b.setLoading(true);LkIp.Request.request({url:a,scope:c,params:d,method:"POST"},function(f){c.getController("Viewport").signAction(f,{loader:c.getIndex(),gp3:true})})},successCallback:function(a){a.resetFileContainer();LkIp.Msg.success(reference.lang.signature.successDefault)},checkFormValidity:function(){var b=this,a=b.getIndex().down("#signBtn");if(b.getFormPanel().getForm().isValid()){a.enable()}else{a.disable()}},validitychangeAction:function(b,d){var c=this,a=c.getIndex().down("#signBtn");if(d){a.enable()}else{a.disable()}},changeCheckbox:function(a,c){var b=this;Ext.suspendLayouts();b.checkAnyFlagSelected();b.checkFormValidity();Ext.resumeLayouts(true)}},0,0,0,0,0,0,[LkIp.controller.Foreign,"Index"],0));(Ext.cmd.derive("LkIp.store.EmployeesIdentification.DocumentsStore",LkIp.store.DefaultStore,{model:"LkIp.model.Filters.DocumentTypes"},0,0,0,0,0,0,[LkIp.store.EmployeesIdentification,"DocumentsStore"],0));(Ext.cmd.derive("LkIp.controller.Employees.Identification",LkIp.controller.Content,{refs:[{ref:"viewport",selector:"#viewport"},{ref:"index",selector:"employeesIdentification"},{ref:"formPanel",selector:"#statementForm"}],models:["Filters.DocumentTypes"],itemIndex:0,selectedFile:undefined,cache:false,getDocumentsStore:function(){return this.getStore("EmployeesIdentification.DocumentsStore")},init:function(){var b=this,a=Ext.getBody();a.addListener("click",function(){LkIp.Msg.info(reference.lang.employeesIdentification.formatHelp)},this,{preventDefault:true,delegate:"#fl-check-format"});b.control({"#employeesIdentification":{activate:function(){if(!b.canSendStatement()){b.blockPage()}}},"#employeesIdentification #loadType":{select:b.selectLoadType},'#employeesIdentification [name="file"]':{change:b.chooseFileToUpload},"#employeesIdentification #addManualItem":{click:b.addManualItem},'#employeesIdentification [name="removeItem"]':{click:b.removeManualItem},'#employeesIdentification [rel="documentType"]':{select:b.selectDocumentType,change:function(c,d){if(Ext.isNumber(d)&&d==0){c.reset()}},blur:function(d){var e=this,f=d.up("container").down("#documentFields"),c=d.up("container").up("container");if(d.getValue()==0){f.hide();Ext.Array.forEach(d.up("container").down("#documentFields").query(".field"),function(g){g.setDisabled(true)});c.down("#inn").allowBlank=false}}},"#employeesIdentification #resetFile":{click:this.resetFileField},'#employeesIdentification [name="signButton"]':{click:this.submitForm}});b.callParent()},loadIndex:function(){var a=this;a.callParent();if(!a.cache){a.getIndex().setLoading(true);LkIp.Request.request({url:"/api/filters/getDocumentTypes"},function(b){b.response.unshift({code:0,value:"-\u041d\u0435 \u0432\u044b\u0431\u0440\u0430\u043d\u043e-"});a.getDocumentsStore().loadData(b.response);a.getIndex().setLoading(false);a.cache=true})}},canSendStatement:function(){return !Ext.isEmpty(LkIp.User.getCodeNO())},blockPage:function(){var b=this,a=b.getIndex();Ext.suspendLayouts();a.down("#fileContainer").hide();a.down("#manualContainer").hide();a.down("#loadType").hide();a.down("#blockPageInfo").show();Ext.resumeLayouts(true)},selectLoadType:function(b,a){var c=this,d=a[0].get("field1");c.resetFileContainer();c.resetManualContainer();if(d==1){c.showFileContainer();c.getIndex().down("#file").enable()}else{c.showManualContainer();c.getIndex().down("#file").disable()}},showManualContainer:function(){var b=this,a=b.getIndex();Ext.suspendLayouts();a.down("#fileContainer").hide();a.down("#manualContainer").show();Ext.resumeLayouts(true);b.addManualItem()},showFileContainer:function(){var b=this,a=b.getIndex();Ext.suspendLayouts();a.down("#fileContainer").show();a.down("#file").enable();a.down("#manualContainer").hide();Ext.resumeLayouts(true)},resetFileContainer:function(){var a=this;a.resetFileField()},addManualItem:function(){var b=this,a=b.getIndex(),c=a.down("#manualContainerItems");Ext.suspendLayouts();c.add({xtype:"container",itemId:"manualItem_"+b.itemIndex,defaults:{width:"100%",componentCls:"form-element-right w-300",labelWidth:200},items:[{xtype:"textfield",fieldLabel:reference.lang.employeesIdentification.inn,name:"inn["+b.itemIndex+"]",itemId:"inn",minLength:12,maxLength:12,enforceMaxLength:true,allowBlank:false,maskRe:/\d/},{xtype:"textfield",fieldLabel:reference.lang.employeesIdentification.snils,afterLabelTextTpl:LkIp.Utils.requiredLabel(),name:"snils["+b.itemIndex+"]",allowBlank:false,plugins:[new LkIp.plugins.MaskedInput("999-999-999 99",{placeholder:" ",exclude:["-"]})],validator:function(d){var d=d.replace(/-|\s/g,"");if(d.length==11){return true}return reference.lang.errors.snilsError}},{xtype:"textfield",fieldLabel:reference.lang.employeesIdentification.surname,afterLabelTextTpl:LkIp.Utils.requiredLabel(),name:"surname["+b.itemIndex+"]",allowBlank:false,validator:function(d){return LkIp.Utils.checkForRussianName(d,reference.lang.employeesIdentification.surname,true)}},{xtype:"textfield",fieldLabel:reference.lang.employeesIdentification.name,afterLabelTextTpl:LkIp.Utils.requiredLabel(),name:"name["+b.itemIndex+"]",allowBlank:false,validator:function(d){return LkIp.Utils.checkForRussianName(d,reference.lang.employeesIdentification.name,true)}},{xtype:"textfield",fieldLabel:reference.lang.employeesIdentification.patronymic,name:"patronymic["+b.itemIndex+"]",validator:function(d){return LkIp.Utils.checkForRussianName(d,reference.lang.employeesIdentification.patronymic,true)}},{xtype:"filterDate",fieldLabel:reference.lang.employeesIdentification.birthday,hidden:false,afterLabelTextTpl:LkIp.Utils.requiredLabel(),allowBlank:false,name:"birthDate["+b.itemIndex+"]"},{xtype:"container",layout:"anchor",defaults:{componentCls:"form-element-right w-300",labelWidth:"30%",width:"100%"},items:[{xtype:"filterSelect",name:"document_type["+b.itemIndex+"]",rel:"documentType",index:b.itemIndex,lang:reference.lang.employeesIdentification.document,displayField:"value",maskRe:undefined,anyMatch:true,tpl:'<tpl for="."><li data-qtip="{qtip}" class="x-boundlist-item" role="option">{value}</li></tpl>',store:"EmployeesIdentification.DocumentsStore"},{xtype:"container",itemId:"documentFields",hidden:true,items:[{xtype:"container",itemId:"documentTypeContainer",items:[{xtype:"textfield",name:"series_number["+b.itemIndex+"]",fieldLabel:reference.lang.employeesIdentification.series,componentCls:"form-element-right w-300",labelWidth:"30%",width:"100%",maxLength:25,disabled:true,enforceMaxLength:true,allowBlank:false,afterLabelTextTpl:LkIp.Utils.requiredLabel(),plugins:[new LkIp.plugins.MaskedInput("99 99 9999990",{placeholder:" ",exclude:["-"]})],validator:function(d){d=d.replace(/\s/g,"");if(d.length==0){return reference.lang.errors.seriesError}return true}}]},{xtype:"filterDate",hidden:false,disabled:true,fieldLabel:reference.lang.employeesIdentification.documentDate,name:"document_date["+b.itemIndex+"]",componentCls:"form-element-right w-300",labelWidth:"30%",width:"100%"},{xtype:"textfield",disabled:true,name:"document_organ_name["+b.itemIndex+"]",fieldLabel:reference.lang.employeesIdentification.documentOrganName,componentCls:"form-element-right w-300",labelWidth:"30%",width:"100%"},{xtype:"textfield",disabled:true,name:"document_organ_code["+b.itemIndex+"]",fieldLabel:reference.lang.employeesIdentification.documentCode,componentCls:"form-element-right w-300",labelWidth:"30%",width:"100%"}]}]},b.itemIndex!=0?{xtype:"button",width:"auto",idBlock:"manualItem_"+b.itemIndex,name:"removeItem",text:reference.lang.buttons.remove}:{cls:"display-none"},{xtype:"component",html:"<hr/>",margin:"10 0"}]});Ext.resumeLayouts(true);if(b.itemIndex!=0){b.checkFormValidity()}++b.itemIndex;if(b.itemIndex>200){a.down("#addManualItem").disable()}},removeManualItem:function(b){var c=this,a=c.getIndex();a.down("#manualContainerItems").remove(b.idBlock);--c.itemIndex;if(c.itemIndex<=200){a.down("#addManualItem").enable()}c.checkFormValidity()},selectDocumentType:function(d,c){var f=this,c=c[0],a=d.up("container").down("#documentTypeContainer"),g=d.up("container").down("#documentFields"),b=d.up("container").up("container");if(0!=c.get("code")){a.removeAll();var e=f.getMaskedInputPlugin(c.get("code"),c.get("regexpr"));a.add(Ext.apply({xtype:"textfield",name:"series_number["+d.index+"]",fieldLabel:reference.lang.employeesIdentification.series,componentCls:"form-element-right w-300",labelWidth:"30%",width:"100%",maxLength:25,enforceMaxLength:true,plugins:e,allowBlank:false,afterLabelTextTpl:LkIp.Utils.requiredLabel(),validator:function(h){h=h.replace(/\s/g,"");if(h.length==0){return reference.lang.errors.seriesError}if("01"===c.get("code")){if(/(?=[CLXVI])((C{0,3})?((X[LC])|(L?XX{0,2})|L)?((I[VX])|(V?(II{0,2}))|V)?)-[-]{2}\s[0-9]{6}/.test(h)){return true}else{return reference.lang.registration.errors.sssrPasport}}return true}}));g.show();Ext.Array.forEach(d.up("container").down("#documentFields").query(".field"),function(h){h.setDisabled(false)});b.down("#inn").allowBlank=true}else{g.hide();Ext.Array.forEach(d.up("container").down("#documentFields").query(".field"),function(h){h.setDisabled(true)});b.down("#inn").allowBlank=false}},getMaskedInputPlugin:function(b,a){if("01"===b){return[]}else{if("04"===b||"07"===b){a="\u0411\u0411 9999990"}}return[new LkIp.plugins.MaskedInput(a,{placeholder:" ",exclude:["-"]})]},resetManualContainer:function(){var a=this;a.getIndex().down("#manualContainerItems").removeAll();a.itemIndex=0},chooseFileToUpload:function(b,e){var d=this,c=d.getFormPanel(),a=d.getIndex();e=-1!=e.indexOf("fakepath")?e.replace("C:\\fakepath\\",""):e;if(!Ext.isEmpty(e)){b.setRawValue(e);a.setLoading(true);LkIp.Request.formSubmit(c.down('[rel="fileUpload"]'),{url:"api/employees/identification/file/upload",scope:d,fileSubmit:true,success:function(g,f){d.selectedFile=f.result.response;b.anchor="90%";a.down("#resetFile").show().enable();d.checkFormValidity();a.doLayout();a.setLoading(false)},failure:function(f,g){a.setLoading(false);d.resetFileContainer();LkIp.Msg.error(g.result.response)}})}},resetFileField:function(){var f=this,d=f.getIndex(),c=d.down("#fileUpload"),e=f.getFormPanel(),g=d.down("#file"),b=d.down("#resetFile"),a=d.down("#signBtn");f.selectedFile=undefined;Ext.suspendLayouts();c.getForm().reset();g.setRawValue("");d.down("#resetFile").hide().disable();g.anchor="100%";b.hide().disable();a.disable();Ext.resumeLayouts(true);d.doLayout()},submitForm:function(){var c=this,b=c.getIndex(),e=b.down("#loadType").getValue(),a,d;if(1==e){a="api/employees/identification/file/send";d={file:c.selectedFile}}else{a="api/employees/identification/send";d=b.down("#statementForm").getValues()}b.setLoading(true);LkIp.Request.request({url:a,scope:c,params:d,method:"POST"},function(f){c.getController("Viewport").signAction(f,{loader:c.getIndex(),successCallback:function(){c.resetFileContainer();c.resetManualContainer();var g=c.getIndex().down("#loadType").getValue();if(1!=g){c.addManualItem()}LkIp.Msg.success(reference.lang.signature.successDefault)}})})},checkFormValidity:function(){var b=this,a=b.getIndex().down("#signBtn"),c=b.getIndex().down("#addManualItem"),d=b.getFormPanel().getForm().isValid();if(d){a.enable();c.enable()}else{a.disable();c.disable()}}},0,0,0,0,0,0,[LkIp.controller.Employees,"Identification"],0));(Ext.cmd.derive("LkIp.plugins.MaskedInput",Ext.AbstractPlugin,{constructor:function(d,b){var c=this;var a={pasteEventName:(Ext.isIE?"paste":"input"),iPhone:(window.orientation!=undefined),mask:{definitions:{"9":"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]",S:".","0":"[0-9]?","\u0411":"[\u0410-\u042f]",R:"(?=[MDCLXVI])((M{0,3})((C[DM])|(D?C{0,3}))?((X[LC])|(L?XX{0,2})|L)?((I[VX])|(V?(II{0,2}))|V)?)?"},dataName:"rawMaskFn"},format:d,settings:b||{}};c.addEvents("unmask");c.callParent([a]);c.mixins.observable.constructor.call(c)},jqmap:function(c,b){var a=[];Ext.each(c,function(g,d){var f=b(d,g);if(f){if(Ext.isArray(f)){for(var e=0;e<f.length;e+=1){this.push(f[e])}}else{this.push(f)}}},a);return a},init:function(d){var c=this;c.field=d;d.enableKeyEvents=true;var a=c.format;if(!a&&this.length>0){var b=this[0];return b[d.mask.dataName]()}c.settings=Ext.applyIf(c.settings,{placeholder:"_",completed:null});c.defs=c.mask.definitions;c.tests=[];c.partialPosition=a.length;c.firstNonMaskPos=null;Ext.each(a.split(""),function(f,e){if(f=="?"){c.format.length--;c.partialPosition=e}else{if(c.defs[f]){c.tests.push(new RegExp(c.defs[f]));if(c.firstNonMaskPos==null){c.firstNonMaskPos=c.tests.length-1}}else{c.tests.push(null)}}});c.fireEvent("unmask");var b=c.field;c.buffer=c.jqmap(a.split(""),function(e,f){if(f!="?"){return c.defs[f]?c.settings.placeholder:f}});c.focusText=b.getRawValue();b[c.mask.dataName]=function(){return c.jqmap(buffer,function(e,f){return tests[e]&&f!=settings.placeholder?f:null}).join("")};if(!b.readOnly){b.on("unmask",function(){this.un(".mask");this[plugin.mask.dataName]=undefined},b,{single:true});b.on("focus",c.onFocus,c);b.on("blur",function(e){c.checkVal();if(e.getRawValue()!=c.focusText){e.fireEvent("change",e.getRawValue(),c.focusText)}});b.on("keydown",function(g,h){if(c.keydownEvent(g,h)==false){h.preventDefault()}},c);b.on("keypress",function(g,h){if(c.keypressEvent(g,h)==false){h.preventDefault()}},c);b.on("render",function(e){b.inputEl.on(c.pasteEventName,function(){setTimeout(function(){b.caret(c.checkVal(true))},0)})},undefined,{single:true})}c.checkVal();b.caret=c.caret;c.oriGet=Ext.Function.bind(d.getValue,d);Ext.apply(d,{getValue:function(e){return c.prepareValueToExternalWorld()},setValue:function(e){c.field.setRawValue("");c.clearBuffer(0,c.format.length);c.prepareValueToInternalWorld(e)}})},caret:function(d,a){if(this.length==0){return}var c=Ext.get(this.inputId);if(typeof d=="number"){a=(typeof a=="number")?a:d;if(c.dom.setSelectionRange){c.dom.setSelectionRange(d,a)}else{if(c.dom.createTextRange){var b=c.dom.createTextRange();b.collapse(true);b.moveEnd("character",a);b.moveStart("character",d);b.select()}}return this}else{if(c.dom.setSelectionRange){d=c.dom.selectionStart;a=c.dom.selectionEnd}else{if(document.selection&&document.selection.createRange){var b=document.selection.createRange();d=0-b.duplicate().moveStart("character",-100000);a=d+b.text.length}}return{begin:d,end:a}}},unmask:function(){return this.fireEvent("unmask")},onFocus:function(c){var b=this;b.focusText=c.getRawValue();var d=b.checkVal();b.writeBuffer();var a=function(){if(d==b.format.length){c.caret(0,d)}else{c.caret(d)}};(Ext.isIE?a:function(){setTimeout(a,0)})()},seekNext:function(b){var a=this;while(++b<=a.format.length&&!a.tests[b]){}return b},seekPrev:function(b){var a=this;while(--b>=0&&!a.tests[b]){}return b},shiftL:function(d,a){var e=this;if(d<0){return}for(var c=d,b=e.seekNext(a);c<e.format.length;c++){if(e.tests[c]){if(b<e.format.length&&e.tests[c].test(e.buffer[b])){e.buffer[c]=e.buffer[b];e.buffer[b]=e.settings.placeholder}else{break}b=e.seekNext(b)}}e.writeBuffer();e.field.caret(Math.max(e.firstNonMaskPos,d))},shiftR:function(g){var e=this;for(var d=g,f=e.settings.placeholder;d<e.format.length;d++){if(e.tests[d]){var a=e.seekNext(d);var b=e.buffer[d];e.buffer[d]=f;if(a<e.format.length&&e.tests[a].test(b)){f=b}else{break}}}},keydownEvent:function(g,h){var d=this;var b=h.getKey();if(b==8||b==46||(d.iPhone&&b==127)){var i=d.field.caret(),c=i.begin,a=i.end;if(a-c==0){c=b!=46?d.seekPrev(c):(a=d.seekNext(c-1));a=b==46?d.seekNext(a):a}d.clearBuffer(c,a);d.shiftL(c,a-1);return false}else{if(b==27){d.field.setRawValue(d.focusText);d.field.caret(0,d.checkVal());return false}}},keypressEvent:function(g,i){var d=this;if(i.charCode==0){return true}var a=i.getCharCode(),l=d.field.caret();if(i.ctrlKey||i.altKey||i.metaKey||a<32){return true}else{if(a){if(l.end-l.begin!=0){d.clearBuffer(l.begin,l.end);d.shiftL(l.begin,l.end-1)}var h=d.seekNext(l.begin-1);if(h<d.format.length){var j=String.fromCharCode(a);if(d.tests[h].test(j)){d.shiftR(h);d.buffer[h]=j;d.writeBuffer();var b=d.seekNext(h);d.field.caret(b);if(d.settings.completed&&b>=d.format.length){d.settings.completed.call(g)}}}return false}}},clearBuffer:function(d,a){var c=this;for(var b=d;b<a&&b<c.format.length;b++){if(c.tests[b]){c.buffer[b]=c.settings.placeholder}}},writeBuffer:function(){var a=this;return a.field.setRawValue(a.buffer.join(""))},checkVal:function(d){var e=this;var a=e.field;var j=a.getRawValue();var h=-1;for(var b=0,g=0;b<e.format.length;b++){if(e.tests[b]){e.buffer[b]=e.settings.placeholder;while(g++<j.length){var f=j.charAt(g-1);if(e.tests[b].test(f)){e.buffer[b]=f;h=b;break}}if(g>j.length){break}}else{if(e.buffer[b]==j.charAt(g)&&b!=e.partialPosition){g++;h=b}}}if(!d&&h+1<e.partialPosition){a.setRawValue("");e.clearBuffer(0,e.format.length)}else{if(d||h+1>=e.partialPosition){e.writeBuffer();if(!d){a.setRawValue(a.getRawValue().substring(0,h+1))}}}return(e.partialPosition?b:e.firstNonMaskPos)},prepareValueToExternalWorld:function(){var d=this;var a=[],c=true;for(var b=0;b<d.tests.length;b+=1){if(d.tests[b]!=null||(Ext.isEmpty(d.settings.exclude)&&Ext.Array.contains(d.settings.exclude,d.buffer[b]))){a.push(d.buffer[b])}}return Ext.Array.indexOf(a,d.settings.placeholder)==-1?a.join(""):""},prepareValueToInternalWorld:function(c){var a=this;var b=-1;Ext.each(c.split(""),function(d){b=a.seekNext(b);if(a.tests[b].test(d)){a.buffer[b]=d}});a.writeBuffer()}},1,0,0,0,["plugin.maskedInput"],[["observable",Ext.util.Observable]],[LkIp.plugins,"MaskedInput"],0));(Ext.cmd.derive("LkIp.view.Registration.UserData",Ext.window.Window,{autoHeight:true,layout:"auto",modal:true,ui:"nalogThemeWindow",closable:false,title:reference.lang.registration.userInfo.title,width:450,required:'<span class="form-required-field" data-qtip="'+reference.lang.form.required+'">*</span>',initComponent:function(){var a=this;Ext.apply(a,{items:[{margin:10,xtype:"form",layout:"anchor",itemId:"registration-user-data",defaults:{anchor:"100%",allowBlank:false,afterLabelTextTpl:a.required,labelWidth:150},items:[{xtype:"filterDate",fieldLabel:reference.lang.registration.userInfo.birthDate,hidden:false,name:"birthDate",anchor:"70%"},{xtype:"filterSelect",name:"documentType",lang:reference.lang.registration.userInfo.documentType,displayField:"value",tpl:'<tpl for="."><li data-qtip="{qtip}" class="x-boundlist-item" role="option">{value}</li></tpl>',store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Filters.DocumentTypes",autoDestroy:true,storeId:"registrationDocumentType"},typeAhead:false,editable:false},{xtype:"container",itemId:"documentInfo",layout:"anchor",items:[{xtype:"textfield",name:"seriesNumber",itemId:"seriesNumber",fieldLabel:reference.lang.registration.userInfo.seriesNumber,anchor:"100%",allowBlank:false,afterLabelTextTpl:a.required,labelWidth:150}]},{xtype:"filterDate",fieldLabel:reference.lang.registration.userInfo.documentDate,hidden:false,name:"documentDate",anchor:"70%"},{margin:"15 0 0 0",xtype:"button",anchor:"20%",formBind:true,name:"registrationUserDataNextStep",text:reference.lang.buttons.next}]}]});a.callParent(arguments)}},0,["registrationUserData"],["panel","window","registrationUserData","component","container","box"],{panel:true,window:true,registrationUserData:true,component:true,container:true,box:true},["widget.registrationUserData"],0,[LkIp.view.Registration,"UserData"],0));(Ext.cmd.derive("LkIp.view.Registration.InnCheck",Ext.window.Window,{autoHeight:true,layout:"auto",modal:true,ui:"nalogThemeWindow",closable:false,inn:undefined,required:'<span class="form-required-field" data-qtip="'+reference.lang.form.required+'">*</span>',initComponent:function(){var a=this;Ext.apply(a,{title:Ext.isEmpty(a.inn)?"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0418\u041d\u041d":"\u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0432\u0432\u0435\u0434\u0435\u043d\u043d\u043e\u0433\u043e \u0418\u041d\u041d",width:Ext.isEmpty(a.inn)?300:350,items:[{margin:10,xtype:"form",layout:"anchor",itemId:"registration-inn-check",items:[{xtype:"numberfield",name:"inn",hideTrigger:true,fieldLabel:"\u0418\u041d\u041d",allowDecimals:false,anchor:"100%",labelWidth:50,allowBlank:false,afterLabelTextTpl:a.required,enforceMaxLength:true,maxLength:12,minLength:12,value:Ext.isEmpty(a.inn)?"":a.inn,maskRe:/\d/},{margin:"15 0 0 0",xtype:"button",formBind:true,name:"registrationInnCheckNextStep",text:reference.lang.buttons.next}]}]});a.callParent(arguments)}},0,["registrationInnCheck"],["panel","registrationInnCheck","window","component","container","box"],{panel:true,registrationInnCheck:true,window:true,component:true,container:true,box:true},["widget.registrationInnCheck"],0,[LkIp.view.Registration,"InnCheck"],0));(Ext.cmd.derive("LkIp.view.Registration.SetPassword",Ext.window.Window,{autoHeight:true,layout:"auto",modal:true,ui:"nalogThemeWindow",closable:false,title:reference.lang.registration.setPassword.title,width:550,email:undefined,userId:undefined,registrationType:undefined,required:'<span class="form-required-field" data-qtip="'+reference.lang.form.required+'">*</span>',initComponent:function(){var a=this;Ext.apply(a,{items:{xtype:"container",layout:{type:"auto"},margin:10,items:[{xtype:"form",layout:"auto",itemId:"registration-setPassword",width:"100%",defaults:{width:350,allowBlank:false,afterLabelTextTpl:a.required,labelWidth:150},items:[{xtype:"hiddenfield",name:"registrationType",value:a.registrationType},{xtype:"hiddenfield",name:"userId",value:Ext.isEmpty(a.userId)?"":a.userId},{xtype:"note",width:"100%",text:"cert"===a.registrationType?reference.lang.registration.setPassword.passwordInfoCert:reference.lang.registration.setPassword.passwordInfoLogin},{xtype:"component",width:"100%",html:reference.lang.registration.setPassword.passwordStart},{xtype:"container",cls:"check",width:"100%",itemId:"password-rules",items:{xtype:"container",cls:"check-steps",defaults:{xtype:"container",cls:"block-with-icon check-step failed"},items:[{itemId:"password-bigLetters",items:[{cls:"check-icon",items:{xtype:"component",itemId:"password-bigLetters-icon",cls:"exclamation-16-icon"}},{xtype:"component",html:reference.lang.registration.setPassword.bigLetters}]},{itemId:"password-smallLetters",items:[{cls:"check-icon",items:{xtype:"component",itemId:"password-smallLetters-icon",cls:"exclamation-16-icon"}},{xtype:"component",html:reference.lang.registration.setPassword.smallLetters}]},{itemId:"password-numbers",items:[{cls:"check-icon",items:{xtype:"component",itemId:"password-numbers-icon",cls:"exclamation-16-icon"}},{xtype:"component",html:reference.lang.registration.setPassword.numbers}]},{itemId:"password-specialChars",items:[{cls:"check-icon",items:{xtype:"component",itemId:"password-specialChars-icon",cls:"exclamation-16-icon"}},{xtype:"component",html:reference.lang.registration.setPassword.specialChars}]},{itemId:"password-minLength",items:[{cls:"check-icon",items:{xtype:"component",itemId:"password-minLength-icon",cls:"exclamation-16-icon"}},{xtype:"component",html:reference.lang.registration.setPassword.minLength}]}]}},{margin:"15 0 0",xtype:"textfield",name:"password",fieldLabel:reference.lang.registration.passwordLabel,afterLabelTextTpl:"",inputType:"password",allowBlank:true,minLength:7,validator:function(l){var h="QWERTYUIOPLKJHGFDSAZXCVBNM\u0419\u0426\u0423\u041a\u0415\u041d\u0413\u0428\u0429\u0417\u0425\u042a\u0424\u042b\u0412\u0410\u041f\u0420\u041e\u041b\u0414\u0416\u042d\u042f\u0427\u0421\u041c\u0418\u0422\u042c\u0411\u042e",c="qwertyuiopasdfghjklzxcvbnm\u0439\u0446\u0443\u043a\u0435\u043d\u0433\u0448\u0449\u0437\u0445\u044a\u0444\u044b\u0432\u0430\u043f\u0440\u043e\u043b\u0434\u0436\u044d\u044f\u0447\u0441\u043c\u0438\u0442\u044c\u0431\u044e",m="0123456789",e="#$^&*_-+%@",j=false,b=false,k=false,f=false,d=l.length,g=0;for(;g<d;g++){if(!j&&h.indexOf(l[g])>-1){j=true;continue}if(!b&&c.indexOf(l[g])>-1){b=true;continue}if(!k&&m.indexOf(l[g])>-1){k=true;continue}if(!f&&e.indexOf(l[g])>-1){f=true;continue}}if(0===d||(j&&b&&k&&f)){return true}}},{margin:"15 0 0 0",xtype:"button",width:100,formBind:true,name:"registrationSetPasswordNextStep",text:reference.lang.buttons.next}]}]}});a.callParent(arguments)}},0,["registrationSetPassword"],["panel","registrationSetPassword","window","component","container","box"],{panel:true,registrationSetPassword:true,window:true,component:true,container:true,box:true},["widget.registrationSetPassword"],0,[LkIp.view.Registration,"SetPassword"],0));(Ext.cmd.derive("LkIp.view.Registration.SetPasswordCert",LkIp.view.Registration.SetPassword,{registrationType:"cert"},0,["registrationSetPasswordCert"],["panel","registrationSetPassword","registrationSetPasswordCert","window","component","container","box"],{panel:true,registrationSetPassword:true,registrationSetPasswordCert:true,window:true,component:true,container:true,box:true},["widget.registrationSetPasswordCert"],0,[LkIp.view.Registration,"SetPasswordCert"],0));(Ext.cmd.derive("LkIp.view.RegistrationViewport",Ext.Container,{id:"LkIpRegistrationViewport",layout:"auto",required:'<span class="form-required-field" data-qtip="'+reference.lang.form.required+'">*</span>',enterFieldText:"",initComponent:function(){var d=this,f=LkIp.User.get("inn"),b=LkIp.User.get("ogrn");if(Ext.isEmpty(f)||"000000000000"==f||Ext.isEmpty(b)){d.enterFieldText=reference.lang.registration.emptyCertificateField;if(Ext.isEmpty(f)&&Ext.isEmpty(b)){d.enterFieldText+=reference.lang.registration.emptyInnOgrn}else{if(Ext.isEmpty(f)||"000000000000"==f){d.enterFieldText+=reference.lang.registration.emptyInn}else{d.enterFieldText+=reference.lang.registration.emptyOgrn}}}Ext.apply(this,{items:[{xtype:"container",cls:"links-fixed-block",items:[{xtype:"container",layout:{type:"auto"},cls:"toolbar links-bar",items:[{xtype:"component",cls:"fl-r",hidden:true,html:'<a href="https://lk2.service.nalog.ru/lk/" target="_blank" class="flk none-click">'+reference.lang.viewport.lkFl+"</a>"}]}]},{xtype:"container",cls:"wrapper",items:[{cls:"top-block",id:"header-element",xtype:"container",items:[{xtype:"container",layout:{type:"auto"},cls:"clear header",defaults:{xtype:"component"},items:[{cls:"fl-l wrap-logo",html:'<a href="http://nalog.ru"><div class="fl-l logo"></div></a>'},{xtype:"container",cls:"fl-l left",defaults:{xtype:"component"},layout:{type:"auto"},items:[{cls:"title",html:reference.lang.viewport.fnsTitle},{cls:"service-title",html:reference.lang.viewport.lkTitle}]}]}]},{cls:"clear"},{xtype:"form",cls:"main",itemId:"registration-form",layout:{type:"auto"},items:[{xtype:"component",itemId:"pageTitle",html:'<h2 class="header-uppercase">\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f</h2>'},{xtype:"container",itemId:"registration",items:c()}]}]},{xtype:"container",cls:"footer",items:{xtype:"container",cls:"footer-frame",items:{xtype:"container",cls:"footer-holder",items:[{xtype:"container",cls:"support",items:[{xtype:"component",html:'<span class="support-text"><a href="https://www.nalog.ru/rn77/service/service_feedback/?service=50">'+reference.lang.viewport.techSupport+"</a></span> "}]},{xtype:"container",cls:"copy-div",items:[{xtype:"component",cls:"copy",html:"&copy; 2013-"+Ext.Date.format(new Date(),"Y")+" \u0424\u041d\u0421 \u0420\u043e\u0441\u0441\u0438\u0438"},{xtype:"component",cls:"date-renew",html:"\u0414\u0430\u0442\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b "+LkIp.app.lastmodified}]}]}}}]});this.callParent(arguments);function c(){var g=[{xtype:"component",html:"<p>"+reference.lang.registration.info+"</p>"},{xtype:"component",html:LkIp.Utils.header(reference.lang.pages.instruction,3),margin:"15 0 0 0"},{xtype:"container",cls:"instruction",items:[{xtype:"displayfield",fieldLabel:reference.lang.registration.fio,value:LkIp.User.get("fullName")},{xtype:"component",html:d.enterFieldText,margin:"0 0 5 0"},((Ext.isEmpty(f)||"000000000000"==f)?{xtype:"textfield",name:"inn",fieldLabel:reference.lang.registration.inn,afterLabelTextTpl:d.required,allowBlank:false,minLength:12,maxLength:12,maskRe:/\d/}:{xtype:"displayfield",name:"inn",submitValue:true,fieldLabel:reference.lang.registration.inn,value:f}),(Ext.isEmpty(b)?{xtype:"textfield",name:"ogrnIp",fieldLabel:reference.lang.registration.ogrnIp,afterLabelTextTpl:d.required,allowBlank:false,minLength:15,maxLength:15,enforceMaxLength:true,maskRe:/\d/}:{xtype:"displayfield",name:"ogrnIp",submitValue:true,fieldLabel:reference.lang.registration.ogrnIp,value:b})]}];var h=e(a());Ext.Array.forEach(h,function(i){g.push(i)});g.push({xtype:"button",formBind:true,name:"registrationNextStep",text:reference.lang.buttons.next});return g}function e(h){var g=[{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"1",cls:"step-number"},{xtype:"container",defaults:{xtype:"component"},items:[{cls:"step-header",html:reference.lang.registration.step1},{html:'<iframe id="agreement-text" src="/web/agreement" width="100%" height="300px"></iframe>'}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"2",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.registration.step2}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"3",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.registration.step3},{xtype:"button",margin:"15 0 0 0",name:"registrationSignAgreement",text:reference.lang.buttons.sign},{xtype:"component",itemId:"signedAgreementSuccess",hidden:true,html:'<span style="color: green;">\u0421\u043e\u0433\u043b\u0430\u0448\u0435\u043d\u0438\u0435 \u043f\u043e\u0434\u043f\u0438\u0441\u0430\u043d\u043e</span>'}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"4",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.registration.step4},{margin:"15 0 0 0",xtype:"textfield",name:"email",fieldLabel:reference.lang.registration.emailLabel,width:350,allowBlank:false,value:LkIp.User.get("email"),afterLabelTextTpl:d.required,vtype:"email"}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"5",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.registration.step5},{xtype:"component",html:"\u041f\u0430\u0440\u043e\u043b\u044c \u043e\u0442 \u041b\u0438\u0447\u043d\u043e\u0433\u043e \u043a\u0430\u0431\u0438\u043d\u0435\u0442\u0430 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c \u0432 \u0442\u043e\u043c \u0441\u043b\u0443\u0447\u0430\u0435, \u0435\u0441\u043b\u0438 \u0432\u044b \u0441\u043e\u0431\u0438\u0440\u0430\u0435\u0442\u0435\u0441\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u043b\u043e\u0433\u0438\u043d\u043e\u043c (\u0418\u041d\u041d) \u0438 \u043f\u0430\u0440\u043e\u043b\u0435\u043c \u0434\u043b\u044f \u0432\u0445\u043e\u0434\u0430."},{xtype:"form",layout:"auto",itemId:"registration-setPassword",width:"100%",margin:"15 0 0",defaults:{width:350,allowBlank:false,afterLabelTextTpl:this.required,labelWidth:150},items:[{xtype:"component",width:"100%",html:reference.lang.registration.setPassword.passwordStart},{xtype:"container",cls:"check",width:"100%",itemId:"password-rules",items:{xtype:"container",cls:"check-steps",defaults:{xtype:"container",cls:"block-with-icon check-step failed"},items:[{itemId:"password-bigLetters",items:[{cls:"check-icon",items:{xtype:"component",itemId:"password-bigLetters-icon",cls:"exclamation-16-icon"}},{xtype:"component",html:reference.lang.registration.setPassword.bigLetters}]},{itemId:"password-smallLetters",items:[{cls:"check-icon",items:{xtype:"component",itemId:"password-smallLetters-icon",cls:"exclamation-16-icon"}},{xtype:"component",html:reference.lang.registration.setPassword.smallLetters}]},{itemId:"password-numbers",items:[{cls:"check-icon",items:{xtype:"component",itemId:"password-numbers-icon",cls:"exclamation-16-icon"}},{xtype:"component",html:reference.lang.registration.setPassword.numbers}]},{itemId:"password-specialChars",items:[{cls:"check-icon",items:{xtype:"component",itemId:"password-specialChars-icon",cls:"exclamation-16-icon"}},{xtype:"component",html:reference.lang.registration.setPassword.specialChars}]},{itemId:"password-minLength",items:[{cls:"check-icon",items:{xtype:"component",itemId:"password-minLength-icon",cls:"exclamation-16-icon"}},{xtype:"component",html:reference.lang.registration.setPassword.minLength}]}]}},{margin:"15 0 0",xtype:"textfield",name:"password",itemId:"password",fieldLabel:reference.lang.registration.passwordLabel,afterLabelTextTpl:"",inputType:"password",allowBlank:true,minLength:7,vtype:"passwordLetters"},{margin:"15 0 0",xtype:"textfield",name:"password_confirmed",itemId:"password_confirmed",initialPassField:"password",fieldLabel:reference.lang.registration.passwordConfirmedLabel,afterLabelTextTpl:"",inputType:"password",allowBlank:true,vtype:"password"}]}]}]},{xtype:"container",layout:{type:"auto"},cls:"instruction",items:[{xtype:"component",html:"6",cls:"step-number"},{xtype:"container",items:[{xtype:"component",cls:"step-header",html:reference.lang.registration.step6},{margin:"15 0 0 0",xtype:"textfield",name:"captcha",fieldLabel:"\u0426\u0438\u0444\u0440\u044b \u0441 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0438",width:320,labelWidth:150,allowBlank:false,afterLabelTextTpl:d.required,enforceMaxLength:true,maxLength:6,minLength:6,maskRe:/\d/},{xtype:"component",margin:"15 0 0 0",height:100,html:'<img id="captchaImage"><div><a id="newCaptcha">\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0434\u0440\u0443\u0433\u0443\u044e \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443</a></div>'}]}]}];if(h){var i=Ext.Array.filter(g,function(j,k){return k!==1});return Ext.Array.map(i,function(j,k){j.items[0].html=(k+1).toString();return j})}return g}function a(){return LkIp.User.authorizedByJacarta()||LkIp.User.authorizedByRutoken()}},setHtmlPageTitle:function(a){a=Ext.util.Format.stripTags(a);if(!this.origTitle){this.origTitle=document.title}document.title=a?(a+" - "+this.origTitle):this.origTitle}},0,["LkIpRegistrationViewport"],["component","container","LkIpRegistrationViewport","box"],{component:true,container:true,LkIpRegistrationViewport:true,box:true},["widget.LkIpRegistrationViewport"],0,[LkIp.view,"RegistrationViewport"],0));Ext.apply(Ext.form.field.VTypes,{passwordLetters:function(m,l){var j=l.up("form"),g="QWERTYUIOPLKJHGFDSAZXCVBNM\u0419\u0426\u0423\u041a\u0415\u041d\u0413\u0428\u0429\u0417\u0425\u042a\u0424\u042b\u0412\u0410\u041f\u0420\u041e\u041b\u0414\u0416\u042d\u042f\u0427\u0421\u041c\u0418\u0422\u042c\u0411\u042e",b="qwertyuiopasdfghjklzxcvbnm\u0439\u0446\u0443\u043a\u0435\u043d\u0433\u0448\u0449\u0437\u0445\u044a\u0444\u044b\u0432\u0430\u043f\u0440\u043e\u043b\u0434\u0436\u044d\u044f\u0447\u0441\u043c\u0438\u0442\u044c\u0431\u044e",n="0123456789",d="#$^&*_-+%@",h=false,a=false,k=false,e=false,c=m.length,f=0;for(;f<c;f++){if(!h&&g.indexOf(m[f])>-1){h=true;continue}if(!a&&b.indexOf(m[f])>-1){a=true;continue}if(!k&&n.indexOf(m[f])>-1){k=true;continue}if(!e&&d.indexOf(m[f])>-1){e=true;continue}}if(h){j.down("#password-bigLetters").removeCls("failed").addCls("success");j.down("#password-bigLetters-icon").removeCls("exclamation-16-icon").addCls("ok-16-icon")}else{j.down("#password-bigLetters").removeCls("success").addCls("failed");j.down("#password-bigLetters-icon").removeCls("ok-16-icon").addCls("exclamation-16-icon")}if(a){j.down("#password-smallLetters").removeCls("failed").addCls("success");j.down("#password-smallLetters-icon").removeCls("exclamation-16-icon").addCls("ok-16-icon")}else{j.down("#password-smallLetters").removeCls("success").addCls("failed");j.down("#password-smallLetters-icon").removeCls("ok-16-icon").addCls("exclamation-16-icon")}if(k){j.down("#password-numbers").removeCls("failed").addCls("success");j.down("#password-numbers-icon").removeCls("exclamation-16-icon").addCls("ok-16-icon")}else{j.down("#password-numbers").removeCls("success").addCls("failed");j.down("#password-numbers-icon").removeCls("ok-16-icon").addCls("exclamation-16-icon")}if(e){j.down("#password-specialChars").removeCls("failed").addCls("success");j.down("#password-specialChars-icon").removeCls("exclamation-16-icon").addCls("ok-16-icon")}else{j.down("#password-specialChars").removeCls("success").addCls("failed");j.down("#password-specialChars-icon").removeCls("ok-16-icon").addCls("exclamation-16-icon")}if(c>=7){j.down("#password-minLength").removeCls("failed").addCls("success");j.down("#password-minLength-icon").removeCls("exclamation-16-icon").addCls("ok-16-icon")}else{j.down("#password-minLength").removeCls("success").addCls("failed");j.down("#password-minLength-icon").removeCls("ok-16-icon").addCls("exclamation-16-icon")}return a&&h&&k&&e&&c>=7},password:function(c,b){if(b.initialPassField){var a=b.up("form").down("#"+b.initialPassField);return(c==a.getValue())}return true},passwordText:reference.lang.registration.passwordConfirmationError,passwordLettersText:reference.lang.registration.passwordLettersError});(Ext.cmd.derive("LkIp.view.ActivationViewport",Ext.Container,{id:"LkIpActivationViewport",layout:"auto",required:'<span class="form-required-field" data-qtip="'+reference.lang.form.required+'">*</span>',initComponent:function(){var a=this;Ext.apply(this,{items:[{xtype:"container",cls:"links-fixed-block",items:[{xtype:"container",layout:{type:"auto"},cls:"toolbar links-bar",items:[{xtype:"component",cls:"fl-r",hidden:true,html:'<a href="https://lk2.service.nalog.ru/lk/" target="_blank" class="flk none-click">'+reference.lang.viewport.lkFl+"</a>"}]}]},{xtype:"container",cls:"wrapper",items:[{cls:"top-block",id:"header-element",xtype:"container",items:[{xtype:"container",layout:{type:"auto"},cls:"clear header",defaults:{xtype:"component"},items:[{cls:"fl-l wrap-logo",html:'<a href="http://nalog.ru"><div class="fl-l logo"></div></a>'},{xtype:"container",cls:"fl-l left",defaults:{xtype:"component"},layout:{type:"auto"},items:[{cls:"title",html:reference.lang.viewport.fnsTitle},{cls:"service-title",html:reference.lang.viewport.lkTitle}]}]}]},{cls:"clear"},{xtype:"form",cls:"main",itemId:"activation-form",layout:{type:"auto"},defaults:{xtype:"component"},items:[{itemId:"pageTitle",html:'<h2  class="header-uppercase">\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f</h2>'},{html:"<p>"+reference.lang.registration.activation.greeting+LkIp.User.get("fullName")+" !</p>"},(1==LkIp.User.get("changeEmail")?{html:"<p>"+reference.lang.registration.activation.changeEmailInfo+"</p>"}:{html:"<p>"+reference.lang.registration.activation.info+"</p>"}),{xtype:"displayfield",width:300,labelWidth:100,labelCls:"label",fieldLabel:reference.lang.registration.activation.innLabel,value:LkIp.User.get("inn")},{xtype:"displayfield",width:300,labelWidth:100,labelCls:"label",fieldLabel:reference.lang.registration.activation.ogrnLabel,value:LkIp.User.get("ogrn")},{tpl:"<p>"+reference.lang.registration.activation.sendInfo+"</p>",data:{email:'<span class="label">'+LkIp.User.get("email")+"</span>"}},{html:"<p>"+reference.lang.registration.activation.changeEmail+"</p>"},{xtype:"hiddenfield",name:"userId",value:LkIp.User.get("userId")},{xtype:"textfield",name:"email",fieldLabel:reference.lang.registration.emailLabel,vtype:"email",value:Ext.isEmpty(LkIp.User.get("email"))?"":LkIp.User.get("email"),allowBlank:false,width:300,afterLabelTextTpl:'<span class="form-required-field" data-qtip="'+reference.lang.form.required+'">*</span>'},{margin:"15 0 0 0",xtype:"button",formBind:true,name:"activationChangeEmail",text:reference.lang.registration.activation.changeEmailAction},{margin:"15 0 0",html:"<hr>"},{cls:"gray",style:{fontSize:"0.9em"},html:reference.lang.registration.activation.support}]}]},{xtype:"container",cls:"footer",items:{xtype:"container",cls:"footer-frame",items:{xtype:"container",cls:"footer-holder",items:[{xtype:"container",cls:"support",items:[{xtype:"component",html:'<span class="support-text"><a href="https://www.nalog.ru/rn77/service/service_feedback/?service=50&INN='+LkIp.User.get("inn")+'">'+reference.lang.viewport.techSupport+"</a></span> "}]},{xtype:"container",cls:"copy-div",items:[{xtype:"component",cls:"copy",html:"&copy; 2013-"+Ext.Date.format(new Date(),"Y")+" \u0424\u041d\u0421 \u0420\u043e\u0441\u0441\u0438\u0438"},{xtype:"component",cls:"date-renew",html:"\u0414\u0430\u0442\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b "+LkIp.app.lastmodified}]}]}}}]});this.callParent(arguments)},setHtmlPageTitle:function(a){a=Ext.util.Format.stripTags(a);if(!this.origTitle){this.origTitle=document.title}document.title=a?(a+" - "+this.origTitle):this.origTitle}},0,["LkIpActivationViewport"],["LkIpActivationViewport","component","container","box"],{LkIpActivationViewport:true,component:true,container:true,box:true},["widget.LkIpActivationViewport"],0,[LkIp.view,"ActivationViewport"],0));(Ext.cmd.derive("LkIp.view.GuestViewport",Ext.Container,{id:"guestViewport",layout:"auto",required:'<span class="form-required-field" data-qtip="'+reference.lang.form.required+'">*</span>',initComponent:function(){var a=this;Ext.apply(this,{items:[{xtype:"container",cls:"links-fixed-block",items:[{xtype:"container",layout:{type:"auto"},cls:"toolbar links-bar"}]},{xtype:"container",cls:"wrapper",items:[{cls:"top-block",id:"header-element",xtype:"container",items:[{xtype:"container",layout:{type:"auto"},cls:"clear header",defaults:{xtype:"component"},items:[{cls:"fl-l wrap-logo",html:'<a href="http://nalog.ru"><div class="fl-l logo"></div></a>'},{xtype:"container",cls:"fl-l left",defaults:{xtype:"component"},layout:{type:"auto"},items:[{cls:"title",html:reference.lang.viewport.fnsTitle}]}]},{xtype:"component",cls:"header",padding:"10 0 20 0",html:"<h1>\u041d\u0430\u043b\u043e\u0433\u043e\u0432\u044b\u0439 \u043a\u0430\u043b\u044c\u043a\u0443\u043b\u044f\u0442\u043e\u0440</h1>"}]},{cls:"clear"},{xtype:"container",cls:"main",id:"main-content",itemId:"main-content",layout:"auto",items:[{xtype:"container",id:"content-container",itemId:"content-container",cls:"content-container",layout:{type:"card",deferredRender:true},items:[{xtype:"calculator",id:"calculator",inGuestViewport:true}]},{cls:"clear"}]}]},{xtype:"container",cls:"footer",items:{xtype:"container",cls:"footer-frame",items:{xtype:"container",cls:"footer-holder",items:[{xtype:"container",cls:"support",items:[{xtype:"component",html:'<span class="support-text"><a target="_blank" href="https://www.nalog.ru/rn77/service/service_feedback/?service=50">'+reference.lang.viewport.techSupport+"</a></span> "}]},{xtype:"container",cls:"copy-div",items:[{xtype:"component",cls:"copy",html:"&copy; 2013-"+Ext.Date.format(new Date(),"Y")+" \u0424\u041d\u0421 \u0420\u043e\u0441\u0441\u0438\u0438"},{xtype:"component",cls:"date-renew",html:"\u0414\u0430\u0442\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b "+LkIp.app.lastmodified}]}]}}}]});this.callParent(arguments)}},0,["LkIpGuestViewport"],["component","container","box","LkIpGuestViewport"],{component:true,container:true,box:true,LkIpGuestViewport:true},["widget.LkIpGuestViewport"],0,[LkIp.view,"GuestViewport"],0));(Ext.cmd.derive("LkIp.view.DelayedRegistrationViewport",Ext.Container,{id:"LkIpDelayedRegistrationViewport",layout:"auto",required:'<span class="form-required-field" data-qtip="'+reference.lang.form.required+'">*</span>',initComponent:function(){var a=this;Ext.apply(this,{items:[{xtype:"container",cls:"links-fixed-block",items:[{xtype:"container",layout:{type:"auto"},cls:"toolbar links-bar",items:[{xtype:"component",cls:"fl-r",hidden:true,html:'<a href="https://lk2.service.nalog.ru/lk/" target="_blank" class="flk none-click">'+reference.lang.viewport.lkFl+"</a>"}]}]},{xtype:"container",cls:"wrapper",items:[{cls:"top-block",id:"header-element",xtype:"container",items:[{xtype:"container",layout:{type:"auto"},cls:"clear header",defaults:{xtype:"component"},items:[{cls:"fl-l wrap-logo",html:'<a href="http://nalog.ru"><div class="fl-l logo"></div></a>'},{xtype:"container",cls:"fl-l left",defaults:{xtype:"component"},layout:{type:"auto"},items:[{cls:"title",html:reference.lang.viewport.fnsTitle},{cls:"service-title",html:reference.lang.viewport.lkTitle}]}]}]},{cls:"clear"},{xtype:"form",cls:"main",itemId:"delayed-registration--form",layout:{type:"auto"},defaults:{xtype:"component"},items:[{itemId:"pageTitle",html:'<h2 class="header-uppercase">\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f</h2>'},{html:"<p>"+reference.lang.registration.delayed.greeting+LkIp.User.get("fullName")+" !</p>"},{html:"<p>"+reference.lang.registration.delayed.info+"</p>"},{xtype:"displayfield",width:300,labelWidth:100,labelCls:"label",fieldLabel:reference.lang.registration.delayed.innLabel,value:LkIp.User.get("inn")},(!Ext.isEmpty(LkIp.User.get("ogrn"))?{xtype:"displayfield",width:300,labelWidth:100,labelCls:"label",fieldLabel:reference.lang.registration.delayed.ogrnLabel,value:LkIp.User.get("ogrn")}:{cls:"display-none"}),(!Ext.isEmpty(LkIp.User.get("email"))?{tpl:reference.lang.registration.delayed.emailInfo,itemId:"delayedInfo",data:{email:LkIp.User.get("email")}}:{html:reference.lang.registration.delayed.emptyEmailInfo}),{xtype:"textfield",name:"email",fieldLabel:reference.lang.registration.emailLabel,vtype:"email",value:Ext.isEmpty(LkIp.User.get("email"))?"":LkIp.User.get("email"),allowBlank:false,width:300,afterLabelTextTpl:'<span class="form-required-field" data-qtip="'+reference.lang.form.required+'">*</span>'},{margin:"15 15 0 0",xtype:"button",name:"logout",text:reference.lang.viewport.exit},{margin:"15 0 0 0",xtype:"button",formBind:true,name:"delayedChangeEmail",text:reference.lang.registration.delayed.changeEmailAction}]}]},{xtype:"container",cls:"footer",items:{xtype:"container",cls:"footer-frame",items:{xtype:"container",cls:"footer-holder",items:[{xtype:"container",cls:"support",items:[{xtype:"component",html:'<span class="support-text"><a href="https://www.nalog.ru/rn77/service/service_feedback/?service=50&INN='+LkIp.User.get("inn")+'">'+reference.lang.viewport.techSupport+"</a></span> "}]},{xtype:"container",cls:"copy-div",items:[{xtype:"component",cls:"copy",html:"&copy; 2013-"+Ext.Date.format(new Date(),"Y")+" \u0424\u041d\u0421 \u0420\u043e\u0441\u0441\u0438\u0438"},{xtype:"component",cls:"date-renew",html:"\u0414\u0430\u0442\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b "+LkIp.app.lastmodified}]}]}}}]});this.callParent(arguments)},setHtmlPageTitle:function(a){a=Ext.util.Format.stripTags(a);if(!this.origTitle){this.origTitle=document.title}document.title=a?(a+" - "+this.origTitle):this.origTitle}},0,["LkIpDelayedRegistrationViewport"],["component","container","box","LkIpDelayedRegistrationViewport"],{component:true,container:true,box:true,LkIpDelayedRegistrationViewport:true},["widget.LkIpDelayedRegistrationViewport"],0,[LkIp.view,"DelayedRegistrationViewport"],0));(Ext.cmd.derive("LkIp.view.Registration.SetPasswordLogin",LkIp.view.Registration.SetPassword,{registrationType:"login"},0,["registrationSetPasswordLogin"],["panel","registrationSetPassword","registrationSetPasswordLogin","window","component","container","box"],{panel:true,registrationSetPassword:true,registrationSetPasswordLogin:true,window:true,component:true,container:true,box:true},["widget.registrationSetPasswordLogin"],0,[LkIp.view.Registration,"SetPasswordLogin"],0));(Ext.cmd.derive("LkIp.view.RegistrationPasswordViewport",Ext.Container,{id:"LkIpRegistrationPasswordViewport",layout:"auto",required:'<span class="form-required-field" data-qtip="'+reference.lang.form.required+'">*</span>',enterFieldText:"",initComponent:function(){Ext.apply(this,{items:[{xtype:"container",cls:"links-fixed-block",items:[{xtype:"container",layout:{type:"auto"},cls:"toolbar links-bar",items:[{xtype:"component",cls:"fl-r",hidden:true,html:'<a href="https://lk2.service.nalog.ru/lk/" target="_blank" class="flk none-click">'+reference.lang.viewport.lkFl+"</a>"}]}]},{xtype:"container",cls:"wrapper",items:[{cls:"top-block",id:"header-element",xtype:"container",items:[{xtype:"container",layout:{type:"auto"},cls:"clear header",defaults:{xtype:"component"},items:[{cls:"fl-l wrap-logo",html:'<a href="http://nalog.ru"><div class="fl-l logo"></div></a>'},{xtype:"container",cls:"fl-l left",defaults:{xtype:"component"},layout:{type:"auto"},items:[{cls:"title",html:reference.lang.viewport.fnsTitle},{cls:"service-title",html:reference.lang.viewport.lkTitle}]}]}]},{cls:"clear"},{xtype:"container",cls:"main",layout:{type:"auto"},items:[{xtype:"form",itemId:"passwordForm",hidden:true,items:[{xtype:"component",cls:"fieldset-title",html:reference.lang.registrationPassword.errors.error10},{margin:"15 0 0",xtype:"textfield",name:"password",itemId:"passwordCorrect",fieldLabel:reference.lang.registration.passwordLabel,afterLabelTextTpl:this.required,inputType:"password",allowBlank:false},{xtype:"container",itemId:"captchaContainer",hidden:true,items:[{xtype:"component",cls:"fieldset-title",html:reference.lang.registrationPassword.captchaInfo},{xtype:"container",items:[{xtype:"component",margin:"15 0 0 0",height:100,html:'<img id="captchaImage"><div><a id="newCaptcha">'+reference.lang.registrationPassword.captchaChange+"</a></div>"},{margin:"15 0 0 0",xtype:"textfield",name:"captcha",disabled:true,fieldLabel:reference.lang.registrationPassword.captcha,width:320,labelWidth:150,allowBlank:false,afterLabelTextTpl:this.required,enforceMaxLength:true,maxLength:6,minLength:6,maskRe:/\d/}]}]},{xtype:"button",formBind:true,itemId:"passwordStepBtn",margin:"10 0 0",text:reference.lang.buttons.send}]},{xtype:"form",itemId:"ogrnipForm",hidden:true,items:[{xtype:"component",cls:"fieldset-title",html:reference.lang.registrationPassword.ogrnipStepText},{xtype:"textfield",name:"ogrnip",allowBlank:false,minLength:15,maxLength:15,enforceMaxLength:true,maskRe:/\d/,margin:"10 0 0",vtype:"ogrnip"},{xtype:"button",formBind:true,itemId:"ogrnipStepBtn",margin:"10 0 0",text:reference.lang.buttons.send}]},{xtype:"form",itemId:"finishForm",hidden:true,items:[{xtype:"hidden",name:"fid"},{xtype:"hidden",name:"ogrnip"},{xtype:"hidden",name:"inn"},{xtype:"component",cls:"fieldset-title",html:reference.lang.registrationPassword.finishStepText},{xtype:"form",layout:"auto",itemId:"registration-setPassword",width:"100%",margin:"15 0 0",defaults:{width:350,afterLabelTextTpl:this.required,labelWidth:150},items:[{xtype:"component",width:"100%",html:reference.lang.registration.setPassword.passwordStart},{xtype:"container",cls:"check",width:"100%",itemId:"password-rules",items:{xtype:"container",cls:"check-steps",defaults:{xtype:"container",cls:"block-with-icon check-step failed"},items:[{itemId:"password-bigLetters",items:[{cls:"check-icon",items:{xtype:"component",itemId:"password-bigLetters-icon",cls:"exclamation-16-icon"}},{xtype:"component",html:reference.lang.registration.setPassword.bigLetters}]},{itemId:"password-smallLetters",items:[{cls:"check-icon",items:{xtype:"component",itemId:"password-smallLetters-icon",cls:"exclamation-16-icon"}},{xtype:"component",html:reference.lang.registration.setPassword.smallLetters}]},{itemId:"password-numbers",items:[{cls:"check-icon",items:{xtype:"component",itemId:"password-numbers-icon",cls:"exclamation-16-icon"}},{xtype:"component",html:reference.lang.registration.setPassword.numbers}]},{itemId:"password-specialChars",items:[{cls:"check-icon",items:{xtype:"component",itemId:"password-specialChars-icon",cls:"exclamation-16-icon"}},{xtype:"component",html:reference.lang.registration.setPassword.specialChars}]},{itemId:"password-minLength",items:[{cls:"check-icon",items:{xtype:"component",itemId:"password-minLength-icon",cls:"exclamation-16-icon"}},{xtype:"component",html:reference.lang.registration.setPassword.minLength}]}]}},{margin:"15 0 0",xtype:"textfield",name:"password",itemId:"password",fieldLabel:reference.lang.registration.passwordLabel,afterLabelTextTpl:"",inputType:"password",minLength:7,vtype:"passwordLetters"},{margin:"15 0 0",xtype:"textfield",name:"password_confirmed",itemId:"passwordConfirmed",initialPassField:"password",fieldLabel:reference.lang.registration.passwordConfirmedLabel,afterLabelTextTpl:"",inputType:"password",vtype:"password"}]},{xtype:"textfield",fieldLabel:reference.lang.registrationPassword.email,name:"email",vtype:"email",labelWidth:150,margin:"15 0 0",afterLabelTextTpl:""},{xtype:"component",cls:"gray",style:{fontSize:"11px"},html:reference.lang.registrationPassword.emailText},{xtype:"button",formBind:true,itemId:"finishStepBtn",margin:"10 0 0",text:reference.lang.buttons.next}]},{xtype:"container",hidden:true,itemId:"error-block",items:[{xtype:"note",itemId:"errorNote",text:""},{xtype:"button",name:"registrationFirstStep",margin:"15 0 0 0",text:reference.lang.pages.index.title,handler:function(){LkIp.Request.request({url:"/api/auth/logout",scope:this,method:"POST"},function(){document.location.href="/"})}}]}]}]},{xtype:"container",cls:"footer",items:{xtype:"container",cls:"footer-frame",items:{xtype:"container",cls:"footer-holder",items:[{xtype:"container",cls:"support",items:[{xtype:"component",html:'<span class="support-text"><a href="https://www.nalog.ru/rn77/service/service_feedback/?service=50&INN='+LkIp.User.get("inn")+'">'+reference.lang.viewport.techSupport+"</a></span> "}]},{xtype:"container",cls:"copy-div",items:[{xtype:"component",cls:"copy",html:"&copy; 2013-"+Ext.Date.format(new Date(),"Y")+" \u0424\u041d\u0421 \u0420\u043e\u0441\u0441\u0438\u0438"},{xtype:"component",cls:"date-renew",html:"\u0414\u0430\u0442\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b "+LkIp.app.lastmodified}]}]}}}]});this.callParent(arguments)},setHtmlPageTitle:function(a){a=Ext.util.Format.stripTags(a);if(!this.origTitle){this.origTitle=document.title}document.title=a?(a+" - "+this.origTitle):this.origTitle}},0,["LkIpRegistrationPasswordViewport"],["component","LkIpRegistrationPasswordViewport","container","box"],{component:true,LkIpRegistrationPasswordViewport:true,container:true,box:true},["widget.LkIpRegistrationPasswordViewport"],0,[LkIp.view,"RegistrationPasswordViewport"],0));Ext.apply(Ext.form.field.VTypes,{passwordLetters:function(m,l){var j=l.up("form"),g="QWERTYUIOPLKJHGFDSAZXCVBNM\u0419\u0426\u0423\u041a\u0415\u041d\u0413\u0428\u0429\u0417\u0425\u042a\u0424\u042b\u0412\u0410\u041f\u0420\u041e\u041b\u0414\u0416\u042d\u042f\u0427\u0421\u041c\u0418\u0422\u042c\u0411\u042e",b="qwertyuiopasdfghjklzxcvbnm\u0439\u0446\u0443\u043a\u0435\u043d\u0433\u0448\u0449\u0437\u0445\u044a\u0444\u044b\u0432\u0430\u043f\u0440\u043e\u043b\u0434\u0436\u044d\u044f\u0447\u0441\u043c\u0438\u0442\u044c\u0431\u044e",n="0123456789",d="#$^&*_-+%@",h=false,a=false,k=false,e=false,c=m.length,f=0;for(;f<c;f++){if(!h&&g.indexOf(m[f])>-1){h=true;continue}if(!a&&b.indexOf(m[f])>-1){a=true;continue}if(!k&&n.indexOf(m[f])>-1){k=true;continue}if(!e&&d.indexOf(m[f])>-1){e=true;continue}}if(h){j.down("#password-bigLetters").removeCls("failed").addCls("success");j.down("#password-bigLetters-icon").removeCls("exclamation-16-icon").addCls("ok-16-icon")}else{j.down("#password-bigLetters").removeCls("success").addCls("failed");j.down("#password-bigLetters-icon").removeCls("ok-16-icon").addCls("exclamation-16-icon")}if(a){j.down("#password-smallLetters").removeCls("failed").addCls("success");j.down("#password-smallLetters-icon").removeCls("exclamation-16-icon").addCls("ok-16-icon")}else{j.down("#password-smallLetters").removeCls("success").addCls("failed");j.down("#password-smallLetters-icon").removeCls("ok-16-icon").addCls("exclamation-16-icon")}if(k){j.down("#password-numbers").removeCls("failed").addCls("success");j.down("#password-numbers-icon").removeCls("exclamation-16-icon").addCls("ok-16-icon")}else{j.down("#password-numbers").removeCls("success").addCls("failed");j.down("#password-numbers-icon").removeCls("ok-16-icon").addCls("exclamation-16-icon")}if(e){j.down("#password-specialChars").removeCls("failed").addCls("success");j.down("#password-specialChars-icon").removeCls("exclamation-16-icon").addCls("ok-16-icon")}else{j.down("#password-specialChars").removeCls("success").addCls("failed");j.down("#password-specialChars-icon").removeCls("ok-16-icon").addCls("exclamation-16-icon")}if(c>=7){j.down("#password-minLength").removeCls("failed").addCls("success");j.down("#password-minLength-icon").removeCls("exclamation-16-icon").addCls("ok-16-icon")}else{j.down("#password-minLength").removeCls("success").addCls("failed");j.down("#password-minLength-icon").removeCls("ok-16-icon").addCls("exclamation-16-icon")}return a&&h&&k&&e&&c>=7},password:function(c,b){if(b.initialPassField){var a=b.up("form").down("#"+b.initialPassField);return(c==a.getValue())}return true},phone:function(b,a){return/^[0-9\+\(\)\-\ ]+$/.test(b)},ogrnip:function(b,a){b=parseInt(b);return String(b).length==15},phoneText:reference.lang.registration.phoneError,passwordText:reference.lang.registration.passwordConfirmationError,passwordLettersText:reference.lang.registration.passwordLettersError,ogrnipText:reference.lang.registrationPassword.invalidOgrnip});(Ext.cmd.derive("LkIp.view.InnEnterViewport",Ext.Container,{id:"LkIpInnEnterViewport",layout:"auto",required:'<span class="form-required-field" data-qtip="'+reference.lang.form.required+'">*</span>',enterFieldText:"",initComponent:function(){Ext.apply(this,{items:[{xtype:"container",cls:"links-fixed-block",items:[{xtype:"container",layout:{type:"auto"},cls:"toolbar links-bar",items:[{xtype:"component",cls:"fl-r",hidden:true,html:'<a href="https://lk2.service.nalog.ru/lk/" target="_blank" class="flk none-click">'+reference.lang.viewport.lkFl+"</a>"}]}]},{xtype:"container",cls:"wrapper",items:[{cls:"top-block",id:"header-element",xtype:"container",items:[{xtype:"container",layout:{type:"auto"},cls:"clear header",defaults:{xtype:"component"},items:[{cls:"fl-l wrap-logo",html:'<a href="http://nalog.ru"><div class="fl-l logo"></div></a>'},{xtype:"container",cls:"fl-l left",defaults:{xtype:"component"},layout:{type:"auto"},items:[{cls:"title",html:reference.lang.viewport.fnsTitle},{cls:"service-title",html:reference.lang.viewport.lkTitle}]}]}]},{cls:"clear"},{xtype:"container",cls:"main",layout:{type:"auto"},items:[{xtype:"note",text:"\u0412\u0430\u0448 \u043a\u0432\u0430\u043b\u0438\u0444\u0438\u0446\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0439 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442 \u043a\u043b\u044e\u0447\u0430 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u043e\u0439 \u043f\u043e\u0434\u043f\u0438\u0441\u0438 \u043d\u0435 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u0418\u041d\u041d."},{xtype:"form",itemId:"enter-user-inn",layout:"anchor",items:[{xtype:"textfield",fieldLabel:reference.lang.registrationPassword.enterInn,name:"inn",itemId:"inn",minLength:12,maxLength:12,maskRe:/[0-9]/,enforceMaxLength:true,anchor:"40%",labelWidth:150,allowBlank:false,afterLabelTextTpl:this.required},{xtype:"button",formBind:true,itemId:"enterInnNextStep",margin:"10 0 0",text:reference.lang.buttons.next}]}]}]},{xtype:"container",cls:"footer",items:{xtype:"container",cls:"footer-frame",items:{xtype:"container",cls:"footer-holder",items:[{xtype:"container",cls:"support",items:[{xtype:"component",html:'<span class="support-text"><a href="https://www.nalog.ru/rn77/service/service_feedback/?service=50">'+reference.lang.viewport.techSupport+"</a></span> "}]},{xtype:"container",cls:"copy-div",items:[{xtype:"component",cls:"copy",html:"&copy; 2013-"+Ext.Date.format(new Date(),"Y")+" \u0424\u041d\u0421 \u0420\u043e\u0441\u0441\u0438\u0438"},{xtype:"component",cls:"date-renew",html:"\u0414\u0430\u0442\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b "+LkIp.app.lastmodified}]}]}}}]});this.callParent(arguments)},setHtmlPageTitle:function(a){a=Ext.util.Format.stripTags(a);if(!this.origTitle){this.origTitle=document.title}document.title=a?(a+" - "+this.origTitle):this.origTitle}},0,["LkIpInnEnterViewport"],["component","container","box","LkIpInnEnterViewport"],{component:true,container:true,box:true,LkIpInnEnterViewport:true},["widget.LkIpInnEnterViewport"],0,[LkIp.view,"InnEnterViewport"],0));(Ext.cmd.derive("LkIp.Application",Ext.app.Application,{name:"LkIp",appFolder:defaultFolder+"app",controllers:["RegistrationViewport","ActivationViewport","DelayedRegistrationViewport","RegistrationPasswordViewport","GuestViewport","InnEnterViewport","Egrip.Request","Rsb.Budget","Docflow.Documents","Docflow.Notice","Index","Viewport","Egrn.Account","Rsb.Cards","Rsb.Cards.Nds","Rsb.Cards.Hung","Rsb.Cards.Operations","Rsb.Cards.Debt","Rsb.Cards.DebtObject","Rsb.Cards.Budget","Rsb.Overpayment","Envd","Rsb.Clarify","Rsb.Clarify.Unexpay","Rsb.Overpayment.Statement","Rsb.Overpayment.Status","Rsb.Clarify.Unexpay.Notify","Rsb.UnexpayDecisions","Rsb.Clarify.Unexpay.Statement","Rsb.OverpaymentDecisions","Rsb.PvzDecisions","Rsb.SuspendedDecisions","Rsb.DebitDecisions","Rsb.Clarify.Other","Rsb.Cards.Details","Partnership","Rsb.Reconciliation","Rsb.Reconciliation.Object","PersonalData.Update","Rsb.CompliedReqs","StateRegistration","Information.Service","Information.Service.PaymentsStatus","Information.Service.Obligation","Information.Service.Accounting","Information.Service.Reconciliation","Information.Service.Operations","Rsb.Reconciliation.Statement","Feedback","Profile","Deactivate","StatementList","ServicesList","DeskAudit","Calculator","TaxSystems.Eshn.Notification","TaxSystems.Eshn.Statement","TaxSystems.Eshn.Stop","TaxSystems.Eshn.Refuse","TaxSystems.Usn.Notification","TaxSystems.Usn.Statement","TaxSystems.Usn.Refuse","TaxSystems.Usn.Change","TaxSystems.Usn.Stop","TaxSystems.Psn.Patent","TaxSystems.Psn.Orn","TaxSystems.Psn.Stop","Address","FnsMail","FnsStands","Complaints","OnlineBooking","Kkt.Index","Kkt.Manufacturer.Index","Kkt.Registration","Kkt.RegistrationFile","Kkt.ReRegistration","Kkt.DeRegistration","Kkt.Manufacturer.Models.Instances.Register","Kkt.Manufacturer.Fn.Instances.Register","Kkt.Fiscalization","Kkt.History","Kkt.FiscalReport","Anketa","SignDocumentController","CertificateListController","SignCheck","CertificatePinController","AddressFIAS","Consent.Index","Foreign.Index","Employees.Identification"],stores:["Settings"],views:["Viewport","RegistrationViewport","ActivationViewport","GuestViewport","DelayedRegistrationViewport","RegistrationPasswordViewport","InnEnterViewport"],listeners:{clearCache:function(){this.getController("Index").cache=false;this.getController("Docflow.Documents").cache=false}},loginType:undefined,launch:function(){LkIp.app=this;Ext.Ajax.disableCaching=false;Ext.Ajax.timeout=120000;LkIp.Utils.init();LkIp.Settings.init();LkIp.History.init();LkIp.PageRegistry.init();var a=this,b=Ext.get("loginType").getValue();LkIp.Signature.init();switch(b){case"certificate":case"jacarta":case"rutoken":LkIp.Auth.authorize(function(){a.tryPageLoad()});break;case"login_password":if(Ext.get("isAuth").getValue()){LkIp.User.getUserData(function(){a.tryPageLoad()})}else{LkIp.Auth.registration()}break;case"lk2":case"inspector":LkIp.User.getUserData(function(){a.tryPageLoad()});break;case"guest":a.renderWidget("LkIpGuestViewport");break;default:LkIp.Error.e403()}},tryPageLoad:function(){this.renderWidget(!Ext.isEmpty(LkIp.User.get("delayedRegistration"))?"LkIpDelayedRegistrationViewport":"LkIpViewport")},setVisibleApplicationBlock:function(a){var b=Ext.get("application");b.setVisible(a)},removeIndexBlock:function(){var a=Ext.get("index-page");if(!Ext.isEmpty(a)){a.remove()}},renderWidget:function(b){var a=this;a.removeIndexBlock();a.setVisibleApplicationBlock(true);Ext.widget(b,{renderTo:Ext.get("application")});b==="LkIpViewport"&&LkIp.History.notifyPageLoaded()}},0,0,0,0,0,0,[LkIp,"Application"],0));(Ext.cmd.derive("LkIp.view.AddressWindow",Ext.window.Window,{autoHeight:true,layout:"auto",modal:true,ui:"nalogThemeWindow",title:reference.lang.address.title,width:800,minHeight:400,data:undefined,componentCls:"kktRegistration",initComponent:function(){var a=this;Ext.apply(a,{defaults:{margin:15},items:[{xtype:"note",text:"\u0412\u0432\u0435\u0434\u0435\u043d\u044b\u0439 \u0430\u0434\u0440\u0435\u0441 \u0434\u043e\u043b\u0436\u0435\u043d \u043f\u0440\u0438\u0441\u0443\u0442\u0441\u0442\u0432\u043e\u0432\u0430\u0442\u044c \u0432 \u0424\u0435\u0434\u0435\u0440\u0430\u043b\u044c\u043d\u043e\u0439 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u043e\u043d\u043d\u043e\u0439 \u0441\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u0435 \u0434\u043e \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0433\u043e \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0433\u043e \u0443\u0440\u043e\u0432\u043d\u044f (\u043d\u0430\u0441\u0435\u043b\u0435\u043d\u043d\u044b\u0439 \u043f\u0443\u043d\u043a\u0442, \u0443\u043b\u0438\u0446\u0430) \u0432\u044b\u0448\u0435 \u0443\u0440\u043e\u0432\u043d\u044f \u0434\u043e\u043c\u0430. \u0412\u0432\u043e\u0434 \u0434\u043e\u043c\u0430 \u0412\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u043e\u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0438\u0442\u044c \u0432 \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0445 \u043f\u043e\u043b\u044f\u0445 \u0441 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435\u043c \u0441\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u0438\u043a\u043e\u0432 \u0442\u0438\u043f\u043e\u0432 \u0438 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u044f\u043c\u0438 \u0432\u0432\u043e\u0434\u0430. \u041e\u0431\u0440\u0430\u0449\u0430\u0435\u043c \u0412\u0430\u0448\u0435 \u0432\u043d\u0438\u043c\u0430\u043d\u0438\u0435, \u0447\u0442\u043e \u0412\u044b \u043d\u0435\u0441\u0435\u0442\u0435 \u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0435\u043d\u043d\u043e\u0441\u0442\u044c \u0437\u0430 \u043f\u043e\u043b\u043d\u043e\u0442\u0443 \u0438 \u0434\u043e\u0441\u0442\u043e\u0432\u0435\u0440\u043d\u043e\u0441\u0442\u044c \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0433\u043e \u0430\u0434\u0440\u0435\u0441\u0430!"},{xtype:"form",itemId:"addressForm",rel:"form",border:false,layout:{type:"anchor"},fieldDefaults:{labelWidth:300,anchor:"100%",labelAlign:"left"},items:[{xtype:"textfield",disabled:false,readOnly:false,name:"addressStringWindow",itemId:"addressStringWindow",ttip:reference.lang.kkt.help.address,fieldLabel:'<span class="page-action-link help-tooltip" data-help="'+reference.lang.kkt.help.address+'">'+reference.lang.kkt.registration.address+"</span>",afterLabelTextTpl:'<span class="red">*</span>',allowBlank:false},{xtype:"component",itemId:"wrongAddress",html:'<span class="red">'+reference.lang.address.wrongAddress2+"</span>",hidden:true},{xtype:"component",itemId:"notFullAddress",html:'<span class="red">'+reference.lang.address.notFullAddress+"</span>",hidden:true},{xtype:"component",itemId:"emptyNo",html:'<span class="red">'+reference.lang.address.emptyNo+"</span>",hidden:true},{xtype:"component",itemId:"fiasNot",html:'<span class="red">'+reference.lang.address.fiasNotAvailable+"</span>",hidden:true},{itemId:"addressBlock",hidden:true,margin:"5 0 0 30",defaults:{margin:"0 0 0 0"},items:[{xtype:"displayfield",submitValue:true,name:"region",itemId:"region",fieldLabel:reference.lang.address.regionCode},{xtype:"displayfield",submitValue:true,name:"region_name",itemId:"region_name",fieldLabel:reference.lang.address.region},{xtype:"displayfield",submitValue:true,hidden:true,name:"noFromAddress",itemId:"noFromAddress"},{xtype:"displayfield",submitValue:true,name:"district",itemId:"district",fieldLabel:reference.lang.address.district},{xtype:"displayfield",submitValue:true,name:"city",itemId:"city",fieldLabel:reference.lang.address.city},{xtype:"displayfield",submitValue:true,name:"locality",itemId:"locality",fieldLabel:reference.lang.address.locality2},{xtype:"displayfield",submitValue:true,name:"street",itemId:"street",fieldLabel:reference.lang.address.street2},{xtype:"textfield",hidden:true,submitValue:true,name:"postcode",itemId:"postcodeTf",allowBlank:false,maskRe:/[0-9]/,minLength:6,maxLength:6,enforceMaxLength:true,fieldLabel:reference.lang.address.postcode},{xtype:"displayfield",disabled:true,hidden:true,submitValue:true,name:"postcode",itemId:"postcodeDf",fieldLabel:reference.lang.address.postcode}]},{xtype:"container",margin:"15 0 0 0",items:[{cls:"fl-l",style:{width:"32%!important"},defaults:{width:"95%",labelAlign:"top",xtype:"simpleSelect",queryMode:"local",editable:false,afterLabelTextTpl:'<span class="red">*</span>',disableTooltip:true},items:[{itemId:"holdType",name:"holdType",disabled:true,fieldLabel:reference.lang.address.holdType,store:[[0,"-\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043f\u0440\u0438\u0437\u043d\u0430\u043a \u0432\u043b\u0430\u0434\u0435\u043d\u0438\u044f-"],["\u0432\u043b\u0434.","\u0412\u043b\u0430\u0434\u0435\u043d\u0438\u0435"],["\u0434.","\u0414\u043e\u043c"],["\u0434\u0432\u043b\u0434.","\u0414\u043e\u043c\u043e\u0432\u043b\u0430\u0434\u0435\u043d\u0438\u0435"],["\u0433-\u0436 ","\u0413\u0430\u0440\u0430\u0436"]]},{itemId:"buildType",name:"buildType",disabled:true,fieldLabel:reference.lang.address.buildType,store:[[0,"-\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043f\u0440\u0438\u0437\u043d\u0430\u043a \u0441\u0442\u0440\u043e\u0435\u043d\u0438\u044f-"],["\u0441\u0442\u0440.","\u0421\u0442\u0440\u043e\u0435\u043d\u0438\u0435"],["\u0441\u043e\u043e\u0440.","\u0421\u043e\u043e\u0440\u0443\u0436\u0435\u043d\u0438\u0435"],["\u043b\u0438\u0442\u0435\u0440","\u041b\u0438\u0442\u0435\u0440"]]}]},{cls:"fl-l",style:{width:"32%!important"},defaults:{width:"95%",xtype:"textfield",enforceMaxLength:true,labelAlign:"top",afterLabelTextTpl:'<span class="red">*</span>'},items:[{name:"houseNumber",itemId:"houseNumber",disabled:true,maxLength:20,enforceMaxLength:true,fieldLabel:reference.lang.address.houseNumber},{name:"buildNumber",itemId:"buildNumber",disabled:true,maxLength:10,enforceMaxLength:true,fieldLabel:reference.lang.address.buildNumber}]},{cls:"fl-l",style:{width:"32%!important"},items:[{xtype:"textfield",width:"95%",name:"housingNumber",itemId:"housingNumber",disabled:true,maxLength:10,enforceMaxLength:true,labelAlign:"top",fieldLabel:reference.lang.address.housingNumber}]}]},{xtype:"container",items:[{xtype:"button",text:reference.lang.buttons.choose,rel:"submit",formBind:true,disabled:true,margin:"0 15 0 0",name:"addressSubmit"}]}]}],listeners:{afterrender:function(){$("input[name='addressStringWindow']").suggestions({serviceURL:"https://suggestions.dadata.ru/suggestions/api/4_1/rs",token:"0773ded29e41732c7894587dbb9602b418b91b1c",type:"ADDRESS",deferRequestBy:100,minChars:3,count:5,onSelect:function(b){a.fireEvent("selectAddressFIAS",b,2)},onSelectNothing:function(b){a.down("#addressStringWindow").blur()}})}}});a.callParent(arguments)}},0,["addressWindow"],["panel","window","component","container","box","addressWindow"],{panel:true,window:true,component:true,container:true,box:true,addressWindow:true},["widget.addressWindow"],0,[LkIp.view,"AddressWindow"],0));(Ext.cmd.derive("LkIp.view.AnketaWindow",Ext.window.Window,{autoHeight:true,layout:"auto",modal:true,ui:"nalogThemeWindow",componentCls:"anketa",title:reference.lang.anketaWindow.title,width:800,maxHeight:700,closable:true,bodyPadding:5,initComponent:function(){var a=this;Ext.apply(a,{padding:5,items:[{xtype:"panel",layout:"card",itemId:"steps",tbar:[{xtype:"container",width:"100%",layout:{type:"hbox",pack:"center"},defaults:{xtype:"component"},items:[{html:"1",itemId:"step-0",cls:"simple-number"},{cls:"anketa-separator",html:""},{html:"2",itemId:"step-1",cls:"simple-number simple-number-disabled"},{cls:"anketa-separator",html:""},{html:"3",itemId:"step-2",cls:"simple-number simple-number-disabled"}]}],bbar:[{text:"\u041d\u0430\u0437\u0430\u0434",itemId:"goToPreviousStep",hidden:true,handler:function(b){a.fireEvent("previousStep",b)}},"->",{text:"\u0414\u0430\u043b\u0435\u0435",itemId:"goToNextStep",handler:function(b){a.fireEvent("nextStep",b)}},{text:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c",itemId:"sendBtn",hidden:true,disabled:true,handler:function(){a.fireEvent("send")}}],items:[{xtype:"container",items:[{xtype:"container",layout:{type:"hbox",pack:"center",align:"middle"},margin:"10 0",items:[{xtype:"component",html:"\u041a\u0430\u043a\u0438\u0435 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u043b\u0438\u0447\u043d\u043e\u0433\u043e \u043a\u0430\u0431\u0438\u043d\u0435\u0442\u0430 \u043d\u0430\u0438\u0431\u043e\u043b\u0435\u0435 \u0430\u043a\u0442\u0443\u0430\u043b\u044c\u043d\u044b \u0434\u043b\u044f \u0412\u0430\u0441?"}]},{xtype:"component",html:"<hr/>"},{xtype:"form",itemId:"step1-form",layout:{type:"hbox"},items:[{xtype:"container",margin:"0 25 0 0",width:"48%",layout:{type:"anchor"},defaults:{anchor:"95%"},items:[{xtype:"checkbox",boxLabel:'<span class="bold">'+reference.lang.anketaWindow.ipInfo.title+"</span>",name:"ipInfoGroupSelectAll",itemId:"ipInfoGroupSelectAll",inputValue:"1"},{xtype:"checkboxgroup",columns:1,itemId:"ipInfoGroup",cls:"anketa__checkboxgroupItems",vertical:true,defaults:{anchor:"100%"},items:[{boxLabel:reference.lang.anketaWindow.ipInfo.vEgrip,name:"ipInfo",inputValue:"vEgrip"},{boxLabel:reference.lang.anketaWindow.ipInfo.rEgrip,name:"ipInfo",inputValue:"rEgrip"},{boxLabel:reference.lang.anketaWindow.ipInfo.cEgrip,name:"ipInfo",inputValue:"cEgrip"},{boxLabel:reference.lang.anketaWindow.ipInfo.pData,name:"ipInfo",inputValue:"pData"}]},{xtype:"component",html:"<hr/>"},{xtype:"checkbox",boxLabel:'<span class="bold">'+reference.lang.anketaWindow.taxes.title+"</span>",name:"taxesGroupSelectAll",itemId:"taxesGroupSelectAll",inputValue:"1"},{xtype:"checkboxgroup",columns:1,itemId:"taxesGroup",cls:"anketa__checkboxgroupItems",vertical:true,items:[{boxLabel:reference.lang.anketaWindow.taxes.iTaxes,name:"taxes",inputValue:"iTaxes"},{boxLabel:reference.lang.anketaWindow.taxes.cTaxes,name:"taxes",inputValue:"cTaxes"},{boxLabel:reference.lang.anketaWindow.taxes.dTaxes,name:"taxes",inputValue:"dTaxes"},{boxLabel:reference.lang.anketaWindow.taxes.idTaxes,name:"taxes",inputValue:"idTaxes"}]},{xtype:"component",html:"<hr/>"},{xtype:"checkbox",boxLabel:'<span class="bold">'+reference.lang.anketaWindow.feedback.title+"</span>",name:"feedbackAll",itemId:"feedbackAll",inputValue:"1"},{xtype:"component",html:"<hr/>"},{xtype:"checkbox",boxLabel:'<span class="bold">'+reference.lang.anketaWindow.other.title+"</span>",name:"otherAll",itemId:"otherAll",inputValue:"1"}]},{xtype:"container",width:"48%",cls:"fl-r",items:[{xtype:"checkbox",boxLabel:'<span class="bold">'+reference.lang.anketaWindow.rsb.title+"</span>",name:"rsbGroupSelectAll",itemId:"rsbGroupSelectAll",inputValue:"1"},{xtype:"checkboxgroup",columns:1,itemId:"rsbGroup",cls:"anketa__checkboxgroupItems",vertical:true,defaults:{anchor:"100%"},items:[{boxLabel:reference.lang.anketaWindow.rsb.mc,name:"rsb",inputValue:"mc"},{boxLabel:reference.lang.anketaWindow.rsb.cards,name:"rsb",inputValue:"cards"},{boxLabel:reference.lang.anketaWindow.rsb.debt,name:"rsb",inputValue:"debt"},{boxLabel:reference.lang.anketaWindow.rsb.overpayment,name:"rsb",inputValue:"overpayment"},{boxLabel:reference.lang.anketaWindow.rsb.reconciliation,name:"rsb",inputValue:"reconciliation"},{boxLabel:reference.lang.anketaWindow.rsb.cameral,name:"rsb",inputValue:"cameral"},{boxLabel:reference.lang.anketaWindow.rsb.rOverpayment,name:"rsb",inputValue:"rOverpayment"},{boxLabel:reference.lang.anketaWindow.rsb.rClarify,name:"rsb",inputValue:"rClarify"},{boxLabel:reference.lang.anketaWindow.rsb.rReconciliation,name:"rsb",inputValue:"rReconciliation"},{boxLabel:reference.lang.anketaWindow.rsb.docs,name:"rsb",inputValue:"docs"}]}]}]}]},{xtype:"container",itemId:"secondStep",items:[{xtype:"container",layout:{type:"hbox",pack:"center",align:"middle"},margin:"10 0",items:[{xtype:"component",html:"\u041e\u0446\u0435\u043d\u0438\u0442\u0435 \u0443\u0434\u043e\u0431\u0441\u0442\u0432\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0445 \u0444\u0443\u043d\u043a\u0446\u0438\u0439"}]},{xtype:"form",itemId:"step2-form",cls:"anketa__step2",layout:{type:"hbox"},items:[{xtype:"container",margin:"0 25 0 0",width:"48%",items:[{xtype:"container",layout:{type:"hbox"},defaults:{xtype:"component",cls:"fs-12 ta-c"},items:[{width:"68%",html:"<span></span>"},{width:"16%",html:"\u0441\u043a\u043e\u0440\u0435\u0435 \u043d\u0435\u0443\u0434\u043e\u0431\u043d\u043e"},{width:"16%",html:"\u0441\u043a\u043e\u0440\u0435\u0435 \u0443\u0434\u043e\u0431\u043d\u043e"}]},{xtype:"component",html:"<hr/>"},{xtype:"container",itemId:"step-2-column-1",margin:"5 0",items:[]}]},{xtype:"container",width:"48%",cls:"fl-r",items:[{xtype:"container",layout:{type:"hbox"},defaults:{xtype:"component",cls:"fs-12 ta-c"},items:[{width:"68%",html:"<span></span>"},{width:"16%",html:"\u0441\u043a\u043e\u0440\u0435\u0435 \u043d\u0435\u0443\u0434\u043e\u0431\u043d\u043e"},{width:"16%",html:"\u0441\u043a\u043e\u0440\u0435\u0435 \u0443\u0434\u043e\u0431\u043d\u043e"}]},{xtype:"component",html:"<hr/>"},{xtype:"container",itemId:"step-2-column-2",margin:"5 0",items:[]}]}]}]},{xtype:"container",itemId:"lastElement",margin:"15 0 0",items:[{xtype:"form",layout:"anchor",itemId:"step3-form",defaults:{anchor:"100%"},items:[{xtype:"radiogroup",margin:"0",fieldLabel:reference.lang.anketaWindow.quality,labelWidth:500,allowBlank:false,items:[{boxLabel:1,name:"quality",inputValue:"1"},{boxLabel:2,name:"quality",inputValue:"2"},{boxLabel:3,name:"quality",inputValue:"3"},{boxLabel:4,name:"quality",inputValue:"4"},{boxLabel:5,name:"quality",inputValue:"5"}]},{xtype:"component",html:reference.lang.anketaWindow.feedbackArea},{xtype:"textareafield",name:"feedback_text",itemId:"feedbackText",grow:true,maxLength:2500,enforceMaxLength:true,allowBlank:true,margin:"5 0 15 0"}]}]}]}]});a.callParent(arguments)}},0,["anketaWindow"],["panel","anketaWindow","window","component","container","box"],{panel:true,anketaWindow:true,window:true,component:true,container:true,box:true},["widget.anketaWindow"],0,[LkIp.view,"AnketaWindow"],0));(Ext.cmd.derive("LkIp.view.Calculator.RegionWindow",Ext.window.Window,{autoHeight:true,layout:"auto",modal:true,ui:"nalogThemeWindow",padding:10,factoryCode:undefined,rnm:undefined,width:700,title:reference.lang.calculator.regionWindowTitle,initComponent:function(){var a=this;Ext.apply(a,{items:[{xtype:"component",html:reference.lang.calculator.regionWindowText},{xtype:"form",items:[{xtype:"filterSelect",width:640,labelWidth:150,maskRe:undefined,anyMatch:true,typeAhead:false,forceSelection:false,name:"region",itemId:"region",fieldLabel:reference.lang.address.region,allowBlank:false,store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Address.SelectFilters",autoDestroy:true,storeId:"addressRegionStore"},listeners:{select:function(b){a.down("#goBtn").setDisabled(false);a.down("#goBtn").setHref("http://nalog.ru/rn"+b.getValue()+"/taxation/taxes/usn/#title11");a.down("#link").update('<a href="http://nalog.ru/rn'+b.getValue()+'/taxation/taxes/usn/#title11" target="_blank">http://nalog.ru/rn'+b.getValue()+"/taxation/taxes/usn/#title11</a>")}}},{xtype:"component",margin:"10 0 20 0",itemId:"link"},{xtype:"container",layout:"hbox",defaults:{xtype:"button",handler:function(){a.close()}},align:"right",items:[{disabled:true,itemId:"goBtn",href:"http://nalog.ru",text:reference.lang.buttons.goOver},{margin:"0 0 0 15",text:reference.lang.buttons.cancel,handler:function(){a.close()}}]}]}]});a.callParent(arguments)}},0,["regionWindow"],["panel","window","component","container","box","regionWindow"],{panel:true,window:true,component:true,container:true,box:true,regionWindow:true},["widget.regionWindow"],0,[LkIp.view.Calculator,"RegionWindow"],0));(Ext.cmd.derive("LkIp.view.Docflow.Documents.Answers",Ext.window.Window,{autoHeight:true,layout:"auto",modal:true,ui:"nalogThemeWindow",padding:"0 5",width:"60%",minHeight:120,answers:undefined,onClose:undefined,initComponent:function(){var a=this;Ext.apply(a,{items:[{xtype:"gridtable",paging:false,getFileAction:false,itemId:"answersGrid",store:{extend:"Ext.data.ArrayStore",model:"LkIp.model.Docflow.Documents.Answers",autoDestroy:true,storeId:"answersStore"},columns:[{text:reference.lang.docflow.grid.noAnswerName,dataIndex:"@NaimDokOtvNO",sortable:false,flex:1},{text:"",dataIndex:"need_signature",sortable:false,width:250,align:"center",menuText:reference.lang.docflow.grid.answerDoc,renderer:function(i,b,d){var h=d.get("@ExtDokOtvNO"),f=d.internalId,g=d.get("@TipOtv"),j=" get-answer-link answer-item ";if(i){return reference.lang.docflow.grid.signAnswer+'<br/><br/><a class="simple-button sign-receipt" data-internalId="'+f+'">\u041f\u043e\u0434\u043f\u0438\u0441\u0430\u0442\u044c \u043a\u0432\u0438\u0442\u0430\u043d\u0446\u0438\u044e</a>'}else{switch(h){case"pdf":j+="pdf-32-icon ";break;case"zip":j+="zip-32-icon ";break;case"doc":case"docs":j+="doc-32-icon";break;case"loading":j="loading-32-icon";break;case"zip_gray":j+="zip-32-gray-icon default-cursor";break;default:j+="x-hide-display";break}if(g=="117"&&"zip_gray"!=i){j+=" egrip-ttip"}var c="";switch(h){case"pdf":case"zip":case"doc":case"docs":c=g=="117"?"":reference.lang.download;break;case"zip_gray":c=reference.lang.docflow.unavailable;break;case"loading":default:}b.tdAttr='data-qtip="'+c+'"';var e='<div class="answers"><div class="'+j+'" style="cursor: pointer;" data-internalId="'+f+'"></div>';if("299"==g){j=j.replace("pdf-32-icon","xml-32-icon");e+='<div class="'+j+'" style="ursor: pointer;" data-internalId="'+f+'" data-returnIn="xml"></div>'}e+="</div>";return e}}},{text:reference.lang.docflow.grid.noAnswerDate,dataIndex:"@DataPolucheniyaOtv",sortable:true,width:120,renderer:function(b){return !Ext.isEmpty(b)?LkIp.Utils.getDate(b,true):""}}]}]});a.callParent(arguments)},listeners:{show:function(b){var a=b.down("#answersGrid").getStore();a.removeAll();a.loadData(b.answers)},close:function(a){if(Ext.isFunction(a.onClose)){a.onClose()}}}},0,["docflowAnswers"],["panel","docflowAnswers","window","component","container","box"],{panel:true,docflowAnswers:true,window:true,component:true,container:true,box:true},["widget.docflowAnswers"],0,[LkIp.view.Docflow.Documents,"Answers"],0));(Ext.cmd.derive("LkIp.view.Docflow.Notice.SignReceiptWindow",Ext.window.Window,{autoHeight:true,layout:"auto",modal:true,ui:"nalogThemeWindow",bodyPadding:10,title:reference.lang.docflowNotice.signReceipt.title,width:550,minHeight:120,initComponent:function(){var a=this;Ext.apply(a,{buttons:[{text:reference.lang.buttons.cancel,handler:function(){a.close()}},{text:reference.lang.docflowNotice.signReceipt.signButton,componentCls:"sign-answer-receipt"}],items:[{xtype:"component",html:reference.lang.docflow.grid.signAnswer}]});a.callParent(arguments)}},0,["signReceiptWidow"],["panel","signReceiptWidow","window","component","container","box"],{panel:true,signReceiptWidow:true,window:true,component:true,container:true,box:true},["widget.signReceiptWidow"],0,[LkIp.view.Docflow.Notice,"SignReceiptWindow"],0));(Ext.cmd.derive("LkIp.view.Kkt.ChooseFn",Ext.window.Window,{autoHeight:true,layout:"auto",modal:true,ui:"nalogThemeWindow",width:700,minHeight:400,data:undefined,componentCls:"kktRegistration",storeId:"kktRegistrationChooseFnStore",initComponent:function(){var a=this;Ext.apply(a,{defaults:{margin:15},items:[{xtype:"component",html:"\u0412\u0430\u043c \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u043c\u043e\u0434\u0435\u043b\u044c \u0444\u0438\u0441\u043a\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043d\u0430\u043a\u043e\u043f\u0438\u0442\u0435\u043b\u044f, \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u0443\u044e \u0432 \u044d\u043a\u0441\u043f\u043b\u0443\u0430\u0442\u0430\u0446\u0438\u043e\u043d\u043d\u043e\u0439 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u0438. <br/> \u0414\u043b\u044f \u044d\u0442\u043e\u0433\u043e \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0432\u044b\u0431\u0440\u0430\u0442\u044c \u043c\u043e\u0434\u0435\u043b\u044c \u0438\u0437 \u0442\u0430\u0431\u043b\u0438\u0446\u044b (\u0434\u043b\u044f \u0443\u0434\u043e\u0431\u043d\u043e\u0433\u043e \u043f\u043e\u0438\u0441\u043a\u0430 \u043c\u043e\u0436\u043d\u043e \u0432\u043e\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0444\u0438\u043b\u044c\u0442\u0440\u043e\u043c \u043f\u043e \u043d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u044e). \u041f\u043e\u0441\u043b\u0435 \u044d\u0442\u043e\u0433\u043e \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0432\u0432\u0435\u0441\u0442\u0438 \u043d\u043e\u043c\u0435\u0440 \u0444\u0438\u0441\u043a\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043d\u0430\u043a\u043e\u043f\u0438\u0442\u0435\u043b\u044f, \u043f\u0440\u0438\u0441\u0432\u043e\u0435\u043d\u043d\u044b\u0439 \u0438\u0437\u0433\u043e\u0442\u043e\u0432\u0438\u0442\u0435\u043b\u0435\u043c, \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0439 \u0432 \u044d\u043a\u0441\u043f\u043b\u0443\u0430\u0442\u0430\u0446\u0438\u043e\u043d\u043d\u043e\u0439 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u0438."},{xtype:"textfield",fieldLabel:reference.lang.kkt.registration.fnFilter.label,width:"80%",labelWidth:Ext.isIE8?"21%":"15%",itemId:"chooseFnModelFilter"},{xtype:"gridtable",itemId:"kktRegistrationChooseFnGrid",queryMode:"local",store:{extend:"Ext.data.ArrayStore",fields:["value","code"],autoDestroy:true,storeId:a.storeId},limitFilter:false,getFileAction:false,contextMenu:false,paging:false,height:200,columns:[{text:"\u041c\u043e\u0434\u0435\u043b\u044c",dataIndex:"value",sortable:true,flex:1}]},{xtype:"component",itemId:"kktRegistrationChooseFnSelected",tpl:'<div><span class="bold" style="margin-right: 75px;">\u0412\u044b \u0432\u044b\u0431\u0440\u0430\u043b\u0438: </span>{selectedModel}</div>',data:{selectedModel:"-"}},{xtype:"form",itemId:"kktRegistrationChooseFnForm",items:[{xtype:"textfield",itemId:"kktRegistrationChooseFnFactoryCode",vtype:"factoryCode",labelWidth:200,width:670,msgTarget:"under",fieldLabel:'<span class="page-action-link help-tooltip" data-help="'+reference.lang.kkt.help.fn_factory_code+'">'+reference.lang.kkt.registration.fnFactoryCode+"</span>",maxLength:100,enforceMaxLength:true,hidden:true,allowBlank:false},{xtype:"button",disabled:true,formBind:true,itemId:"kktRegistrationChooseFnButton",text:reference.lang.buttons.choose}]}]});a.callParent(arguments)}},0,["chooseFn"],["panel","window","chooseFn","component","container","box"],{panel:true,window:true,chooseFn:true,component:true,container:true,box:true},["widget.chooseFn"],0,[LkIp.view.Kkt,"ChooseFn"],0));(Ext.cmd.derive("LkIp.view.Kkt.ChooseKkt",Ext.window.Window,{autoHeight:true,layout:"auto",modal:true,ui:"nalogThemeWindow",title:reference.lang.kkt.registration.chooseKktWindowTitle,width:700,minHeight:400,data:undefined,componentCls:"kktRegistration",initComponent:function(){var a=this;Ext.apply(a,{defaults:{margin:15},items:[{xtype:"component",html:"\u0412\u0430\u043c \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u043c\u043e\u0434\u0435\u043b\u044c \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044c\u043d\u043e-\u043a\u0430\u0441\u0441\u043e\u0432\u043e\u0439 \u0442\u0435\u0445\u043d\u0438\u043a\u0438, \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0439 \u0432 \u044d\u043a\u0441\u043f\u043b\u0443\u0430\u0442\u0430\u0446\u0438\u043e\u043d\u043d\u043e\u0439 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u0438. <br/> \u0414\u043b\u044f \u044d\u0442\u043e\u0433\u043e \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0432\u044b\u0431\u0440\u0430\u0442\u044c \u043c\u043e\u0434\u0435\u043b\u044c \u0438\u0437 \u0442\u0430\u0431\u043b\u0438\u0446\u044b (\u0434\u043b\u044f \u0443\u0434\u043e\u0431\u043d\u043e\u0433\u043e \u043f\u043e\u0438\u0441\u043a\u0430 \u043c\u043e\u0436\u043d\u043e \u0432\u043e\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0444\u0438\u043b\u044c\u0442\u0440\u043e\u043c \u043f\u043e \u043d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u044e). \u041f\u043e\u0441\u043b\u0435 \u044d\u0442\u043e\u0433\u043e \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0432\u0432\u0435\u0441\u0442\u0438 \u0437\u0430\u0432\u043e\u0434\u0441\u043a\u043e\u0439 \u043d\u043e\u043c\u0435\u0440 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044c\u043d\u043e-\u043a\u0430\u0441\u0441\u043e\u0432\u043e\u0439 \u0442\u0435\u0445\u043d\u0438\u043a\u0438."},{xtype:"textfield",fieldLabel:reference.lang.kkt.registration.modelFilter.label,width:"90%",labelWidth:Ext.isIE8?"15%":"9%",itemId:"chooseKktModelFilter"},{xtype:"gridtable",itemId:"kktRegistrationChooseKktGrid",queryMode:"local",store:{extend:"Ext.data.ArrayStore",fields:["value","version","code"],autoDestroy:true,storeId:"kktRegistrationChooseKktStore"},limitFilter:false,getFileAction:false,contextMenu:false,paging:false,height:200,columns:[{text:"\u041c\u043e\u0434\u0435\u043b\u044c",dataIndex:"value",sortable:true,flex:1},{text:"\u0412\u0435\u0440\u0441\u0438\u044f",dataIndex:"version",sortable:true,width:80}]},{xtype:"component",itemId:"kktRegistrationChooseKktSelected",tpl:'<div><span class="bold" style="margin-right: 75px;">\u0412\u044b \u0432\u044b\u0431\u0440\u0430\u043b\u0438: </span>{selectedModel}</div>',data:{selectedModel:"-"}},{xtype:"form",itemId:"kktRegistrationChooseKktForm",items:[{xtype:"textfield",itemId:"kktRegistrationChooseKktFactoryCode",vtype:"factoryCode",labelWidth:200,width:670,msgTarget:"under",fieldLabel:'<span class="page-action-link help-tooltip" data-help="'+reference.lang.kkt.help.kkt_factory_code+'">'+reference.lang.kkt.registration.modelFactoryCode+"</span>",maxLength:20,enforceMaxLength:true,hidden:true,allowBlank:false},{xtype:"button",disabled:true,formBind:true,itemId:"kktRegistrationChooseKktButton",text:reference.lang.buttons.choose}]}]});a.callParent(arguments)}},0,["chooseKkt"],["panel","chooseKkt","window","component","container","box"],{panel:true,chooseKkt:true,window:true,component:true,container:true,box:true},["widget.chooseKkt"],0,[LkIp.view.Kkt,"ChooseKkt"],0));(Ext.cmd.derive("LkIp.view.Kkt.KktInformation",Ext.window.Window,{autoHeight:true,layout:"auto",modal:true,ui:"nalogThemeWindow",width:700,minHeight:400,data:undefined,componentCls:"kktInformationWindow",hideKktRegistrationInfoBlock:true,initComponent:function(){var a=this;Ext.apply(a,{defaults:{margin:15},items:[{xtype:"note",itemId:"kktFinishRegistrationInfo",hidden:true,text:reference.lang.kkt.details.help},{xtype:"note",itemId:"kktFinishReRegistrationInfo",hidden:true,text:reference.lang.kkt.details.helpRe},{xtype:"note",itemId:"kktChangeReRegistrationInfo",hidden:true,text:reference.lang.kkt.details.helpReChange},{xtype:"note",itemId:"kktFinishRegistrationNotInLkInfo",hidden:true,text:reference.lang.kkt.details.helpNotFromLk},{xtype:"note",itemId:"kktFinishRegistrationNotInLkOfdInfo",hidden:true,text:reference.lang.kkt.details.helpNotFromLkOfd},{xtype:"note",itemId:"closedUserBlock",hidden:!LkIp.User.isClosedUser(),text:reference.lang.errors.closedUser},{xtype:"container",layout:{type:"table",columns:2},cls:"twoColumnsStripedTable",defaults:{xtype:"component"},items:[{html:reference.lang.kkt.grid.state,cls:"twoColumnsStripedTable__td-left"},{html:LkIp.app.getController("Kkt.Index").drawIndicator(a.data.status_key)+' <div class="twoColumnsStripedTable__td-inline-text">'+a.data.status+"</div>",cls:"twoColumnsStripedTable__td-right twoColumnsStripedTable__td-inline"},{html:reference.lang.kkt.details.date,cls:"twoColumnsStripedTable__td-left"},{html:!Ext.isEmpty(a.data.date)?a.data.date:"-",cls:"twoColumnsStripedTable__td-right"},{html:reference.lang.kkt.details.address,cls:"twoColumnsStripedTable__td-left"},{html:a.data.address+", "+a.data.place_name,cls:"twoColumnsStripedTable__td-right"},{html:reference.lang.kkt.details.rnm,cls:"twoColumnsStripedTable__td-left"},{html:a.data.rnm,cls:"twoColumnsStripedTable__td-right"},{html:reference.lang.kkt.details.model_kkt,cls:"twoColumnsStripedTable__td-left"},{html:a.data.model_kkt_full+", \u2116 "+a.data.model_factory_code,cls:"twoColumnsStripedTable__td-right"},{html:reference.lang.kkt.details.model_fn,cls:"twoColumnsStripedTable__td-left"},{html:a.data.model_fn+", \u2116 "+a.data.model_fn_code+(!Ext.isEmpty(a.data.date_stop_fn)?", \u0414\u0430\u0442\u0430 \u043e\u043a\u043e\u043d\u0447\u0430\u043d\u0438\u044f \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f: "+a.data.date_stop_fn:""),cls:"twoColumnsStripedTable__td-right"},{html:reference.lang.kkt.details.no,cls:"twoColumnsStripedTable__td-left"},{html:a.data.no_full,cls:"twoColumnsStripedTable__td-right"},{html:reference.lang.kkt.details.ofd,hidden:Ext.isEmpty(a.data.ofd),cls:"twoColumnsStripedTable__td-left"},{html:a.data.ofd,hidden:Ext.isEmpty(a.data.ofd),cls:"twoColumnsStripedTable__td-right"},{html:reference.lang.kkt.details.okved,hidden:Ext.isEmpty(a.data.okved),cls:"twoColumnsStripedTable__td-left"},{html:a.data.okved,hidden:Ext.isEmpty(a.data.okved)}]},{xtype:"container",itemId:"kktOptionsBlock",hidden:true,items:[{xtype:"component",html:"\u041a\u043e\u043d\u0442\u0440\u043e\u043b\u044c\u043d\u043e-\u043a\u0430\u0441\u0441\u043e\u0432\u0430\u044f \u0442\u0435\u0445\u043d\u0438\u043a\u0430:",margin:5},{xtype:"component",itemId:"kktOptionsText",html:"-"},{xtype:"component",html:"<hr/>"}]},{xtype:"note",hidden:true,itemId:"kktNotFromLk",text:reference.lang.kkt.kktNotFromLk},{xtype:"note",hidden:true,itemId:"kktNotFromLkOfd",text:reference.lang.kkt.kktNotFromLkOfd},{xtype:"container",itemId:"kktActions",defaults:{xtype:"button",margin:"0 10 0 0",width:202,hidden:true},items:[{itemId:"kktRegistrationOneMoreTimeButton",text:reference.lang.kkt.registrationOneMoreTime,type:"registrationStatement",width:212},{itemId:"kktFinishRegistrationButton",text:reference.lang.kkt.finishRegistration,type:"fiscalizationReport"},{itemId:"kktFinishReRegistrationButton",text:reference.lang.kkt.finishReRegistration,type:"closeFiscalizationReport",width:212},{itemId:"kktChangeReRegistrationButton",text:reference.lang.kkt.changeReRegistration,type:"changeFiscalizationReport",width:212},{itemId:"kktReRegistrationButton",text:reference.lang.kkt.reRegisterBtn},{itemId:"kktDeRegistrationButton",text:reference.lang.kkt.deregistration},{itemId:"kktContinueRegistrationButton",text:reference.lang.kkt.registerBtn},{itemId:"kktDownloadRegistrationCardButton",text:reference.lang.kkt.details.download}]}]});a.callParent(arguments)},listeners:{show:function(a){var g=this;Ext.suspendLayouts();var c=g.generateKktInformation();if(!Ext.isEmpty(c)){a.down("#kktOptionsBlock").show();a.down("#kktOptionsText").update('<ul class="kktInformationWindow__kktOptions">'+c+"</ul>")}var f=!Ext.isEmpty(g.data.date),i=f&&g.data.has_file;if(Ext.Array.contains(["13003","13005","13006","13007","13008"],g.data.status_key)&&!g.data.from_lk){if(g.data.from_ofd){a.down("#kktNotFromLkOfd").show()}else{a.down("#kktNotFromLk").show()}}if(LkIp.User.isActiveUser()){a.down("#kktDownloadRegistrationCardButton").setVisible(i);var h=f&&g.data.status_key!="13011",k=g.data.status_key=="13002",j=f&&g.data.status_key!="13011",e=g.data.status_key=="13006",d=g.data.status_key=="13005",b=g.data.status_key=="13012";if(g.data.from_lk){a.down("#kktFinishRegistrationInfo").setVisible(!g.hideKktRegistrationInfoBlock&&!b);a.down("#kktFinishRegistrationButton").setVisible((!g.hideKktRegistrationInfoBlock))}if(b){a.down("#kktRegistrationOneMoreTimeButton").setVisible(true)}if(g.hideKktRegistrationInfoBlock){if(g.data.from_lk){a.down("#kktFinishReRegistrationInfo").setVisible(e);a.down("#kktFinishReRegistrationButton").setVisible(e);a.down("#kktChangeReRegistrationButton").setVisible(d);a.down("#kktChangeReRegistrationInfo").setVisible(d)}if(!e&&!d){a.down("#kktReRegistrationButton").setVisible(h);a.down("#kktDeRegistrationButton").setVisible(j);if(g.data.from_lk){a.down("#kktContinueRegistrationButton").setVisible(k)}}}}Ext.resumeLayouts(true)}},generateKktInformation:function(){var a=this,b="";if(a.data.autoMode==1){b+="<li>"+reference.lang.kkt.registration.autoModeDetails+"</li>"}if(a.data.lottery==1){b+="<li>"+reference.lang.kkt.registration.lotteryDetails+"</li>"}if(a.data.rates==1){b+="<li>"+reference.lang.kkt.registration.ratesDetails+"</li>"}if(a.data.bank==1){b+="<li>"+reference.lang.kkt.registration.bankDetails+"</li>"}if(a.data.calculation_device==1){b+="<li>"+reference.lang.kkt.registration.calculation_deviceDetails+(!Ext.isEmpty(a.data.calculation_device_number)?" (\u041d\u043e\u043c\u0435\u0440 \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0430: "+a.data.calculation_device_number+")":"")+"</li>"}if(a.data.internet==1){b+="<li>"+reference.lang.kkt.registration.internetDetails+"</li>"}if(a.data.peddling==1){b+="<li>"+reference.lang.kkt.registration.peddlingDetails+"</li>"}if(a.data.blank==1){b+="<li>"+reference.lang.kkt.registration.blankDetails+"</li>"}if(a.data.akciz==1){b+="<li>"+reference.lang.kkt.registration.akcizDetails+"</li>"}if(a.data.payment_agent==1){b+="<li>"+reference.lang.kkt.registration.platAgentDetails+"</li>"}return b}},0,["kktInformation"],["panel","window","component","kktInformation","container","box"],{panel:true,window:true,component:true,kktInformation:true,container:true,box:true},["widget.kktInformation"],0,[LkIp.view.Kkt,"KktInformation"],0));var defaultFolder="/extjs/lk-ip-app/";var browserLocalStorage;try{browserLocalStorage=window.localStorage}catch(exception){browserLocalStorage=false}if(typeof String.prototype.trim!=="function"){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}}Ext.isMobile=isMobile;Ext.isSafariPrivateMode=checkPrivateMode();if(!Ext.isIE&&Object.hasOwnProperty.call(window,"ActiveXObject")&&!window.ActiveXObject){Ext.ieVersion=11;Ext.isIE=true}Ext.onReady(function(){Ext.application({name:"LkIp",appFolder:defaultFolder+"app",extend:"LkIp.Application",lastmodified:"13.08.2018",version:"18.08.3"})});